!function(ed){function td(rd){if(ad[rd])return ad[rd].exports;var od=ad[rd]={i:rd,l:!1,exports:{}};return ed[rd].call(od.exports,od,od.exports,td),od.l=!0,od.exports}var ad={};td.m=ed,td.c=ad,td.d=function(rd,od,id){td.o(rd,od)||Object.defineProperty(rd,od,{configurable:!1,enumerable:!0,get:id})},td.r=function(rd){Object.defineProperty(rd,"__esModule",{value:!0})},td.n=function(rd){var od=rd&&rd.__esModule?function(){return rd.default}:function(){return rd};return td.d(od,"a",od),od},td.o=function(rd,od){return Object.prototype.hasOwnProperty.call(rd,od)},td.p="",td(td.s=74)}([function(ed,td,ad){function rd(xd){return od(this).alloc(xd)}function od(xd){return cd(xd)?gd:md(xd)?hd:pd(xd)?ud:dd?gd:ld?hd:ud}function id(){return!1}function nd(xd,vd){return xd="[object "+xd+"]",function(Ld){return null!=Ld&&{}.toString.call(vd?Ld[vd]:Ld)===xd}}var sd=td.global=ad(41),dd=td.hasBuffer=sd&&!!sd.isBuffer,ld=td.hasArrayBuffer="undefined"!=typeof ArrayBuffer,pd=td.isArray=ad(4);td.isArrayBuffer=ld?function(xd){return xd instanceof ArrayBuffer||yd(xd)}:id;var cd=td.isBuffer=dd?sd.isBuffer:id,md=td.isView=ld?ArrayBuffer.isView||nd("ArrayBuffer","buffer"):id;td.alloc=rd,td.concat=function(xd,vd){vd||(vd=0,Array.prototype.forEach.call(xd,function(Ad){vd+=Ad.length}));var Ld=this!==td&&this||xd[0],bd=rd.call(Ld,vd),_d=0;return Array.prototype.forEach.call(xd,function(Ad){_d+=fd.copy.call(Ad,bd,_d)}),bd},td.from=function(xd){return"string"==typeof xd?function(vd){var Ld=3*vd.length,bd=rd.call(this,Ld),_d=fd.write.call(bd,vd);return Ld!==_d&&(bd=fd.slice.call(bd,0,_d)),bd}.call(this,xd):od(this).from(xd)};var ud=td.Array=ad(39),gd=td.Buffer=ad(38),hd=td.Uint8Array=ad(37),fd=td.prototype=ad(7),yd=nd("ArrayBuffer")},function(ed,td,ad){(function(rd){ed.exports.isProd=void 0!==rd&&!!rd.env.IS_PROD||"undefined"!=typeof location&&"127.0.0.1"!==location.hostname&&!location.hostname.startsWith("192.168."),ed.exports.enableHttps=ed.exports.isProd,ed.exports.serverTickRate=1e3/30,ed.exports.serverSendRate=100,ed.exports.clientSendRate=1e3/30,ed.exports.maxDelta=1e3/30,ed.exports.maxPlayers=8,ed.exports.playerSpread=1,ed.exports.gamesPerServer=6,ed.exports.kickTimer=45e3,ed.exports.prefabIDS=["CUBE","CRATE","BARREL","LADDER","PLANE","SPAWN_POINT","CAMERA_POSITION","VEHICLE","STACK","RAMP"],ed.exports.gravity=15e-5,ed.exports.deathY=-300,ed.exports.skyScale=18e3,ed.exports.shadowDst=600,ed.exports.shadowRes=512,ed.exports.shadowOff=.004,ed.exports.lightDistance=300,ed.exports.cornerPad=1,ed.exports.cornerScl=2.5,ed.exports.cornerH=7,ed.exports.wallH=5,ed.exports.wallW=.8,ed.exports.crateScale=6,ed.exports.stackScale=6,ed.exports.barrelScale=4,ed.exports.vehicleScale=20,ed.exports.barrelMlt=1.5,ed.exports.ladderWidth=3.2,ed.exports.ladderScale=.5,ed.exports.terrainGrid=8,ed.exports.otherSoundMlt=.55,ed.exports.gameTime=24e4,ed.exports.endTimer=2e4,ed.exports.endAnim=5e3,ed.exports.maxParticles=100,ed.exports.chatMaxLength=70,ed.exports.chatInterval=800,ed.exports.movDirs=[];for(var od=0;8>od;++od)ed.exports.movDirs.push(-Math.PI+(od+1)*Math.PI/4);ed.exports.interpolation=1.1,ed.exports.stateHistory=1e3,ed.exports.syncFreq=500,ed.exports.pingCount=10,ed.exports.mouseSens=.0024,ed.exports.camChaseTrn=.0022,ed.exports.camChaseSpd=.0012,ed.exports.camChaseSen=.2,ed.exports.camChaseDst=30,ed.exports.menuCamDist=200,ed.exports.menuCamAngle=-.5,ed.exports.menuCamSpeed=.1,ed.exports.animMult=1.2,ed.exports.leanPull=.99,ed.exports.leanSens=.035,ed.exports.leanMax=.16,ed.exports.bobAnimZMax=.3,ed.exports.leanPullZ=.99,ed.exports.leanMltZ=.028,ed.exports.bobMltY=.028,ed.exports.bobMltZ=.08,ed.exports.bobPullY=.985,ed.exports.bobPullZ=.99,ed.exports.aimAnimMlt=.18,ed.exports.aimSlow=.55,ed.exports.aimJumpSlow=.75,ed.exports.stepAnim=.065,ed.exports.stepMlt=.25,ed.exports.stepPull=.995,ed.exports.maxHealth=100,ed.exports.passiveInc=500,ed.exports.cameraHeight=1.5,ed.exports.playerSpeed=42e-5,ed.exports.ladderSpeed=.035,ed.exports.ladderDecel=.97,ed.exports.groundDecel=.99,ed.exports.airSpeed=45e-6,ed.exports.airDecel=.9995,ed.exports.jumpVel=.072,ed.exports.jumpPush=.1,ed.exports.decelMin=1e-4,ed.exports.climbHeight=1.5,ed.exports.wpnSpin=.018,ed.exports.materialDens={flesh:.2,floor_0:.5},ed.exports.nameOffset=2,ed.exports.maxNameLength=14,ed.exports.maxPassLength=16,ed.exports.playerHeight=11,ed.exports.chestWidth=2.6,ed.exports.chestScale=1.3,ed.exports.armScale=1.3,ed.exports.legScale=1.3,ed.exports.uArmLength=2.7,ed.exports.armInset=-.1,ed.exports.lArmLength=2.7,ed.exports.headScale=2,ed.exports.armOff=-.8,ed.exports.legHeight=4.2,ed.exports.playerScale=(2*ed.exports.armScale+ed.exports.chestWidth+ed.exports.armInset)/2,ed.exports.hitBoxPad=1,ed.exports.tracerMinDst=60,ed.exports.tracerMaxDst=400,ed.exports.tracerSpeed=1.7,ed.exports.tracerChance=1,ed.exports.crouchLean=-.1*Math.PI,ed.exports.crouchDst=2.5,ed.exports.crouchSlow=.3,ed.exports.crouchSpeed=.007,ed.exports.crouchJump=.25,ed.exports.crouchSpread=.4,ed.exports.crouchAnim=7e-4,ed.exports.crouchAnimMlt=.5,ed.exports.spreadMove=30,ed.exports.spreadFall=35,ed.exports.spreadRecover=.985,ed.exports.spreadAdj=63e-5,ed.exports.spreadMlt=400,ed.exports.recoilMlt=.3,ed.exports.maxLevel=60,ed.exports.medalAnim=1e3,ed.exports.medalDelay=900,ed.exports.scoreStreak=2e3,ed.exports.feedTimer=1500,ed.exports.spinTimer=1800,ed.exports.endStats=["sid","name","score","kills","deaths","highest"],ed.exports.hitLife=1e3,ed.exports.regenDelay=5e3,ed.exports.regenVal=10,ed.exports.sprayTimer=1e3,ed.exports.sprayRange=25,ed.exports.sprayScale=15,ed.exports.deathDelay=2800,ed.exports.deathFollowD=100,ed.exports.fov=70,ed.exports.viewDist=2e3,ed.exports.nameVisRate=200,ed.exports.worldUV=60,ed.exports.ambientVal=.3,ed.exports.ambD=2,ed.exports.ambMlt=15,ed.exports.ambS=3,ed.exports.ambScale=6,ed.exports.ambBleed=0,ed.exports.rankVar=.03,ed.exports.newDataInterval=6e4,ed.exports.socials=["leaders","profile","feed"],ed.exports.leaderQueries=["score","kills","wins","timeplayed"],ed.exports.leaderCal={player_score:function(id){return"<span class='lName'>lvl </span>"+Math.max(1,Math.floor(ed.exports.rankVar*Math.sqrt(id)))},player_kills:function(id){return id+"<span class='lName'> kills</span>"},player_wins:function(id){return id+"<span class='lName'> wins</span>"},player_timeplayed:function(id){var nd=id/1e3/60,sd=parseInt(nd%60);nd/=60;var dd=parseInt(nd%24);nd/=24;var ld=parseInt(nd);return(ld?ld+"d ":"")+(dd?dd+"h ":"")+(sd||0)+"m "}}}).call(this,ad(24))},function(ed,td,ad){"use strict";function rd(){}function od(ix,nx){this.x=ix||0,this.y=nx||0}function id(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],0<arguments.length&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}function nd(ix,nx,sx,dx){this._x=ix||0,this._y=nx||0,this._z=sx||0,this._w=void 0===dx?1:dx}function sd(ix,nx,sx){this.x=ix||0,this.y=nx||0,this.z=sx||0}function dd(){this.elements=[1,0,0,0,1,0,0,0,1],0<arguments.length&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}function ld(ix,nx,sx,dx,lx,px,cx,mx,ux,gx){Object.defineProperty(this,"id",{value:gy++}),this.uuid=uy.generateUUID(),this.name="",this.image=void 0===ix?ld.DEFAULT_IMAGE:ix,this.mipmaps=[],this.mapping=void 0===nx?ld.DEFAULT_MAPPING:nx,this.wrapS=void 0===sx?Xh:sx,this.wrapT=void 0===dx?Xh:dx,this.magFilter=void 0===lx?Qh:lx,this.minFilter=void 0===px?ef:px,this.anisotropy=void 0===ux?1:ux,this.format=void 0===cx?ff:cx,this.type=void 0===mx?tf:mx,this.offset=new od(0,0),this.repeat=new od(1,1),this.center=new od(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new dd,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=void 0===gx?ry:gx,this.version=0,this.onUpdate=null}function pd(ix,nx,sx,dx){this.x=ix||0,this.y=nx||0,this.z=sx||0,this.w=void 0===dx?1:dx}function cd(ix,nx,sx){this.uuid=uy.generateUUID(),this.width=ix,this.height=nx,this.scissor=new pd(0,0,ix,nx),this.scissorTest=!1,this.viewport=new pd(0,0,ix,nx),void 0===(sx=sx||{}).minFilter&&(sx.minFilter=Qh),this.texture=new ld(void 0,void 0,sx.wrapS,sx.wrapT,sx.magFilter,sx.minFilter,sx.format,sx.type,sx.anisotropy,sx.encoding),this.depthBuffer=void 0===sx.depthBuffer||sx.depthBuffer,this.stencilBuffer=void 0===sx.stencilBuffer||sx.stencilBuffer,this.depthTexture=void 0===sx.depthTexture?null:sx.depthTexture}function md(ix,nx,sx){cd.call(this,ix,nx,sx),this.activeCubeFace=0,this.activeMipMapLevel=0}function ud(ix,nx,sx,dx,lx,px,cx,mx,ux,gx,hx,fx){ld.call(this,null,px,cx,mx,ux,gx,dx,lx,hx,fx),this.image={data:ix,width:nx,height:sx},this.magFilter=void 0===ux?Zh:ux,this.minFilter=void 0===gx?Zh:gx,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}function gd(ix,nx,sx,dx,lx,px,cx,mx,ux,gx){ix=void 0===ix?[]:ix,nx=void 0===nx?Wh:nx,ld.call(this,ix,nx,sx,dx,lx,px,cx,mx,ux,gx),this.flipY=!1}function hd(){this.seq=[],this.map={}}function fd(ix,nx,sx){var dx=ix[0];if(0>=dx||0<dx)return ix;var lx=nx*sx,px=yy[lx];if(void 0===px&&(px=new Float32Array(lx),yy[lx]=px),0!==nx){dx.toArray(px,0);for(var cx=1,mx=0;cx!==nx;++cx)mx+=sx,ix[cx].toArray(px,mx)}return px}function yd(ix,nx){var sx=xy[nx];void 0===sx&&(sx=new Int32Array(nx),xy[nx]=sx);for(var dx=0;dx!==nx;++dx)sx[dx]=ix.allocTextureUnit();return sx}function xd(ix,nx){ix.uniform1f(this.addr,nx)}function vd(ix,nx){ix.uniform1i(this.addr,nx)}function Ld(ix,nx){void 0===nx.x?ix.uniform2fv(this.addr,nx):ix.uniform2f(this.addr,nx.x,nx.y)}function bd(ix,nx){void 0===nx.x?void 0===nx.r?ix.uniform3fv(this.addr,nx):ix.uniform3f(this.addr,nx.r,nx.g,nx.b):ix.uniform3f(this.addr,nx.x,nx.y,nx.z)}function _d(ix,nx){void 0===nx.x?ix.uniform4fv(this.addr,nx):ix.uniform4f(this.addr,nx.x,nx.y,nx.z,nx.w)}function Ad(ix,nx){ix.uniformMatrix2fv(this.addr,!1,nx.elements||nx)}function Ed(ix,nx){void 0===nx.elements?ix.uniformMatrix3fv(this.addr,!1,nx):(Ly.set(nx.elements),ix.uniformMatrix3fv(this.addr,!1,Ly))}function Sd(ix,nx){void 0===nx.elements?ix.uniformMatrix4fv(this.addr,!1,nx):(vy.set(nx.elements),ix.uniformMatrix4fv(this.addr,!1,vy))}function Td(ix,nx,sx){var dx=sx.allocTextureUnit();ix.uniform1i(this.addr,dx),sx.setTexture2D(nx||hy,dx)}function Md(ix,nx,sx){var dx=sx.allocTextureUnit();ix.uniform1i(this.addr,dx),sx.setTextureCube(nx||fy,dx)}function wd(ix,nx){ix.uniform2iv(this.addr,nx)}function Rd(ix,nx){ix.uniform3iv(this.addr,nx)}function Pd(ix,nx){ix.uniform4iv(this.addr,nx)}function Cd(ix,nx){ix.uniform1fv(this.addr,nx)}function Od(ix,nx){ix.uniform1iv(this.addr,nx)}function Id(ix,nx){ix.uniform2fv(this.addr,fd(nx,this.size,2))}function Dd(ix,nx){ix.uniform3fv(this.addr,fd(nx,this.size,3))}function Fd(ix,nx){ix.uniform4fv(this.addr,fd(nx,this.size,4))}function Bd(ix,nx){ix.uniformMatrix2fv(this.addr,!1,fd(nx,this.size,4))}function Ud(ix,nx){ix.uniformMatrix3fv(this.addr,!1,fd(nx,this.size,9))}function Nd(ix,nx){ix.uniformMatrix4fv(this.addr,!1,fd(nx,this.size,16))}function Wd(ix,nx,sx){var dx=nx.length,lx=yd(sx,dx);ix.uniform1iv(this.addr,lx);for(var px=0;px!==dx;++px)sx.setTexture2D(nx[px]||hy,lx[px])}function zd(ix,nx,sx){var dx=nx.length,lx=yd(sx,dx);ix.uniform1iv(this.addr,lx);for(var px=0;px!==dx;++px)sx.setTextureCube(nx[px]||fy,lx[px])}function Hd(ix,nx,sx){this.id=ix,this.addr=sx,this.setValue=function(){switch(nx.type){case 5126:return xd;case 35664:return Ld;case 35665:return bd;case 35666:return _d;case 35674:return Ad;case 35675:return Ed;case 35676:return Sd;case 35678:case 36198:return Td;case 35680:return Md;case 5124:case 35670:return vd;case 35667:case 35671:return wd;case 35668:case 35672:return Rd;case 35669:case 35673:return Pd;}}()}function Gd(ix,nx,sx){this.id=ix,this.addr=sx,this.size=nx.size,this.setValue=function(){switch(nx.type){case 5126:return Cd;case 35664:return Id;case 35665:return Dd;case 35666:return Fd;case 35674:return Bd;case 35675:return Ud;case 35676:return Nd;case 35678:return Wd;case 35680:return zd;case 5124:case 35670:return Od;case 35667:case 35671:return wd;case 35668:case 35672:return Rd;case 35669:case 35673:return Pd;}}()}function Vd(ix){this.id=ix,hd.call(this)}function kd(ix,nx){ix.seq.push(nx),ix.map[nx.id]=nx}function jd(ix,nx,sx){var dx=ix.name,lx=dx.length;for(by.lastIndex=0;;){var px=by.exec(dx),cx=by.lastIndex,mx=px[1],ux="]"===px[2],gx=px[3];if(ux&&(mx|=0),void 0===gx||"["===gx&&cx+2===lx){kd(sx,void 0===gx?new Hd(mx,ix,nx):new Gd(mx,ix,nx));break}var hx=sx.map[mx];void 0===hx&&kd(sx,hx=new Vd(mx)),sx=hx}}function Yd(ix,nx,sx){hd.call(this),this.renderer=sx;for(var dx=ix.getProgramParameter(nx,ix.ACTIVE_UNIFORMS),lx=0;lx<dx;++lx){var px=ix.getActiveUniform(nx,lx),cx=px.name;jd(px,ix.getUniformLocation(nx,cx),this)}}function Xd(ix,nx,sx){return void 0===nx&&void 0===sx?this.set(ix):this.setRGB(ix,nx,sx)}function qd(ix,nx,sx,dx,lx,px,cx,mx,ux){ld.call(this,ix,nx,sx,dx,lx,px,cx,mx,ux),this.needsUpdate=!0}function Zd(){Object.defineProperty(this,"id",{value:My++}),this.uuid=uy.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.lights=!0,this.blending=th,this.side=Yg,this.flatShading=!1,this.vertexColors=Kg,this.opacity=1,this.transparent=!1,this.blendSrc=hh,this.blendDst=fh,this.blendEquation=nh,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=Sh,this.depthTest=!0,this.depthWrite=!0,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.overdraw=0,this.visible=!0,this.userData={},this.needsUpdate=!0}function Jd(ix){Zd.call(this),this.type="MeshDepthMaterial",this.depthPacking=cy,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.setValues(ix)}function Kd(ix){Zd.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new sd,this.nearDistance=1,this.farDistance=1e3,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.lights=!1,this.setValues(ix)}function Qd(ix,nx){this.min=void 0===ix?new sd(1/0,1/0,1/0):ix,this.max=void 0===nx?new sd(-1/0,-1/0,-1/0):nx}function $d(ix,nx){this.center=void 0===ix?new sd:ix,this.radius=void 0===nx?0:nx}function el(ix,nx){this.normal=void 0===ix?new sd(1,0,0):ix,this.constant=void 0===nx?0:nx}function tl(ix,nx,sx,dx,lx,px){this.planes=[void 0===ix?new el:ix,void 0===nx?new el:nx,void 0===sx?new el:sx,void 0===dx?new el:dx,void 0===lx?new el:lx,void 0===px?new el:px]}function al(ix,nx,sx){function dx(Ox,Ix,Dx,Fx,Bx,Ux){var Nx=Ox.geometry,Wx=null,zx=vx,Hx=Ox.customDepthMaterial;if(Dx&&(zx=Lx,Hx=Ox.customDistanceMaterial),Hx)Wx=Hx;else{var Gx=!1;Ix.morphTargets&&(Nx&&Nx.isBufferGeometry?Gx=Nx.morphAttributes&&Nx.morphAttributes.position&&0<Nx.morphAttributes.position.length:Nx&&Nx.isGeometry&&(Gx=Nx.morphTargets&&0<Nx.morphTargets.length)),Ox.isSkinnedMesh&&!1===Ix.skinning&&console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",Ox);var Vx=Ox.isSkinnedMesh&&Ix.skinning,kx=0;Gx&&(kx|=fx),Vx&&(kx|=yx),Wx=zx[kx]}if(ix.localClippingEnabled&&!0===Ix.clipShadows&&0!==Ix.clippingPlanes.length){var jx=Wx.uuid,Yx=Ix.uuid,Xx=bx[jx];void 0===Xx&&(Xx={},bx[jx]=Xx);var qx=Xx[Yx];void 0===qx&&(qx=Wx.clone(),Xx[Yx]=qx),Wx=qx}return Wx.visible=Ix.visible,Wx.wireframe=Ix.wireframe,Wx.side=null==Ix.shadowSide?_x[Ix.side]:Ix.shadowSide,Wx.clipShadows=Ix.clipShadows,Wx.clippingPlanes=Ix.clippingPlanes,Wx.clipIntersection=Ix.clipIntersection,Wx.wireframeLinewidth=Ix.wireframeLinewidth,Wx.linewidth=Ix.linewidth,Dx&&Wx.isMeshDistanceMaterial&&(Wx.referencePosition.copy(Fx),Wx.nearDistance=Bx,Wx.farDistance=Ux),Wx}function lx(Ox,Ix,Dx,Fx){if(!1!==Ox.visible){if(Ox.layers.test(Ix.layers)&&(Ox.isMesh||Ox.isLine||Ox.isPoints)&&Ox.castShadow&&(!Ox.frustumCulled||px.intersectsObject(Ox))){Ox.modelViewMatrix.multiplyMatrices(Dx.matrixWorldInverse,Ox.matrixWorld);var Bx=nx.update(Ox),Ux=Ox.material;if(Array.isArray(Ux))for(var Nx=Bx.groups,Wx=0,zx=Nx.length;Wx<zx;Wx++){var Hx=Nx[Wx],Gx=Ux[Hx.materialIndex];if(Gx&&Gx.visible){var Vx=dx(Ox,Gx,Fx,hx,Dx.near,Dx.far);ix.renderBufferDirect(Dx,null,Bx,Vx,Ox,Hx)}}else Ux.visible&&(Vx=dx(Ox,Ux,Fx,hx,Dx.near,Dx.far),ix.renderBufferDirect(Dx,null,Bx,Vx,Ox,null))}for(var kx=Ox.children,jx=0,Yx=kx.length;jx<Yx;jx++)lx(kx[jx],Ix,Dx,Fx)}}for(var px=new tl,cx=new id,mx=new od,ux=new od(sx,sx),gx=new sd,hx=new sd,fx=1,yx=2,vx=[,,,,],Lx=[,,,,],bx={},_x={0:Xg,1:Yg,2:qg},Ax=[new sd(1,0,0),new sd(-1,0,0),new sd(0,0,1),new sd(0,0,-1),new sd(0,1,0),new sd(0,-1,0)],Ex=[new sd(0,1,0),new sd(0,1,0),new sd(0,1,0),new sd(0,1,0),new sd(0,0,1),new sd(0,0,-1)],Sx=[new pd,new pd,new pd,new pd,new pd,new pd],Tx=0;Tx!==1+(fx|yx);++Tx){var Mx=0!=(Tx&fx),wx=0!=(Tx&yx),Rx=new Jd({depthPacking:my,morphTargets:Mx,skinning:wx});vx[Tx]=Rx;var Px=new Kd({morphTargets:Mx,skinning:wx});Lx[Tx]=Px}var Cx=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=kg,this.render=function(Ox,Ix,Dx){if(!1!==Cx.enabled&&(!1!==Cx.autoUpdate||!1!==Cx.needsUpdate)&&0!==Ox.length){var Bx=ix.context,Ux=ix.state,Fx;Ux.disable(Bx.BLEND),Ux.buffers.color.setClear(1,1,1,1),Ux.buffers.depth.setTest(!0),Ux.setScissorTest(!1);for(var Nx=0,Wx=Ox.length;Nx<Wx;Nx++){var zx=Ox[Nx],Hx=zx.shadow,Gx=zx&&zx.isPointLight;if(void 0!==Hx){var Vx=Hx.camera;if(mx.copy(Hx.mapSize),mx.min(ux),Gx){var kx=mx.x,jx=mx.y;Sx[0].set(2*kx,jx,kx,jx),Sx[1].set(0,jx,kx,jx),Sx[2].set(3*kx,jx,kx,jx),Sx[3].set(kx,jx,kx,jx),Sx[4].set(3*kx,0,kx,jx),Sx[5].set(kx,0,kx,jx),mx.x*=4,mx.y*=2}if(null===Hx.map){Hx.map=new cd(mx.x,mx.y,{minFilter:Zh,magFilter:Zh,format:ff}),Hx.map.texture.name=zx.name+".shadowMap",Vx.updateProjectionMatrix()}Hx.isSpotLightShadow&&Hx.update(zx);var Xx=Hx.map,qx=Hx.matrix;hx.setFromMatrixPosition(zx.matrixWorld),Vx.position.copy(hx),Gx?(Fx=6,qx.makeTranslation(-hx.x,-hx.y,-hx.z)):(Fx=1,gx.setFromMatrixPosition(zx.target.matrixWorld),Vx.lookAt(gx),Vx.updateMatrixWorld(),qx.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),qx.multiply(Vx.projectionMatrix),qx.multiply(Vx.matrixWorldInverse)),ix.setRenderTarget(Xx),ix.clear();for(var Zx=0;Zx<Fx;Zx++){if(Gx){gx.copy(Vx.position),gx.add(Ax[Zx]),Vx.up.copy(Ex[Zx]),Vx.lookAt(gx),Vx.updateMatrixWorld();var Jx=Sx[Zx];Ux.viewport(Jx)}cx.multiplyMatrices(Vx.projectionMatrix,Vx.matrixWorldInverse),px.setFromMatrix(cx),lx(Ix,Dx,Vx,Gx)}}else console.warn("THREE.WebGLShadowMap:",zx,"has no shadow.")}Cx.needsUpdate=!1}}}function rl(ix,nx,sx,dx){this._x=ix||0,this._y=nx||0,this._z=sx||0,this._order=dx||rl.DefaultOrder}function ol(){this.mask=1}function il(){Object.defineProperty(this,"id",{value:wy++}),this.uuid=uy.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=il.DefaultUp.clone();var ix=new sd,nx=new rl,sx=new nd,dx=new sd(1,1,1);nx.onChange(function(){sx.setFromEuler(nx,!1)}),sx.onChange(function(){nx.setFromQuaternion(sx,void 0,!1)}),Object.defineProperties(this,{position:{enumerable:!0,value:ix},rotation:{enumerable:!0,value:nx},quaternion:{enumerable:!0,value:sx},scale:{enumerable:!0,value:dx},modelViewMatrix:{value:new id},normalMatrix:{value:new dd}}),this.matrix=new id,this.matrixWorld=new id,this.matrixAutoUpdate=il.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new ol,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}function nl(){il.call(this),this.type="Camera",this.matrixWorldInverse=new id,this.projectionMatrix=new id}function sl(ix,nx,sx,dx,lx,px){nl.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=ix,this.right=nx,this.top=sx,this.bottom=dx,this.near=void 0===lx?.1:lx,this.far=void 0===px?2e3:px,this.updateProjectionMatrix()}function dl(ix,nx,sx,dx,lx,px){this.a=ix,this.b=nx,this.c=sx,this.normal=dx&&dx.isVector3?dx:new sd,this.vertexNormals=Array.isArray(dx)?dx:[],this.color=lx&&lx.isColor?lx:new Xd,this.vertexColors=Array.isArray(lx)?lx:[],this.materialIndex=void 0===px?0:px}function ll(){Object.defineProperty(this,"id",{value:Ry+=2}),this.uuid=uy.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}function pl(ix,nx,sx){if(Array.isArray(ix))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.uuid=uy.generateUUID(),this.name="",this.array=ix,this.itemSize=nx,this.count=void 0===ix?0:ix.length/nx,this.normalized=!0===sx,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.onUploadCallback=function(){},this.version=0}function cl(ix,nx,sx){pl.call(this,new Int8Array(ix),nx,sx)}function ml(ix,nx,sx){pl.call(this,new Uint8Array(ix),nx,sx)}function ul(ix,nx,sx){pl.call(this,new Uint8ClampedArray(ix),nx,sx)}function gl(ix,nx,sx){pl.call(this,new Int16Array(ix),nx,sx)}function hl(ix,nx,sx){pl.call(this,new Uint16Array(ix),nx,sx)}function fl(ix,nx,sx){pl.call(this,new Int32Array(ix),nx,sx)}function yl(ix,nx,sx){pl.call(this,new Uint32Array(ix),nx,sx)}function xl(ix,nx,sx){pl.call(this,new Float32Array(ix),nx,sx)}function vl(ix,nx,sx){pl.call(this,new Float64Array(ix),nx,sx)}function Ll(){this.indices=[],this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}function bl(ix){if(0===ix.length)return-1/0;for(var nx=ix[0],sx=1,dx=ix.length;sx<dx;++sx)ix[sx]>nx&&(nx=ix[sx]);return nx}function _l(){Object.defineProperty(this,"id",{value:Py+=2}),this.uuid=uy.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0}}function Al(ix,nx,sx,dx,lx,px){ll.call(this),this.type="BoxGeometry",this.parameters={width:ix,height:nx,depth:sx,widthSegments:dx,heightSegments:lx,depthSegments:px},this.fromBufferGeometry(new El(ix,nx,sx,dx,lx,px)),this.mergeVertices()}function El(ix,nx,sx,dx,lx,px){function cx(vx,Lx,bx,_x,Ax,Ex,Sx,Tx,Mx,wx,Rx){var Ux=Mx+1,Wx=0,zx=0,Hx=new sd,Px,Cx;for(Cx=0;Cx<wx+1;Cx++){var Gx=Cx*(Sx/wx)-Sx/2;for(Px=0;Px<Ux;Px++){var Vx=Px*(Ex/Mx)-Ex/2;Hx[vx]=Vx*_x,Hx[Lx]=Gx*Ax,Hx[bx]=Tx/2,gx.push(Hx.x,Hx.y,Hx.z),Hx[vx]=0,Hx[Lx]=0,Hx[bx]=0<Tx?1:-1,hx.push(Hx.x,Hx.y,Hx.z),fx.push(Px/Mx),fx.push(1-Cx/wx),Wx+=1}}for(Cx=0;Cx<wx;Cx++)for(Px=0;Px<Mx;Px++){var kx=yx+Px+Ux*Cx,jx=yx+Px+Ux*(Cx+1),Yx=yx+(Px+1)+Ux*(Cx+1),Xx=yx+(Px+1)+Ux*Cx;ux.push(kx,jx,Xx),ux.push(jx,Yx,Xx),zx+=6}mx.addGroup(xx,zx,Rx),xx+=zx,yx+=Wx}_l.call(this),this.type="BoxBufferGeometry",this.parameters={width:ix,height:nx,depth:sx,widthSegments:dx,heightSegments:lx,depthSegments:px};var mx=this;ix=ix||1,nx=nx||1,sx=sx||1,dx=Math.floor(dx)||1,lx=Math.floor(lx)||1;var ux=[],gx=[],hx=[],fx=[],yx=0,xx=0;cx("z","y","x",-1,-1,sx,nx,ix,px=Math.floor(px)||1,lx,0),cx("z","y","x",1,-1,sx,nx,-ix,px,lx,1),cx("x","z","y",1,1,ix,sx,nx,dx,px,2),cx("x","z","y",1,-1,ix,sx,-nx,dx,px,3),cx("x","y","z",1,-1,ix,nx,sx,dx,lx,4),cx("x","y","z",-1,-1,ix,nx,-sx,dx,lx,5),this.setIndex(ux),this.addAttribute("position",new xl(gx,3)),this.addAttribute("normal",new xl(hx,3)),this.addAttribute("uv",new xl(fx,2))}function Sl(ix,nx,sx,dx){ll.call(this),this.type="PlaneGeometry",this.parameters={width:ix,height:nx,widthSegments:sx,heightSegments:dx},this.fromBufferGeometry(new Tl(ix,nx,sx,dx)),this.mergeVertices()}function Tl(ix,nx,sx,dx){_l.call(this),this.type="PlaneBufferGeometry",this.parameters={width:ix,height:nx,widthSegments:sx,heightSegments:dx};var cx=(ix=ix||1)/2,mx=(nx=nx||1)/2,ux=Math.floor(sx)||1,gx=Math.floor(dx)||1,hx=ux+1,yx=ix/ux,xx=nx/gx,vx=[],Lx=[],bx=[],_x=[],lx,px;for(px=0;px<gx+1;px++){var Ax=px*xx-mx;for(lx=0;lx<hx;lx++){var Ex=lx*yx-cx;Lx.push(Ex,-Ax,0),bx.push(0,0,1),_x.push(lx/ux),_x.push(1-px/gx)}}for(px=0;px<gx;px++)for(lx=0;lx<ux;lx++){var Sx=lx+hx*px,Tx=lx+hx*(px+1),Mx=lx+1+hx*(px+1),wx=lx+1+hx*px;vx.push(Sx,Tx,wx),vx.push(Tx,Mx,wx)}this.setIndex(vx),this.addAttribute("position",new xl(Lx,3)),this.addAttribute("normal",new xl(bx,3)),this.addAttribute("uv",new xl(_x,2))}function Ml(ix){Zd.call(this),this.type="MeshBasicMaterial",this.color=new Xd(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Ph,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.lights=!1,this.setValues(ix)}function wl(ix){Zd.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,void 0!==ix&&(void 0!==ix.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(ix))}function Rl(ix,nx){this.origin=void 0===ix?new sd:ix,this.direction=void 0===nx?new sd:nx}function Pl(ix,nx){this.start=void 0===ix?new sd:ix,this.end=void 0===nx?new sd:nx}function Cl(ix,nx,sx){this.a=void 0===ix?new sd:ix,this.b=void 0===nx?new sd:nx,this.c=void 0===sx?new sd:sx}function Ol(ix,nx){il.call(this),this.type="Mesh",this.geometry=void 0===ix?new _l:ix,this.material=void 0===nx?new Ml({color:16777215*Math.random()}):nx,this.drawMode=ey,this.updateMorphTargets()}function Il(ix,nx){return ix.renderOrder===nx.renderOrder?ix.program&&nx.program&&ix.program!==nx.program?ix.program.id-nx.program.id:ix.material.id===nx.material.id?ix.z===nx.z?ix.id-nx.id:ix.z-nx.z:ix.material.id-nx.material.id:ix.renderOrder-nx.renderOrder}function Dl(ix,nx){return ix.renderOrder===nx.renderOrder?ix.z===nx.z?ix.id-nx.id:nx.z-ix.z:ix.renderOrder-nx.renderOrder}function Fl(ix,nx){return Math.abs(nx[1])-Math.abs(ix[1])}function Bl(ix,nx,sx){var dx=ix.createShader(nx);return ix.shaderSource(dx,sx),ix.compileShader(dx),!1===ix.getShaderParameter(dx,ix.COMPILE_STATUS)&&console.error("THREE.WebGLShader: Shader couldn't compile."),""!==ix.getShaderInfoLog(dx)&&console.warn("THREE.WebGLShader: gl.getShaderInfoLog()",nx===ix.VERTEX_SHADER?"vertex":"fragment",ix.getShaderInfoLog(dx),function(lx){for(var px=lx.split("\n"),cx=0;cx<px.length;cx++)px[cx]=cx+1+": "+px[cx];return px.join("\n")}(sx)),dx}function Ul(ix){switch(ix){case ry:return["Linear","( value )"];case oy:return["sRGB","( value )"];case ny:return["RGBE","( value )"];case dy:return["RGBM","( value, 7.0 )"];case ly:return["RGBM","( value, 16.0 )"];case py:return["RGBD","( value, 256.0 )"];case iy:return["Gamma","( value, float( GAMMA_FACTOR ) )"];default:throw new Error("unsupported encoding: "+ix);}}function Nl(ix,nx){var sx=Ul(nx);return"vec4 "+ix+"( vec4 value ) { return "+sx[0]+"ToLinear"+sx[1]+"; }"}function Wl(ix){return""!==ix}function zl(ix,nx){return ix.replace(/NUM_DIR_LIGHTS/g,nx.numDirLights).replace(/NUM_SPOT_LIGHTS/g,nx.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,nx.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,nx.numPointLights).replace(/NUM_HEMI_LIGHTS/g,nx.numHemiLights)}function Hl(ix,nx){return ix.replace(/NUM_CLIPPING_PLANES/g,nx.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,nx.numClippingPlanes-nx.numClipIntersection)}function Gl(ix){return ix.replace(/^[ \t]*#include +<([\w\d.]+)>/gm,function(nx,sx){var dx=Sy[sx];if(void 0===dx)throw new Error("Can not resolve #include <"+sx+">");return Gl(dx)})}function Vl(ix){return ix.replace(/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,function(nx,sx,dx,lx){for(var px="",cx=parseInt(sx);cx<parseInt(dx);cx++)px+=lx.replace(/\[ i \]/g,"[ "+cx+" ]");return px})}function kl(ix,nx,sx){function dx(mx,ux){var gx;return mx?mx.isTexture?gx=mx.encoding:mx.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),gx=mx.texture.encoding):gx=ry,gx===ry&&ux&&(gx=iy),gx}var lx=[],px={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"phong",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow"},cx=["precision","supportsVertexTextures","map","mapEncoding","envMap","envMapMode","envMapEncoding","lightMap","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","fog","useFog","fogExp","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering"];this.getParameters=function(mx,ux,gx,hx,fx,yx,xx){var vx=px[mx.type],Lx=xx.isSkinnedMesh?function(){var Ex=xx.skeleton.bones;if(sx.floatVertexTextures)return 1024;var Sx=sx.maxVertexUniforms,Tx=Math.floor((Sx-20)/4),Mx=Math.min(Tx,Ex.length);return Mx<Ex.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+Ex.length+" bones. This GPU supports "+Mx+"."),0):Mx}():0,bx=sx.precision;null!==mx.precision&&(bx=sx.getMaxPrecision(mx.precision))!==mx.precision&&console.warn("THREE.WebGLProgram.getParameters:",mx.precision,"not supported, using",bx,"instead.");var _x=ix.getRenderTarget();return{shaderID:vx,precision:bx,supportsVertexTextures:sx.vertexTextures,outputEncoding:dx(_x?_x.texture:null,ix.gammaOutput),map:!!mx.map,mapEncoding:dx(mx.map,ix.gammaInput),envMap:!!mx.envMap,envMapMode:mx.envMap&&mx.envMap.mapping,envMapEncoding:dx(mx.envMap,ix.gammaInput),envMapCubeUV:!!mx.envMap&&(mx.envMap.mapping===kh||mx.envMap.mapping===jh),lightMap:!!mx.lightMap,aoMap:!!mx.aoMap,emissiveMap:!!mx.emissiveMap,emissiveMapEncoding:dx(mx.emissiveMap,ix.gammaInput),bumpMap:!!mx.bumpMap,normalMap:!!mx.normalMap,displacementMap:!!mx.displacementMap,roughnessMap:!!mx.roughnessMap,metalnessMap:!!mx.metalnessMap,specularMap:!!mx.specularMap,alphaMap:!!mx.alphaMap,gradientMap:!!mx.gradientMap,combine:mx.combine,vertexColors:mx.vertexColors,fog:!!hx,useFog:mx.fog,fogExp:hx&&hx.isFogExp2,flatShading:mx.flatShading,sizeAttenuation:mx.sizeAttenuation,logarithmicDepthBuffer:sx.logarithmicDepthBuffer,skinning:mx.skinning&&0<Lx,maxBones:Lx,useVertexTexture:sx.floatVertexTextures,morphTargets:mx.morphTargets,morphNormals:mx.morphNormals,maxMorphTargets:ix.maxMorphTargets,maxMorphNormals:ix.maxMorphNormals,numDirLights:ux.directional.length,numPointLights:ux.point.length,numSpotLights:ux.spot.length,numRectAreaLights:ux.rectArea.length,numHemiLights:ux.hemi.length,numClippingPlanes:fx,numClipIntersection:yx,dithering:mx.dithering,shadowMapEnabled:ix.shadowMap.enabled&&xx.receiveShadow&&0<gx.length,shadowMapType:ix.shadowMap.type,toneMapping:ix.toneMapping,physicallyCorrectLights:ix.physicallyCorrectLights,premultipliedAlpha:mx.premultipliedAlpha,alphaTest:mx.alphaTest,doubleSided:mx.side===qg,flipSided:mx.side===Xg,depthPacking:void 0!==mx.depthPacking&&mx.depthPacking}},this.getProgramCode=function(mx,ux){var gx=[];if(ux.shaderID?gx.push(ux.shaderID):(gx.push(mx.fragmentShader),gx.push(mx.vertexShader)),void 0!==mx.defines)for(var hx in mx.defines)gx.push(hx),gx.push(mx.defines[hx]);for(var fx=0;fx<cx.length;fx++)gx.push(ux[cx[fx]]);return gx.push(mx.onBeforeCompile.toString()),gx.push(ix.gammaOutput),gx.join()},this.acquireProgram=function(mx,ux,gx,hx){for(var yx=0,xx=lx.length,fx,vx;yx<xx;yx++)if(vx=lx[yx],vx.code===hx){++(fx=vx).usedTimes;break}return void 0===fx&&(fx=new function(Lx,bx,_x,Ax,Ex,Sx){var Tx=Lx.context,Mx=Ax.defines,wx=Ex.vertexShader,Rx=Ex.fragmentShader,Px="SHADOWMAP_TYPE_BASIC";Sx.shadowMapType===kg?Px="SHADOWMAP_TYPE_PCF":Sx.shadowMapType===jg&&(Px="SHADOWMAP_TYPE_PCF_SOFT");var Cx="ENVMAP_TYPE_CUBE",Ox="ENVMAP_MODE_REFLECTION",Ix="ENVMAP_BLENDING_MULTIPLY";if(Sx.envMap){switch(Ax.envMap.mapping){case Wh:case zh:Cx="ENVMAP_TYPE_CUBE";break;case kh:case jh:Cx="ENVMAP_TYPE_CUBE_UV";break;case Hh:case Gh:Cx="ENVMAP_TYPE_EQUIREC";break;case Vh:Cx="ENVMAP_TYPE_SPHERE";}switch(Ax.envMap.mapping){case zh:case Gh:Ox="ENVMAP_MODE_REFRACTION";}switch(Ax.combine){case Ph:Ix="ENVMAP_BLENDING_MULTIPLY";break;case Ch:Ix="ENVMAP_BLENDING_MIX";break;case Oh:Ix="ENVMAP_BLENDING_ADD";}}var Bx=0<Lx.gammaFactor?Lx.gammaFactor:1,Ux=function(Kx,Qx,$x){return[(Kx=Kx||{}).derivatives||Qx.envMapCubeUV||Qx.bumpMap||Qx.normalMap||Qx.flatShading?"#extension GL_OES_standard_derivatives : enable":"",(Kx.fragDepth||Qx.logarithmicDepthBuffer)&&$x.get("EXT_frag_depth")?"#extension GL_EXT_frag_depth : enable":"",Kx.drawBuffers&&$x.get("WEBGL_draw_buffers")?"#extension GL_EXT_draw_buffers : require":"",(Kx.shaderTextureLOD||Qx.envMap)&&$x.get("EXT_shader_texture_lod")?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Wl).join("\n")}(Ax.extensions,Sx,bx),Nx=function(Kx){var Qx=[];for(var $x in Kx){var ev=Kx[$x];!1!==ev&&Qx.push("#define "+$x+" "+ev)}return Qx.join("\n")}(Mx),Wx=Tx.createProgram(),Dx,Fx;Ax.isRawShaderMaterial?(0<(Dx=[Nx].filter(Wl).join("\n")).length&&(Dx+="\n"),0<(Fx=[Ux,Nx].filter(Wl).join("\n")).length&&(Fx+="\n")):(Dx=["precision "+Sx.precision+" float;","precision "+Sx.precision+" int;","#define SHADER_NAME "+Ex.name,Nx,Sx.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+Bx,"#define MAX_BONES "+Sx.maxBones,Sx.useFog&&Sx.fog?"#define USE_FOG":"",Sx.useFog&&Sx.fogExp?"#define FOG_EXP2":"",Sx.map?"#define USE_MAP":"",Sx.envMap?"#define USE_ENVMAP":"",Sx.envMap?"#define "+Ox:"",Sx.lightMap?"#define USE_LIGHTMAP":"",Sx.aoMap?"#define USE_AOMAP":"",Sx.emissiveMap?"#define USE_EMISSIVEMAP":"",Sx.bumpMap?"#define USE_BUMPMAP":"",Sx.normalMap?"#define USE_NORMALMAP":"",Sx.displacementMap&&Sx.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",Sx.specularMap?"#define USE_SPECULARMAP":"",Sx.roughnessMap?"#define USE_ROUGHNESSMAP":"",Sx.metalnessMap?"#define USE_METALNESSMAP":"",Sx.alphaMap?"#define USE_ALPHAMAP":"",Sx.vertexColors?"#define USE_COLOR":"",Sx.flatShading?"#define FLAT_SHADED":"",Sx.skinning?"#define USE_SKINNING":"",Sx.useVertexTexture?"#define BONE_TEXTURE":"",Sx.morphTargets?"#define USE_MORPHTARGETS":"",Sx.morphNormals&&!1===Sx.flatShading?"#define USE_MORPHNORMALS":"",Sx.doubleSided?"#define DOUBLE_SIDED":"",Sx.flipSided?"#define FLIP_SIDED":"",Sx.shadowMapEnabled?"#define USE_SHADOWMAP":"",Sx.shadowMapEnabled?"#define "+Px:"",Sx.sizeAttenuation?"#define USE_SIZEATTENUATION":"",Sx.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",Sx.logarithmicDepthBuffer&&bx.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(Wl).join("\n"),Fx=[Ux,"precision "+Sx.precision+" float;","precision "+Sx.precision+" int;","#define SHADER_NAME "+Ex.name,Nx,Sx.alphaTest?"#define ALPHATEST "+Sx.alphaTest:"","#define GAMMA_FACTOR "+Bx,Sx.useFog&&Sx.fog?"#define USE_FOG":"",Sx.useFog&&Sx.fogExp?"#define FOG_EXP2":"",Sx.map?"#define USE_MAP":"",Sx.envMap?"#define USE_ENVMAP":"",Sx.envMap?"#define "+Cx:"",Sx.envMap?"#define "+Ox:"",Sx.envMap?"#define "+Ix:"",Sx.lightMap?"#define USE_LIGHTMAP":"",Sx.aoMap?"#define USE_AOMAP":"",Sx.emissiveMap?"#define USE_EMISSIVEMAP":"",Sx.bumpMap?"#define USE_BUMPMAP":"",Sx.normalMap?"#define USE_NORMALMAP":"",Sx.specularMap?"#define USE_SPECULARMAP":"",Sx.roughnessMap?"#define USE_ROUGHNESSMAP":"",Sx.metalnessMap?"#define USE_METALNESSMAP":"",Sx.alphaMap?"#define USE_ALPHAMAP":"",Sx.vertexColors?"#define USE_COLOR":"",Sx.gradientMap?"#define USE_GRADIENTMAP":"",Sx.flatShading?"#define FLAT_SHADED":"",Sx.doubleSided?"#define DOUBLE_SIDED":"",Sx.flipSided?"#define FLIP_SIDED":"",Sx.shadowMapEnabled?"#define USE_SHADOWMAP":"",Sx.shadowMapEnabled?"#define "+Px:"",Sx.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",Sx.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",Sx.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",Sx.logarithmicDepthBuffer&&bx.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"",Sx.envMap&&bx.get("EXT_shader_texture_lod")?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;",Sx.toneMapping===Ih?"":"#define TONE_MAPPING",Sx.toneMapping===Ih?"":Sy.tonemapping_pars_fragment,Sx.toneMapping===Ih?"":function(Kx,Qx){var $x;switch(Qx){case Dh:$x="Linear";break;case Fh:$x="Reinhard";break;case Bh:$x="Uncharted2";break;case Uh:$x="OptimizedCineon";break;default:throw new Error("unsupported toneMapping: "+Qx);}return"vec3 toneMapping( vec3 color ) { return "+$x+"ToneMapping( color ); }"}(0,Sx.toneMapping),Sx.dithering?"#define DITHERING":"",Sx.outputEncoding||Sx.mapEncoding||Sx.envMapEncoding||Sx.emissiveMapEncoding?Sy.encodings_pars_fragment:"",Sx.mapEncoding?Nl("mapTexelToLinear",Sx.mapEncoding):"",Sx.envMapEncoding?Nl("envMapTexelToLinear",Sx.envMapEncoding):"",Sx.emissiveMapEncoding?Nl("emissiveMapTexelToLinear",Sx.emissiveMapEncoding):"",Sx.outputEncoding?function(){var $x=Ul(Sx.outputEncoding);return"vec4 linearToOutputTexel( vec4 value ) { return LinearTo"+$x[0]+$x[1]+"; }"}():"",Sx.depthPacking?"#define DEPTH_PACKING "+Ax.depthPacking:"","\n"].filter(Wl).join("\n")),wx=Hl(wx=zl(wx=Gl(wx),Sx),Sx),Rx=Hl(Rx=zl(Rx=Gl(Rx),Sx),Sx);var zx=Dx+(wx=Vl(wx)),Hx=Fx+(Rx=Vl(Rx)),Gx=Bl(Tx,Tx.VERTEX_SHADER,zx),Vx=Bl(Tx,Tx.FRAGMENT_SHADER,Hx);Tx.attachShader(Wx,Gx),Tx.attachShader(Wx,Vx),void 0===Ax.index0AttributeName?!0===Sx.morphTargets&&Tx.bindAttribLocation(Wx,0,"position"):Tx.bindAttribLocation(Wx,0,Ax.index0AttributeName),Tx.linkProgram(Wx);var Yx=Tx.getProgramInfoLog(Wx).trim(),Xx=Tx.getShaderInfoLog(Gx).trim(),qx=Tx.getShaderInfoLog(Vx).trim(),Zx=!0,Jx=!0,kx,jx;return!1===Tx.getProgramParameter(Wx,Tx.LINK_STATUS)?(Zx=!1,console.error("THREE.WebGLProgram: shader error: ",Tx.getError(),"gl.VALIDATE_STATUS",Tx.getProgramParameter(Wx,Tx.VALIDATE_STATUS),"gl.getProgramInfoLog",Yx,Xx,qx)):""===Yx?""!==Xx&&""!==qx||(Jx=!1):console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",Yx),Jx&&(this.diagnostics={runnable:Zx,material:Ax,programLog:Yx,vertexShader:{log:Xx,prefix:Dx},fragmentShader:{log:qx,prefix:Fx}}),Tx.deleteShader(Gx),Tx.deleteShader(Vx),this.getUniforms=function(){return void 0==kx&&(kx=new Yd(Tx,Wx,Lx)),kx},this.getAttributes=function(){return void 0==jx&&(jx=function(Kx,Qx){for(var $x={},ev=Kx.getProgramParameter(Qx,Kx.ACTIVE_ATTRIBUTES),tv=0,av;tv<ev;tv++)av=Kx.getActiveAttrib(Qx,tv).name,$x[av]=Kx.getAttribLocation(Qx,av);return $x}(Tx,Wx)),jx},this.destroy=function(){Tx.deleteProgram(Wx),this.program=void 0},Object.defineProperties(this,{uniforms:{get:function(){return console.warn("THREE.WebGLProgram: .uniforms is now .getUniforms()."),this.getUniforms()}},attributes:{get:function(){return console.warn("THREE.WebGLProgram: .attributes is now .getAttributes()."),this.getAttributes()}}}),this.id=Cy++,this.code=_x,this.usedTimes=1,this.program=Wx,this.vertexShader=Gx,this.fragmentShader=Vx,this}(ix,nx,hx,mx,ux,gx),lx.push(fx)),fx},this.releaseProgram=function(mx){if(0==--mx.usedTimes){var ux=lx.indexOf(mx);lx[ux]=lx[lx.length-1],lx.pop(),mx.destroy()}},this.programs=lx}function jl(ix,nx,sx,dx,lx,px,cx,mx){function ux(Tx,Mx){if(Tx.width>Mx||Tx.height>Mx){var wx=Mx/Math.max(Tx.width,Tx.height),Rx=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");return Rx.width=Math.floor(Tx.width*wx),Rx.height=Math.floor(Tx.height*wx),Rx.getContext("2d").drawImage(Tx,0,0,Tx.width,Tx.height,0,0,Rx.width,Rx.height),console.warn("THREE.WebGLRenderer: image is too big ("+Tx.width+"x"+Tx.height+"). Resized to "+Rx.width+"x"+Rx.height,Tx),Rx}return Tx}function gx(Tx){return uy.isPowerOfTwo(Tx.width)&&uy.isPowerOfTwo(Tx.height)}function hx(Tx,Mx){return Tx.generateMipmaps&&Mx&&Tx.minFilter!==Zh&&Tx.minFilter!==Qh}function fx(Tx){return Tx===Zh||Tx===Jh||Tx===Kh?ix.NEAREST:ix.LINEAR}function yx(Tx){var Mx=Tx.target;Mx.removeEventListener("dispose",yx),function(wx){var Rx=dx.get(wx);if(wx.image&&Rx.__image__webglTextureCube)ix.deleteTexture(Rx.__image__webglTextureCube);else{if(void 0===Rx.__webglInit)return;ix.deleteTexture(Rx.__webglTexture)}dx.remove(wx)}(Mx),Mx.isVideoTexture&&delete Sx[Mx.id],cx.textures--}function xx(Tx){var Mx=Tx.target;Mx.removeEventListener("dispose",xx),function(wx){var Rx=dx.get(wx),Px=dx.get(wx.texture);if(wx){if(void 0!==Px.__webglTexture&&ix.deleteTexture(Px.__webglTexture),wx.depthTexture&&wx.depthTexture.dispose(),wx.isWebGLRenderTargetCube)for(var Cx=0;6>Cx;Cx++)ix.deleteFramebuffer(Rx.__webglFramebuffer[Cx]),Rx.__webglDepthbuffer&&ix.deleteRenderbuffer(Rx.__webglDepthbuffer[Cx]);else ix.deleteFramebuffer(Rx.__webglFramebuffer),Rx.__webglDepthbuffer&&ix.deleteRenderbuffer(Rx.__webglDepthbuffer);dx.remove(wx.texture),dx.remove(wx)}}(Mx),cx.textures--}function vx(Tx,Mx){var wx=dx.get(Tx);if(Tx.isVideoTexture&&function(Px){var Cx=Px.id,Ox=mx.frame;Sx[Cx]!==Ox&&(Sx[Cx]=Ox,Px.update())}(Tx),0<Tx.version&&wx.__version!==Tx.version){var Rx=Tx.image;if(void 0===Rx)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined",Tx);else{if(!1!==Rx.complete)return void function(Px,Cx,Ox){void 0===Px.__webglInit&&(Px.__webglInit=!0,Cx.addEventListener("dispose",yx),Px.__webglTexture=ix.createTexture(),cx.textures++),sx.activeTexture(ix.TEXTURE0+Ox),sx.bindTexture(ix.TEXTURE_2D,Px.__webglTexture),ix.pixelStorei(ix.UNPACK_FLIP_Y_WEBGL,Cx.flipY),ix.pixelStorei(ix.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Cx.premultiplyAlpha),ix.pixelStorei(ix.UNPACK_ALIGNMENT,Cx.unpackAlignment);var Ix=ux(Cx.image,lx.maxTextureSize);(function(Gx){return Gx.wrapS!==Xh||Gx.wrapT!==Xh||Gx.minFilter!==Zh&&Gx.minFilter!==Qh})(Cx)&&!1===gx(Ix)&&(Ix=function(Gx){return Gx instanceof HTMLImageElement||Gx instanceof HTMLCanvasElement||Gx instanceof ImageBitmap?(void 0===Ax&&(Ax=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),Ax.width=uy.floorPowerOfTwo(Gx.width),Ax.height=uy.floorPowerOfTwo(Gx.height),Ax.getContext("2d").drawImage(Gx,0,0,Ax.width,Ax.height),console.warn("THREE.WebGLRenderer: image is not power of two ("+Gx.width+"x"+Gx.height+"). Resized to "+Ax.width+"x"+Ax.height,Gx),Ax):Gx}(Ix));var Dx=gx(Ix),Fx=px.convert(Cx.format),Bx=px.convert(Cx.type);Lx(ix.TEXTURE_2D,Cx,Dx);var Nx=Cx.mipmaps,Ux;if(Cx.isDepthTexture){var Wx=ix.DEPTH_COMPONENT;if(Cx.type===df){if(!Ex)throw new Error("Float Depth Texture only supported in WebGL2.0");Wx=ix.DEPTH_COMPONENT32F}else Ex&&(Wx=ix.DEPTH_COMPONENT16);Cx.format===Lf&&Wx===ix.DEPTH_COMPONENT&&Cx.type!==of&&Cx.type!==sf&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),Cx.type=of,Bx=px.convert(Cx.type)),Cx.format===bf&&(Wx=ix.DEPTH_STENCIL,Cx.type!==uf&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),Cx.type=uf,Bx=px.convert(Cx.type))),sx.texImage2D(ix.TEXTURE_2D,0,Wx,Ix.width,Ix.height,0,Fx,Bx,null)}else if(Cx.isDataTexture){if(0<Nx.length&&Dx){for(var zx=0,Hx=Nx.length;zx<Hx;zx++)Ux=Nx[zx],sx.texImage2D(ix.TEXTURE_2D,zx,Fx,Ux.width,Ux.height,0,Fx,Bx,Ux.data);Cx.generateMipmaps=!1}else sx.texImage2D(ix.TEXTURE_2D,0,Fx,Ix.width,Ix.height,0,Fx,Bx,Ix.data);}else if(Cx.isCompressedTexture)for(zx=0,Hx=Nx.length;zx<Hx;zx++)Ux=Nx[zx],Cx.format!==ff&&Cx.format!==hf?-1<sx.getCompressedTextureFormats().indexOf(Fx)?sx.compressedTexImage2D(ix.TEXTURE_2D,zx,Fx,Ux.width,Ux.height,0,Ux.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):sx.texImage2D(ix.TEXTURE_2D,zx,Fx,Ux.width,Ux.height,0,Fx,Bx,Ux.data);else if(0<Nx.length&&Dx){for(zx=0,Hx=Nx.length;zx<Hx;zx++)Ux=Nx[zx],sx.texImage2D(ix.TEXTURE_2D,zx,Fx,Fx,Bx,Ux);Cx.generateMipmaps=!1}else sx.texImage2D(ix.TEXTURE_2D,0,Fx,Fx,Bx,Ix);hx(Cx,Dx)&&ix.generateMipmap(ix.TEXTURE_2D),Px.__version=Cx.version,Cx.onUpdate&&Cx.onUpdate(Cx)}(wx,Tx,Mx);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete",Tx)}}sx.activeTexture(ix.TEXTURE0+Mx),sx.bindTexture(ix.TEXTURE_2D,wx.__webglTexture)}function Lx(Tx,Mx,wx){var Rx;if(wx?(ix.texParameteri(Tx,ix.TEXTURE_WRAP_S,px.convert(Mx.wrapS)),ix.texParameteri(Tx,ix.TEXTURE_WRAP_T,px.convert(Mx.wrapT)),ix.texParameteri(Tx,ix.TEXTURE_MAG_FILTER,px.convert(Mx.magFilter)),ix.texParameteri(Tx,ix.TEXTURE_MIN_FILTER,px.convert(Mx.minFilter))):(ix.texParameteri(Tx,ix.TEXTURE_WRAP_S,ix.CLAMP_TO_EDGE),ix.texParameteri(Tx,ix.TEXTURE_WRAP_T,ix.CLAMP_TO_EDGE),Mx.wrapS===Xh&&Mx.wrapT===Xh||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping.",Mx),ix.texParameteri(Tx,ix.TEXTURE_MAG_FILTER,fx(Mx.magFilter)),ix.texParameteri(Tx,ix.TEXTURE_MIN_FILTER,fx(Mx.minFilter)),Mx.minFilter!==Zh&&Mx.minFilter!==Qh&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.",Mx)),Rx=nx.get("EXT_texture_filter_anisotropic")){if(Mx.type===df&&null===nx.get("OES_texture_float_linear"))return;if(Mx.type===lf&&null===nx.get("OES_texture_half_float_linear"))return;(1<Mx.anisotropy||dx.get(Mx).__currentAnisotropy)&&(ix.texParameterf(Tx,Rx.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(Mx.anisotropy,lx.getMaxAnisotropy())),dx.get(Mx).__currentAnisotropy=Mx.anisotropy)}}function bx(Tx,Mx,wx,Rx){var Px=px.convert(Mx.texture.format),Cx=px.convert(Mx.texture.type);sx.texImage2D(Rx,0,Px,Mx.width,Mx.height,0,Px,Cx,null),ix.bindFramebuffer(ix.FRAMEBUFFER,Tx),ix.framebufferTexture2D(ix.FRAMEBUFFER,wx,Rx,dx.get(Mx.texture).__webglTexture,0),ix.bindFramebuffer(ix.FRAMEBUFFER,null)}function _x(Tx,Mx){ix.bindRenderbuffer(ix.RENDERBUFFER,Tx),Mx.depthBuffer&&!Mx.stencilBuffer?(ix.renderbufferStorage(ix.RENDERBUFFER,ix.DEPTH_COMPONENT16,Mx.width,Mx.height),ix.framebufferRenderbuffer(ix.FRAMEBUFFER,ix.DEPTH_ATTACHMENT,ix.RENDERBUFFER,Tx)):Mx.depthBuffer&&Mx.stencilBuffer?(ix.renderbufferStorage(ix.RENDERBUFFER,ix.DEPTH_STENCIL,Mx.width,Mx.height),ix.framebufferRenderbuffer(ix.FRAMEBUFFER,ix.DEPTH_STENCIL_ATTACHMENT,ix.RENDERBUFFER,Tx)):ix.renderbufferStorage(ix.RENDERBUFFER,ix.RGBA4,Mx.width,Mx.height),ix.bindRenderbuffer(ix.RENDERBUFFER,null)}var Ex="undefined"!=typeof WebGL2RenderingContext&&ix instanceof WebGL2RenderingContext,Sx={},Ax;this.setTexture2D=vx,this.setTextureCube=function(Tx,Mx){var wx=dx.get(Tx);if(6===Tx.image.length)if(0<Tx.version&&wx.__version!==Tx.version){wx.__image__webglTextureCube||(Tx.addEventListener("dispose",yx),wx.__image__webglTextureCube=ix.createTexture(),cx.textures++),sx.activeTexture(ix.TEXTURE0+Mx),sx.bindTexture(ix.TEXTURE_CUBE_MAP,wx.__image__webglTextureCube),ix.pixelStorei(ix.UNPACK_FLIP_Y_WEBGL,Tx.flipY);for(var Rx=Tx&&Tx.isCompressedTexture,Px=Tx.image[0]&&Tx.image[0].isDataTexture,Cx=[],Ox=0;6>Ox;Ox++)Cx[Ox]=Rx||Px?Px?Tx.image[Ox].image:Tx.image[Ox]:ux(Tx.image[Ox],lx.maxCubemapSize);var Ix=gx(Cx[0]),Dx=px.convert(Tx.format),Fx=px.convert(Tx.type);for(Lx(ix.TEXTURE_CUBE_MAP,Tx,Ix),Ox=0;6>Ox;Ox++)if(Rx)for(var Ux=Cx[Ox].mipmaps,Nx=0,Wx=Ux.length,Bx;Nx<Wx;Nx++)Bx=Ux[Nx],Tx.format!==ff&&Tx.format!==hf?-1<sx.getCompressedTextureFormats().indexOf(Dx)?sx.compressedTexImage2D(ix.TEXTURE_CUBE_MAP_POSITIVE_X+Ox,Nx,Dx,Bx.width,Bx.height,0,Bx.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):sx.texImage2D(ix.TEXTURE_CUBE_MAP_POSITIVE_X+Ox,Nx,Dx,Bx.width,Bx.height,0,Dx,Fx,Bx.data);else Px?sx.texImage2D(ix.TEXTURE_CUBE_MAP_POSITIVE_X+Ox,0,Dx,Cx[Ox].width,Cx[Ox].height,0,Dx,Fx,Cx[Ox].data):sx.texImage2D(ix.TEXTURE_CUBE_MAP_POSITIVE_X+Ox,0,Dx,Dx,Fx,Cx[Ox]);hx(Tx,Ix)&&ix.generateMipmap(ix.TEXTURE_CUBE_MAP),wx.__version=Tx.version,Tx.onUpdate&&Tx.onUpdate(Tx)}else sx.activeTexture(ix.TEXTURE0+Mx),sx.bindTexture(ix.TEXTURE_CUBE_MAP,wx.__image__webglTextureCube)},this.setTextureCubeDynamic=function(Tx,Mx){sx.activeTexture(ix.TEXTURE0+Mx),sx.bindTexture(ix.TEXTURE_CUBE_MAP,dx.get(Tx).__webglTexture)},this.setupRenderTarget=function(Tx){var Mx=dx.get(Tx),wx=dx.get(Tx.texture);Tx.addEventListener("dispose",xx),wx.__webglTexture=ix.createTexture(),cx.textures++;var Rx=!0===Tx.isWebGLRenderTargetCube,Px=gx(Tx);if(Rx){Mx.__webglFramebuffer=[];for(var Cx=0;6>Cx;Cx++)Mx.__webglFramebuffer[Cx]=ix.createFramebuffer()}else Mx.__webglFramebuffer=ix.createFramebuffer();if(Rx){for(sx.bindTexture(ix.TEXTURE_CUBE_MAP,wx.__webglTexture),Lx(ix.TEXTURE_CUBE_MAP,Tx.texture,Px),Cx=0;6>Cx;Cx++)bx(Mx.__webglFramebuffer[Cx],Tx,ix.COLOR_ATTACHMENT0,ix.TEXTURE_CUBE_MAP_POSITIVE_X+Cx);hx(Tx.texture,Px)&&ix.generateMipmap(ix.TEXTURE_CUBE_MAP),sx.bindTexture(ix.TEXTURE_CUBE_MAP,null)}else sx.bindTexture(ix.TEXTURE_2D,wx.__webglTexture),Lx(ix.TEXTURE_2D,Tx.texture,Px),bx(Mx.__webglFramebuffer,Tx,ix.COLOR_ATTACHMENT0,ix.TEXTURE_2D),hx(Tx.texture,Px)&&ix.generateMipmap(ix.TEXTURE_2D),sx.bindTexture(ix.TEXTURE_2D,null);Tx.depthBuffer&&function(Ox){var Ix=dx.get(Ox),Dx=!0===Ox.isWebGLRenderTargetCube;if(Ox.depthTexture){if(Dx)throw new Error("target.depthTexture not supported in Cube render targets");!function(Bx,Ux){if(Ux&&Ux.isWebGLRenderTargetCube)throw new Error("Depth Texture with cube render targets is not supported");if(ix.bindFramebuffer(ix.FRAMEBUFFER,Bx),!Ux.depthTexture||!Ux.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");dx.get(Ux.depthTexture).__webglTexture&&Ux.depthTexture.image.width===Ux.width&&Ux.depthTexture.image.height===Ux.height||(Ux.depthTexture.image.width=Ux.width,Ux.depthTexture.image.height=Ux.height,Ux.depthTexture.needsUpdate=!0),vx(Ux.depthTexture,0);var Nx=dx.get(Ux.depthTexture).__webglTexture;if(Ux.depthTexture.format===Lf)ix.framebufferTexture2D(ix.FRAMEBUFFER,ix.DEPTH_ATTACHMENT,ix.TEXTURE_2D,Nx,0);else{if(Ux.depthTexture.format!==bf)throw new Error("Unknown depthTexture format");ix.framebufferTexture2D(ix.FRAMEBUFFER,ix.DEPTH_STENCIL_ATTACHMENT,ix.TEXTURE_2D,Nx,0)}}(Ix.__webglFramebuffer,Ox)}else if(Dx){Ix.__webglDepthbuffer=[];for(var Fx=0;6>Fx;Fx++)ix.bindFramebuffer(ix.FRAMEBUFFER,Ix.__webglFramebuffer[Fx]),Ix.__webglDepthbuffer[Fx]=ix.createRenderbuffer(),_x(Ix.__webglDepthbuffer[Fx],Ox)}else ix.bindFramebuffer(ix.FRAMEBUFFER,Ix.__webglFramebuffer),Ix.__webglDepthbuffer=ix.createRenderbuffer(),_x(Ix.__webglDepthbuffer,Ox);ix.bindFramebuffer(ix.FRAMEBUFFER,null)}(Tx)},this.updateRenderTargetMipmap=function(Tx){var Mx=Tx.texture;if(hx(Mx,gx(Tx))){var wx=Tx.isWebGLRenderTargetCube?ix.TEXTURE_CUBE_MAP:ix.TEXTURE_2D,Rx=dx.get(Mx).__webglTexture;sx.bindTexture(wx,Rx),ix.generateMipmap(wx),sx.bindTexture(wx,null)}}}function Yl(ix,nx,sx,dx){nl.call(this),this.type="PerspectiveCamera",this.fov=void 0===ix?50:ix,this.zoom=1,this.near=void 0===sx?.1:sx,this.far=void 0===dx?2e3:dx,this.focus=10,this.aspect=void 0===nx?1:nx,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}function Xl(ix){Yl.call(this),this.cameras=ix||[]}function ql(ix){function nx(){if(null!==dx&&dx.isPresenting){var vx=dx.getEyeParameters("left"),Lx=vx.renderWidth,bx=vx.renderHeight;yx=ix.getPixelRatio(),fx=ix.getSize(),ix.setDrawingBufferSize(2*Lx,bx,1)}else sx.enabled&&ix.setDrawingBufferSize(fx.width,fx.height,yx)}var sx=this,dx=null,lx=null,px=null,cx=new id,mx=new id;"undefined"!=typeof window&&"VRFrameData"in window&&(lx=new window.VRFrameData);var ux=new id,gx=new Yl;gx.bounds=new pd(0,0,.5,1),gx.layers.enable(1);var hx=new Yl;hx.bounds=new pd(.5,0,.5,1),hx.layers.enable(2);var xx=new Xl([gx,hx]),fx,yx;xx.layers.enable(1),xx.layers.enable(2),"undefined"!=typeof window&&window.addEventListener("vrdisplaypresentchange",nx,!1),this.enabled=!1,this.userHeight=1.6,this.getDevice=function(){return dx},this.setDevice=function(vx){void 0!==vx&&(dx=vx)},this.setPoseTarget=function(vx){void 0!==vx&&(px=vx)},this.getCamera=function(vx){if(null===dx)return vx;dx.depthNear=vx.near,dx.depthFar=vx.far,dx.getFrameData(lx);var Lx=lx.pose,bx=null===px?vx:px;null===Lx.position?bx.position.set(0,0,0):bx.position.fromArray(Lx.position),null!==Lx.orientation&&bx.quaternion.fromArray(Lx.orientation);var _x=dx.stageParameters;if(_x?cx.fromArray(_x.sittingToStandingTransform):cx.makeTranslation(0,sx.userHeight,0),bx.position.applyMatrix4(cx),bx.updateMatrixWorld(),!1===dx.isPresenting)return vx;gx.near=vx.near,hx.near=vx.near,gx.far=vx.far,hx.far=vx.far,xx.matrixWorld.copy(vx.matrixWorld),xx.matrixWorldInverse.copy(vx.matrixWorldInverse),gx.matrixWorldInverse.fromArray(lx.leftViewMatrix),hx.matrixWorldInverse.fromArray(lx.rightViewMatrix),mx.getInverse(cx),gx.matrixWorldInverse.multiply(mx),hx.matrixWorldInverse.multiply(mx);var Ax=bx.parent;null!==Ax&&(ux.getInverse(Ax.matrixWorld),gx.matrixWorldInverse.multiply(ux),hx.matrixWorldInverse.multiply(ux)),gx.matrixWorld.getInverse(gx.matrixWorldInverse),hx.matrixWorld.getInverse(hx.matrixWorldInverse),gx.projectionMatrix.fromArray(lx.leftProjectionMatrix),hx.projectionMatrix.fromArray(lx.rightProjectionMatrix),xx.projectionMatrix.copy(gx.projectionMatrix);var Ex=dx.getLayers();if(Ex.length){var Sx=Ex[0];null!==Sx.leftBounds&&4===Sx.leftBounds.length&&gx.bounds.fromArray(Sx.leftBounds),null!==Sx.rightBounds&&4===Sx.rightBounds.length&&hx.bounds.fromArray(Sx.rightBounds)}return xx},this.getStandingMatrix=function(){return cx},this.submitFrame=function(){dx&&dx.isPresenting&&dx.submitFrame()},this.dispose=function(){"undefined"!=typeof window&&window.removeEventListener("vrdisplaypresentchange",nx)}}function Zl(ix,nx){return{convert:function(sx){var dx;if(sx===Yh)return ix.REPEAT;if(sx===Xh)return ix.CLAMP_TO_EDGE;if(sx===qh)return ix.MIRRORED_REPEAT;if(sx===Zh)return ix.NEAREST;if(sx===Jh)return ix.NEAREST_MIPMAP_NEAREST;if(sx===Kh)return ix.NEAREST_MIPMAP_LINEAR;if(sx===Qh)return ix.LINEAR;if(sx===$h)return ix.LINEAR_MIPMAP_NEAREST;if(sx===ef)return ix.LINEAR_MIPMAP_LINEAR;if(sx===tf)return ix.UNSIGNED_BYTE;if(sx===pf)return ix.UNSIGNED_SHORT_4_4_4_4;if(sx===cf)return ix.UNSIGNED_SHORT_5_5_5_1;if(sx===mf)return ix.UNSIGNED_SHORT_5_6_5;if(sx===af)return ix.BYTE;if(sx===rf)return ix.SHORT;if(sx===of)return ix.UNSIGNED_SHORT;if(sx===nf)return ix.INT;if(sx===sf)return ix.UNSIGNED_INT;if(sx===df)return ix.FLOAT;if(sx===lf&&null!==(dx=nx.get("OES_texture_half_float")))return dx.HALF_FLOAT_OES;if(sx===gf)return ix.ALPHA;if(sx===hf)return ix.RGB;if(sx===ff)return ix.RGBA;if(sx===yf)return ix.LUMINANCE;if(sx===xf)return ix.LUMINANCE_ALPHA;if(sx===Lf)return ix.DEPTH_COMPONENT;if(sx===bf)return ix.DEPTH_STENCIL;if(sx===nh)return ix.FUNC_ADD;if(sx===sh)return ix.FUNC_SUBTRACT;if(sx===dh)return ix.FUNC_REVERSE_SUBTRACT;if(sx===ch)return ix.ZERO;if(sx===mh)return ix.ONE;if(sx===uh)return ix.SRC_COLOR;if(sx===gh)return ix.ONE_MINUS_SRC_COLOR;if(sx===hh)return ix.SRC_ALPHA;if(sx===fh)return ix.ONE_MINUS_SRC_ALPHA;if(sx===yh)return ix.DST_ALPHA;if(sx===xh)return ix.ONE_MINUS_DST_ALPHA;if(sx===vh)return ix.DST_COLOR;if(sx===Lh)return ix.ONE_MINUS_DST_COLOR;if(sx===bh)return ix.SRC_ALPHA_SATURATE;if((sx===_f||sx===Af||sx===Ef||sx===Sf)&&null!==(dx=nx.get("WEBGL_compressed_texture_s3tc"))){if(sx===_f)return dx.COMPRESSED_RGB_S3TC_DXT1_EXT;if(sx===Af)return dx.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(sx===Ef)return dx.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(sx===Sf)return dx.COMPRESSED_RGBA_S3TC_DXT5_EXT}if((sx===Tf||sx===Mf||sx===wf||sx===Rf)&&null!==(dx=nx.get("WEBGL_compressed_texture_pvrtc"))){if(sx===Tf)return dx.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(sx===Mf)return dx.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(sx===wf)return dx.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(sx===Rf)return dx.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(sx===Pf&&null!==(dx=nx.get("WEBGL_compressed_texture_etc1")))return dx.COMPRESSED_RGB_ETC1_WEBGL;if((sx===Cf||sx===Of||sx===If||sx===Df||sx===Ff||sx===Bf||sx===Uf||sx===Nf||sx===Wf||sx===zf||sx===Hf||sx===Gf||sx===Vf||sx===kf)&&null!==(dx=nx.get("WEBGL_compressed_texture_astc")))return sx;if((sx===lh||sx===ph)&&null!==(dx=nx.get("EXT_blend_minmax"))){if(sx===lh)return dx.MIN_EXT;if(sx===ph)return dx.MAX_EXT}return sx===uf&&null!==(dx=nx.get("WEBGL_depth_texture"))?dx.UNSIGNED_INT_24_8_WEBGL:0}}}function Jl(){var ix={};return{get:function(nx,sx){var dx=nx.id+","+sx.id,lx=ix[dx];return void 0===lx&&(lx=new function(){var px=new function(){var gx=new function(){var vx={};return{get:function(Lx){if(void 0!==vx[Lx.id])return vx[Lx.id];var bx;switch(Lx.type){case"DirectionalLight":bx={direction:new sd,color:new Xd,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new od};break;case"SpotLight":bx={position:new sd,direction:new sd,color:new Xd,distance:0,coneCos:0,penumbraCos:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new od};break;case"PointLight":bx={position:new sd,color:new Xd,distance:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new od,shadowCameraNear:1,shadowCameraFar:1e3};break;case"HemisphereLight":bx={direction:new sd,skyColor:new Xd,groundColor:new Xd};break;case"RectAreaLight":bx={color:new Xd,position:new sd,halfWidth:new sd,halfHeight:new sd};}return vx[Lx.id]=bx,bx}}},hx={id:Oy++,hash:"",ambient:[0,0,0],directional:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]},fx=new sd,yx=new id,xx=new id;return{setup:function(vx,Lx,bx){for(var _x=0,Ax=0,Ex=0,Sx=0,Tx=0,Mx=0,wx=0,Rx=0,Px=bx.matrixWorldInverse,Cx=0,Ox=vx.length;Cx<Ox;Cx++){var Ix=vx[Cx],Dx=Ix.color,Fx=Ix.intensity,Bx=Ix.distance,Ux=Ix.shadow&&Ix.shadow.map?Ix.shadow.map.texture:null;if(Ix.isAmbientLight)_x+=Dx.r*Fx,Ax+=Dx.g*Fx,Ex+=Dx.b*Fx;else if(Ix.isDirectionalLight){if((Wx=gx.get(Ix)).color.copy(Ix.color).multiplyScalar(Ix.intensity),Wx.direction.setFromMatrixPosition(Ix.matrixWorld),fx.setFromMatrixPosition(Ix.target.matrixWorld),Wx.direction.sub(fx),Wx.direction.transformDirection(Px),Wx.shadow=Ix.castShadow,Ix.castShadow){var Nx=Ix.shadow;Wx.shadowBias=Nx.bias,Wx.shadowRadius=Nx.radius,Wx.shadowMapSize=Nx.mapSize}hx.directionalShadowMap[Sx]=Ux,hx.directionalShadowMatrix[Sx]=Ix.shadow.matrix,hx.directional[Sx]=Wx,Sx++}else if(Ix.isSpotLight)(Wx=gx.get(Ix)).position.setFromMatrixPosition(Ix.matrixWorld),Wx.position.applyMatrix4(Px),Wx.color.copy(Dx).multiplyScalar(Fx),Wx.distance=Bx,Wx.direction.setFromMatrixPosition(Ix.matrixWorld),fx.setFromMatrixPosition(Ix.target.matrixWorld),Wx.direction.sub(fx),Wx.direction.transformDirection(Px),Wx.coneCos=Math.cos(Ix.angle),Wx.penumbraCos=Math.cos(Ix.angle*(1-Ix.penumbra)),Wx.decay=0===Ix.distance?0:Ix.decay,Wx.shadow=Ix.castShadow,Ix.castShadow&&(Nx=Ix.shadow,Wx.shadowBias=Nx.bias,Wx.shadowRadius=Nx.radius,Wx.shadowMapSize=Nx.mapSize),hx.spotShadowMap[Mx]=Ux,hx.spotShadowMatrix[Mx]=Ix.shadow.matrix,hx.spot[Mx]=Wx,Mx++;else if(Ix.isRectAreaLight)(Wx=gx.get(Ix)).color.copy(Dx).multiplyScalar(Fx),Wx.position.setFromMatrixPosition(Ix.matrixWorld),Wx.position.applyMatrix4(Px),xx.identity(),yx.copy(Ix.matrixWorld),yx.premultiply(Px),xx.extractRotation(yx),Wx.halfWidth.set(.5*Ix.width,0,0),Wx.halfHeight.set(0,.5*Ix.height,0),Wx.halfWidth.applyMatrix4(xx),Wx.halfHeight.applyMatrix4(xx),hx.rectArea[wx]=Wx,wx++;else if(Ix.isPointLight)(Wx=gx.get(Ix)).position.setFromMatrixPosition(Ix.matrixWorld),Wx.position.applyMatrix4(Px),Wx.color.copy(Ix.color).multiplyScalar(Ix.intensity),Wx.distance=Ix.distance,Wx.decay=0===Ix.distance?0:Ix.decay,Wx.shadow=Ix.castShadow,Ix.castShadow&&(Nx=Ix.shadow,Wx.shadowBias=Nx.bias,Wx.shadowRadius=Nx.radius,Wx.shadowMapSize=Nx.mapSize,Wx.shadowCameraNear=Nx.camera.near,Wx.shadowCameraFar=Nx.camera.far),hx.pointShadowMap[Tx]=Ux,hx.pointShadowMatrix[Tx]=Ix.shadow.matrix,hx.point[Tx]=Wx,Tx++;else if(Ix.isHemisphereLight){var Wx;(Wx=gx.get(Ix)).direction.setFromMatrixPosition(Ix.matrixWorld),Wx.direction.transformDirection(Px),Wx.direction.normalize(),Wx.skyColor.copy(Ix.color).multiplyScalar(Fx),Wx.groundColor.copy(Ix.groundColor).multiplyScalar(Fx),hx.hemi[Rx]=Wx,Rx++}}hx.ambient[0]=_x,hx.ambient[1]=Ax,hx.ambient[2]=Ex,hx.directional.length=Sx,hx.spot.length=Mx,hx.rectArea.length=wx,hx.point.length=Tx,hx.hemi.length=Rx,hx.hash=hx.id+","+Sx+","+Tx+","+Mx+","+wx+","+Rx+","+Lx.length},state:hx}},cx=[],mx=[],ux=[];return{init:function(){cx.length=0,mx.length=0,ux.length=0},state:{lightsArray:cx,shadowsArray:mx,spritesArray:ux,lights:px},setupLights:function(gx){px.setup(cx,mx,gx)},pushLight:function(gx){cx.push(gx)},pushShadow:function(gx){mx.push(gx)},pushSprite:function(gx){ux.push(gx)}}},ix[dx]=lx),lx},dispose:function(){ix={}}}}function Kl(ix){function nx(){return null===$x?cv:1}function sx(){(Dx=new function(wv){var Rv={};return{get:function(Pv){if(void 0!==Rv[Pv])return Rv[Pv];var Cv;return Cv="WEBGL_depth_texture"===Pv?wv.getExtension("WEBGL_depth_texture")||wv.getExtension("MOZ_WEBGL_depth_texture")||wv.getExtension("WEBKIT_WEBGL_depth_texture"):"EXT_texture_filter_anisotropic"===Pv?wv.getExtension("EXT_texture_filter_anisotropic")||wv.getExtension("MOZ_EXT_texture_filter_anisotropic")||wv.getExtension("WEBKIT_EXT_texture_filter_anisotropic"):"WEBGL_compressed_texture_s3tc"===Pv?wv.getExtension("WEBGL_compressed_texture_s3tc")||wv.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||wv.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc"):"WEBGL_compressed_texture_pvrtc"===Pv?wv.getExtension("WEBGL_compressed_texture_pvrtc")||wv.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"):"WEBGL_compressed_texture_etc1"===Pv?wv.getExtension("WEBGL_compressed_texture_etc1"):wv.getExtension(Pv),null===Cv&&console.warn("THREE.WebGLRenderer: "+Pv+" extension not supported."),Rv[Pv]=Cv,Cv}}}(Ix)).get("WEBGL_depth_texture"),Dx.get("OES_texture_float"),Dx.get("OES_texture_float_linear"),Dx.get("OES_texture_half_float"),Dx.get("OES_texture_half_float_linear"),Dx.get("OES_standard_derivatives"),Dx.get("OES_element_index_uint"),Dx.get("ANGLE_instanced_arrays"),Jx=new Zl(Ix,Dx),Fx=new function(wv,Rv,Pv){function Cv(Yv){if("highp"===Yv){if(0<wv.getShaderPrecisionFormat(wv.VERTEX_SHADER,wv.HIGH_FLOAT).precision&&0<wv.getShaderPrecisionFormat(wv.FRAGMENT_SHADER,wv.HIGH_FLOAT).precision)return"highp";Yv="mediump"}return"mediump"===Yv&&0<wv.getShaderPrecisionFormat(wv.VERTEX_SHADER,wv.MEDIUM_FLOAT).precision&&0<wv.getShaderPrecisionFormat(wv.FRAGMENT_SHADER,wv.MEDIUM_FLOAT).precision?"mediump":"lowp"}var Ov,Iv=void 0===Pv.precision?"highp":Pv.precision,Dv=Cv(Iv);Dv!==Iv&&(console.warn("THREE.WebGLRenderer:",Iv,"not supported, using",Dv,"instead."),Iv=Dv);var Fv=!0===Pv.logarithmicDepthBuffer,Bv=wv.getParameter(wv.MAX_TEXTURE_IMAGE_UNITS),Uv=wv.getParameter(wv.MAX_VERTEX_TEXTURE_IMAGE_UNITS),Nv=wv.getParameter(wv.MAX_TEXTURE_SIZE),Wv=wv.getParameter(wv.MAX_CUBE_MAP_TEXTURE_SIZE),zv=wv.getParameter(wv.MAX_VERTEX_ATTRIBS),Hv=wv.getParameter(wv.MAX_VERTEX_UNIFORM_VECTORS),Gv=wv.getParameter(wv.MAX_VARYING_VECTORS),Vv=wv.getParameter(wv.MAX_FRAGMENT_UNIFORM_VECTORS),kv=0<Uv,jv=!!Rv.get("OES_texture_float");return{getMaxAnisotropy:function(){if(void 0!=Ov)return Ov;var Yv=Rv.get("EXT_texture_filter_anisotropic");return Ov=null===Yv?0:wv.getParameter(Yv.MAX_TEXTURE_MAX_ANISOTROPY_EXT)},getMaxPrecision:Cv,precision:Iv,logarithmicDepthBuffer:Fv,maxTextures:Bv,maxVertexTextures:Uv,maxTextureSize:Nv,maxCubemapSize:Wv,maxAttributes:zv,maxVertexUniforms:Hv,maxVaryings:Gv,maxFragmentUniforms:Vv,vertexTextures:kv,floatFragmentTextures:jv,floatVertexTextures:kv&&jv}}(Ix,Dx,ix),(Bx=new function(wv,Rv,Pv){function Cv(yL,xL,vL){var LL=new Uint8Array(4),bL=wv.createTexture();wv.bindTexture(yL,bL),wv.texParameteri(yL,wv.TEXTURE_MIN_FILTER,wv.NEAREST),wv.texParameteri(yL,wv.TEXTURE_MAG_FILTER,wv.NEAREST);for(var _L=0;_L<vL;_L++)wv.texImage2D(xL+_L,0,wv.RGBA,1,1,0,wv.RGBA,wv.UNSIGNED_BYTE,LL);return bL}function Ov(yL){!0!==Yv[yL]&&(wv.enable(yL),Yv[yL]=!0)}function Iv(yL){!1!==Yv[yL]&&(wv.disable(yL),Yv[yL]=!1)}function Dv(yL,xL,vL,LL,bL,_L,AL,EL){(yL===eh?Iv(wv.BLEND):Ov(wv.BLEND),yL!==ih)?((yL!==Zv||EL!==aL)&&(yL===ah?EL?(wv.blendEquationSeparate(wv.FUNC_ADD,wv.FUNC_ADD),wv.blendFuncSeparate(wv.ONE,wv.ONE,wv.ONE,wv.ONE)):(wv.blendEquation(wv.FUNC_ADD),wv.blendFunc(wv.SRC_ALPHA,wv.ONE)):yL===rh?EL?(wv.blendEquationSeparate(wv.FUNC_ADD,wv.FUNC_ADD),wv.blendFuncSeparate(wv.ZERO,wv.ZERO,wv.ONE_MINUS_SRC_COLOR,wv.ONE_MINUS_SRC_ALPHA)):(wv.blendEquation(wv.FUNC_ADD),wv.blendFunc(wv.ZERO,wv.ONE_MINUS_SRC_COLOR)):yL===oh?EL?(wv.blendEquationSeparate(wv.FUNC_ADD,wv.FUNC_ADD),wv.blendFuncSeparate(wv.ZERO,wv.SRC_COLOR,wv.ZERO,wv.SRC_ALPHA)):(wv.blendEquation(wv.FUNC_ADD),wv.blendFunc(wv.ZERO,wv.SRC_COLOR)):EL?(wv.blendEquationSeparate(wv.FUNC_ADD,wv.FUNC_ADD),wv.blendFuncSeparate(wv.ONE,wv.ONE_MINUS_SRC_ALPHA,wv.ONE,wv.ONE_MINUS_SRC_ALPHA)):(wv.blendEquationSeparate(wv.FUNC_ADD,wv.FUNC_ADD),wv.blendFuncSeparate(wv.SRC_ALPHA,wv.ONE_MINUS_SRC_ALPHA,wv.ONE,wv.ONE_MINUS_SRC_ALPHA))),Jv=null,Kv=null,Qv=null,$v=null,eL=null,tL=null):(bL=bL||xL,_L=_L||vL,AL=AL||LL,xL===Jv&&bL===$v||(wv.blendEquationSeparate(Pv.convert(xL),Pv.convert(bL)),Jv=xL,$v=bL),vL===Kv&&LL===Qv&&_L===eL&&AL===tL||(wv.blendFuncSeparate(Pv.convert(vL),Pv.convert(LL),Pv.convert(_L),Pv.convert(AL)),Kv=vL,Qv=LL,eL=_L,tL=AL));Zv=yL,aL=EL}function Fv(yL){rL!==yL&&(yL?wv.frontFace(wv.CW):wv.frontFace(wv.CCW),rL=yL)}function Bv(yL){yL===Ug?Iv(wv.CULL_FACE):(Ov(wv.CULL_FACE),yL!==oL&&(yL===Ng?wv.cullFace(wv.BACK):yL===Wg?wv.cullFace(wv.FRONT):wv.cullFace(wv.FRONT_AND_BACK))),oL=yL}function Uv(yL,xL,vL){yL?(Ov(wv.POLYGON_OFFSET_FILL),nL===xL&&sL===vL||(wv.polygonOffset(xL,vL),nL=xL,sL=vL)):Iv(wv.POLYGON_OFFSET_FILL)}function Nv(yL){void 0===yL&&(yL=wv.TEXTURE0+dL-1),mL!==yL&&(wv.activeTexture(yL),mL=yL)}var Wv=new function(){var yL=!1,xL=new pd,vL=null,LL=new pd(0,0,0,0);return{setMask:function(bL){vL===bL||yL||(wv.colorMask(bL,bL,bL,bL),vL=bL)},setLocked:function(bL){yL=bL},setClear:function(bL,_L,AL,EL,SL){!0===SL&&(bL*=EL,_L*=EL,AL*=EL),xL.set(bL,_L,AL,EL),!1===LL.equals(xL)&&(wv.clearColor(bL,_L,AL,EL),LL.copy(xL))},reset:function(){yL=!1,vL=null,LL.set(-1,0,0,0)}}},zv=new function(){var yL=!1,xL=null,vL=null,LL=null;return{setTest:function(bL){bL?Ov(wv.DEPTH_TEST):Iv(wv.DEPTH_TEST)},setMask:function(bL){xL===bL||yL||(wv.depthMask(bL),xL=bL)},setFunc:function(bL){vL!==bL&&(bL?bL===_h?wv.depthFunc(wv.NEVER):bL===Ah?wv.depthFunc(wv.ALWAYS):bL===Eh?wv.depthFunc(wv.LESS):bL===Sh?wv.depthFunc(wv.LEQUAL):bL===Th?wv.depthFunc(wv.EQUAL):bL===Mh?wv.depthFunc(wv.GEQUAL):bL===wh?wv.depthFunc(wv.GREATER):bL===Rh?wv.depthFunc(wv.NOTEQUAL):wv.depthFunc(wv.LEQUAL):wv.depthFunc(wv.LEQUAL),vL=bL)},setLocked:function(bL){yL=bL},setClear:function(bL){LL!==bL&&(wv.clearDepth(bL),LL=bL)},reset:function(){yL=!1,xL=null,vL=null,LL=null}}},Hv=new function(){var yL=!1,xL=null,vL=null,LL=null,bL=null,_L=null,AL=null,EL=null,SL=null;return{setTest:function(TL){TL?Ov(wv.STENCIL_TEST):Iv(wv.STENCIL_TEST)},setMask:function(TL){xL===TL||yL||(wv.stencilMask(TL),xL=TL)},setFunc:function(TL,ML,wL){vL===TL&&LL===ML&&bL===wL||(wv.stencilFunc(TL,ML,wL),vL=TL,LL=ML,bL=wL)},setOp:function(TL,ML,wL){_L===TL&&AL===ML&&EL===wL||(wv.stencilOp(TL,ML,wL),_L=TL,AL=ML,EL=wL)},setLocked:function(TL){yL=TL},setClear:function(TL){SL!==TL&&(wv.clearStencil(TL),SL=TL)},reset:function(){yL=!1,xL=null,vL=null,LL=null,bL=null,_L=null,AL=null,EL=null,SL=null}}},Gv=wv.getParameter(wv.MAX_VERTEX_ATTRIBS),Vv=new Uint8Array(Gv),kv=new Uint8Array(Gv),jv=new Uint8Array(Gv),Yv={},Xv=null,qv=null,Zv=null,Jv=null,Kv=null,Qv=null,$v=null,eL=null,tL=null,aL=!1,rL=null,oL=null,iL=null,nL=null,sL=null,dL=wv.getParameter(wv.MAX_COMBINED_TEXTURE_IMAGE_UNITS),lL=!1,pL=0,cL=wv.getParameter(wv.VERSION);-1===cL.indexOf("WebGL")?-1!==cL.indexOf("OpenGL ES")&&(pL=parseFloat(/^OpenGL\ ES\ ([0-9])/.exec(cL)[1]),lL=2<=pL):(pL=parseFloat(/^WebGL\ ([0-9])/.exec(cL)[1]),lL=1<=pL);var mL=null,uL={},gL=new pd,hL=new pd,fL={};return fL[wv.TEXTURE_2D]=Cv(wv.TEXTURE_2D,wv.TEXTURE_2D,1),fL[wv.TEXTURE_CUBE_MAP]=Cv(wv.TEXTURE_CUBE_MAP,wv.TEXTURE_CUBE_MAP_POSITIVE_X,6),Wv.setClear(0,0,0,1),zv.setClear(1),Hv.setClear(0),Ov(wv.DEPTH_TEST),zv.setFunc(Sh),Fv(!1),Bv(Ng),Ov(wv.CULL_FACE),Ov(wv.BLEND),Dv(th),{buffers:{color:Wv,depth:zv,stencil:Hv},initAttributes:function(){for(var yL=0,xL=Vv.length;yL<xL;yL++)Vv[yL]=0},enableAttribute:function(yL){Vv[yL]=1,0===kv[yL]&&(wv.enableVertexAttribArray(yL),kv[yL]=1),0!==jv[yL]&&(Rv.get("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(yL,0),jv[yL]=0)},enableAttributeAndDivisor:function(yL,xL){Vv[yL]=1,0===kv[yL]&&(wv.enableVertexAttribArray(yL),kv[yL]=1),jv[yL]!==xL&&(Rv.get("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(yL,xL),jv[yL]=xL)},disableUnusedAttributes:function(){for(var yL=0,xL=kv.length;yL!==xL;++yL)kv[yL]!==Vv[yL]&&(wv.disableVertexAttribArray(yL),kv[yL]=0)},enable:Ov,disable:Iv,getCompressedTextureFormats:function(){if(null===Xv&&(Xv=[],Rv.get("WEBGL_compressed_texture_pvrtc")||Rv.get("WEBGL_compressed_texture_s3tc")||Rv.get("WEBGL_compressed_texture_etc1")||Rv.get("WEBGL_compressed_texture_astc")))for(var yL=wv.getParameter(wv.COMPRESSED_TEXTURE_FORMATS),xL=0;xL<yL.length;xL++)Xv.push(yL[xL]);return Xv},useProgram:function(yL){return qv!==yL&&(wv.useProgram(yL),qv=yL,!0)},setBlending:Dv,setMaterial:function(yL,xL){yL.side===qg?Iv(wv.CULL_FACE):Ov(wv.CULL_FACE);var vL=yL.side===Xg;xL&&(vL=!vL),Fv(vL),!0===yL.transparent?Dv(yL.blending,yL.blendEquation,yL.blendSrc,yL.blendDst,yL.blendEquationAlpha,yL.blendSrcAlpha,yL.blendDstAlpha,yL.premultipliedAlpha):Dv(eh),zv.setFunc(yL.depthFunc),zv.setTest(yL.depthTest),zv.setMask(yL.depthWrite),Wv.setMask(yL.colorWrite),Uv(yL.polygonOffset,yL.polygonOffsetFactor,yL.polygonOffsetUnits)},setFlipSided:Fv,setCullFace:Bv,setLineWidth:function(yL){yL!==iL&&(lL&&wv.lineWidth(yL),iL=yL)},setPolygonOffset:Uv,setScissorTest:function(yL){yL?Ov(wv.SCISSOR_TEST):Iv(wv.SCISSOR_TEST)},activeTexture:Nv,bindTexture:function(yL,xL){null===mL&&Nv();var vL=uL[mL];void 0===vL&&(vL={type:void 0,texture:void 0},uL[mL]=vL),vL.type===yL&&vL.texture===xL||(wv.bindTexture(yL,xL||fL[yL]),vL.type=yL,vL.texture=xL)},compressedTexImage2D:function(){try{wv.compressedTexImage2D.apply(wv,arguments)}catch(yL){console.error("THREE.WebGLState:",yL)}},texImage2D:function(){try{wv.texImage2D.apply(wv,arguments)}catch(yL){console.error("THREE.WebGLState:",yL)}},scissor:function(yL){!1===gL.equals(yL)&&(wv.scissor(yL.x,yL.y,yL.z,yL.w),gL.copy(yL))},viewport:function(yL){!1===hL.equals(yL)&&(wv.viewport(yL.x,yL.y,yL.z,yL.w),hL.copy(yL))},reset:function(){for(var yL=0;yL<kv.length;yL++)1===kv[yL]&&(wv.disableVertexAttribArray(yL),kv[yL]=0);Yv={},Xv=null,mL=null,uL={},qv=null,Zv=null,rL=null,oL=null,Wv.reset(),zv.reset(),Hv.reset()}}}(Ix,Dx,Jx)).scissor(nv.copy(uv).multiplyScalar(cv)),Bx.viewport(iv.copy(mv).multiplyScalar(cv)),Ux=new function(){var wv={};return{get:function(Rv){var Pv=Rv.uuid,Cv=wv[Pv];return void 0===Cv&&(Cv={},wv[Pv]=Cv),Cv},remove:function(Rv){delete wv[Rv.uuid]},update:function(Rv,Pv,Cv){var Ov=Rv.uuid;wv[Ov][Pv]=Cv},dispose:function(){wv={}}}},Nx=new jl(Ix,Dx,Bx,Ux,Fx,Jx,bv,_v),Wx=new function(wv){var Rv={};return{get:function(Pv){return Pv.isInterleavedBufferAttribute&&(Pv=Pv.data),Rv[Pv.uuid]},remove:function(Pv){Pv.isInterleavedBufferAttribute&&(Pv=Pv.data);var Cv=Rv[Pv.uuid];Cv&&(wv.deleteBuffer(Cv.buffer),delete Rv[Pv.uuid])},update:function(Pv,Cv){Pv.isInterleavedBufferAttribute&&(Pv=Pv.data);var Ov=Rv[Pv.uuid];void 0===Ov?Rv[Pv.uuid]=function(Iv,Dv){var Fv=Iv.array,Bv=Iv.dynamic?wv.DYNAMIC_DRAW:wv.STATIC_DRAW,Uv=wv.createBuffer();wv.bindBuffer(Dv,Uv),wv.bufferData(Dv,Fv,Bv),Iv.onUploadCallback();var Nv=wv.FLOAT;return Fv instanceof Float32Array?Nv=wv.FLOAT:Fv instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):Fv instanceof Uint16Array?Nv=wv.UNSIGNED_SHORT:Fv instanceof Int16Array?Nv=wv.SHORT:Fv instanceof Uint32Array?Nv=wv.UNSIGNED_INT:Fv instanceof Int32Array?Nv=wv.INT:Fv instanceof Int8Array?Nv=wv.BYTE:Fv instanceof Uint8Array&&(Nv=wv.UNSIGNED_BYTE),{buffer:Uv,type:Nv,bytesPerElement:Fv.BYTES_PER_ELEMENT,version:Iv.version}}(Pv,Cv):Ov.version<Pv.version&&(function(Iv,Dv,Fv){var Bv=Dv.array,Uv=Dv.updateRange;wv.bindBuffer(Fv,Iv),!1===Dv.dynamic?wv.bufferData(Fv,Bv,wv.STATIC_DRAW):-1===Uv.count?wv.bufferSubData(Fv,0,Bv):0===Uv.count?console.error("THREE.WebGLObjects.updateBuffer: dynamic THREE.BufferAttribute marked as needsUpdate but updateRange.count is 0, ensure you are using set methods or updating manually."):(wv.bufferSubData(Fv,Uv.offset*Bv.BYTES_PER_ELEMENT,Bv.subarray(Uv.offset,Uv.offset+Uv.count)),Uv.count=-1)}(Ov.buffer,Pv,Cv),Ov.version=Pv.version)}}}(Ix),zx=new function(wv,Rv,Pv){function Cv(Dv){var Fv=Dv.target,Bv=Ov[Fv.id];for(var Uv in null!==Bv.index&&Rv.remove(Bv.index),Bv.attributes)Rv.remove(Bv.attributes[Uv]);Fv.removeEventListener("dispose",Cv),delete Ov[Fv.id];var Nv=Iv[Fv.id];Nv&&(Rv.remove(Nv),delete Iv[Fv.id]),(Nv=Iv[Bv.id])&&(Rv.remove(Nv),delete Iv[Bv.id]),Pv.geometries--}var Ov={},Iv={};return{get:function(Dv,Fv){var Bv=Ov[Fv.id];return Bv||(Fv.addEventListener("dispose",Cv),Fv.isBufferGeometry?Bv=Fv:Fv.isGeometry&&(void 0===Fv._bufferGeometry&&(Fv._bufferGeometry=new _l().setFromObject(Dv)),Bv=Fv._bufferGeometry),Ov[Fv.id]=Bv,Pv.geometries++,Bv)},update:function(Dv){var Fv=Dv.index,Bv=Dv.attributes;for(var Uv in null!==Fv&&Rv.update(Fv,wv.ELEMENT_ARRAY_BUFFER),Bv)Rv.update(Bv[Uv],wv.ARRAY_BUFFER);var Nv=Dv.morphAttributes;for(var Uv in Nv)for(var Wv=Nv[Uv],zv=0,Hv=Wv.length;zv<Hv;zv++)Rv.update(Wv[zv],wv.ARRAY_BUFFER)},getWireframeAttribute:function(Dv){var Fv=Iv[Dv.id];if(Fv)return Fv;var Uv=[],Nv=Dv.index,Wv=Dv.attributes,Bv;if(null!==Nv)for(var zv=0,Hv=(Bv=Nv.array).length;zv<Hv;zv+=3){var Gv=Bv[zv+0],Vv=Bv[zv+1],kv=Bv[zv+2];Uv.push(Gv,Vv,Vv,kv,kv,Gv)}else for(zv=0,Hv=(Bv=Wv.position.array).length/3-1;zv<Hv;zv+=3)Gv=zv+0,Vv=zv+1,kv=zv+2,Uv.push(Gv,Vv,Vv,kv,kv,Gv);return Fv=new(65535<bl(Uv)?yl:hl)(Uv,1),Rv.update(Fv,wv.ELEMENT_ARRAY_BUFFER),Iv[Dv.id]=Fv,Fv}}}(Ix,Wx,bv),Hx=new function(wv,Rv){var Pv={};return{update:function(Cv){var Ov=Rv.frame,Iv=Cv.geometry,Dv=wv.get(Cv,Iv);return Pv[Dv.id]!==Ov&&(Iv.isGeometry&&Dv.updateFromObject(Cv),wv.update(Dv),Pv[Dv.id]=Ov),Dv},dispose:function(){Pv={}}}}(zx,_v),Yx=new function(wv){var Rv={},Pv=new Float32Array(8);return{update:function(Cv,Ov,Iv,Dv){var Fv=Cv.morphTargetInfluences,Bv=Fv.length,Uv=Rv[Ov.id];if(void 0===Uv){Uv=[];for(var Nv=0;Nv<Bv;Nv++)Uv[Nv]=[Nv,0];Rv[Ov.id]=Uv}var Wv=Iv.morphTargets&&Ov.morphAttributes.position,zv=Iv.morphNormals&&Ov.morphAttributes.normal;for(Nv=0;Nv<Bv;Nv++)0!==(Hv=Uv[Nv])[1]&&(Wv&&Ov.removeAttribute("morphTarget"+Nv),zv&&Ov.removeAttribute("morphNormal"+Nv));for(Nv=0;Nv<Bv;Nv++)(Hv=Uv[Nv])[0]=Nv,Hv[1]=Fv[Nv];for(Uv.sort(Fl),Nv=0;8>Nv;Nv++){var Hv;if(Hv=Uv[Nv]){var Gv=Hv[0],Vv=Hv[1];if(Vv){Wv&&Ov.addAttribute("morphTarget"+Nv,Wv[Gv]),zv&&Ov.addAttribute("morphNormal"+Nv,zv[Gv]),Pv[Nv]=Vv;continue}}Pv[Nv]=0}Dv.getUniforms().setValue(wv,"morphTargetInfluences",Pv)}}}(Ix),Gx=new kl(Kx,Dx,Fx),Vx=new function(){var wv={};return{get:function(Rv,Pv){var Cv=Rv.id+","+Pv.id,Ov=wv[Cv];return void 0===Ov&&(Ov=new function(){var Iv=[],Dv=0,Fv=[],Bv=[];return{opaque:Fv,transparent:Bv,init:function(){Dv=0,Fv.length=0,Bv.length=0},push:function(Uv,Nv,Wv,zv,Hv){var Gv=Iv[Dv];void 0===Gv?(Gv={id:Uv.id,object:Uv,geometry:Nv,material:Wv,program:Wv.program,renderOrder:Uv.renderOrder,z:zv,group:Hv},Iv[Dv]=Gv):(Gv.id=Uv.id,Gv.object=Uv,Gv.geometry=Nv,Gv.material=Wv,Gv.program=Wv.program,Gv.renderOrder=Uv.renderOrder,Gv.z=zv,Gv.group=Hv),(!0===Wv.transparent?Bv:Fv).push(Gv),Dv++},sort:function(){1<Fv.length&&Fv.sort(Il),1<Bv.length&&Bv.sort(Dl)}}},wv[Cv]=Ov),Ov},dispose:function(){wv={}}}},kx=new Jl,jx=new function(wv,Rv,Pv,Cv){function Ov(Nv,Wv){Rv.buffers.color.setClear(Nv.r,Nv.g,Nv.b,Wv,Cv)}var Bv=new Xd(0),Uv=0,Iv,Dv,Fv;return{getClearColor:function(){return Bv},setClearColor:function(Nv,Wv){Bv.set(Nv),Ov(Bv,Uv=void 0===Wv?1:Wv)},getClearAlpha:function(){return Uv},setClearAlpha:function(Nv){Ov(Bv,Uv=Nv)},render:function(Nv,Wv,zv,Hv){var Gv=Wv.background;null===Gv?Ov(Bv,Uv):Gv&&Gv.isColor&&(Ov(Gv,1),Hv=!0),(wv.autoClear||Hv)&&wv.clear(wv.autoClearColor,wv.autoClearDepth,wv.autoClearStencil),Gv&&Gv.isCubeTexture?(void 0===Fv&&((Fv=new Ol(new El(1,1,1),new wl({uniforms:Ty.cube.uniforms,vertexShader:Ty.cube.vertexShader,fragmentShader:Ty.cube.fragmentShader,side:Xg,depthTest:!0,depthWrite:!1,fog:!1}))).geometry.removeAttribute("normal"),Fv.geometry.removeAttribute("uv"),Fv.onBeforeRender=function(Vv,kv,jv){this.matrixWorld.copyPosition(jv.matrixWorld)},Pv.update(Fv.geometry)),Fv.material.uniforms.tCube.value=Gv,Nv.push(Fv,Fv.geometry,Fv.material,0,null)):Gv&&Gv.isTexture&&(void 0===Iv&&(Iv=new sl(-1,1,1,-1,0,1),Dv=new Ol(new Tl(2,2),new Ml({depthTest:!1,depthWrite:!1,fog:!1})),Pv.update(Dv.geometry)),Dv.material.map=Gv,wv.renderBufferDirect(Iv,null,Dv.geometry,Dv.material,Dv,null))}}}(Kx,Bx,zx,wx),Xx=new function(wv,Rv,Pv){var Cv;this.setMode=function(Ov){Cv=Ov},this.render=function(Ov,Iv){wv.drawArrays(Cv,Ov,Iv),Pv.calls++,Pv.vertices+=Iv,Cv===wv.TRIANGLES?Pv.faces+=Iv/3:Cv===wv.POINTS&&(Pv.points+=Iv)},this.renderInstances=function(Ov,Iv,Dv){var Fv=Rv.get("ANGLE_instanced_arrays");if(null!==Fv){var Bv=Ov.attributes.position;Bv.isInterleavedBufferAttribute?(Dv=Bv.data.count,Fv.drawArraysInstancedANGLE(Cv,0,Dv,Ov.maxInstancedCount)):Fv.drawArraysInstancedANGLE(Cv,Iv,Dv,Ov.maxInstancedCount),Pv.calls++,Pv.vertices+=Dv*Ov.maxInstancedCount,Cv===wv.TRIANGLES?Pv.faces+=Ov.maxInstancedCount*Dv/3:Cv===wv.POINTS&&(Pv.points+=Ov.maxInstancedCount*Dv)}else console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.")}}(Ix,Dx,_v),qx=new function(wv,Rv,Pv){var Cv,Ov,Iv;this.setMode=function(Dv){Cv=Dv},this.setIndex=function(Dv){Ov=Dv.type,Iv=Dv.bytesPerElement},this.render=function(Dv,Fv){wv.drawElements(Cv,Fv,Ov,Dv*Iv),Pv.calls++,Pv.vertices+=Fv,Cv===wv.TRIANGLES?Pv.faces+=Fv/3:Cv===wv.POINTS&&(Pv.points+=Fv)},this.renderInstances=function(Dv,Fv,Bv){var Uv=Rv.get("ANGLE_instanced_arrays");null===Uv?console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays."):(Uv.drawElementsInstancedANGLE(Cv,Bv,Ov,Fv*Iv,Dv.maxInstancedCount),Pv.calls++,Pv.vertices+=Bv*Dv.maxInstancedCount,Cv===wv.TRIANGLES?Pv.faces+=Dv.maxInstancedCount*Bv/3:Cv===wv.POINTS&&(Pv.points+=Dv.maxInstancedCount*Bv))}}(Ix,Dx,_v),Zx=new function(wv,Rv,Pv,Cv,Ov){function Iv(){var kv=new Float32Array([-0.5,-0.5,0,0,0.5,-0.5,1,0,0.5,0.5,1,1,-0.5,0.5,0,1]),jv=new Uint16Array([0,1,2,0,2,3]);Fv=Rv.createBuffer(),Bv=Rv.createBuffer(),Rv.bindBuffer(Rv.ARRAY_BUFFER,Fv),Rv.bufferData(Rv.ARRAY_BUFFER,kv,Rv.STATIC_DRAW),Rv.bindBuffer(Rv.ELEMENT_ARRAY_BUFFER,Bv),Rv.bufferData(Rv.ELEMENT_ARRAY_BUFFER,jv,Rv.STATIC_DRAW),Uv=function(){var qv=Rv.createProgram(),Zv=Rv.createShader(Rv.VERTEX_SHADER),Jv=Rv.createShader(Rv.FRAGMENT_SHADER);return Rv.shaderSource(Zv,["precision "+Ov.precision+" float;","#define SHADER_NAME SpriteMaterial","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform float rotation;","uniform vec2 center;","uniform vec2 scale;","uniform vec2 uvOffset;","uniform vec2 uvScale;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","varying float fogDepth;","void main() {","\tvUV = uvOffset + uv * uvScale;","\tvec2 alignedPosition = ( position - center ) * scale;","\tvec2 rotatedPosition;","\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;","\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;","\tvec4 mvPosition;","\tmvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );","\tmvPosition.xy += rotatedPosition;","\tgl_Position = projectionMatrix * mvPosition;","\tfogDepth = - mvPosition.z;","}"].join("\n")),Rv.shaderSource(Jv,["precision "+Ov.precision+" float;","#define SHADER_NAME SpriteMaterial","uniform vec3 color;","uniform sampler2D map;","uniform float opacity;","uniform int fogType;","uniform vec3 fogColor;","uniform float fogDensity;","uniform float fogNear;","uniform float fogFar;","uniform float alphaTest;","varying vec2 vUV;","varying float fogDepth;","void main() {","\tvec4 texture = texture2D( map, vUV );","\tgl_FragColor = vec4( color * texture.xyz, texture.a * opacity );","\tif ( gl_FragColor.a < alphaTest ) discard;","\tif ( fogType > 0 ) {","\t\tfloat fogFactor = 0.0;","\t\tif ( fogType == 1 ) {","\t\t\tfogFactor = smoothstep( fogNear, fogFar, fogDepth );","\t\t} else {","\t\t\tconst float LOG2 = 1.442695;","\t\t\tfogFactor = exp2( - fogDensity * fogDensity * fogDepth * fogDepth * LOG2 );","\t\t\tfogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );","\t\t}","\t\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );","\t}","}"].join("\n")),Rv.compileShader(Zv),Rv.compileShader(Jv),Rv.attachShader(qv,Zv),Rv.attachShader(qv,Jv),Rv.linkProgram(qv),qv}(),Nv={position:Rv.getAttribLocation(Uv,"position"),uv:Rv.getAttribLocation(Uv,"uv")},Wv={uvOffset:Rv.getUniformLocation(Uv,"uvOffset"),uvScale:Rv.getUniformLocation(Uv,"uvScale"),rotation:Rv.getUniformLocation(Uv,"rotation"),center:Rv.getUniformLocation(Uv,"center"),scale:Rv.getUniformLocation(Uv,"scale"),color:Rv.getUniformLocation(Uv,"color"),map:Rv.getUniformLocation(Uv,"map"),opacity:Rv.getUniformLocation(Uv,"opacity"),modelViewMatrix:Rv.getUniformLocation(Uv,"modelViewMatrix"),projectionMatrix:Rv.getUniformLocation(Uv,"projectionMatrix"),fogType:Rv.getUniformLocation(Uv,"fogType"),fogDensity:Rv.getUniformLocation(Uv,"fogDensity"),fogNear:Rv.getUniformLocation(Uv,"fogNear"),fogFar:Rv.getUniformLocation(Uv,"fogFar"),fogColor:Rv.getUniformLocation(Uv,"fogColor"),fogDepth:Rv.getUniformLocation(Uv,"fogDepth"),alphaTest:Rv.getUniformLocation(Uv,"alphaTest")};var Yv=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");Yv.width=8,Yv.height=8;var Xv=Yv.getContext("2d");Xv.fillStyle="white",Xv.fillRect(0,0,8,8),zv=new qd(Yv)}function Dv(kv,jv){return kv.renderOrder===jv.renderOrder?kv.z===jv.z?jv.id-kv.id:jv.z-kv.z:kv.renderOrder-jv.renderOrder}var Hv=new sd,Gv=new nd,Vv=new sd,Fv,Bv,Uv,Nv,Wv,zv;this.render=function(kv,jv,Yv){if(0!==kv.length){void 0===Uv&&Iv(),Pv.useProgram(Uv),Pv.initAttributes(),Pv.enableAttribute(Nv.position),Pv.enableAttribute(Nv.uv),Pv.disableUnusedAttributes(),Pv.disable(Rv.CULL_FACE),Pv.enable(Rv.BLEND),Rv.bindBuffer(Rv.ARRAY_BUFFER,Fv),Rv.vertexAttribPointer(Nv.position,2,Rv.FLOAT,!1,16,0),Rv.vertexAttribPointer(Nv.uv,2,Rv.FLOAT,!1,16,8),Rv.bindBuffer(Rv.ELEMENT_ARRAY_BUFFER,Bv),Rv.uniformMatrix4fv(Wv.projectionMatrix,!1,Yv.projectionMatrix.elements),Pv.activeTexture(Rv.TEXTURE0),Rv.uniform1i(Wv.map,0);var Xv=0,qv=0,Zv=jv.fog;Zv?(Rv.uniform3f(Wv.fogColor,Zv.color.r,Zv.color.g,Zv.color.b),Zv.isFog?(Rv.uniform1f(Wv.fogNear,Zv.near),Rv.uniform1f(Wv.fogFar,Zv.far),Rv.uniform1i(Wv.fogType,1),Xv=1,qv=1):Zv.isFogExp2&&(Rv.uniform1f(Wv.fogDensity,Zv.density),Rv.uniform1i(Wv.fogType,2),Xv=2,qv=2)):(Rv.uniform1i(Wv.fogType,0),Xv=0,qv=0);for(var Jv=0,Kv=kv.length;Jv<Kv;Jv++)(eL=kv[Jv]).modelViewMatrix.multiplyMatrices(Yv.matrixWorldInverse,eL.matrixWorld),eL.z=-eL.modelViewMatrix.elements[14];kv.sort(Dv);var Qv=[],$v=[];for(Jv=0,Kv=kv.length;Jv<Kv;Jv++){var tL=(eL=kv[Jv]).material,eL;if(!1!==tL.visible){eL.onBeforeRender(wv,jv,Yv,void 0,tL,void 0),Rv.uniform1f(Wv.alphaTest,tL.alphaTest),Rv.uniformMatrix4fv(Wv.modelViewMatrix,!1,eL.modelViewMatrix.elements),eL.matrixWorld.decompose(Hv,Gv,Vv),Qv[0]=Vv.x,Qv[1]=Vv.y,$v[0]=eL.center.x-.5,$v[1]=eL.center.y-.5;var aL=0;jv.fog&&tL.fog&&(aL=qv),Xv!=aL&&(Rv.uniform1i(Wv.fogType,aL),Xv=aL),null===tL.map?(Rv.uniform2f(Wv.uvOffset,0,0),Rv.uniform2f(Wv.uvScale,1,1)):(Rv.uniform2f(Wv.uvOffset,tL.map.offset.x,tL.map.offset.y),Rv.uniform2f(Wv.uvScale,tL.map.repeat.x,tL.map.repeat.y)),Rv.uniform1f(Wv.opacity,tL.opacity),Rv.uniform3f(Wv.color,tL.color.r,tL.color.g,tL.color.b),Rv.uniform1f(Wv.rotation,tL.rotation),Rv.uniform2fv(Wv.center,$v),Rv.uniform2fv(Wv.scale,Qv),Pv.setBlending(tL.blending,tL.blendEquation,tL.blendSrc,tL.blendDst,tL.blendEquationAlpha,tL.blendSrcAlpha,tL.blendDstAlpha,tL.premultipliedAlpha),Pv.buffers.depth.setTest(tL.depthTest),Pv.buffers.depth.setMask(tL.depthWrite),Pv.buffers.color.setMask(tL.colorWrite),Cv.setTexture2D(tL.map||zv,0),Rv.drawElements(Rv.TRIANGLES,6,Rv.UNSIGNED_SHORT,0),eL.onAfterRender(wv,jv,Yv,void 0,tL,void 0)}}Pv.enable(Rv.CULL_FACE),Pv.reset()}}}(Kx,Ix,Bx,Nx,Fx),Kx.info.programs=Gx.programs,Kx.context=Ix,Kx.capabilities=Fx,Kx.extensions=Dx,Kx.properties=Ux,Kx.renderLists=Vx,Kx.state=Bx}function dx(wv){wv.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),Qx=!0}function lx(){console.log("THREE.WebGLRenderer: Context Restored."),Qx=!1,sx()}function px(wv){var Rv=wv.target;Rv.removeEventListener("dispose",px),function(Pv){cx(Pv),Ux.remove(Pv)}(Rv)}function cx(wv){var Rv=Ux.get(wv).program;wv.program=void 0,void 0!==Rv&&Gx.releaseProgram(Rv)}function mx(){Tv=!1}function ux(){var wv=Ev.getDevice();wv&&wv.isPresenting?wv.requestAnimationFrame(gx):window.requestAnimationFrame(gx)}function gx(wv){!1!=Tv&&(Mv(wv),ux())}function hx(wv,Rv,Pv,Cv){for(var Ov=0,Iv=wv.length;Ov<Iv;Ov++){var Dv=wv[Ov],Fv=Dv.object,Bv=Dv.geometry,Uv=void 0===Cv?Dv.material:Cv,Nv=Dv.group;if(Pv.isArrayCamera){ov=Pv;for(var Wv=Pv.cameras,zv=0,Hv=Wv.length,Gv;zv<Hv;zv++)if(Gv=Wv[zv],Fv.layers.test(Gv.layers)){var Vv=Gv.bounds,kv=Vv.x*lv,jv=Vv.y*pv,Yv=Vv.z*lv,Xv=Vv.w*pv;Bx.viewport(iv.set(kv,jv,Yv,Xv).multiplyScalar(cv)),fx(Fv,Rv,Gv,Bv,Uv,Nv)}}else ov=null,fx(Fv,Rv,Pv,Bv,Uv,Nv)}}function fx(wv,Rv,Pv,Cv,Ov,Iv){if(wv.onBeforeRender(Kx,Rv,Pv,Cv,Ov,Iv),Ox=kx.get(Rv,ov||Pv),wv.modelViewMatrix.multiplyMatrices(Pv.matrixWorldInverse,wv.matrixWorld),wv.normalMatrix.getNormalMatrix(wv.modelViewMatrix),wv.isImmediateRenderObject){var Dv=wv.isMesh&&0>wv.matrixWorld.determinant();Bx.setMaterial(Ov,Dv);var Fv=xx(Pv,Rv.fog,Ov,wv);av="",function(Bv,Uv,Nv){Bv.render(function(Wv){Kx.renderBufferImmediate(Wv,Uv,Nv)})}(wv,Fv,Ov)}else Kx.renderBufferDirect(Pv,Rv.fog,Cv,Ov,wv,Iv);wv.onAfterRender(Kx,Rv,Pv,Cv,Ov,Iv),Ox=kx.get(Rv,ov||Pv)}function yx(wv,Rv,Pv){var Cv=Ux.get(wv),Ov=Ox.state.lights,Iv=Ox.state.shadowsArray,Dv=Gx.getParameters(wv,Ov.state,Iv,Rv,fv.numPlanes,fv.numIntersection,Pv),Fv=Gx.getProgramCode(wv,Dv),Bv=Cv.program,Uv=!0;if(void 0===Bv)wv.addEventListener("dispose",px);else if(Bv.code!==Fv)cx(wv);else if(Cv.lightsHash!==Ov.state.hash)Ux.update(wv,"lightsHash",Ov.state.hash),Uv=!1;else{if(void 0!==Dv.shaderID)return;Uv=!1}if(Uv){if(Dv.shaderID){var Nv=Ty[Dv.shaderID];Cv.shader={name:wv.type,uniforms:Ey.clone(Nv.uniforms),vertexShader:Nv.vertexShader,fragmentShader:Nv.fragmentShader}}else Cv.shader={name:wv.type,uniforms:wv.uniforms,vertexShader:wv.vertexShader,fragmentShader:wv.fragmentShader};wv.onBeforeCompile(Cv.shader),Bv=Gx.acquireProgram(wv,Cv.shader,Dv,Fv),Cv.program=Bv,wv.program=Bv}var Wv=Bv.getAttributes();if(wv.morphTargets){wv.numSupportedMorphTargets=0;for(var zv=0;zv<Kx.maxMorphTargets;zv++)0<=Wv["morphTarget"+zv]&&wv.numSupportedMorphTargets++}if(wv.morphNormals)for(wv.numSupportedMorphNormals=0,zv=0;zv<Kx.maxMorphNormals;zv++)0<=Wv["morphNormal"+zv]&&wv.numSupportedMorphNormals++;var Hv=Cv.shader.uniforms;(wv.isShaderMaterial||wv.isRawShaderMaterial)&&!0!==wv.clipping||(Cv.numClippingPlanes=fv.numPlanes,Cv.numIntersection=fv.numIntersection,Hv.clippingPlanes=fv.uniform),Cv.fog=Rv,Cv.lightsHash=Ov.state.hash,wv.lights&&(Hv.ambientLightColor.value=Ov.state.ambient,Hv.directionalLights.value=Ov.state.directional,Hv.spotLights.value=Ov.state.spot,Hv.rectAreaLights.value=Ov.state.rectArea,Hv.pointLights.value=Ov.state.point,Hv.hemisphereLights.value=Ov.state.hemi,Hv.directionalShadowMap.value=Ov.state.directionalShadowMap,Hv.directionalShadowMatrix.value=Ov.state.directionalShadowMatrix,Hv.spotShadowMap.value=Ov.state.spotShadowMap,Hv.spotShadowMatrix.value=Ov.state.spotShadowMatrix,Hv.pointShadowMap.value=Ov.state.pointShadowMap,Hv.pointShadowMatrix.value=Ov.state.pointShadowMatrix);var Gv=Cv.program.getUniforms(),Vv=Yd.seqWithValue(Gv.seq,Hv);Cv.uniformsList=Vv}function xx(wv,Rv,Pv,Cv){dv=0;var Ov=Ux.get(Pv),Iv=Ox.state.lights;if(yv&&(xv||wv!==rv)){var Dv=wv===rv&&Pv.id===tv;fv.setState(Pv.clippingPlanes,Pv.clipIntersection,Pv.clipShadows,wv,Ov,Dv)}!1===Pv.needsUpdate&&(void 0===Ov.program?Pv.needsUpdate=!0:Pv.fog&&Ov.fog!==Rv?Pv.needsUpdate=!0:Pv.lights&&Ov.lightsHash!==Iv.state.hash?Pv.needsUpdate=!0:void 0===Ov.numClippingPlanes||Ov.numClippingPlanes===fv.numPlanes&&Ov.numIntersection===fv.numIntersection||(Pv.needsUpdate=!0)),Pv.needsUpdate&&(yx(Pv,Rv,Cv),Pv.needsUpdate=!1);var Fv=!1,Bv=!1,Uv=!1,Nv=Ov.program,Wv=Nv.getUniforms(),zv=Ov.shader.uniforms;if(Bx.useProgram(Nv.program)&&(Fv=!0,Bv=!0,Uv=!0),Pv.id!==tv&&(tv=Pv.id,Bv=!0),Fv||wv!==rv){if(Wv.setValue(Ix,"projectionMatrix",wv.projectionMatrix),Fx.logarithmicDepthBuffer&&Wv.setValue(Ix,"logDepthBufFC",2/(Math.log(wv.far+1)/Math.LN2)),rv!==(ov||wv)&&(rv=ov||wv,Bv=!0,Uv=!0),Pv.isShaderMaterial||Pv.isMeshPhongMaterial||Pv.isMeshStandardMaterial||Pv.envMap){var Hv=Wv.map.cameraPosition;void 0!==Hv&&Hv.setValue(Ix,Lv.setFromMatrixPosition(wv.matrixWorld))}(Pv.isMeshPhongMaterial||Pv.isMeshLambertMaterial||Pv.isMeshBasicMaterial||Pv.isMeshStandardMaterial||Pv.isShaderMaterial||Pv.skinning)&&Wv.setValue(Ix,"viewMatrix",wv.matrixWorldInverse)}if(Pv.skinning){Wv.setOptional(Ix,Cv,"bindMatrix"),Wv.setOptional(Ix,Cv,"bindMatrixInverse");var Gv=Cv.skeleton;if(Gv){var Vv=Gv.bones;if(Fx.floatVertexTextures){if(void 0===Gv.boneTexture){var kv=Math.sqrt(4*Vv.length);kv=uy.ceilPowerOfTwo(kv),kv=Math.max(kv,4);var jv=new Float32Array(4*(kv*kv));jv.set(Gv.boneMatrices);var Yv=new ud(jv,kv,kv,ff,df);Yv.needsUpdate=!0,Gv.boneMatrices=jv,Gv.boneTexture=Yv,Gv.boneTextureSize=kv}Wv.setValue(Ix,"boneTexture",Gv.boneTexture),Wv.setValue(Ix,"boneTextureSize",Gv.boneTextureSize)}else Wv.setOptional(Ix,Gv,"boneMatrices")}}return Bv&&(Wv.setValue(Ix,"toneMappingExposure",Kx.toneMappingExposure),Wv.setValue(Ix,"toneMappingWhitePoint",Kx.toneMappingWhitePoint),Pv.lights&&function(Xv,qv){Xv.ambientLightColor.needsUpdate=qv,Xv.directionalLights.needsUpdate=qv,Xv.pointLights.needsUpdate=qv,Xv.spotLights.needsUpdate=qv,Xv.rectAreaLights.needsUpdate=qv,Xv.hemisphereLights.needsUpdate=qv}(zv,Uv),Rv&&Pv.fog&&function(Xv,qv){Xv.fogColor.value=qv.color,qv.isFog?(Xv.fogNear.value=qv.near,Xv.fogFar.value=qv.far):qv.isFogExp2&&(Xv.fogDensity.value=qv.density)}(zv,Rv),Pv.isMeshBasicMaterial?vx(zv,Pv):Pv.isMeshLambertMaterial?(vx(zv,Pv),function(Xv,qv){qv.emissiveMap&&(Xv.emissiveMap.value=qv.emissiveMap)}(zv,Pv)):Pv.isMeshPhongMaterial?(vx(zv,Pv),Pv.isMeshToonMaterial?function(Xv,qv){Lx(Xv,qv),qv.gradientMap&&(Xv.gradientMap.value=qv.gradientMap)}(zv,Pv):Lx(zv,Pv)):Pv.isMeshStandardMaterial?(vx(zv,Pv),Pv.isMeshPhysicalMaterial?function(Xv,qv){Xv.clearCoat.value=qv.clearCoat,Xv.clearCoatRoughness.value=qv.clearCoatRoughness,bx(Xv,qv)}(zv,Pv):bx(zv,Pv)):Pv.isMeshDepthMaterial?(vx(zv,Pv),function(Xv,qv){qv.displacementMap&&(Xv.displacementMap.value=qv.displacementMap,Xv.displacementScale.value=qv.displacementScale,Xv.displacementBias.value=qv.displacementBias)}(zv,Pv)):Pv.isMeshDistanceMaterial?(vx(zv,Pv),function(Xv,qv){qv.displacementMap&&(Xv.displacementMap.value=qv.displacementMap,Xv.displacementScale.value=qv.displacementScale,Xv.displacementBias.value=qv.displacementBias),Xv.referencePosition.value.copy(qv.referencePosition),Xv.nearDistance.value=qv.nearDistance,Xv.farDistance.value=qv.farDistance}(zv,Pv)):Pv.isMeshNormalMaterial?(vx(zv,Pv),function(Xv,qv){qv.bumpMap&&(Xv.bumpMap.value=qv.bumpMap,Xv.bumpScale.value=qv.bumpScale),qv.normalMap&&(Xv.normalMap.value=qv.normalMap,Xv.normalScale.value.copy(qv.normalScale)),qv.displacementMap&&(Xv.displacementMap.value=qv.displacementMap,Xv.displacementScale.value=qv.displacementScale,Xv.displacementBias.value=qv.displacementBias)}(zv,Pv)):Pv.isLineBasicMaterial?(function(Xv,qv){Xv.diffuse.value=qv.color,Xv.opacity.value=qv.opacity}(zv,Pv),Pv.isLineDashedMaterial&&function(Xv,qv){Xv.dashSize.value=qv.dashSize,Xv.totalSize.value=qv.dashSize+qv.gapSize,Xv.scale.value=qv.scale}(zv,Pv)):Pv.isPointsMaterial?function(Xv,qv){if(Xv.diffuse.value=qv.color,Xv.opacity.value=qv.opacity,Xv.size.value=qv.size*cv,Xv.scale.value=.5*pv,Xv.map.value=qv.map,null!==qv.map){if(!0===qv.map.matrixAutoUpdate){var Zv=qv.map.offset,Jv=qv.map.repeat,Kv=qv.map.rotation,Qv=qv.map.center;qv.map.matrix.setUvTransform(Zv.x,Zv.y,Jv.x,Jv.y,Kv,Qv.x,Qv.y)}Xv.uvTransform.value.copy(qv.map.matrix)}}(zv,Pv):Pv.isShadowMaterial&&(zv.color.value=Pv.color,zv.opacity.value=Pv.opacity),void 0!==zv.ltc_1&&(zv.ltc_1.value=Ay.LTC_1),void 0!==zv.ltc_2&&(zv.ltc_2.value=Ay.LTC_2),Yd.upload(Ix,Ov.uniformsList,zv,Kx)),Pv.isShaderMaterial&&!0===Pv.uniformsNeedUpdate&&(Yd.upload(Ix,Ov.uniformsList,zv,Kx),Pv.uniformsNeedUpdate=!1),Wv.setValue(Ix,"modelViewMatrix",Cv.modelViewMatrix),Wv.setValue(Ix,"normalMatrix",Cv.normalMatrix),Wv.setValue(Ix,"modelMatrix",Cv.matrixWorld),Nv}function vx(wv,Rv){var Pv;if(wv.opacity.value=Rv.opacity,Rv.color&&(wv.diffuse.value=Rv.color),Rv.emissive&&wv.emissive.value.copy(Rv.emissive).multiplyScalar(Rv.emissiveIntensity),Rv.map&&(wv.map.value=Rv.map),Rv.alphaMap&&(wv.alphaMap.value=Rv.alphaMap),Rv.specularMap&&(wv.specularMap.value=Rv.specularMap),Rv.envMap&&(wv.envMap.value=Rv.envMap,wv.flipEnvMap.value=Rv.envMap&&Rv.envMap.isCubeTexture?-1:1,wv.reflectivity.value=Rv.reflectivity,wv.refractionRatio.value=Rv.refractionRatio),Rv.lightMap&&(wv.lightMap.value=Rv.lightMap,wv.lightMapIntensity.value=Rv.lightMapIntensity),Rv.aoMap&&(wv.aoMap.value=Rv.aoMap,wv.aoMapIntensity.value=Rv.aoMapIntensity),Rv.map?Pv=Rv.map:Rv.specularMap?Pv=Rv.specularMap:Rv.displacementMap?Pv=Rv.displacementMap:Rv.normalMap?Pv=Rv.normalMap:Rv.bumpMap?Pv=Rv.bumpMap:Rv.roughnessMap?Pv=Rv.roughnessMap:Rv.metalnessMap?Pv=Rv.metalnessMap:Rv.alphaMap?Pv=Rv.alphaMap:Rv.emissiveMap&&(Pv=Rv.emissiveMap),void 0!==Pv){if(Pv.isWebGLRenderTarget&&(Pv=Pv.texture),!0===Pv.matrixAutoUpdate){var Cv=Pv.offset,Ov=Pv.repeat,Iv=Pv.rotation,Dv=Pv.center;Pv.matrix.setUvTransform(Cv.x,Cv.y,Ov.x,Ov.y,Iv,Dv.x,Dv.y)}wv.uvTransform.value.copy(Pv.matrix)}}function Lx(wv,Rv){wv.specular.value=Rv.specular,wv.shininess.value=Math.max(Rv.shininess,1e-4),Rv.emissiveMap&&(wv.emissiveMap.value=Rv.emissiveMap),Rv.bumpMap&&(wv.bumpMap.value=Rv.bumpMap,wv.bumpScale.value=Rv.bumpScale),Rv.normalMap&&(wv.normalMap.value=Rv.normalMap,wv.normalScale.value.copy(Rv.normalScale)),Rv.displacementMap&&(wv.displacementMap.value=Rv.displacementMap,wv.displacementScale.value=Rv.displacementScale,wv.displacementBias.value=Rv.displacementBias)}function bx(wv,Rv){wv.roughness.value=Rv.roughness,wv.metalness.value=Rv.metalness,Rv.roughnessMap&&(wv.roughnessMap.value=Rv.roughnessMap),Rv.metalnessMap&&(wv.metalnessMap.value=Rv.metalnessMap),Rv.emissiveMap&&(wv.emissiveMap.value=Rv.emissiveMap),Rv.bumpMap&&(wv.bumpMap.value=Rv.bumpMap,wv.bumpScale.value=Rv.bumpScale),Rv.normalMap&&(wv.normalMap.value=Rv.normalMap,wv.normalScale.value.copy(Rv.normalScale)),Rv.displacementMap&&(wv.displacementMap.value=Rv.displacementMap,wv.displacementScale.value=Rv.displacementScale,wv.displacementBias.value=Rv.displacementBias),Rv.envMap&&(wv.envMapIntensity.value=Rv.envMapIntensity)}console.log("THREE.WebGLRenderer",Fg);var _x=void 0===(ix=ix||{}).canvas?document.createElementNS("http://www.w3.org/1999/xhtml","canvas"):ix.canvas,Ax=void 0===ix.context?null:ix.context,Ex=void 0!==ix.alpha&&ix.alpha,Sx=void 0===ix.depth||ix.depth,Tx=void 0===ix.stencil||ix.stencil,Mx=void 0!==ix.antialias&&ix.antialias,wx=void 0===ix.premultipliedAlpha||ix.premultipliedAlpha,Rx=void 0!==ix.preserveDrawingBuffer&&ix.preserveDrawingBuffer,Px=void 0===ix.powerPreference?"default":ix.powerPreference,Cx=null,Ox=null;this.domElement=_x,this.context=null,this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.gammaInput=!1,this.gammaOutput=!1,this.physicallyCorrectLights=!1,this.toneMapping=Dh,this.toneMappingExposure=1,this.toneMappingWhitePoint=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var Kx=this,Qx=!1,$x=null,ev=null,tv=-1,av="",rv=null,ov=null,iv=new pd,nv=new pd,sv=null,dv=0,lv=_x.width,pv=_x.height,cv=1,mv=new pd(0,0,lv,pv),uv=new pd(0,0,lv,pv),gv=!1,hv=new tl,fv=new function(){function wv(){Uv.value!==Cv&&(Uv.value=Cv,Uv.needsUpdate=0<Ov),Pv.numPlanes=Ov,Pv.numIntersection=0}function Rv(Nv,Wv,zv,Hv){var Gv=null===Nv?0:Nv.length,Vv=null;if(0!==Gv){if(Vv=Uv.value,!0!==Hv||null===Vv){var kv=zv+4*Gv,jv=Wv.matrixWorldInverse;Bv.getNormalMatrix(jv),(null==Vv||Vv.length<kv)&&(Vv=new Float32Array(kv));for(var Yv=0,Xv=zv;Yv!==Gv;++Yv,Xv+=4)Fv.copy(Nv[Yv]).applyMatrix4(jv,Bv),Fv.normal.toArray(Vv,Xv),Vv[Xv+3]=Fv.constant}Uv.value=Vv,Uv.needsUpdate=!0}return Pv.numPlanes=Gv,Vv}var Pv=this,Cv=null,Ov=0,Iv=!1,Dv=!1,Fv=new el,Bv=new dd,Uv={value:null,needsUpdate:!1};this.uniform=Uv,this.numPlanes=0,this.numIntersection=0,this.init=function(Nv,Wv,zv){var Hv=0!==Nv.length||Wv||0!=Ov||Iv;return Iv=Wv,Cv=Rv(Nv,zv,0),Ov=Nv.length,Hv},this.beginShadows=function(){Dv=!0,Rv(null)},this.endShadows=function(){Dv=!1,wv()},this.setState=function(Nv,Wv,zv,Hv,Gv,Vv){if(!Iv||null===Nv||0===Nv.length||Dv&&!zv)Dv?Rv(null):wv();else{var kv=Dv?0:Ov,jv=4*kv,Yv=Gv.clippingState||null;Uv.value=Yv,Yv=Rv(Nv,Hv,jv,Vv);for(var Xv=0;Xv!==jv;++Xv)Yv[Xv]=Cv[Xv];Gv.clippingState=Yv,this.numIntersection=Wv?this.numPlanes:0,this.numPlanes+=kv}}},yv=!1,xv=!1,vv=new id,Lv=new sd,bv={geometries:0,textures:0},_v={frame:0,calls:0,vertices:0,faces:0,points:0},Ix,Dx,Fx,Bx,Ux,Nx,Wx,zx,Hx,Gx,Vx,kx,jx,Yx,Xx,qx,Zx,Jx;this.info={render:_v,memory:bv,programs:null,autoReset:!0,reset:function(){_v.frame++,_v.calls=0,_v.vertices=0,_v.faces=0,_v.points=0}};try{var Av={alpha:Ex,depth:Sx,stencil:Tx,antialias:Mx,premultipliedAlpha:wx,preserveDrawingBuffer:Rx,powerPreference:Px};if(_x.addEventListener("webglcontextlost",dx,!1),_x.addEventListener("webglcontextrestored",lx,!1),null===(Ix=Ax||_x.getContext("webgl",Av)||_x.getContext("experimental-webgl",Av)))throw null===_x.getContext("webgl")?new Error("Error creating WebGL context."):new Error("Error creating WebGL context with your selected attributes.");void 0===Ix.getShaderPrecisionFormat&&(Ix.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(wv){console.error("THREE.WebGLRenderer: "+wv.message)}sx();var Ev=new ql(Kx);this.vr=Ev;var Sv=new al(Kx,Hx,Fx.maxTextureSize);this.shadowMap=Sv,this.getContext=function(){return Ix},this.getContextAttributes=function(){return Ix.getContextAttributes()},this.forceContextLoss=function(){var wv=Dx.get("WEBGL_lose_context");wv&&wv.loseContext()},this.forceContextRestore=function(){var wv=Dx.get("WEBGL_lose_context");wv&&wv.restoreContext()},this.getPixelRatio=function(){return cv},this.setPixelRatio=function(wv){void 0!==wv&&(cv=wv,this.setSize(lv,pv,!1))},this.getSize=function(){return{width:lv,height:pv}},this.setSize=function(wv,Rv,Pv){var Cv=Ev.getDevice();Cv&&Cv.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(lv=wv,pv=Rv,_x.width=wv*cv,_x.height=Rv*cv,!1!==Pv&&(_x.style.width=wv+"px",_x.style.height=Rv+"px"),this.setViewport(0,0,wv,Rv))},this.getDrawingBufferSize=function(){return{width:lv*cv,height:pv*cv}},this.setDrawingBufferSize=function(wv,Rv,Pv){lv=wv,pv=Rv,cv=Pv,_x.width=wv*Pv,_x.height=Rv*Pv,this.setViewport(0,0,wv,Rv)},this.getCurrentViewport=function(){return iv},this.setViewport=function(wv,Rv,Pv,Cv){mv.set(wv,pv-Rv-Cv,Pv,Cv),Bx.viewport(iv.copy(mv).multiplyScalar(cv))},this.setScissor=function(wv,Rv,Pv,Cv){uv.set(wv,pv-Rv-Cv,Pv,Cv),Bx.scissor(nv.copy(uv).multiplyScalar(cv))},this.setScissorTest=function(wv){Bx.setScissorTest(gv=wv)},this.getClearColor=function(){return jx.getClearColor()},this.setClearColor=function(){jx.setClearColor.apply(jx,arguments)},this.getClearAlpha=function(){return jx.getClearAlpha()},this.setClearAlpha=function(){jx.setClearAlpha.apply(jx,arguments)},this.clear=function(wv,Rv,Pv){var Cv=0;(void 0===wv||wv)&&(Cv|=Ix.COLOR_BUFFER_BIT),(void 0===Rv||Rv)&&(Cv|=Ix.DEPTH_BUFFER_BIT),(void 0===Pv||Pv)&&(Cv|=Ix.STENCIL_BUFFER_BIT),Ix.clear(Cv)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.clearTarget=function(wv,Rv,Pv,Cv){this.setRenderTarget(wv),this.clear(Rv,Pv,Cv)},this.dispose=function(){_x.removeEventListener("webglcontextlost",dx,!1),_x.removeEventListener("webglcontextrestored",lx,!1),Vx.dispose(),kx.dispose(),Ux.dispose(),Hx.dispose(),Ev.dispose(),mx()},this.renderBufferImmediate=function(wv,Rv,Pv){Bx.initAttributes();var Cv=Ux.get(wv);wv.hasPositions&&!Cv.position&&(Cv.position=Ix.createBuffer()),wv.hasNormals&&!Cv.normal&&(Cv.normal=Ix.createBuffer()),wv.hasUvs&&!Cv.uv&&(Cv.uv=Ix.createBuffer()),wv.hasColors&&!Cv.color&&(Cv.color=Ix.createBuffer());var Ov=Rv.getAttributes();if(wv.hasPositions&&(Ix.bindBuffer(Ix.ARRAY_BUFFER,Cv.position),Ix.bufferData(Ix.ARRAY_BUFFER,wv.positionArray,Ix.DYNAMIC_DRAW),Bx.enableAttribute(Ov.position),Ix.vertexAttribPointer(Ov.position,3,Ix.FLOAT,!1,0,0)),wv.hasNormals){if(Ix.bindBuffer(Ix.ARRAY_BUFFER,Cv.normal),!Pv.isMeshPhongMaterial&&!Pv.isMeshStandardMaterial&&!Pv.isMeshNormalMaterial&&!0===Pv.flatShading)for(var Iv=0,Dv=3*wv.count;Iv<Dv;Iv+=9){var Fv=wv.normalArray,Bv=(Fv[Iv+0]+Fv[Iv+3]+Fv[Iv+6])/3,Uv=(Fv[Iv+1]+Fv[Iv+4]+Fv[Iv+7])/3,Nv=(Fv[Iv+2]+Fv[Iv+5]+Fv[Iv+8])/3;Fv[Iv+0]=Bv,Fv[Iv+1]=Uv,Fv[Iv+2]=Nv,Fv[Iv+3]=Bv,Fv[Iv+4]=Uv,Fv[Iv+5]=Nv,Fv[Iv+6]=Bv,Fv[Iv+7]=Uv,Fv[Iv+8]=Nv}Ix.bufferData(Ix.ARRAY_BUFFER,wv.normalArray,Ix.DYNAMIC_DRAW),Bx.enableAttribute(Ov.normal),Ix.vertexAttribPointer(Ov.normal,3,Ix.FLOAT,!1,0,0)}wv.hasUvs&&Pv.map&&(Ix.bindBuffer(Ix.ARRAY_BUFFER,Cv.uv),Ix.bufferData(Ix.ARRAY_BUFFER,wv.uvArray,Ix.DYNAMIC_DRAW),Bx.enableAttribute(Ov.uv),Ix.vertexAttribPointer(Ov.uv,2,Ix.FLOAT,!1,0,0)),wv.hasColors&&Pv.vertexColors!==Kg&&(Ix.bindBuffer(Ix.ARRAY_BUFFER,Cv.color),Ix.bufferData(Ix.ARRAY_BUFFER,wv.colorArray,Ix.DYNAMIC_DRAW),Bx.enableAttribute(Ov.color),Ix.vertexAttribPointer(Ov.color,3,Ix.FLOAT,!1,0,0)),Bx.disableUnusedAttributes(),Ix.drawArrays(Ix.TRIANGLES,0,wv.count),wv.count=0},this.renderBufferDirect=function(wv,Rv,Pv,Cv,Ov,Iv){var Dv=Ov.isMesh&&0>Ov.matrixWorld.determinant();Bx.setMaterial(Cv,Dv);var Fv=xx(wv,Rv,Cv,Ov),Bv=Pv.id+"_"+Fv.id+"_"+(!0===Cv.wireframe),Uv=!1;Bv!=av&&(av=Bv,Uv=!0),Ov.morphTargetInfluences&&(Yx.update(Ov,Pv,Cv,Fv),Uv=!0);var Wv=Pv.index,zv=Pv.attributes.position,Hv=1,Nv;!0===Cv.wireframe&&(Wv=zx.getWireframeAttribute(Pv),Hv=2);var Gv=Xx;null!==Wv&&(Nv=Wx.get(Wv),(Gv=qx).setIndex(Nv)),Uv&&(function(Qv,$v,eL,tL){if(eL&&eL.isInstancedBufferGeometry&&null===Dx.get("ANGLE_instanced_arrays"))console.error("THREE.WebGLRenderer.setupVertexAttributes: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");else{void 0===tL&&(tL=0),Bx.initAttributes();var aL=eL.attributes,rL=$v.getAttributes(),oL=Qv.defaultAttributeValues;for(var iL in rL){var nL=rL[iL];if(0<=nL){var sL=aL[iL];if(void 0!==sL){var dL=sL.normalized,lL=sL.itemSize,pL=Wx.get(sL);if(void 0===pL)continue;var cL=pL.buffer,mL=pL.type,uL=pL.bytesPerElement;if(sL.isInterleavedBufferAttribute){var gL=sL.data,hL=gL.stride,fL=sL.offset;gL&&gL.isInstancedInterleavedBuffer?(Bx.enableAttributeAndDivisor(nL,gL.meshPerAttribute),void 0===eL.maxInstancedCount&&(eL.maxInstancedCount=gL.meshPerAttribute*gL.count)):Bx.enableAttribute(nL),Ix.bindBuffer(Ix.ARRAY_BUFFER,cL),Ix.vertexAttribPointer(nL,lL,mL,dL,hL*uL,(tL*hL+fL)*uL)}else sL.isInstancedBufferAttribute?(Bx.enableAttributeAndDivisor(nL,sL.meshPerAttribute),void 0===eL.maxInstancedCount&&(eL.maxInstancedCount=sL.meshPerAttribute*sL.count)):Bx.enableAttribute(nL),Ix.bindBuffer(Ix.ARRAY_BUFFER,cL),Ix.vertexAttribPointer(nL,lL,mL,dL,0,tL*lL*uL)}else if(void 0!==oL){var yL=oL[iL];if(void 0!==yL)switch(yL.length){case 2:Ix.vertexAttrib2fv(nL,yL);break;case 3:Ix.vertexAttrib3fv(nL,yL);break;case 4:Ix.vertexAttrib4fv(nL,yL);break;default:Ix.vertexAttrib1fv(nL,yL);}}}}Bx.disableUnusedAttributes()}}(Cv,Fv,Pv),null!==Wv&&Ix.bindBuffer(Ix.ELEMENT_ARRAY_BUFFER,Nv.buffer));var Vv=1/0;null===Wv?void 0!==zv&&(Vv=zv.count):Vv=Wv.count;var kv=Pv.drawRange.start*Hv,jv=Pv.drawRange.count*Hv,Yv=null===Iv?0:Iv.start*Hv,Xv=null===Iv?1/0:Iv.count*Hv,qv=Math.max(kv,Yv),Zv=Math.min(Vv,kv+jv,Yv+Xv)-1,Jv=Math.max(0,Zv-qv+1);if(0!==Jv){if(Ov.isMesh){if(!0===Cv.wireframe)Bx.setLineWidth(Cv.wireframeLinewidth*nx()),Gv.setMode(Ix.LINES);else switch(Ov.drawMode){case ey:Gv.setMode(Ix.TRIANGLES);break;case ty:Gv.setMode(Ix.TRIANGLE_STRIP);break;case ay:Gv.setMode(Ix.TRIANGLE_FAN);}}else if(Ov.isLine){var Kv=Cv.linewidth;void 0===Kv&&(Kv=1),Bx.setLineWidth(Kv*nx()),Ov.isLineSegments?Gv.setMode(Ix.LINES):Ov.isLineLoop?Gv.setMode(Ix.LINE_LOOP):Gv.setMode(Ix.LINE_STRIP)}else Ov.isPoints&&Gv.setMode(Ix.POINTS);Pv&&Pv.isInstancedBufferGeometry?0<Pv.maxInstancedCount&&Gv.renderInstances(Pv,qv,Jv):Gv.render(qv,Jv)}},this.compile=function(wv,Rv){(Ox=kx.get(wv,Rv)).init(),wv.traverse(function(Pv){Pv.isLight&&(Ox.pushLight(Pv),Pv.castShadow&&Ox.pushShadow(Pv))}),Ox.setupLights(Rv),wv.traverse(function(Pv){if(Pv.material)if(Array.isArray(Pv.material))for(var Cv=0;Cv<Pv.material.length;Cv++)yx(Pv.material[Cv],wv.fog,Pv);else yx(Pv.material,wv.fog,Pv)})};var Tv=!1,Mv=null;this.animate=function(wv){null===(Mv=wv)?mx():Tv||(ux(),Tv=!0)},this.render=function(wv,Rv,Pv,Cv){if(!(Rv&&Rv.isCamera))console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");else if(!Qx){av="",tv=-1,rv=null,!0===wv.autoUpdate&&wv.updateMatrixWorld(),null===Rv.parent&&Rv.updateMatrixWorld(),Ev.enabled&&(Rv=Ev.getCamera(Rv)),(Ox=kx.get(wv,Rv)).init(),wv.onBeforeRender(Kx,wv,Rv,Pv),vv.multiplyMatrices(Rv.projectionMatrix,Rv.matrixWorldInverse),hv.setFromMatrix(vv),xv=this.localClippingEnabled,yv=fv.init(this.clippingPlanes,xv,Rv),(Cx=Vx.get(wv,Rv)).init(),function Uv(Nv,Wv,zv){if(!1!==Nv.visible){if(Nv.layers.test(Wv.layers))if(Nv.isLight)Ox.pushLight(Nv),Nv.castShadow&&Ox.pushShadow(Nv);else if(Nv.isSprite)Nv.frustumCulled&&!hv.intersectsSprite(Nv)||Ox.pushSprite(Nv);else if(Nv.isImmediateRenderObject)zv&&Lv.setFromMatrixPosition(Nv.matrixWorld).applyMatrix4(vv),Cx.push(Nv,null,Nv.material,Lv.z,null);else if((Nv.isMesh||Nv.isLine||Nv.isPoints)&&(Nv.isSkinnedMesh&&Nv.skeleton.update(),!Nv.frustumCulled||hv.intersectsObject(Nv))){zv&&Lv.setFromMatrixPosition(Nv.matrixWorld).applyMatrix4(vv);var Hv=Hx.update(Nv),Gv=Nv.material;if(Array.isArray(Gv))for(var Vv=Hv.groups,kv=0,jv=Vv.length;kv<jv;kv++){var Yv=Vv[kv],Xv=Gv[Yv.materialIndex];Xv&&Xv.visible&&Cx.push(Nv,Hv,Xv,Lv.z,Yv)}else Gv.visible&&Cx.push(Nv,Hv,Gv,Lv.z,null)}var qv=Nv.children;for(kv=0,jv=qv.length;kv<jv;kv++)Uv(qv[kv],Wv,zv)}}(wv,Rv,Kx.sortObjects),!0===Kx.sortObjects&&Cx.sort(),yv&&fv.beginShadows();var Ov=Ox.state.shadowsArray;Sv.render(Ov,wv,Rv),Ox.setupLights(Rv),yv&&fv.endShadows(),this.info.autoReset&&this.info.reset(),void 0===Pv&&(Pv=null),this.setRenderTarget(Pv),jx.render(Cx,wv,Rv,Cv);var Iv=Cx.opaque,Dv=Cx.transparent;if(wv.overrideMaterial){var Fv=wv.overrideMaterial;Iv.length&&hx(Iv,wv,Rv,Fv),Dv.length&&hx(Dv,wv,Rv,Fv)}else Iv.length&&hx(Iv,wv,Rv),Dv.length&&hx(Dv,wv,Rv);var Bv=Ox.state.spritesArray;Zx.render(Bv,wv,Rv),Pv&&Nx.updateRenderTargetMipmap(Pv),Bx.buffers.depth.setTest(!0),Bx.buffers.depth.setMask(!0),Bx.buffers.color.setMask(!0),Bx.setPolygonOffset(!1),wv.onAfterRender(Kx,wv,Rv),Ev.enabled&&Ev.submitFrame(),Cx=null,Ox=null}},this.allocTextureUnit=function(){var wv=dv;return wv>=Fx.maxTextures&&console.warn("THREE.WebGLRenderer: Trying to use "+wv+" texture units while this GPU supports only "+Fx.maxTextures),dv+=1,wv},this.setTexture2D=function(){var wv=!1;return function(Rv,Pv){Rv&&Rv.isWebGLRenderTarget&&(wv||(console.warn("THREE.WebGLRenderer.setTexture2D: don't use render targets as textures. Use their .texture property instead."),wv=!0),Rv=Rv.texture),Nx.setTexture2D(Rv,Pv)}}(),this.setTexture=function(){var wv=!1;return function(Rv,Pv){wv||(console.warn("THREE.WebGLRenderer: .setTexture is deprecated, use setTexture2D instead."),wv=!0),Nx.setTexture2D(Rv,Pv)}}(),this.setTextureCube=function(){var wv=!1;return function(Rv,Pv){Rv&&Rv.isWebGLRenderTargetCube&&(wv||(console.warn("THREE.WebGLRenderer.setTextureCube: don't use cube render targets as textures. Use their .texture property instead."),wv=!0),Rv=Rv.texture),Rv&&Rv.isCubeTexture||Array.isArray(Rv.image)&&6===Rv.image.length?Nx.setTextureCube(Rv,Pv):Nx.setTextureCubeDynamic(Rv,Pv)}}(),this.getRenderTarget=function(){return $x},this.setRenderTarget=function(wv){$x=wv,wv&&void 0===Ux.get(wv).__webglFramebuffer&&Nx.setupRenderTarget(wv);var Rv=null,Pv=!1;if(wv){var Cv=Ux.get(wv).__webglFramebuffer;wv.isWebGLRenderTargetCube?(Rv=Cv[wv.activeCubeFace],Pv=!0):Rv=Cv,iv.copy(wv.viewport),nv.copy(wv.scissor),sv=wv.scissorTest}else iv.copy(mv).multiplyScalar(cv),nv.copy(uv).multiplyScalar(cv),sv=gv;if(ev!==Rv&&(Ix.bindFramebuffer(Ix.FRAMEBUFFER,Rv),ev=Rv),Bx.viewport(iv),Bx.scissor(nv),Bx.setScissorTest(sv),Pv){var Ov=Ux.get(wv.texture);Ix.framebufferTexture2D(Ix.FRAMEBUFFER,Ix.COLOR_ATTACHMENT0,Ix.TEXTURE_CUBE_MAP_POSITIVE_X+wv.activeCubeFace,Ov.__webglTexture,wv.activeMipMapLevel)}},this.readRenderTargetPixels=function(wv,Rv,Pv,Cv,Ov,Iv){if(wv&&wv.isWebGLRenderTarget){var Dv=Ux.get(wv).__webglFramebuffer;if(Dv){var Fv=!1;Dv!==ev&&(Ix.bindFramebuffer(Ix.FRAMEBUFFER,Dv),Fv=!0);try{var Bv=wv.texture,Uv=Bv.format,Nv=Bv.type;if(Uv!==ff&&Jx.convert(Uv)!==Ix.getParameter(Ix.IMPLEMENTATION_COLOR_READ_FORMAT))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(!(Nv===tf||Jx.convert(Nv)===Ix.getParameter(Ix.IMPLEMENTATION_COLOR_READ_TYPE)||Nv===df&&(Dx.get("OES_texture_float")||Dx.get("WEBGL_color_buffer_float"))||Nv===lf&&Dx.get("EXT_color_buffer_half_float")))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");Ix.checkFramebufferStatus(Ix.FRAMEBUFFER)===Ix.FRAMEBUFFER_COMPLETE?0<=Rv&&Rv<=wv.width-Cv&&0<=Pv&&Pv<=wv.height-Ov&&Ix.readPixels(Rv,Pv,Cv,Ov,Jx.convert(Uv),Jx.convert(Nv),Iv):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{Fv&&Ix.bindFramebuffer(Ix.FRAMEBUFFER,ev)}}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")},this.copyFramebufferToTexture=function(wv,Rv,Pv){var Cv=Rv.image.width,Ov=Rv.image.height,Iv=Jx.convert(Rv.format);this.setTexture2D(Rv,0),Ix.copyTexImage2D(Ix.TEXTURE_2D,Pv||0,Iv,wv.x,wv.y,Cv,Ov,0)}}function Ql(ix,nx){this.name="",this.color=new Xd(ix),this.density=void 0===nx?25e-5:nx}function $l(ix,nx,sx){this.name="",this.color=new Xd(ix),this.near=void 0===nx?1:nx,this.far=void 0===sx?1e3:sx}function ep(){il.call(this),this.type="Scene",this.background=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0}function tp(ix){Zd.call(this),this.type="SpriteMaterial",this.color=new Xd(16777215),this.map=null,this.rotation=0,this.fog=!1,this.lights=!1,this.setValues(ix)}function ap(ix){il.call(this),this.type="Sprite",this.material=void 0===ix?new tp:ix,this.center=new od(.5,.5)}function rp(){il.call(this),this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}})}function op(ix,nx){if(ix=ix||[],this.bones=ix.slice(0),this.boneMatrices=new Float32Array(16*this.bones.length),void 0===nx)this.calculateInverses();else if(this.bones.length===nx.length)this.boneInverses=nx.slice(0);else{console.warn("THREE.Skeleton boneInverses is the wrong length."),this.boneInverses=[];for(var sx=0,dx=this.bones.length;sx<dx;sx++)this.boneInverses.push(new id)}}function ip(){il.call(this),this.type="Bone"}function np(ix,nx){Ol.call(this,ix,nx),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new id,this.bindMatrixInverse=new id;var sx=new op(this.initBones());this.bind(sx,this.matrixWorld),this.normalizeSkinWeights()}function sp(ix){Zd.call(this),this.type="LineBasicMaterial",this.color=new Xd(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.lights=!1,this.setValues(ix)}function dp(ix,nx,sx){return 1===sx?(console.warn("THREE.Line: parameter THREE.LinePieces no longer supported. Created THREE.LineSegments instead."),new lp(ix,nx)):void(il.call(this),this.type="Line",this.geometry=void 0===ix?new _l:ix,this.material=void 0===nx?new sp({color:16777215*Math.random()}):nx)}function lp(ix,nx){dp.call(this,ix,nx),this.type="LineSegments"}function pp(ix,nx){dp.call(this,ix,nx),this.type="LineLoop"}function cp(ix){Zd.call(this),this.type="PointsMaterial",this.color=new Xd(16777215),this.map=null,this.size=1,this.sizeAttenuation=!0,this.lights=!1,this.setValues(ix)}function mp(ix,nx){il.call(this),this.type="Points",this.geometry=void 0===ix?new _l:ix,this.material=void 0===nx?new cp({color:16777215*Math.random()}):nx}function up(){il.call(this),this.type="Group"}function gp(ix,nx,sx,dx,lx,px,cx,mx,ux){ld.call(this,ix,nx,sx,dx,lx,px,cx,mx,ux),this.generateMipmaps=!1}function hp(ix,nx,sx,dx,lx,px,cx,mx,ux,gx,hx,fx){ld.call(this,null,px,cx,mx,ux,gx,dx,lx,hx,fx),this.image={width:nx,height:sx},this.mipmaps=ix,this.flipY=!1,this.generateMipmaps=!1}function fp(ix,nx,sx,dx,lx,px,cx,mx,ux,gx){if((gx=void 0===gx?Lf:gx)!==Lf&&gx!==bf)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===sx&&gx===Lf&&(sx=of),void 0===sx&&gx===bf&&(sx=uf),ld.call(this,null,dx,lx,px,cx,mx,gx,sx,ux),this.image={width:ix,height:nx},this.magFilter=void 0===cx?Zh:cx,this.minFilter=void 0===mx?Zh:mx,this.flipY=!1,this.generateMipmaps=!1}function yp(ix){_l.call(this),this.type="WireframeGeometry";var fx=[],yx=[0,0],xx={},vx=["a","b","c"],nx,sx,dx,lx,px,cx,mx,ux,gx,hx;if(ix&&ix.isGeometry){var Lx=ix.faces;for(nx=0,dx=Lx.length;nx<dx;nx++){var bx=Lx[nx];for(sx=0;3>sx;sx++)mx=bx[vx[sx]],ux=bx[vx[(sx+1)%3]],yx[0]=Math.min(mx,ux),yx[1]=Math.max(mx,ux),void 0===xx[gx=yx[0]+","+yx[1]]&&(xx[gx]={index1:yx[0],index2:yx[1]})}for(gx in xx)cx=xx[gx],hx=ix.vertices[cx.index1],fx.push(hx.x,hx.y,hx.z),hx=ix.vertices[cx.index2],fx.push(hx.x,hx.y,hx.z)}else if(ix&&ix.isBufferGeometry){var _x,Ax,Ex,Sx,Tx,Mx,wx;if(hx=new sd,null!==ix.index){for(_x=ix.attributes.position,Ax=ix.index,0===(Ex=ix.groups).length&&(Ex=[{start:0,count:Ax.count,materialIndex:0}]),lx=0,px=Ex.length;lx<px;++lx)for(nx=Tx=(Sx=Ex[lx]).start,dx=Tx+Sx.count;nx<dx;nx+=3)for(sx=0;3>sx;sx++)mx=Ax.getX(nx+sx),ux=Ax.getX(nx+(sx+1)%3),yx[0]=Math.min(mx,ux),yx[1]=Math.max(mx,ux),void 0===xx[gx=yx[0]+","+yx[1]]&&(xx[gx]={index1:yx[0],index2:yx[1]});for(gx in xx)cx=xx[gx],hx.fromBufferAttribute(_x,cx.index1),fx.push(hx.x,hx.y,hx.z),hx.fromBufferAttribute(_x,cx.index2),fx.push(hx.x,hx.y,hx.z)}else for(nx=0,dx=(_x=ix.attributes.position).count/3;nx<dx;nx++)for(sx=0;3>sx;sx++)Mx=3*nx+sx,hx.fromBufferAttribute(_x,Mx),fx.push(hx.x,hx.y,hx.z),wx=3*nx+(sx+1)%3,hx.fromBufferAttribute(_x,wx),fx.push(hx.x,hx.y,hx.z)}this.addAttribute("position",new xl(fx,3))}function xp(ix,nx,sx){ll.call(this),this.type="ParametricGeometry",this.parameters={func:ix,slices:nx,stacks:sx},this.fromBufferGeometry(new vp(ix,nx,sx)),this.mergeVertices()}function vp(ix,nx,sx){_l.call(this),this.type="ParametricBufferGeometry",this.parameters={func:ix,slices:nx,stacks:sx};var px=[],cx=[],mx=[],ux=[],gx=new sd,hx=new sd,fx=new sd,yx=new sd,xx=new sd,vx=nx+1,dx,lx;for(dx=0;dx<=sx;dx++){var Lx=dx/sx;for(lx=0;lx<=nx;lx++){var bx=lx/nx;hx=ix(bx,Lx,hx),cx.push(hx.x,hx.y,hx.z),0<=bx-1e-5?(fx=ix(bx-1e-5,Lx,fx),yx.subVectors(hx,fx)):(fx=ix(bx+1e-5,Lx,fx),yx.subVectors(fx,hx)),0<=Lx-1e-5?(fx=ix(bx,Lx-1e-5,fx),xx.subVectors(hx,fx)):(fx=ix(bx,Lx+1e-5,fx),xx.subVectors(fx,hx)),gx.crossVectors(yx,xx).normalize(),mx.push(gx.x,gx.y,gx.z),ux.push(bx,Lx)}}for(dx=0;dx<sx;dx++)for(lx=0;lx<nx;lx++){var _x=dx*vx+lx,Ax=dx*vx+lx+1,Ex=(dx+1)*vx+lx+1,Sx=(dx+1)*vx+lx;px.push(_x,Ax,Sx),px.push(Ax,Ex,Sx)}this.setIndex(px),this.addAttribute("position",new xl(cx,3)),this.addAttribute("normal",new xl(mx,3)),this.addAttribute("uv",new xl(ux,2))}function Lp(ix,nx,sx,dx){ll.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:ix,indices:nx,radius:sx,detail:dx},this.fromBufferGeometry(new bp(ix,nx,sx,dx)),this.mergeVertices()}function bp(ix,nx,sx,dx){function lx(yx,xx,vx,Lx){var Ax=Math.pow(2,Lx),Ex=[],bx,_x;for(bx=0;bx<=Ax;bx++){Ex[bx]=[];var Sx=yx.clone().lerp(vx,bx/Ax),Tx=xx.clone().lerp(vx,bx/Ax),Mx=Ax-bx;for(_x=0;_x<=Mx;_x++)Ex[bx][_x]=0===_x&&bx===Ax?Sx:Sx.clone().lerp(Tx,_x/Mx)}for(bx=0;bx<Ax;bx++)for(_x=0;_x<2*(Ax-bx)-1;_x++){var wx=Math.floor(_x/2);0==_x%2?(px(Ex[bx][wx+1]),px(Ex[bx+1][wx]),px(Ex[bx][wx])):(px(Ex[bx][wx+1]),px(Ex[bx+1][wx+1]),px(Ex[bx+1][wx]))}}function px(yx){hx.push(yx.x,yx.y,yx.z)}function cx(yx,xx){var vx=3*yx;xx.x=ix[vx+0],xx.y=ix[vx+1],xx.z=ix[vx+2]}function mx(yx,xx,vx,Lx){0>Lx&&1===yx.x&&(fx[xx]=yx.x-1),0===vx.x&&0===vx.z&&(fx[xx]=Lx/2/Math.PI+.5)}function ux(yx){return Math.atan2(yx.z,-yx.x)}function gx(yx){return Math.atan2(-yx.y,Math.sqrt(yx.x*yx.x+yx.z*yx.z))}_l.call(this),this.type="PolyhedronBufferGeometry",this.parameters={vertices:ix,indices:nx,radius:sx,detail:dx},sx=sx||1;var hx=[],fx=[];!function(yx){for(var xx=new sd,vx=new sd,Lx=new sd,bx=0;bx<nx.length;bx+=3)cx(nx[bx+0],xx),cx(nx[bx+1],vx),cx(nx[bx+2],Lx),lx(xx,vx,Lx,yx)}(dx=dx||0),function(yx){for(var xx=new sd,vx=0;vx<hx.length;vx+=3)xx.x=hx[vx+0],xx.y=hx[vx+1],xx.z=hx[vx+2],xx.normalize().multiplyScalar(yx),hx[vx+0]=xx.x,hx[vx+1]=xx.y,hx[vx+2]=xx.z}(sx),function(){for(var yx=new sd,xx=0;xx<hx.length;xx+=3){yx.x=hx[xx+0],yx.y=hx[xx+1],yx.z=hx[xx+2];var vx=ux(yx)/2/Math.PI+.5,Lx=gx(yx)/Math.PI+.5;fx.push(vx,1-Lx)}(function(){for(var bx=new sd,_x=new sd,Ax=new sd,Ex=new sd,Sx=new od,Tx=new od,Mx=new od,wx=0,Rx=0;wx<hx.length;wx+=9,Rx+=6){bx.set(hx[wx+0],hx[wx+1],hx[wx+2]),_x.set(hx[wx+3],hx[wx+4],hx[wx+5]),Ax.set(hx[wx+6],hx[wx+7],hx[wx+8]),Sx.set(fx[Rx+0],fx[Rx+1]),Tx.set(fx[Rx+2],fx[Rx+3]),Mx.set(fx[Rx+4],fx[Rx+5]),Ex.copy(bx).add(_x).add(Ax).divideScalar(3);var Px=ux(Ex);mx(Sx,Rx+0,bx,Px),mx(Tx,Rx+2,_x,Px),mx(Mx,Rx+4,Ax,Px)}})(),function(){for(var bx=0;bx<fx.length;bx+=6){var _x=fx[bx+0],Ax=fx[bx+2],Ex=fx[bx+4],Sx=Math.max(_x,Ax,Ex),Tx=Math.min(_x,Ax,Ex);.9<Sx&&.1>Tx&&(.2>_x&&(fx[bx+0]+=1),.2>Ax&&(fx[bx+2]+=1),.2>Ex&&(fx[bx+4]+=1))}}()}(),this.addAttribute("position",new xl(hx,3)),this.addAttribute("normal",new xl(hx.slice(),3)),this.addAttribute("uv",new xl(fx,2)),0===dx?this.computeVertexNormals():this.normalizeNormals()}function _p(ix,nx){ll.call(this),this.type="TetrahedronGeometry",this.parameters={radius:ix,detail:nx},this.fromBufferGeometry(new Ap(ix,nx)),this.mergeVertices()}function Ap(ix,nx){bp.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],ix,nx),this.type="TetrahedronBufferGeometry",this.parameters={radius:ix,detail:nx}}function Ep(ix,nx){ll.call(this),this.type="OctahedronGeometry",this.parameters={radius:ix,detail:nx},this.fromBufferGeometry(new Sp(ix,nx)),this.mergeVertices()}function Sp(ix,nx){bp.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],ix,nx),this.type="OctahedronBufferGeometry",this.parameters={radius:ix,detail:nx}}function Tp(ix,nx){ll.call(this),this.type="IcosahedronGeometry",this.parameters={radius:ix,detail:nx},this.fromBufferGeometry(new Mp(ix,nx)),this.mergeVertices()}function Mp(ix,nx){var sx=(1+Math.sqrt(5))/2;bp.call(this,[-1,sx,0,1,sx,0,-1,-sx,0,1,-sx,0,0,-1,sx,0,1,sx,0,-1,-sx,0,1,-sx,sx,0,-1,sx,0,1,-sx,0,-1,-sx,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],ix,nx),this.type="IcosahedronBufferGeometry",this.parameters={radius:ix,detail:nx}}function wp(ix,nx){ll.call(this),this.type="DodecahedronGeometry",this.parameters={radius:ix,detail:nx},this.fromBufferGeometry(new Rp(ix,nx)),this.mergeVertices()}function Rp(ix,nx){var sx=(1+Math.sqrt(5))/2,dx=1/sx;bp.call(this,[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-dx,-sx,0,-dx,sx,0,dx,-sx,0,dx,sx,-dx,-sx,0,-dx,sx,0,dx,-sx,0,dx,sx,0,-sx,0,-dx,sx,0,-dx,-sx,0,dx,sx,0,dx],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],ix,nx),this.type="DodecahedronBufferGeometry",this.parameters={radius:ix,detail:nx}}function Pp(ix,nx,sx,dx,lx,px){ll.call(this),this.type="TubeGeometry",this.parameters={path:ix,tubularSegments:nx,radius:sx,radialSegments:dx,closed:lx},void 0!==px&&console.warn("THREE.TubeGeometry: taper has been removed.");var cx=new Cp(ix,nx,sx,dx,lx);this.tangents=cx.tangents,this.normals=cx.normals,this.binormals=cx.binormals,this.fromBufferGeometry(cx),this.mergeVertices()}function Cp(ix,nx,sx,dx,lx){function px(_x){yx=ix.getPointAt(_x/nx,yx);var Ax=cx.normals[_x],Ex=cx.binormals[_x];for(ux=0;ux<=dx;ux++){var Sx=2*(ux/dx*Math.PI),Tx=Math.sin(Sx),Mx=-Math.cos(Sx);hx.x=Mx*Ax.x+Tx*Ex.x,hx.y=Mx*Ax.y+Tx*Ex.y,hx.z=Mx*Ax.z+Tx*Ex.z,hx.normalize(),vx.push(hx.x,hx.y,hx.z),gx.x=yx.x+sx*hx.x,gx.y=yx.y+sx*hx.y,gx.z=yx.z+sx*hx.z,xx.push(gx.x,gx.y,gx.z)}}_l.call(this),this.type="TubeBufferGeometry",this.parameters={path:ix,tubularSegments:nx,radius:sx,radialSegments:dx,closed:lx},nx=nx||64,sx=sx||1,dx=dx||8,lx=lx||!1;var cx=ix.computeFrenetFrames(nx,lx);this.tangents=cx.tangents,this.normals=cx.normals,this.binormals=cx.binormals;var gx=new sd,hx=new sd,fx=new od,yx=new sd,xx=[],vx=[],Lx=[],bx=[],mx,ux;!function(){for(mx=0;mx<nx;mx++)px(mx);px(!1===lx?nx:0),function(){for(mx=0;mx<=nx;mx++)for(ux=0;ux<=dx;ux++)fx.x=mx/nx,fx.y=ux/dx,Lx.push(fx.x,fx.y)}(),function(){for(ux=1;ux<=nx;ux++)for(mx=1;mx<=dx;mx++){var _x=(dx+1)*(ux-1)+(mx-1),Ax=(dx+1)*ux+(mx-1),Ex=(dx+1)*ux+mx,Sx=(dx+1)*(ux-1)+mx;bx.push(_x,Ax,Sx),bx.push(Ax,Ex,Sx)}}()}(),this.setIndex(bx),this.addAttribute("position",new xl(xx,3)),this.addAttribute("normal",new xl(vx,3)),this.addAttribute("uv",new xl(Lx,2))}function Op(ix,nx,sx,dx,lx,px,cx){ll.call(this),this.type="TorusKnotGeometry",this.parameters={radius:ix,tube:nx,tubularSegments:sx,radialSegments:dx,p:lx,q:px},void 0!==cx&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),this.fromBufferGeometry(new Ip(ix,nx,sx,dx,lx,px)),this.mergeVertices()}function Ip(ix,nx,sx,dx,lx,px){function cx(Ix,Dx,Fx,Bx,Ux){var Nx=Math.cos(Ix),Wx=Math.sin(Ix),zx=Fx/Dx*Ix,Hx=Math.cos(zx);Ux.x=.5*(Bx*(2+Hx))*Nx,Ux.y=.5*(Bx*(2+Hx)*Wx),Ux.z=.5*(Bx*Math.sin(zx))}_l.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:ix,tube:nx,tubularSegments:sx,radialSegments:dx,p:lx,q:px},ix=ix||1,nx=nx||.4,sx=Math.floor(sx)||64,dx=Math.floor(dx)||8,lx=lx||2,px=px||3;var gx=[],hx=[],fx=[],yx=[],xx=new sd,vx=new sd,Lx=new sd,bx=new sd,_x=new sd,Ax=new sd,Ex=new sd,mx,ux;for(mx=0;mx<=sx;++mx){var Sx=2*(mx/sx*lx*Math.PI);for(cx(Sx,lx,px,ix,Lx),cx(Sx+.01,lx,px,ix,bx),Ax.subVectors(bx,Lx),Ex.addVectors(bx,Lx),_x.crossVectors(Ax,Ex),Ex.crossVectors(_x,Ax),_x.normalize(),Ex.normalize(),ux=0;ux<=dx;++ux){var Tx=2*(ux/dx*Math.PI),Mx=-nx*Math.cos(Tx),wx=nx*Math.sin(Tx);xx.x=Lx.x+(Mx*Ex.x+wx*_x.x),xx.y=Lx.y+(Mx*Ex.y+wx*_x.y),xx.z=Lx.z+(Mx*Ex.z+wx*_x.z),hx.push(xx.x,xx.y,xx.z),vx.subVectors(xx,Lx).normalize(),fx.push(vx.x,vx.y,vx.z),yx.push(mx/sx),yx.push(ux/dx)}}for(ux=1;ux<=sx;ux++)for(mx=1;mx<=dx;mx++){var Rx=(dx+1)*(ux-1)+(mx-1),Px=(dx+1)*ux+(mx-1),Cx=(dx+1)*ux+mx,Ox=(dx+1)*(ux-1)+mx;gx.push(Rx,Px,Ox),gx.push(Px,Cx,Ox)}this.setIndex(gx),this.addAttribute("position",new xl(hx,3)),this.addAttribute("normal",new xl(fx,3)),this.addAttribute("uv",new xl(yx,2))}function Dp(ix,nx,sx,dx,lx){ll.call(this),this.type="TorusGeometry",this.parameters={radius:ix,tube:nx,radialSegments:sx,tubularSegments:dx,arc:lx},this.fromBufferGeometry(new Fp(ix,nx,sx,dx,lx)),this.mergeVertices()}function Fp(ix,nx,sx,dx,lx){_l.call(this),this.type="TorusBufferGeometry",this.parameters={radius:ix,tube:nx,radialSegments:sx,tubularSegments:dx,arc:lx},ix=ix||1,nx=nx||.4,sx=Math.floor(sx)||8,dx=Math.floor(dx)||6,lx=lx||2*Math.PI;var mx=[],ux=[],gx=[],hx=[],fx=new sd,yx=new sd,xx=new sd,px,cx;for(px=0;px<=sx;px++)for(cx=0;cx<=dx;cx++){var vx=cx/dx*lx,Lx=2*(px/sx*Math.PI);yx.x=(ix+nx*Math.cos(Lx))*Math.cos(vx),yx.y=(ix+nx*Math.cos(Lx))*Math.sin(vx),yx.z=nx*Math.sin(Lx),ux.push(yx.x,yx.y,yx.z),fx.x=ix*Math.cos(vx),fx.y=ix*Math.sin(vx),xx.subVectors(yx,fx).normalize(),gx.push(xx.x,xx.y,xx.z),hx.push(cx/dx),hx.push(px/sx)}for(px=1;px<=sx;px++)for(cx=1;cx<=dx;cx++){var bx=(dx+1)*px+cx-1,_x=(dx+1)*(px-1)+cx-1,Ax=(dx+1)*(px-1)+cx,Ex=(dx+1)*px+cx;mx.push(bx,_x,Ex),mx.push(_x,Ax,Ex)}this.setIndex(mx),this.addAttribute("position",new xl(ux,3)),this.addAttribute("normal",new xl(gx,3)),this.addAttribute("uv",new xl(hx,2))}function Bp(ix,nx,sx,dx,lx){var px,cx;if(lx===0<function(mx,ux,gx,hx){for(var fx=0,yx=ux,xx=gx-hx;yx<gx;yx+=hx)fx+=(mx[xx]-mx[yx])*(mx[yx+1]+mx[xx+1]),xx=yx;return fx}(ix,nx,sx,dx))for(px=nx;px<sx;px+=dx)cx=Pc(px,ix[px],ix[px+1],cx);else for(px=sx-dx;px>=nx;px-=dx)cx=Pc(px,ix[px],ix[px+1],cx);return cx&&Jp(cx,cx.next)&&(Cc(cx),cx=cx.next),cx}function Up(ix,nx){if(!ix)return ix;nx||(nx=ix);var dx=ix,sx;do if(sx=!1,dx.steiner||!Jp(dx,dx.next)&&0!==Zp(dx.prev,dx,dx.next))dx=dx.next;else{if(Cc(dx),(dx=nx=dx.prev)===dx.next)break;sx=!0}while(sx||dx!==nx);return nx}function Np(ix,nx,sx,dx,lx,px,cx){if(ix){!cx&&px&&function(hx,fx,yx,xx){var vx=hx;do null===vx.z&&(vx.z=jp(vx.x,vx.y,fx,yx,xx)),vx.prevZ=vx.prev,vx.nextZ=vx.next,vx=vx.next;while(vx!==hx);vx.prevZ.nextZ=null,vx.prevZ=null,function(Lx){var Rx=1,bx,_x,Ax,Ex,Sx,Tx,Mx,wx;do{for(_x=Lx,Lx=null,Sx=null,Tx=0;_x;){for(Tx++,Ax=_x,Mx=0,bx=0;bx<Rx&&(Mx++,Ax=Ax.nextZ);bx++);for(wx=Rx;0<Mx||0<wx&&Ax;)0!==Mx&&(0===wx||!Ax||_x.z<=Ax.z)?(Ex=_x,_x=_x.nextZ,Mx--):(Ex=Ax,Ax=Ax.nextZ,wx--),Sx?Sx.nextZ=Ex:Lx=Ex,Ex.prevZ=Sx,Sx=Ex;_x=Ax}Sx.nextZ=null,Rx*=2}while(1<Tx)}(vx)}(ix,dx,lx,px);for(var gx=ix,mx,ux;ix.prev!==ix.next;)if(mx=ix.prev,ux=ix.next,px?zp(ix,dx,lx,px):Wp(ix))nx.push(mx.i/sx),nx.push(ix.i/sx),nx.push(ux.i/sx),Cc(ix),ix=ux.next,gx=ux.next;else if((ix=ux)===gx){cx?1===cx?Np(ix=Hp(ix,nx,sx),nx,sx,dx,lx,px,2):2==cx&&Gp(ix,nx,sx,dx,lx,px):Np(Up(ix),nx,sx,dx,lx,px,1);break}}}function Wp(ix){var nx=ix.prev,sx=ix,dx=ix.next;if(0<=Zp(nx,sx,dx))return!1;for(var lx=ix.next.next;lx!==ix.prev;){if(Xp(nx.x,nx.y,sx.x,sx.y,dx.x,dx.y,lx.x,lx.y)&&0<=Zp(lx.prev,lx,lx.next))return!1;lx=lx.next}return!0}function zp(ix,nx,sx,dx){var lx=ix.prev,px=ix,cx=ix.next;if(0<=Zp(lx,px,cx))return!1;for(var mx=lx.x<px.x?lx.x<cx.x?lx.x:cx.x:px.x<cx.x?px.x:cx.x,ux=lx.y<px.y?lx.y<cx.y?lx.y:cx.y:px.y<cx.y?px.y:cx.y,gx=lx.x>px.x?lx.x>cx.x?lx.x:cx.x:px.x>cx.x?px.x:cx.x,hx=lx.y>px.y?lx.y>cx.y?lx.y:cx.y:px.y>cx.y?px.y:cx.y,fx=jp(mx,ux,nx,sx,dx),yx=jp(gx,hx,nx,sx,dx),xx=ix.nextZ;xx&&xx.z<=yx;){if(xx!==ix.prev&&xx!==ix.next&&Xp(lx.x,lx.y,px.x,px.y,cx.x,cx.y,xx.x,xx.y)&&0<=Zp(xx.prev,xx,xx.next))return!1;xx=xx.nextZ}for(xx=ix.prevZ;xx&&xx.z>=fx;){if(xx!==ix.prev&&xx!==ix.next&&Xp(lx.x,lx.y,px.x,px.y,cx.x,cx.y,xx.x,xx.y)&&0<=Zp(xx.prev,xx,xx.next))return!1;xx=xx.prevZ}return!0}function Hp(ix,nx,sx){var dx=ix;do{var lx=dx.prev,px=dx.next.next;!Jp(lx,px)&&Kp(lx,dx,dx.next,px)&&Qp(lx,px)&&Qp(px,lx)&&(nx.push(lx.i/sx),nx.push(dx.i/sx),nx.push(px.i/sx),Cc(dx),Cc(dx.next),dx=ix=px),dx=dx.next}while(dx!==ix);return dx}function Gp(ix,nx,sx,dx,lx,px){var cx=ix;do{for(var mx=cx.next.next;mx!==cx.prev;){if(cx.i!==mx.i&&qp(cx,mx)){var ux=$p(cx,mx);return cx=Up(cx,cx.next),ux=Up(ux,ux.next),Np(cx,nx,sx,dx,lx,px),void Np(ux,nx,sx,dx,lx,px)}mx=mx.next}cx=cx.next}while(cx!==ix)}function Vp(ix,nx){return ix.x-nx.x}function kp(ix,nx){if(nx=function(dx,lx){var cx=lx,mx=dx.x,ux=dx.y,gx=-1/0,px;do{if(ux<=cx.y&&ux>=cx.next.y&&cx.next.y!==cx.y){var hx=cx.x+(ux-cx.y)*(cx.next.x-cx.x)/(cx.next.y-cx.y);if(hx<=mx&&hx>gx){if(gx=hx,hx===mx){if(ux===cx.y)return cx;if(ux===cx.next.y)return cx.next}px=cx.x<cx.next.x?cx:cx.next}}cx=cx.next}while(cx!==lx);if(!px)return null;if(mx===gx)return px.prev;var yx=px,xx=px.x,vx=px.y,Lx=1/0,fx;for(cx=px.next;cx!==yx;)mx>=cx.x&&cx.x>=xx&&mx!==cx.x&&Xp(ux<vx?mx:gx,ux,xx,vx,ux<vx?gx:mx,ux,cx.x,cx.y)&&((fx=Math.abs(ux-cx.y)/(mx-cx.x))<Lx||fx===Lx&&cx.x>px.x)&&Qp(cx,dx)&&(px=cx,Lx=fx),cx=cx.next;return px}(ix,nx)){var sx=$p(nx,ix);Up(sx,sx.next)}}function jp(ix,nx,sx,dx,lx){return(ix=1431655765&((ix=858993459&((ix=252645135&((ix=16711935&((ix=32767*(ix-sx)*lx)|ix<<8))|ix<<4))|ix<<2))|ix<<1))|(nx=1431655765&((nx=858993459&((nx=252645135&((nx=16711935&((nx=32767*(nx-dx)*lx)|nx<<8))|nx<<4))|nx<<2))|nx<<1))<<1}function Yp(ix){var nx=ix,sx=ix;do nx.x<sx.x&&(sx=nx),nx=nx.next;while(nx!==ix);return sx}function Xp(ix,nx,sx,dx,lx,px,cx,mx){return 0<=(lx-cx)*(nx-mx)-(ix-cx)*(px-mx)&&0<=(ix-cx)*(dx-mx)-(sx-cx)*(nx-mx)&&0<=(sx-cx)*(px-mx)-(lx-cx)*(dx-mx)}function qp(ix,nx){return ix.next.i!==nx.i&&ix.prev.i!==nx.i&&!function(sx,dx){var lx=sx;do{if(lx.i!==sx.i&&lx.next.i!==sx.i&&lx.i!==dx.i&&lx.next.i!==dx.i&&Kp(lx,lx.next,sx,dx))return!0;lx=lx.next}while(lx!==sx);return!1}(ix,nx)&&Qp(ix,nx)&&Qp(nx,ix)&&function(sx,dx){var lx=sx,px=!1,cx=(sx.x+dx.x)/2,mx=(sx.y+dx.y)/2;do lx.y>mx!=lx.next.y>mx&&lx.next.y!==lx.y&&cx<(lx.next.x-lx.x)*(mx-lx.y)/(lx.next.y-lx.y)+lx.x&&(px=!px),lx=lx.next;while(lx!==sx);return px}(ix,nx)}function Zp(ix,nx,sx){return(nx.y-ix.y)*(sx.x-nx.x)-(nx.x-ix.x)*(sx.y-nx.y)}function Jp(ix,nx){return ix.x===nx.x&&ix.y===nx.y}function Kp(ix,nx,sx,dx){return!!(Jp(ix,nx)&&Jp(sx,dx)||Jp(ix,dx)&&Jp(sx,nx))||0<Zp(ix,nx,sx)!=0<Zp(ix,nx,dx)&&0<Zp(sx,dx,ix)!=0<Zp(sx,dx,nx)}function Qp(ix,nx){return 0>Zp(ix.prev,ix,ix.next)?0<=Zp(ix,nx,ix.next)&&0<=Zp(ix,ix.prev,nx):0>Zp(ix,nx,ix.prev)||0>Zp(ix,ix.next,nx)}function $p(ix,nx){var sx=new Oc(ix.i,ix.x,ix.y),dx=new Oc(nx.i,nx.x,nx.y),lx=ix.next,px=nx.prev;return ix.next=nx,nx.prev=ix,sx.next=lx,lx.prev=sx,dx.next=sx,sx.prev=dx,px.next=dx,dx.prev=px,dx}function Pc(ix,nx,sx,dx){var lx=new Oc(ix,nx,sx);return dx?(lx.next=dx.next,lx.prev=dx,dx.next.prev=lx,dx.next=lx):(lx.prev=lx,lx.next=lx),lx}function Cc(ix){ix.next.prev=ix.prev,ix.prev.next=ix.next,ix.prevZ&&(ix.prevZ.nextZ=ix.nextZ),ix.nextZ&&(ix.nextZ.prevZ=ix.prevZ)}function Oc(ix,nx,sx){this.i=ix,this.x=nx,this.y=sx,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Ic(ix){var nx=ix.length;2<nx&&ix[nx-1].equals(ix[0])&&ix.pop()}function Dc(ix,nx){for(var sx=0;sx<nx.length;sx++)ix.push(nx[sx].x),ix.push(nx[sx].y)}function Fc(ix,nx){ll.call(this),this.type="ExtrudeGeometry",this.parameters={shapes:ix,options:nx},this.fromBufferGeometry(new Bc(ix,nx)),this.mergeVertices()}function Bc(ix,nx){void 0!==ix&&(_l.call(this),this.type="ExtrudeBufferGeometry",ix=Array.isArray(ix)?ix:[ix],this.addShapeList(ix,nx),this.computeVertexNormals())}function Uc(ix,nx){ll.call(this),this.type="TextGeometry",this.parameters={text:ix,parameters:nx},this.fromBufferGeometry(new Nc(ix,nx)),this.mergeVertices()}function Nc(ix,nx){var sx=(nx=nx||{}).font;if(!sx||!sx.isFont)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new ll;var dx=sx.generateShapes(ix,nx.size,nx.curveSegments);nx.amount=void 0===nx.height?50:nx.height,void 0===nx.bevelThickness&&(nx.bevelThickness=10),void 0===nx.bevelSize&&(nx.bevelSize=8),void 0===nx.bevelEnabled&&(nx.bevelEnabled=!1),Bc.call(this,dx,nx),this.type="TextBufferGeometry"}function Wc(ix,nx,sx,dx,lx,px,cx){ll.call(this),this.type="SphereGeometry",this.parameters={radius:ix,widthSegments:nx,heightSegments:sx,phiStart:dx,phiLength:lx,thetaStart:px,thetaLength:cx},this.fromBufferGeometry(new zc(ix,nx,sx,dx,lx,px,cx)),this.mergeVertices()}function zc(ix,nx,sx,dx,lx,px,cx){_l.call(this),this.type="SphereBufferGeometry",this.parameters={radius:ix,widthSegments:nx,heightSegments:sx,phiStart:dx,phiLength:lx,thetaStart:px,thetaLength:cx},ix=ix||1,nx=Math.max(3,Math.floor(nx)||8),sx=Math.max(2,Math.floor(sx)||6),dx=void 0===dx?0:dx,lx=void 0===lx?2*Math.PI:lx;var gx=(px=void 0===px?0:px)+(cx=void 0===cx?Math.PI:cx),hx=0,fx=[],yx=new sd,xx=new sd,vx=[],Lx=[],bx=[],_x=[],mx,ux;for(ux=0;ux<=sx;ux++){var Ax=[],Ex=ux/sx;for(mx=0;mx<=nx;mx++){var Sx=mx/nx;yx.x=-ix*Math.cos(dx+Sx*lx)*Math.sin(px+Ex*cx),yx.y=ix*Math.cos(px+Ex*cx),yx.z=ix*Math.sin(dx+Sx*lx)*Math.sin(px+Ex*cx),Lx.push(yx.x,yx.y,yx.z),xx.set(yx.x,yx.y,yx.z).normalize(),bx.push(xx.x,xx.y,xx.z),_x.push(Sx,1-Ex),Ax.push(hx++)}fx.push(Ax)}for(ux=0;ux<sx;ux++)for(mx=0;mx<nx;mx++){var Tx=fx[ux][mx+1],Mx=fx[ux][mx],wx=fx[ux+1][mx],Rx=fx[ux+1][mx+1];(0!==ux||0<px)&&vx.push(Tx,Mx,Rx),(ux!==sx-1||gx<Math.PI)&&vx.push(Mx,wx,Rx)}this.setIndex(vx),this.addAttribute("position",new xl(Lx,3)),this.addAttribute("normal",new xl(bx,3)),this.addAttribute("uv",new xl(_x,2))}function Hc(ix,nx,sx,dx,lx,px){ll.call(this),this.type="RingGeometry",this.parameters={innerRadius:ix,outerRadius:nx,thetaSegments:sx,phiSegments:dx,thetaStart:lx,thetaLength:px},this.fromBufferGeometry(new Gc(ix,nx,sx,dx,lx,px)),this.mergeVertices()}function Gc(ix,nx,sx,dx,lx,px){_l.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:ix,outerRadius:nx,thetaSegments:sx,phiSegments:dx,thetaStart:lx,thetaLength:px},ix=ix||.5,nx=nx||1,lx=void 0===lx?0:lx,px=void 0===px?2*Math.PI:px,sx=void 0===sx?8:Math.max(3,sx);var gx=[],hx=[],fx=[],yx=[],xx=ix,vx=(nx-ix)/(dx=void 0===dx?1:Math.max(1,dx)),Lx=new sd,bx=new od,cx,mx,ux;for(mx=0;mx<=dx;mx++){for(ux=0;ux<=sx;ux++)cx=lx+ux/sx*px,Lx.x=xx*Math.cos(cx),Lx.y=xx*Math.sin(cx),hx.push(Lx.x,Lx.y,Lx.z),fx.push(0,0,1),bx.x=(Lx.x/nx+1)/2,bx.y=(Lx.y/nx+1)/2,yx.push(bx.x,bx.y);xx+=vx}for(mx=0;mx<dx;mx++){var _x=mx*(sx+1);for(ux=0;ux<sx;ux++){var Ax=cx=ux+_x,Ex=cx+sx+1,Sx=cx+sx+2,Tx=cx+1;gx.push(Ax,Ex,Tx),gx.push(Ex,Sx,Tx)}}this.setIndex(gx),this.addAttribute("position",new xl(hx,3)),this.addAttribute("normal",new xl(fx,3)),this.addAttribute("uv",new xl(yx,2))}function Vc(ix,nx,sx,dx){ll.call(this),this.type="LatheGeometry",this.parameters={points:ix,segments:nx,phiStart:sx,phiLength:dx},this.fromBufferGeometry(new kc(ix,nx,sx,dx)),this.mergeVertices()}function kc(ix,nx,sx,dx){_l.call(this),this.type="LatheBufferGeometry",this.parameters={points:ix,segments:nx,phiStart:sx,phiLength:dx},nx=Math.floor(nx)||12,sx=sx||0,dx=dx||2*Math.PI,dx=uy.clamp(dx,0,2*Math.PI);var mx=[],ux=[],gx=[],hx=1/nx,fx=new sd,yx=new od,lx,px,cx;for(px=0;px<=nx;px++){var xx=sx+px*hx*dx,vx=Math.sin(xx),Lx=Math.cos(xx);for(cx=0;cx<=ix.length-1;cx++)fx.x=ix[cx].x*vx,fx.y=ix[cx].y,fx.z=ix[cx].x*Lx,ux.push(fx.x,fx.y,fx.z),yx.x=px/nx,yx.y=cx/(ix.length-1),gx.push(yx.x,yx.y)}for(px=0;px<nx;px++)for(cx=0;cx<ix.length-1;cx++){var bx=lx=cx+px*ix.length,_x=lx+ix.length,Ax=lx+ix.length+1,Ex=lx+1;mx.push(bx,_x,Ex),mx.push(_x,Ax,Ex)}if(this.setIndex(mx),this.addAttribute("position",new xl(ux,3)),this.addAttribute("uv",new xl(gx,2)),this.computeVertexNormals(),dx===2*Math.PI){var Sx=this.attributes.normal.array,Tx=new sd,Mx=new sd,wx=new sd;for(lx=3*(nx*ix.length),px=0,cx=0;px<ix.length;px++,cx+=3)Tx.x=Sx[cx+0],Tx.y=Sx[cx+1],Tx.z=Sx[cx+2],Mx.x=Sx[lx+cx+0],Mx.y=Sx[lx+cx+1],Mx.z=Sx[lx+cx+2],wx.addVectors(Tx,Mx).normalize(),Sx[cx+0]=Sx[lx+cx+0]=wx.x,Sx[cx+1]=Sx[lx+cx+1]=wx.y,Sx[cx+2]=Sx[lx+cx+2]=wx.z}}function jc(ix,nx){ll.call(this),this.type="ShapeGeometry","object"==typeof nx&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),nx=nx.curveSegments),this.parameters={shapes:ix,curveSegments:nx},this.fromBufferGeometry(new Yc(ix,nx)),this.mergeVertices()}function Yc(ix,nx){function sx(hx){var vx=lx.length/3,Lx=hx.extractPoints(nx),bx=Lx.shape,_x=Lx.holes,fx,yx,xx;if(!1===Iy.isClockWise(bx))for(bx=bx.reverse(),fx=0,yx=_x.length;fx<yx;fx++)xx=_x[fx],!0===Iy.isClockWise(xx)&&(_x[fx]=xx.reverse());var Ax=Iy.triangulateShape(bx,_x);for(fx=0,yx=_x.length;fx<yx;fx++)xx=_x[fx],bx=bx.concat(xx);for(fx=0,yx=bx.length;fx<yx;fx++){var Ex=bx[fx];lx.push(Ex.x,Ex.y,0),px.push(0,0,1),cx.push(Ex.x,Ex.y)}for(fx=0,yx=Ax.length;fx<yx;fx++){var Sx=Ax[fx],Tx=Sx[0]+vx,Mx=Sx[1]+vx,wx=Sx[2]+vx;dx.push(Tx,Mx,wx),ux+=3}}_l.call(this),this.type="ShapeBufferGeometry",this.parameters={shapes:ix,curveSegments:nx},nx=nx||12;var dx=[],lx=[],px=[],cx=[],mx=0,ux=0;if(!1===Array.isArray(ix))sx(ix);else for(var gx=0;gx<ix.length;gx++)sx(ix[gx]),this.addGroup(mx,ux,gx),mx+=ux,ux=0;this.setIndex(dx),this.addAttribute("position",new xl(lx,3)),this.addAttribute("normal",new xl(px,3)),this.addAttribute("uv",new xl(cx,2))}function Xc(ix,nx){if(nx.shapes=[],Array.isArray(ix))for(var sx=0,dx=ix.length,lx;sx<dx;sx++)lx=ix[sx],nx.shapes.push(lx.uuid);else nx.shapes.push(ix.uuid);return nx}function qc(ix,nx){_l.call(this),this.type="EdgesGeometry",this.parameters={thresholdAngle:nx},nx=void 0===nx?1:nx;var cx=[],mx=Math.cos(uy.DEG2RAD*nx),ux=[0,0],gx={},hx=["a","b","c"],sx,dx,lx,px;ix.isBufferGeometry?(px=new ll).fromBufferGeometry(ix):px=ix.clone(),px.mergeVertices(),px.computeFaceNormals();for(var fx=px.vertices,yx=px.faces,xx=0,vx=yx.length;xx<vx;xx++)for(var Lx=yx[xx],bx=0;3>bx;bx++)sx=Lx[hx[bx]],dx=Lx[hx[(bx+1)%3]],ux[0]=Math.min(sx,dx),ux[1]=Math.max(sx,dx),void 0===gx[lx=ux[0]+","+ux[1]]?gx[lx]={index1:ux[0],index2:ux[1],face1:xx,face2:void 0}:gx[lx].face2=xx;for(lx in gx){var _x=gx[lx];if(void 0===_x.face2||yx[_x.face1].normal.dot(yx[_x.face2].normal)<=mx){var Ax=fx[_x.index1];cx.push(Ax.x,Ax.y,Ax.z),Ax=fx[_x.index2],cx.push(Ax.x,Ax.y,Ax.z)}}this.addAttribute("position",new xl(cx,3))}function Zc(ix,nx,sx,dx,lx,px,cx,mx){ll.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:ix,radiusBottom:nx,height:sx,radialSegments:dx,heightSegments:lx,openEnded:px,thetaStart:cx,thetaLength:mx},this.fromBufferGeometry(new Jc(ix,nx,sx,dx,lx,px,cx,mx)),this.mergeVertices()}function Jc(ix,nx,sx,dx,lx,px,cx,mx){function ux(Ax){var Mx=new od,wx=new sd,Rx=0,Px=!0===Ax?ix:nx,Cx=!0===Ax?1:-1,Ex,Sx,Tx;for(Sx=vx,Ex=1;Ex<=dx;Ex++)fx.push(0,bx*Cx,0),yx.push(0,Cx,0),xx.push(.5,.5),vx++;for(Tx=vx,Ex=0;Ex<=dx;Ex++){var Ox=Ex/dx*mx+cx,Ix=Math.cos(Ox),Dx=Math.sin(Ox);wx.x=Px*Dx,wx.y=bx*Cx,wx.z=Px*Ix,fx.push(wx.x,wx.y,wx.z),yx.push(0,Cx,0),Mx.x=.5*Ix+.5,Mx.y=.5*Dx*Cx+.5,xx.push(Mx.x,Mx.y),vx++}for(Ex=0;Ex<dx;Ex++){var Fx=Sx+Ex,Bx=Tx+Ex;!0===Ax?hx.push(Bx,Bx+1,Fx):hx.push(Bx+1,Bx,Fx),Rx+=3}gx.addGroup(_x,Rx,!0===Ax?1:2),_x+=Rx}_l.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:ix,radiusBottom:nx,height:sx,radialSegments:dx,heightSegments:lx,openEnded:px,thetaStart:cx,thetaLength:mx};var gx=this;ix=void 0===ix?1:ix,nx=void 0===nx?1:nx,sx=sx||1,dx=Math.floor(dx)||8,lx=Math.floor(lx)||1,px=void 0!==px&&px,cx=void 0===cx?0:cx,mx=void 0===mx?2*Math.PI:mx;var hx=[],fx=[],yx=[],xx=[],vx=0,Lx=[],bx=sx/2,_x=0;!function(){var Sx=new sd,Tx=new sd,Mx=0,wx=(nx-ix)/sx,Ax,Ex;for(Ex=0;Ex<=lx;Ex++){var Rx=[],Px=Ex/lx,Cx=Px*(nx-ix)+ix;for(Ax=0;Ax<=dx;Ax++){var Ox=Ax/dx,Ix=Ox*mx+cx,Dx=Math.sin(Ix),Fx=Math.cos(Ix);Tx.x=Cx*Dx,Tx.y=-Px*sx+bx,Tx.z=Cx*Fx,fx.push(Tx.x,Tx.y,Tx.z),Sx.set(Dx,wx,Fx).normalize(),yx.push(Sx.x,Sx.y,Sx.z),xx.push(Ox,1-Px),Rx.push(vx++)}Lx.push(Rx)}for(Ax=0;Ax<dx;Ax++)for(Ex=0;Ex<lx;Ex++){var Bx=Lx[Ex][Ax],Ux=Lx[Ex+1][Ax],Nx=Lx[Ex+1][Ax+1],Wx=Lx[Ex][Ax+1];hx.push(Bx,Ux,Wx),hx.push(Ux,Nx,Wx),Mx+=6}gx.addGroup(_x,Mx,0),_x+=Mx}(),!1===px&&(0<ix&&ux(!0),0<nx&&ux(!1)),this.setIndex(hx),this.addAttribute("position",new xl(fx,3)),this.addAttribute("normal",new xl(yx,3)),this.addAttribute("uv",new xl(xx,2))}function Kc(ix,nx,sx,dx,lx,px,cx){Zc.call(this,0,ix,nx,sx,dx,lx,px,cx),this.type="ConeGeometry",this.parameters={radius:ix,height:nx,radialSegments:sx,heightSegments:dx,openEnded:lx,thetaStart:px,thetaLength:cx}}function Qc(ix,nx,sx,dx,lx,px,cx){Jc.call(this,0,ix,nx,sx,dx,lx,px,cx),this.type="ConeBufferGeometry",this.parameters={radius:ix,height:nx,radialSegments:sx,heightSegments:dx,openEnded:lx,thetaStart:px,thetaLength:cx}}function $c(ix,nx,sx,dx){ll.call(this),this.type="CircleGeometry",this.parameters={radius:ix,segments:nx,thetaStart:sx,thetaLength:dx},this.fromBufferGeometry(new em(ix,nx,sx,dx)),this.mergeVertices()}function em(ix,nx,sx,dx){_l.call(this),this.type="CircleBufferGeometry",this.parameters={radius:ix,segments:nx,thetaStart:sx,thetaLength:dx},ix=ix||1,nx=void 0===nx?8:Math.max(3,nx),sx=void 0===sx?0:sx,dx=void 0===dx?2*Math.PI:dx;var cx=[],mx=[],ux=[],gx=[],hx=new sd,fx=new od,lx,px;for(mx.push(0,0,0),ux.push(0,0,1),gx.push(.5,.5),px=0,lx=3;px<=nx;px++,lx+=3){var yx=sx+px/nx*dx;hx.x=ix*Math.cos(yx),hx.y=ix*Math.sin(yx),mx.push(hx.x,hx.y,hx.z),ux.push(0,0,1),fx.x=(mx[lx]/ix+1)/2,fx.y=(mx[lx+1]/ix+1)/2,gx.push(fx.x,fx.y)}for(lx=1;lx<=nx;lx++)cx.push(lx,lx+1,0);this.setIndex(cx),this.addAttribute("position",new xl(mx,3)),this.addAttribute("normal",new xl(ux,3)),this.addAttribute("uv",new xl(gx,2))}function tm(ix){Zd.call(this),this.type="ShadowMaterial",this.color=new Xd(0),this.opacity=1,this.lights=!0,this.transparent=!0,this.setValues(ix)}function am(ix){wl.call(this,ix),this.type="RawShaderMaterial"}function rm(ix){Zd.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Xd(16777215),this.roughness=.5,this.metalness=.5,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Xd(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new od(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(ix)}function om(ix){rm.call(this),this.defines={PHYSICAL:""},this.type="MeshPhysicalMaterial",this.reflectivity=.5,this.clearCoat=0,this.clearCoatRoughness=0,this.setValues(ix)}function im(ix){Zd.call(this),this.type="MeshPhongMaterial",this.color=new Xd(16777215),this.specular=new Xd(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Xd(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new od(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Ph,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(ix)}function nm(ix){im.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.gradientMap=null,this.setValues(ix)}function sm(ix){Zd.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new od(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(ix)}function dm(ix){Zd.call(this),this.type="MeshLambertMaterial",this.color=new Xd(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Xd(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Ph,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(ix)}function lm(ix){sp.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(ix)}function pm(ix,nx,sx){var dx=this,lx=!1,px=0,cx=0,mx;this.onStart=void 0,this.onLoad=ix,this.onProgress=nx,this.onError=sx,this.itemStart=function(ux){cx++,!1==lx&&void 0!==dx.onStart&&dx.onStart(ux,px,cx),lx=!0},this.itemEnd=function(ux){px++,void 0!==dx.onProgress&&dx.onProgress(ux,px,cx),px==cx&&(lx=!1,void 0!==dx.onLoad&&dx.onLoad())},this.itemError=function(ux){void 0!==dx.onError&&dx.onError(ux)},this.resolveURL=function(ux){return mx?mx(ux):ux},this.setURLModifier=function(ux){return mx=ux,this}}function cm(ix){this.manager=void 0===ix?Uy:ix}function mm(ix){this.manager=void 0===ix?Uy:ix,this._parser=null}function um(ix){this.manager=void 0===ix?Uy:ix,this._parser=null}function gm(ix){this.manager=void 0===ix?Uy:ix}function hm(ix){this.manager=void 0===ix?Uy:ix}function fm(ix){this.manager=void 0===ix?Uy:ix}function ym(){this.type="Curve",this.arcLengthDivisions=200}function xm(ix,nx,sx,dx,lx,px,cx,mx){ym.call(this),this.type="EllipseCurve",this.aX=ix||0,this.aY=nx||0,this.xRadius=sx||1,this.yRadius=dx||1,this.aStartAngle=lx||0,this.aEndAngle=px||2*Math.PI,this.aClockwise=cx||!1,this.aRotation=mx||0}function vm(ix,nx,sx,dx,lx,px){xm.call(this,ix,nx,sx,sx,dx,lx,px),this.type="ArcCurve"}function Lm(){function ix(px,cx,mx,ux){nx=px,sx=mx,dx=-3*px+3*cx-2*mx-ux,lx=2*px-2*cx+mx+ux}var nx=0,sx=0,dx=0,lx=0;return{initCatmullRom:function(px,cx,mx,ux,gx){ix(cx,mx,gx*(mx-px),gx*(ux-cx))},initNonuniformCatmullRom:function(px,cx,mx,ux,gx,hx,fx){var yx=(cx-px)/gx-(mx-px)/(gx+hx)+(mx-cx)/hx,xx=(mx-cx)/hx-(ux-cx)/(hx+fx)+(ux-mx)/fx;ix(cx,mx,yx*=hx,xx*=hx)},calc:function(px){var cx=px*px;return nx+sx*px+dx*cx+lx*(cx*px)}}}function bm(ix,nx,sx,dx){ym.call(this),this.type="CatmullRomCurve3",this.points=ix||[],this.closed=nx||!1,this.curveType=sx||"centripetal",this.tension=dx||.5}function _m(ix,nx,sx,dx,lx){var px=.5*(dx-nx),cx=.5*(lx-sx),mx=ix*ix;return(2*sx-2*dx+px+cx)*(ix*mx)+(-3*sx+3*dx-2*px-cx)*mx+px*ix+sx}function Am(ix,nx,sx,dx){return function(lx,px){var cx=1-lx;return cx*cx*px}(ix,nx)+function(lx){return 2*(1-lx)*lx*sx}(ix)+function(lx){return lx*lx*dx}(ix)}function Em(ix,nx,sx,dx,lx){return function(px,cx){var mx=1-px;return mx*mx*mx*cx}(ix,nx)+function(px,cx){var mx=1-px;return 3*mx*mx*px*cx}(ix,sx)+function(px){return 3*(1-px)*px*px*dx}(ix)+function(px){return px*px*px*lx}(ix)}function Sm(ix,nx,sx,dx){ym.call(this),this.type="CubicBezierCurve",this.v0=ix||new od,this.v1=nx||new od,this.v2=sx||new od,this.v3=dx||new od}function Tm(ix,nx,sx,dx){ym.call(this),this.type="CubicBezierCurve3",this.v0=ix||new sd,this.v1=nx||new sd,this.v2=sx||new sd,this.v3=dx||new sd}function Mm(ix,nx){ym.call(this),this.type="LineCurve",this.v1=ix||new od,this.v2=nx||new od}function wm(ix,nx){ym.call(this),this.type="LineCurve3",this.v1=ix||new sd,this.v2=nx||new sd}function Rm(ix,nx,sx){ym.call(this),this.type="QuadraticBezierCurve",this.v0=ix||new od,this.v1=nx||new od,this.v2=sx||new od}function Pm(ix,nx,sx){ym.call(this),this.type="QuadraticBezierCurve3",this.v0=ix||new sd,this.v1=nx||new sd,this.v2=sx||new sd}function Cm(ix){ym.call(this),this.type="SplineCurve",this.points=ix||[]}function Om(){ym.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}function Im(ix){Om.call(this),this.type="Path",this.currentPoint=new od,ix&&this.setFromPoints(ix)}function Dm(ix){Im.call(this,ix),this.uuid=uy.generateUUID(),this.type="Shape",this.holes=[]}function Fm(ix,nx){il.call(this),this.type="Light",this.color=new Xd(ix),this.intensity=void 0===nx?1:nx,this.receiveShadow=void 0}function Bm(ix,nx,sx){Fm.call(this,ix,sx),this.type="HemisphereLight",this.castShadow=void 0,this.position.copy(il.DefaultUp),this.updateMatrix(),this.groundColor=new Xd(nx)}function Um(ix){this.camera=ix,this.bias=0,this.radius=1,this.mapSize=new od(512,512),this.map=null,this.matrix=new id}function Nm(){Um.call(this,new Yl(50,1,.5,500))}function Wm(ix,nx,sx,dx,lx,px){Fm.call(this,ix,nx),this.type="SpotLight",this.position.copy(il.DefaultUp),this.updateMatrix(),this.target=new il,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(cx){this.intensity=cx/Math.PI}}),this.distance=void 0===sx?0:sx,this.angle=void 0===dx?Math.PI/3:dx,this.penumbra=void 0===lx?0:lx,this.decay=void 0===px?1:px,this.shadow=new Nm}function zm(ix,nx,sx,dx){Fm.call(this,ix,nx),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(lx){this.intensity=lx/(4*Math.PI)}}),this.distance=void 0===sx?0:sx,this.decay=void 0===dx?1:dx,this.shadow=new Um(new Yl(90,1,.5,500))}function Hm(){Um.call(this,new sl(-5,5,5,-5,.5,500))}function Gm(ix,nx){Fm.call(this,ix,nx),this.type="DirectionalLight",this.position.copy(il.DefaultUp),this.updateMatrix(),this.target=new il,this.shadow=new Hm}function Vm(ix,nx){Fm.call(this,ix,nx),this.type="AmbientLight",this.castShadow=void 0}function km(ix,nx,sx,dx){Fm.call(this,ix,nx),this.type="RectAreaLight",this.width=void 0===sx?10:sx,this.height=void 0===dx?10:dx}function jm(ix,nx,sx,dx){tu.call(this,ix,nx,sx,dx)}function Ym(ix,nx,sx){tu.call(this,ix,nx,sx)}function Xm(ix,nx,sx,dx){this.parameterPositions=ix,this._cachedIndex=0,this.resultBuffer=void 0===dx?new nx.constructor(sx):dx,this.sampleValues=nx,this.valueSize=sx}function qm(ix,nx,sx,dx){Xm.call(this,ix,nx,sx,dx)}function Zm(ix,nx,sx,dx){tu.call(this,ix,nx,sx,dx)}function Jm(ix,nx,sx,dx){tu.call(this,ix,nx,sx,dx)}function Km(ix,nx,sx,dx){tu.call(this,ix,nx,sx,dx)}function Qm(ix,nx,sx,dx){Xm.call(this,ix,nx,sx,dx),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}function $m(ix,nx,sx,dx){Xm.call(this,ix,nx,sx,dx)}function eu(ix,nx,sx,dx){Xm.call(this,ix,nx,sx,dx)}function tu(ix,nx,sx,dx){if(void 0===ix)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===nx||0===nx.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+ix);this.name=ix,this.times=ky.convertArray(nx,this.TimeBufferType),this.values=ky.convertArray(sx,this.ValueBufferType),this.setInterpolation(dx||this.DefaultInterpolation),this.validate(),this.optimize()}function au(ix,nx,sx,dx){tu.call(this,ix,nx,sx,dx)}function ru(ix,nx,sx){this.name=ix,this.tracks=sx,this.duration=void 0===nx?-1:nx,this.uuid=uy.generateUUID(),0>this.duration&&this.resetDuration(),this.optimize()}function ou(ix){this.manager=void 0===ix?Uy:ix,this.textures={}}function iu(ix){this.manager=void 0===ix?Uy:ix}function nu(){this.onLoadStart=function(){},this.onLoadProgress=function(){},this.onLoadComplete=function(){}}function su(ix){"boolean"==typeof ix&&(console.warn("THREE.JSONLoader: showStatus parameter has been removed from constructor."),ix=void 0),this.manager=void 0===ix?Uy:ix,this.withCredentials=!1}function du(ix){this.manager=void 0===ix?Uy:ix,this.texturePath=""}function lu(ix){"undefined"==typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.manager=void 0===ix?Uy:ix,this.options=void 0}function pu(){this.type="ShapePath",this.subPaths=[],this.currentPath=null}function cu(ix){this.type="Font",this.data=ix}function mu(ix,nx,sx,dx,lx,px){var cx=px.glyphs[ix]||px.glyphs["?"];if(cx){var Lx=new pu,mx,ux,gx,hx,fx,yx,xx,vx;if(cx.o)for(var bx=cx._cachedOutline||(cx._cachedOutline=cx.o.split(" ")),_x=0,Ax=bx.length;_x<Ax;)switch(bx[_x++]){case"m":mx=bx[_x++]*sx+dx,ux=bx[_x++]*sx+lx,Lx.moveTo(mx,ux);break;case"l":mx=bx[_x++]*sx+dx,ux=bx[_x++]*sx+lx,Lx.lineTo(mx,ux);break;case"q":gx=bx[_x++]*sx+dx,hx=bx[_x++]*sx+lx,fx=bx[_x++]*sx+dx,yx=bx[_x++]*sx+lx,Lx.quadraticCurveTo(fx,yx,gx,hx);break;case"b":gx=bx[_x++]*sx+dx,hx=bx[_x++]*sx+lx,fx=bx[_x++]*sx+dx,yx=bx[_x++]*sx+lx,xx=bx[_x++]*sx+dx,vx=bx[_x++]*sx+lx,Lx.bezierCurveTo(fx,yx,xx,vx,gx,hx);}return{offsetX:cx.ha*sx,path:Lx}}}function uu(ix){this.manager=void 0===ix?Uy:ix}function gu(ix){this.manager=void 0===ix?Uy:ix}function hu(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Yl,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Yl,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1}function fu(ix,nx,sx){il.call(this),this.type="CubeCamera";var dx=new Yl(90,1,ix,nx);dx.up.set(0,-1,0),dx.lookAt(new sd(1,0,0)),this.add(dx);var lx=new Yl(90,1,ix,nx);lx.up.set(0,-1,0),lx.lookAt(new sd(-1,0,0)),this.add(lx);var px=new Yl(90,1,ix,nx);px.up.set(0,0,1),px.lookAt(new sd(0,1,0)),this.add(px);var cx=new Yl(90,1,ix,nx);cx.up.set(0,0,-1),cx.lookAt(new sd(0,-1,0)),this.add(cx);var mx=new Yl(90,1,ix,nx);mx.up.set(0,-1,0),mx.lookAt(new sd(0,0,1)),this.add(mx);var ux=new Yl(90,1,ix,nx);ux.up.set(0,-1,0),ux.lookAt(new sd(0,0,-1)),this.add(ux);this.renderTarget=new md(sx,sx,{format:hf,magFilter:Qh,minFilter:Qh}),this.renderTarget.texture.name="CubeCamera",this.update=function(hx,fx){null===this.parent&&this.updateMatrixWorld();var yx=this.renderTarget,xx=yx.texture.generateMipmaps;yx.texture.generateMipmaps=!1,yx.activeCubeFace=0,hx.render(fx,dx,yx),yx.activeCubeFace=1,hx.render(fx,lx,yx),yx.activeCubeFace=2,hx.render(fx,px,yx),yx.activeCubeFace=3,hx.render(fx,cx,yx),yx.activeCubeFace=4,hx.render(fx,mx,yx),yx.texture.generateMipmaps=xx,yx.activeCubeFace=5,hx.render(fx,ux,yx),hx.setRenderTarget(null)},this.clear=function(hx,fx,yx,xx){for(var vx=this.renderTarget,Lx=0;6>Lx;Lx++)vx.activeCubeFace=Lx,hx.setRenderTarget(vx),hx.clear(fx,yx,xx);hx.setRenderTarget(null)}}function yu(){il.call(this),this.type="AudioListener",this.context=$y.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null}function xu(ix){il.call(this),this.type="Audio",this.context=ix.context,this.gain=this.context.createGain(),this.gain.connect(ix.getInput()),this.autoplay=!1,this.buffer=null,this.loop=!1,this.startTime=0,this.offset=0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this.filters=[]}function vu(ix){xu.call(this,ix),this.panner=this.context.createPanner(),this.panner.connect(this.gain)}function Lu(ix,nx){this.analyser=ix.context.createAnalyser(),this.analyser.fftSize=void 0===nx?2048:nx,this.data=new Uint8Array(this.analyser.frequencyBinCount),ix.getOutput().connect(this.analyser)}function bu(ix,nx,sx){this.binding=ix,this.valueSize=sx;var lx=Float64Array,dx;"quaternion"===nx?dx=this._slerp:"string"===nx||"bool"===nx?(lx=Array,dx=this._select):dx=this._lerp;this.buffer=new lx(4*sx),this._mixBufferRegion=dx,this.cumulativeWeight=0,this.useCount=0,this.referenceCount=0}function _u(ix,nx,sx){var dx=sx||Au.parseTrackName(nx);this._targetGroup=ix,this._bindings=ix.subscribe_(nx,dx)}function Au(ix,nx,sx){this.path=nx,this.parsedPath=sx||Au.parseTrackName(nx),this.node=Au.findNode(ix,this.parsedPath.nodeName)||ix,this.rootNode=ix}function Eu(){this.uuid=uy.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var ix={};this._indicesByUUID=ix;for(var nx=0,sx=arguments.length;nx!==sx;++nx)ix[arguments[nx].uuid]=nx;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var dx=this;this.stats={objects:{get total(){return dx._objects.length},get inUse(){return this.total-dx.nCachedObjects_}},get bindingsPerObject(){return dx._bindings.length}}}function Su(ix,nx,sx){this._mixer=ix,this._clip=nx,this._localRoot=sx||null;for(var dx=nx.tracks,lx=dx.length,px=Array(lx),cx={endingStart:Kf,endingEnd:Kf},mx=0,ux;mx!==lx;++mx)ux=dx[mx].createInterpolant(null),px[mx]=ux,ux.settings=cx;this._interpolantSettings=cx,this._interpolants=px,this._propertyBindings=Array(lx),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=Yf,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}function Tu(ix){this._root=ix,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}function Mu(ix){"string"==typeof ix&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),ix=arguments[1]),this.value=ix}function wu(){_l.call(this),this.type="InstancedBufferGeometry",this.maxInstancedCount=void 0}function Ru(ix,nx,sx,dx){this.uuid=uy.generateUUID(),this.data=ix,this.itemSize=nx,this.offset=sx,this.normalized=!0===dx}function Pu(ix,nx){this.uuid=uy.generateUUID(),this.array=ix,this.stride=nx,this.count=void 0===ix?0:ix.length/nx,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.onUploadCallback=function(){},this.version=0}function Cu(ix,nx,sx){Pu.call(this,ix,nx),this.meshPerAttribute=sx||1}function Ou(ix,nx,sx){pl.call(this,ix,nx),this.meshPerAttribute=sx||1}function Iu(ix,nx,sx,dx){this.ray=new Rl(ix,nx),this.near=sx||0,this.far=dx||1/0,this.params={Mesh:{},Line:{},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function Du(ix,nx){return ix.distance-nx.distance}function Fu(ix,nx,sx,dx){if(!1!==ix.visible&&(ix.raycast(nx,sx),!0===dx))for(var lx=ix.children,px=0,cx=lx.length;px<cx;px++)Fu(lx[px],nx,sx,!0)}function Bu(ix){this.autoStart=void 0===ix||ix,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}function Uu(ix,nx,sx){return this.radius=void 0===ix?1:ix,this.phi=void 0===nx?0:nx,this.theta=void 0===sx?0:sx,this}function Nu(ix,nx,sx){return this.radius=void 0===ix?1:ix,this.theta=void 0===nx?0:nx,this.y=void 0===sx?0:sx,this}function Wu(ix,nx){this.min=void 0===ix?new od(1/0,1/0):ix,this.max=void 0===nx?new od(-1/0,-1/0):nx}function zu(ix){il.call(this),this.material=ix,this.render=function(){}}function Hu(ix,nx,sx,dx){this.object=ix,this.size=void 0===nx?1:nx;var lx=void 0===sx?16711680:sx,px=void 0===dx?1:dx,cx=0,mx=this.object.geometry;mx&&mx.isGeometry?cx=3*mx.faces.length:mx&&mx.isBufferGeometry&&(cx=mx.attributes.normal.count);var ux=new _l,gx=new xl(3*(2*cx),3);ux.addAttribute("position",gx),lp.call(this,ux,new sp({color:lx,linewidth:px})),this.matrixAutoUpdate=!1,this.update()}function Gu(ix,nx){il.call(this),this.light=ix,this.light.updateMatrixWorld(),this.matrix=ix.matrixWorld,this.matrixAutoUpdate=!1,this.color=nx;for(var sx=new _l,dx=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],lx=0,px=1;32>lx;lx++,px++){var cx=2*(lx/32*Math.PI),mx=2*(px/32*Math.PI);dx.push(Math.cos(cx),Math.sin(cx),1,Math.cos(mx),Math.sin(mx),1)}sx.addAttribute("position",new xl(dx,3));var ux=new sp({fog:!1});this.cone=new lp(sx,ux),this.add(this.cone),this.update()}function Vu(ix){for(var nx=function hx(fx){var yx=[];fx&&fx.isBone&&yx.push(fx);for(var xx=0;xx<fx.children.length;xx++)yx.push.apply(yx,hx(fx.children[xx]));return yx}(ix),sx=new _l,dx=[],lx=[],px=new Xd(0,0,1),cx=new Xd(0,1,0),mx=0,ux;mx<nx.length;mx++)ux=nx[mx],ux.parent&&ux.parent.isBone&&(dx.push(0,0,0),dx.push(0,0,0),lx.push(px.r,px.g,px.b),lx.push(cx.r,cx.g,cx.b));sx.addAttribute("position",new xl(dx,3)),sx.addAttribute("color",new xl(lx,3));var gx=new sp({vertexColors:$g,depthTest:!1,depthWrite:!1,transparent:!0});lp.call(this,sx,gx),this.root=ix,this.bones=nx,this.matrix=ix.matrixWorld,this.matrixAutoUpdate=!1}function ku(ix,nx,sx){this.light=ix,this.light.updateMatrixWorld(),this.color=sx;var dx=new zc(nx,4,2),lx=new Ml({wireframe:!0,fog:!1});Ol.call(this,dx,lx),this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}function ju(ix,nx){il.call(this),this.light=ix,this.light.updateMatrixWorld(),this.matrix=ix.matrixWorld,this.matrixAutoUpdate=!1,this.color=nx;var sx=new sp({fog:!1}),dx=new _l;dx.addAttribute("position",new pl(new Float32Array(15),3)),this.line=new dp(dx,sx),this.add(this.line),this.update()}function Yu(ix,nx,sx){il.call(this),this.light=ix,this.light.updateMatrixWorld(),this.matrix=ix.matrixWorld,this.matrixAutoUpdate=!1,this.color=sx;var dx=new Sp(nx);dx.rotateY(.5*Math.PI),this.material=new Ml({wireframe:!0,fog:!1}),void 0===this.color&&(this.material.vertexColors=$g);var lx=dx.getAttribute("position"),px=new Float32Array(3*lx.count);dx.addAttribute("color",new pl(px,3)),this.add(new Ol(dx,this.material)),this.update()}function Xu(ix,nx,sx,dx){ix=ix||10,nx=nx||10,sx=new Xd(void 0===sx?4473924:sx),dx=new Xd(void 0===dx?8947848:dx);for(var lx=nx/2,px=ix/nx,cx=ix/2,mx=[],ux=[],gx=0,hx=0,fx=-cx;gx<=nx;gx++,fx+=px){mx.push(-cx,0,fx,cx,0,fx),mx.push(fx,0,-cx,fx,0,cx);var yx=gx===lx?sx:dx;yx.toArray(ux,hx),hx+=3,yx.toArray(ux,hx),hx+=3,yx.toArray(ux,hx),hx+=3,yx.toArray(ux,hx),hx+=3}var xx=new _l;xx.addAttribute("position",new xl(mx,3)),xx.addAttribute("color",new xl(ux,3));var vx=new sp({vertexColors:$g});lp.call(this,xx,vx)}function qu(ix,nx,sx,dx,lx,px){ix=ix||10,nx=nx||16,sx=sx||8,dx=dx||64,lx=new Xd(void 0===lx?4473924:lx),px=new Xd(void 0===px?8947848:px);var xx=[],vx=[],cx,mx,ux,gx,hx,fx,yx;for(gx=0;gx<=nx;gx++)ux=gx/nx*(2*Math.PI),cx=Math.sin(ux)*ix,mx=Math.cos(ux)*ix,xx.push(0,0,0),xx.push(cx,0,mx),yx=1&gx?lx:px,vx.push(yx.r,yx.g,yx.b),vx.push(yx.r,yx.g,yx.b);for(gx=0;gx<=sx;gx++)for(yx=1&gx?lx:px,fx=ix-ix/sx*gx,hx=0;hx<dx;hx++)ux=hx/dx*(2*Math.PI),cx=Math.sin(ux)*fx,mx=Math.cos(ux)*fx,xx.push(cx,0,mx),vx.push(yx.r,yx.g,yx.b),ux=(hx+1)/dx*(2*Math.PI),cx=Math.sin(ux)*fx,mx=Math.cos(ux)*fx,xx.push(cx,0,mx),vx.push(yx.r,yx.g,yx.b);var Lx=new _l;Lx.addAttribute("position",new xl(xx,3)),Lx.addAttribute("color",new xl(vx,3));var bx=new sp({vertexColors:$g});lp.call(this,Lx,bx)}function Zu(ix,nx,sx,dx){this.object=ix,this.size=void 0===nx?1:nx;var lx=void 0===sx?16776960:sx,px=void 0===dx?1:dx,cx=0,mx=this.object.geometry;mx&&mx.isGeometry?cx=mx.faces.length:console.warn("THREE.FaceNormalsHelper: only THREE.Geometry is supported. Use THREE.VertexNormalsHelper, instead.");var ux=new _l,gx=new xl(3*(2*cx),3);ux.addAttribute("position",gx),lp.call(this,ux,new sp({color:lx,linewidth:px})),this.matrixAutoUpdate=!1,this.update()}function Ju(ix,nx,sx){il.call(this),this.light=ix,this.light.updateMatrixWorld(),this.matrix=ix.matrixWorld,this.matrixAutoUpdate=!1,this.color=sx,void 0===nx&&(nx=1);var dx=new _l;dx.addAttribute("position",new xl([-nx,nx,0,nx,nx,0,nx,-nx,0,-nx,-nx,0,-nx,nx,0],3));var lx=new sp({fog:!1});this.lightPlane=new dp(dx,lx),this.add(this.lightPlane),(dx=new _l).addAttribute("position",new xl([0,0,0,0,0,1],3)),this.targetLine=new dp(dx,lx),this.add(this.targetLine),this.update()}function Ku(ix){function nx(xx,vx,Lx){sx(xx,Lx),sx(vx,Lx)}function sx(xx,vx){px.push(0,0,0),cx.push(vx.r,vx.g,vx.b),void 0===mx[xx]&&(mx[xx]=[]),mx[xx].push(px.length/3-1)}var dx=new _l,lx=new sp({color:16777215,vertexColors:Qg}),px=[],cx=[],mx={},ux=new Xd(16755200),gx=new Xd(16711680),hx=new Xd(43775),fx=new Xd(16777215),yx=new Xd(3355443);nx("n1","n2",ux),nx("n2","n4",ux),nx("n4","n3",ux),nx("n3","n1",ux),nx("f1","f2",ux),nx("f2","f4",ux),nx("f4","f3",ux),nx("f3","f1",ux),nx("n1","f1",ux),nx("n2","f2",ux),nx("n3","f3",ux),nx("n4","f4",ux),nx("p","n1",gx),nx("p","n2",gx),nx("p","n3",gx),nx("p","n4",gx),nx("u1","u2",hx),nx("u2","u3",hx),nx("u3","u1",hx),nx("c","t",fx),nx("p","c",yx),nx("cn1","cn2",yx),nx("cn3","cn4",yx),nx("cf1","cf2",yx),nx("cf3","cf4",yx),dx.addAttribute("position",new xl(px,3)),dx.addAttribute("color",new xl(cx,3)),lp.call(this,dx,lx),this.camera=ix,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=ix.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=mx,this.update()}function Qu(ix,nx){this.object=ix,void 0===nx&&(nx=16776960);var sx=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),dx=new Float32Array(24),lx=new _l;lx.setIndex(new pl(sx,1)),lx.addAttribute("position",new pl(dx,3)),lp.call(this,lx,new sp({color:nx})),this.matrixAutoUpdate=!1,this.update()}function $u(ix,nx){this.type="Box3Helper",this.box=ix;var sx=void 0===nx?16776960:nx,dx=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),lx=new _l;lx.setIndex(new pl(dx,1)),lx.addAttribute("position",new xl([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),lp.call(this,lx,new sp({color:sx})),this.geometry.computeBoundingSphere()}function eg(ix,nx,sx){this.type="PlaneHelper",this.plane=ix,this.size=void 0===nx?1:nx;var dx=void 0===sx?16776960:sx,lx=new _l;lx.addAttribute("position",new xl([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),lx.computeBoundingSphere(),dp.call(this,lx,new sp({color:dx}));var px=new _l;px.addAttribute("position",new xl([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),px.computeBoundingSphere(),this.add(new Ol(px,new Ml({color:dx,opacity:.2,transparent:!0,depthWrite:!1})))}function tg(ix,nx,sx,dx,lx,px){il.call(this),void 0===dx&&(dx=16776960),void 0===sx&&(sx=1),void 0===lx&&(lx=.2*sx),void 0===px&&(px=.2*lx),void 0===Ky&&((Ky=new _l).addAttribute("position",new xl([0,0,0,0,1,0],3)),(Qy=new Jc(0,.5,1,5,1)).translate(0,-.5,0)),this.position.copy(nx),this.line=new dp(Ky,new sp({color:dx})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Ol(Qy,new Ml({color:dx})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(ix),this.setLength(sx,lx,px)}function ag(ix){var nx=[0,0,0,ix=ix||1,0,0,0,0,0,0,ix,0,0,0,0,0,0,ix],sx=new _l;sx.addAttribute("position",new xl(nx,3)),sx.addAttribute("color",new xl([1,0,0,1,0.6,0,0,1,0,0.6,1,0,0,0,1,0,0.6,1],3));var dx=new sp({vertexColors:$g});lp.call(this,sx,dx)}function rg(ix,nx,sx,dx,lx,px,cx){return console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead."),new dl(ix,nx,sx,lx,px,cx)}function og(ix){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),ix}function ig(ix){return void 0===ix&&(ix=[]),console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),ix.isMultiMaterial=!0,ix.materials=ix,ix.clone=function(){return ix.slice()},ix}function ng(ix,nx){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new mp(ix,nx)}function sg(ix){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new ap(ix)}function dg(ix,nx){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new mp(ix,nx)}function lg(ix){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new cp(ix)}function pg(ix){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new cp(ix)}function cg(ix){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new cp(ix)}function mg(ix,nx,sx){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new sd(ix,nx,sx)}function ug(ix,nx){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setDynamic( true ) instead."),new pl(ix,nx).setDynamic(!0)}function gg(ix,nx){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new cl(ix,nx)}function hg(ix,nx){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new ml(ix,nx)}function fg(ix,nx){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new ul(ix,nx)}function yg(ix,nx){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new gl(ix,nx)}function xg(ix,nx){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new hl(ix,nx)}function vg(ix,nx){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new fl(ix,nx)}function Lg(ix,nx){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new yl(ix,nx)}function bg(ix,nx){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new xl(ix,nx)}function _g(ix,nx){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new vl(ix,nx)}function Ag(ix){console.warn("THREE.ClosedSplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),bm.call(this,ix),this.type="catmullrom",this.closed=!0}function Eg(ix){console.warn("THREE.SplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),bm.call(this,ix),this.type="catmullrom"}function Sg(ix){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),bm.call(this,ix),this.type="catmullrom"}function Tg(ix){return console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper."),new ag(ix)}function Mg(ix,nx){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new Qu(ix,nx)}function wg(ix,nx){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new lp(new qc(ix.geometry),new sp({color:void 0===nx?16777215:nx}))}function Rg(ix,nx){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new lp(new yp(ix.geometry),new sp({color:void 0===nx?16777215:nx}))}function Pg(ix){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new cm(ix)}function Cg(ix){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new um(ix)}function Og(){console.error("THREE.Projector has been moved to /examples/js/renderers/Projector.js."),this.projectVector=function(ix,nx){console.warn("THREE.Projector: .projectVector() is now vector.project()."),ix.project(nx)},this.unprojectVector=function(ix,nx){console.warn("THREE.Projector: .unprojectVector() is now vector.unproject()."),ix.unproject(nx)},this.pickingRay=function(){console.error("THREE.Projector: .pickingRay() is now raycaster.setFromCamera().")}}function Ig(){console.error("THREE.CanvasRenderer has been moved to /examples/js/renderers/CanvasRenderer.js"),this.domElement=document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),this.clear=function(){},this.render=function(){},this.setClearColor=function(){},this.setSize=function(){}}function Dg(){console.error("THREE.LensFlare has been moved to /examples/js/objects/Lensflare.js")}ad.r(td),ad.d(td,"WebGLRenderTargetCube",function(){return md}),ad.d(td,"WebGLRenderTarget",function(){return cd}),ad.d(td,"WebGLRenderer",function(){return Kl}),ad.d(td,"ShaderLib",function(){return Ty}),ad.d(td,"UniformsLib",function(){return Ay}),ad.d(td,"UniformsUtils",function(){return Ey}),ad.d(td,"ShaderChunk",function(){return Sy}),ad.d(td,"FogExp2",function(){return Ql}),ad.d(td,"Fog",function(){return $l}),ad.d(td,"Scene",function(){return ep}),ad.d(td,"Sprite",function(){return ap}),ad.d(td,"LOD",function(){return rp}),ad.d(td,"SkinnedMesh",function(){return np}),ad.d(td,"Skeleton",function(){return op}),ad.d(td,"Bone",function(){return ip}),ad.d(td,"Mesh",function(){return Ol}),ad.d(td,"LineSegments",function(){return lp}),ad.d(td,"LineLoop",function(){return pp}),ad.d(td,"Line",function(){return dp}),ad.d(td,"Points",function(){return mp}),ad.d(td,"Group",function(){return up}),ad.d(td,"VideoTexture",function(){return gp}),ad.d(td,"DataTexture",function(){return ud}),ad.d(td,"CompressedTexture",function(){return hp}),ad.d(td,"CubeTexture",function(){return gd}),ad.d(td,"CanvasTexture",function(){return qd}),ad.d(td,"DepthTexture",function(){return fp}),ad.d(td,"Texture",function(){return ld}),ad.d(td,"CompressedTextureLoader",function(){return mm}),ad.d(td,"DataTextureLoader",function(){return um}),ad.d(td,"CubeTextureLoader",function(){return hm}),ad.d(td,"TextureLoader",function(){return fm}),ad.d(td,"ObjectLoader",function(){return du}),ad.d(td,"MaterialLoader",function(){return ou}),ad.d(td,"BufferGeometryLoader",function(){return iu}),ad.d(td,"DefaultLoadingManager",function(){return Uy}),ad.d(td,"LoadingManager",function(){return pm}),ad.d(td,"JSONLoader",function(){return su}),ad.d(td,"ImageLoader",function(){return gm}),ad.d(td,"ImageBitmapLoader",function(){return lu}),ad.d(td,"FontLoader",function(){return uu}),ad.d(td,"FileLoader",function(){return cm}),ad.d(td,"Loader",function(){return nu}),ad.d(td,"LoaderUtils",function(){return Yy}),ad.d(td,"Cache",function(){return By}),ad.d(td,"AudioLoader",function(){return gu}),ad.d(td,"SpotLightShadow",function(){return Nm}),ad.d(td,"SpotLight",function(){return Wm}),ad.d(td,"PointLight",function(){return zm}),ad.d(td,"RectAreaLight",function(){return km}),ad.d(td,"HemisphereLight",function(){return Bm}),ad.d(td,"DirectionalLightShadow",function(){return Hm}),ad.d(td,"DirectionalLight",function(){return Gm}),ad.d(td,"AmbientLight",function(){return Vm}),ad.d(td,"LightShadow",function(){return Um}),ad.d(td,"Light",function(){return Fm}),ad.d(td,"StereoCamera",function(){return hu}),ad.d(td,"PerspectiveCamera",function(){return Yl}),ad.d(td,"OrthographicCamera",function(){return sl}),ad.d(td,"CubeCamera",function(){return fu}),ad.d(td,"ArrayCamera",function(){return Xl}),ad.d(td,"Camera",function(){return nl}),ad.d(td,"AudioListener",function(){return yu}),ad.d(td,"PositionalAudio",function(){return vu}),ad.d(td,"AudioContext",function(){return $y}),ad.d(td,"AudioAnalyser",function(){return Lu}),ad.d(td,"Audio",function(){return xu}),ad.d(td,"VectorKeyframeTrack",function(){return au}),ad.d(td,"StringKeyframeTrack",function(){return jm}),ad.d(td,"QuaternionKeyframeTrack",function(){return Zm}),ad.d(td,"NumberKeyframeTrack",function(){return Km}),ad.d(td,"ColorKeyframeTrack",function(){return Jm}),ad.d(td,"BooleanKeyframeTrack",function(){return Ym}),ad.d(td,"PropertyMixer",function(){return bu}),ad.d(td,"PropertyBinding",function(){return Au}),ad.d(td,"KeyframeTrack",function(){return tu}),ad.d(td,"AnimationUtils",function(){return ky}),ad.d(td,"AnimationObjectGroup",function(){return Eu}),ad.d(td,"AnimationMixer",function(){return Tu}),ad.d(td,"AnimationClip",function(){return ru}),ad.d(td,"Uniform",function(){return Mu}),ad.d(td,"InstancedBufferGeometry",function(){return wu}),ad.d(td,"BufferGeometry",function(){return _l}),ad.d(td,"Geometry",function(){return ll}),ad.d(td,"InterleavedBufferAttribute",function(){return Ru}),ad.d(td,"InstancedInterleavedBuffer",function(){return Cu}),ad.d(td,"InterleavedBuffer",function(){return Pu}),ad.d(td,"InstancedBufferAttribute",function(){return Ou}),ad.d(td,"Face3",function(){return dl}),ad.d(td,"Object3D",function(){return il}),ad.d(td,"Raycaster",function(){return Iu}),ad.d(td,"Layers",function(){return ol}),ad.d(td,"EventDispatcher",function(){return rd}),ad.d(td,"Clock",function(){return Bu}),ad.d(td,"QuaternionLinearInterpolant",function(){return qm}),ad.d(td,"LinearInterpolant",function(){return $m}),ad.d(td,"DiscreteInterpolant",function(){return eu}),ad.d(td,"CubicInterpolant",function(){return Qm}),ad.d(td,"Interpolant",function(){return Xm}),ad.d(td,"Triangle",function(){return Cl}),ad.d(td,"Math",function(){return uy}),ad.d(td,"Spherical",function(){return Uu}),ad.d(td,"Cylindrical",function(){return Nu}),ad.d(td,"Plane",function(){return el}),ad.d(td,"Frustum",function(){return tl}),ad.d(td,"Sphere",function(){return $d}),ad.d(td,"Ray",function(){return Rl}),ad.d(td,"Matrix4",function(){return id}),ad.d(td,"Matrix3",function(){return dd}),ad.d(td,"Box3",function(){return Qd}),ad.d(td,"Box2",function(){return Wu}),ad.d(td,"Line3",function(){return Pl}),ad.d(td,"Euler",function(){return rl}),ad.d(td,"Vector4",function(){return pd}),ad.d(td,"Vector3",function(){return sd}),ad.d(td,"Vector2",function(){return od}),ad.d(td,"Quaternion",function(){return nd}),ad.d(td,"Color",function(){return Xd}),ad.d(td,"ImmediateRenderObject",function(){return zu}),ad.d(td,"VertexNormalsHelper",function(){return Hu}),ad.d(td,"SpotLightHelper",function(){return Gu}),ad.d(td,"SkeletonHelper",function(){return Vu}),ad.d(td,"PointLightHelper",function(){return ku}),ad.d(td,"RectAreaLightHelper",function(){return ju}),ad.d(td,"HemisphereLightHelper",function(){return Yu}),ad.d(td,"GridHelper",function(){return Xu}),ad.d(td,"PolarGridHelper",function(){return qu}),ad.d(td,"FaceNormalsHelper",function(){return Zu}),ad.d(td,"DirectionalLightHelper",function(){return Ju}),ad.d(td,"CameraHelper",function(){return Ku}),ad.d(td,"BoxHelper",function(){return Qu}),ad.d(td,"Box3Helper",function(){return $u}),ad.d(td,"PlaneHelper",function(){return eg}),ad.d(td,"ArrowHelper",function(){return tg}),ad.d(td,"AxesHelper",function(){return ag}),ad.d(td,"Shape",function(){return Dm}),ad.d(td,"Path",function(){return Im}),ad.d(td,"ShapePath",function(){return pu}),ad.d(td,"Font",function(){return cu}),ad.d(td,"CurvePath",function(){return Om}),ad.d(td,"Curve",function(){return ym}),ad.d(td,"ShapeUtils",function(){return Iy}),ad.d(td,"WebGLUtils",function(){return Zl}),ad.d(td,"WireframeGeometry",function(){return yp}),ad.d(td,"ParametricGeometry",function(){return xp}),ad.d(td,"ParametricBufferGeometry",function(){return vp}),ad.d(td,"TetrahedronGeometry",function(){return _p}),ad.d(td,"TetrahedronBufferGeometry",function(){return Ap}),ad.d(td,"OctahedronGeometry",function(){return Ep}),ad.d(td,"OctahedronBufferGeometry",function(){return Sp}),ad.d(td,"IcosahedronGeometry",function(){return Tp}),ad.d(td,"IcosahedronBufferGeometry",function(){return Mp}),ad.d(td,"DodecahedronGeometry",function(){return wp}),ad.d(td,"DodecahedronBufferGeometry",function(){return Rp}),ad.d(td,"PolyhedronGeometry",function(){return Lp}),ad.d(td,"PolyhedronBufferGeometry",function(){return bp}),ad.d(td,"TubeGeometry",function(){return Pp}),ad.d(td,"TubeBufferGeometry",function(){return Cp}),ad.d(td,"TorusKnotGeometry",function(){return Op}),ad.d(td,"TorusKnotBufferGeometry",function(){return Ip}),ad.d(td,"TorusGeometry",function(){return Dp}),ad.d(td,"TorusBufferGeometry",function(){return Fp}),ad.d(td,"TextGeometry",function(){return Uc}),ad.d(td,"TextBufferGeometry",function(){return Nc}),ad.d(td,"SphereGeometry",function(){return Wc}),ad.d(td,"SphereBufferGeometry",function(){return zc}),ad.d(td,"RingGeometry",function(){return Hc}),ad.d(td,"RingBufferGeometry",function(){return Gc}),ad.d(td,"PlaneGeometry",function(){return Sl}),ad.d(td,"PlaneBufferGeometry",function(){return Tl}),ad.d(td,"LatheGeometry",function(){return Vc}),ad.d(td,"LatheBufferGeometry",function(){return kc}),ad.d(td,"ShapeGeometry",function(){return jc}),ad.d(td,"ShapeBufferGeometry",function(){return Yc}),ad.d(td,"ExtrudeGeometry",function(){return Fc}),ad.d(td,"ExtrudeBufferGeometry",function(){return Bc}),ad.d(td,"EdgesGeometry",function(){return qc}),ad.d(td,"ConeGeometry",function(){return Kc}),ad.d(td,"ConeBufferGeometry",function(){return Qc}),ad.d(td,"CylinderGeometry",function(){return Zc}),ad.d(td,"CylinderBufferGeometry",function(){return Jc}),ad.d(td,"CircleGeometry",function(){return $c}),ad.d(td,"CircleBufferGeometry",function(){return em}),ad.d(td,"BoxGeometry",function(){return Al}),ad.d(td,"BoxBufferGeometry",function(){return El}),ad.d(td,"ShadowMaterial",function(){return tm}),ad.d(td,"SpriteMaterial",function(){return tp}),ad.d(td,"RawShaderMaterial",function(){return am}),ad.d(td,"ShaderMaterial",function(){return wl}),ad.d(td,"PointsMaterial",function(){return cp}),ad.d(td,"MeshPhysicalMaterial",function(){return om}),ad.d(td,"MeshStandardMaterial",function(){return rm}),ad.d(td,"MeshPhongMaterial",function(){return im}),ad.d(td,"MeshToonMaterial",function(){return nm}),ad.d(td,"MeshNormalMaterial",function(){return sm}),ad.d(td,"MeshLambertMaterial",function(){return dm}),ad.d(td,"MeshDepthMaterial",function(){return Jd}),ad.d(td,"MeshDistanceMaterial",function(){return Kd}),ad.d(td,"MeshBasicMaterial",function(){return Ml}),ad.d(td,"LineDashedMaterial",function(){return lm}),ad.d(td,"LineBasicMaterial",function(){return sp}),ad.d(td,"Material",function(){return Zd}),ad.d(td,"Float64BufferAttribute",function(){return vl}),ad.d(td,"Float32BufferAttribute",function(){return xl}),ad.d(td,"Uint32BufferAttribute",function(){return yl}),ad.d(td,"Int32BufferAttribute",function(){return fl}),ad.d(td,"Uint16BufferAttribute",function(){return hl}),ad.d(td,"Int16BufferAttribute",function(){return gl}),ad.d(td,"Uint8ClampedBufferAttribute",function(){return ul}),ad.d(td,"Uint8BufferAttribute",function(){return ml}),ad.d(td,"Int8BufferAttribute",function(){return cl}),ad.d(td,"BufferAttribute",function(){return pl}),ad.d(td,"ArcCurve",function(){return vm}),ad.d(td,"CatmullRomCurve3",function(){return bm}),ad.d(td,"CubicBezierCurve",function(){return Sm}),ad.d(td,"CubicBezierCurve3",function(){return Tm}),ad.d(td,"EllipseCurve",function(){return xm}),ad.d(td,"LineCurve",function(){return Mm}),ad.d(td,"LineCurve3",function(){return wm}),ad.d(td,"QuadraticBezierCurve",function(){return Rm}),ad.d(td,"QuadraticBezierCurve3",function(){return Pm}),ad.d(td,"SplineCurve",function(){return Cm}),ad.d(td,"REVISION",function(){return Fg}),ad.d(td,"MOUSE",function(){return Bg}),ad.d(td,"CullFaceNone",function(){return Ug}),ad.d(td,"CullFaceBack",function(){return Ng}),ad.d(td,"CullFaceFront",function(){return Wg}),ad.d(td,"CullFaceFrontBack",function(){return 3}),ad.d(td,"FrontFaceDirectionCW",function(){return 0}),ad.d(td,"FrontFaceDirectionCCW",function(){return 1}),ad.d(td,"BasicShadowMap",function(){return 0}),ad.d(td,"PCFShadowMap",function(){return kg}),ad.d(td,"PCFSoftShadowMap",function(){return jg}),ad.d(td,"FrontSide",function(){return Yg}),ad.d(td,"BackSide",function(){return Xg}),ad.d(td,"DoubleSide",function(){return qg}),ad.d(td,"FlatShading",function(){return Zg}),ad.d(td,"SmoothShading",function(){return 2}),ad.d(td,"NoColors",function(){return Kg}),ad.d(td,"FaceColors",function(){return Qg}),ad.d(td,"VertexColors",function(){return $g}),ad.d(td,"NoBlending",function(){return eh}),ad.d(td,"NormalBlending",function(){return th}),ad.d(td,"AdditiveBlending",function(){return ah}),ad.d(td,"SubtractiveBlending",function(){return rh}),ad.d(td,"MultiplyBlending",function(){return oh}),ad.d(td,"CustomBlending",function(){return ih}),ad.d(td,"AddEquation",function(){return nh}),ad.d(td,"SubtractEquation",function(){return sh}),ad.d(td,"ReverseSubtractEquation",function(){return dh}),ad.d(td,"MinEquation",function(){return lh}),ad.d(td,"MaxEquation",function(){return ph}),ad.d(td,"ZeroFactor",function(){return ch}),ad.d(td,"OneFactor",function(){return mh}),ad.d(td,"SrcColorFactor",function(){return uh}),ad.d(td,"OneMinusSrcColorFactor",function(){return gh}),ad.d(td,"SrcAlphaFactor",function(){return hh}),ad.d(td,"OneMinusSrcAlphaFactor",function(){return fh}),ad.d(td,"DstAlphaFactor",function(){return yh}),ad.d(td,"OneMinusDstAlphaFactor",function(){return xh}),ad.d(td,"DstColorFactor",function(){return vh}),ad.d(td,"OneMinusDstColorFactor",function(){return Lh}),ad.d(td,"SrcAlphaSaturateFactor",function(){return bh}),ad.d(td,"NeverDepth",function(){return _h}),ad.d(td,"AlwaysDepth",function(){return Ah}),ad.d(td,"LessDepth",function(){return Eh}),ad.d(td,"LessEqualDepth",function(){return Sh}),ad.d(td,"EqualDepth",function(){return Th}),ad.d(td,"GreaterEqualDepth",function(){return Mh}),ad.d(td,"GreaterDepth",function(){return wh}),ad.d(td,"NotEqualDepth",function(){return Rh}),ad.d(td,"MultiplyOperation",function(){return Ph}),ad.d(td,"MixOperation",function(){return Ch}),ad.d(td,"AddOperation",function(){return Oh}),ad.d(td,"NoToneMapping",function(){return Ih}),ad.d(td,"LinearToneMapping",function(){return Dh}),ad.d(td,"ReinhardToneMapping",function(){return Fh}),ad.d(td,"Uncharted2ToneMapping",function(){return Bh}),ad.d(td,"CineonToneMapping",function(){return Uh}),ad.d(td,"UVMapping",function(){return Nh}),ad.d(td,"CubeReflectionMapping",function(){return Wh}),ad.d(td,"CubeRefractionMapping",function(){return zh}),ad.d(td,"EquirectangularReflectionMapping",function(){return Hh}),ad.d(td,"EquirectangularRefractionMapping",function(){return Gh}),ad.d(td,"SphericalReflectionMapping",function(){return Vh}),ad.d(td,"CubeUVReflectionMapping",function(){return kh}),ad.d(td,"CubeUVRefractionMapping",function(){return jh}),ad.d(td,"RepeatWrapping",function(){return Yh}),ad.d(td,"ClampToEdgeWrapping",function(){return Xh}),ad.d(td,"MirroredRepeatWrapping",function(){return qh}),ad.d(td,"NearestFilter",function(){return Zh}),ad.d(td,"NearestMipMapNearestFilter",function(){return Jh}),ad.d(td,"NearestMipMapLinearFilter",function(){return Kh}),ad.d(td,"LinearFilter",function(){return Qh}),ad.d(td,"LinearMipMapNearestFilter",function(){return $h}),ad.d(td,"LinearMipMapLinearFilter",function(){return ef}),ad.d(td,"UnsignedByteType",function(){return tf}),ad.d(td,"ByteType",function(){return af}),ad.d(td,"ShortType",function(){return rf}),ad.d(td,"UnsignedShortType",function(){return of}),ad.d(td,"IntType",function(){return nf}),ad.d(td,"UnsignedIntType",function(){return sf}),ad.d(td,"FloatType",function(){return df}),ad.d(td,"HalfFloatType",function(){return lf}),ad.d(td,"UnsignedShort4444Type",function(){return pf}),ad.d(td,"UnsignedShort5551Type",function(){return cf}),ad.d(td,"UnsignedShort565Type",function(){return mf}),ad.d(td,"UnsignedInt248Type",function(){return uf}),ad.d(td,"AlphaFormat",function(){return gf}),ad.d(td,"RGBFormat",function(){return hf}),ad.d(td,"RGBAFormat",function(){return ff}),ad.d(td,"LuminanceFormat",function(){return yf}),ad.d(td,"LuminanceAlphaFormat",function(){return xf}),ad.d(td,"RGBEFormat",function(){return ff}),ad.d(td,"DepthFormat",function(){return Lf}),ad.d(td,"DepthStencilFormat",function(){return bf}),ad.d(td,"RGB_S3TC_DXT1_Format",function(){return _f}),ad.d(td,"RGBA_S3TC_DXT1_Format",function(){return Af}),ad.d(td,"RGBA_S3TC_DXT3_Format",function(){return Ef}),ad.d(td,"RGBA_S3TC_DXT5_Format",function(){return Sf}),ad.d(td,"RGB_PVRTC_4BPPV1_Format",function(){return Tf}),ad.d(td,"RGB_PVRTC_2BPPV1_Format",function(){return Mf}),ad.d(td,"RGBA_PVRTC_4BPPV1_Format",function(){return wf}),ad.d(td,"RGBA_PVRTC_2BPPV1_Format",function(){return Rf}),ad.d(td,"RGB_ETC1_Format",function(){return Pf}),ad.d(td,"RGBA_ASTC_4x4_Format",function(){return Cf}),ad.d(td,"RGBA_ASTC_5x4_Format",function(){return Of}),ad.d(td,"RGBA_ASTC_5x5_Format",function(){return If}),ad.d(td,"RGBA_ASTC_6x5_Format",function(){return Df}),ad.d(td,"RGBA_ASTC_6x6_Format",function(){return Ff}),ad.d(td,"RGBA_ASTC_8x5_Format",function(){return Bf}),ad.d(td,"RGBA_ASTC_8x6_Format",function(){return Uf}),ad.d(td,"RGBA_ASTC_8x8_Format",function(){return Nf}),ad.d(td,"RGBA_ASTC_10x5_Format",function(){return Wf}),ad.d(td,"RGBA_ASTC_10x6_Format",function(){return zf}),ad.d(td,"RGBA_ASTC_10x8_Format",function(){return Hf}),ad.d(td,"RGBA_ASTC_10x10_Format",function(){return Gf}),ad.d(td,"RGBA_ASTC_12x10_Format",function(){return Vf}),ad.d(td,"RGBA_ASTC_12x12_Format",function(){return kf}),ad.d(td,"LoopOnce",function(){return jf}),ad.d(td,"LoopRepeat",function(){return Yf}),ad.d(td,"LoopPingPong",function(){return Xf}),ad.d(td,"InterpolateDiscrete",function(){return qf}),ad.d(td,"InterpolateLinear",function(){return Zf}),ad.d(td,"InterpolateSmooth",function(){return Jf}),ad.d(td,"ZeroCurvatureEnding",function(){return Kf}),ad.d(td,"ZeroSlopeEnding",function(){return Qf}),ad.d(td,"WrapAroundEnding",function(){return $f}),ad.d(td,"TrianglesDrawMode",function(){return ey}),ad.d(td,"TriangleStripDrawMode",function(){return ty}),ad.d(td,"TriangleFanDrawMode",function(){return ay}),ad.d(td,"LinearEncoding",function(){return ry}),ad.d(td,"sRGBEncoding",function(){return oy}),ad.d(td,"GammaEncoding",function(){return iy}),ad.d(td,"RGBEEncoding",function(){return ny}),ad.d(td,"LogLuvEncoding",function(){return 3003}),ad.d(td,"RGBM7Encoding",function(){return dy}),ad.d(td,"RGBM16Encoding",function(){return ly}),ad.d(td,"RGBDEncoding",function(){return py}),ad.d(td,"BasicDepthPacking",function(){return cy}),ad.d(td,"RGBADepthPacking",function(){return my}),ad.d(td,"CubeGeometry",function(){return Al}),ad.d(td,"Face4",function(){return rg}),ad.d(td,"LineStrip",function(){return 0}),ad.d(td,"LinePieces",function(){return 1}),ad.d(td,"MeshFaceMaterial",function(){return og}),ad.d(td,"MultiMaterial",function(){return ig}),ad.d(td,"PointCloud",function(){return ng}),ad.d(td,"Particle",function(){return sg}),ad.d(td,"ParticleSystem",function(){return dg}),ad.d(td,"PointCloudMaterial",function(){return lg}),ad.d(td,"ParticleBasicMaterial",function(){return pg}),ad.d(td,"ParticleSystemMaterial",function(){return cg}),ad.d(td,"Vertex",function(){return mg}),ad.d(td,"DynamicBufferAttribute",function(){return ug}),ad.d(td,"Int8Attribute",function(){return gg}),ad.d(td,"Uint8Attribute",function(){return hg}),ad.d(td,"Uint8ClampedAttribute",function(){return fg}),ad.d(td,"Int16Attribute",function(){return yg}),ad.d(td,"Uint16Attribute",function(){return xg}),ad.d(td,"Int32Attribute",function(){return vg}),ad.d(td,"Uint32Attribute",function(){return Lg}),ad.d(td,"Float32Attribute",function(){return bg}),ad.d(td,"Float64Attribute",function(){return _g}),ad.d(td,"ClosedSplineCurve3",function(){return Ag}),ad.d(td,"SplineCurve3",function(){return Eg}),ad.d(td,"Spline",function(){return Sg}),ad.d(td,"AxisHelper",function(){return Tg}),ad.d(td,"BoundingBoxHelper",function(){return Mg}),ad.d(td,"EdgesHelper",function(){return wg}),ad.d(td,"WireframeHelper",function(){return Rg}),ad.d(td,"XHRLoader",function(){return Pg}),ad.d(td,"BinaryTextureLoader",function(){return Cg}),ad.d(td,"GeometryUtils",function(){return ax}),ad.d(td,"ImageUtils",function(){return rx}),ad.d(td,"Projector",function(){return Og}),ad.d(td,"CanvasRenderer",function(){return Ig}),ad.d(td,"SceneUtils",function(){return ox}),ad.d(td,"LensFlare",function(){return Dg}),void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52)),void 0===Number.isInteger&&(Number.isInteger=function(ix){return"number"==typeof ix&&isFinite(ix)&&Math.floor(ix)===ix}),void 0===Math.sign&&(Math.sign=function(ix){return 0>ix?-1:0<ix?1:+ix}),0=="name"in Function.prototype&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),void 0===Object.assign&&(Object.assign=function(ix){if(void 0===ix||null===ix)throw new TypeError("Cannot convert undefined or null to object");for(var nx=Object(ix),sx=1,dx;sx<arguments.length;sx++)if(dx=arguments[sx],void 0!==dx&&null!==dx)for(var lx in dx)Object.prototype.hasOwnProperty.call(dx,lx)&&(nx[lx]=dx[lx]);return nx}),Object.assign(rd.prototype,{addEventListener:function(ix,nx){void 0===this._listeners&&(this._listeners={});var sx=this._listeners;void 0===sx[ix]&&(sx[ix]=[]),-1===sx[ix].indexOf(nx)&&sx[ix].push(nx)},hasEventListener:function(ix,nx){if(void 0===this._listeners)return!1;var sx=this._listeners;return void 0!==sx[ix]&&-1!==sx[ix].indexOf(nx)},removeEventListener:function(ix,nx){if(void 0!==this._listeners){var sx=this._listeners[ix];if(void 0!==sx){var dx=sx.indexOf(nx);-1!==dx&&sx.splice(dx,1)}}},dispatchEvent:function(ix){if(void 0!==this._listeners){var nx=this._listeners[ix.type];if(void 0!==nx){ix.target=this;for(var sx=nx.slice(0),dx=0,lx=sx.length;dx<lx;dx++)sx[dx].call(this,ix)}}}});var Fg="90",Bg={LEFT:0,MIDDLE:1,RIGHT:2},Ug=0,Ng=1,Wg=2,kg=1,jg=2,Yg=0,Xg=1,qg=2,Zg=1,Kg=0,Qg=1,$g=2,eh=0,th=1,ah=2,rh=3,oh=4,ih=5,nh=100,sh=101,dh=102,lh=103,ph=104,ch=200,mh=201,uh=202,gh=203,hh=204,fh=205,yh=206,xh=207,vh=208,Lh=209,bh=210,_h=0,Ah=1,Eh=2,Sh=3,Th=4,Mh=5,wh=6,Rh=7,Ph=0,Ch=1,Oh=2,Ih=0,Dh=1,Fh=2,Bh=3,Uh=4,Nh=300,Wh=301,zh=302,Hh=303,Gh=304,Vh=305,kh=306,jh=307,Yh=1e3,Xh=1001,qh=1002,Zh=1003,Jh=1004,Kh=1005,Qh=1006,$h=1007,ef=1008,tf=1009,af=1010,rf=1011,of=1012,nf=1013,sf=1014,df=1015,lf=1016,pf=1017,cf=1018,mf=1019,uf=1020,gf=1021,hf=1022,ff=1023,yf=1024,xf=1025,Lf=1026,bf=1027,_f=33776,Af=33777,Ef=33778,Sf=33779,Tf=35840,Mf=35841,wf=35842,Rf=35843,Pf=36196,Cf=37808,Of=37809,If=37810,Df=37811,Ff=37812,Bf=37813,Uf=37814,Nf=37815,Wf=37816,zf=37817,Hf=37818,Gf=37819,Vf=37820,kf=37821,jf=2200,Yf=2201,Xf=2202,qf=2300,Zf=2301,Jf=2302,Kf=2400,Qf=2401,$f=2402,ey=0,ty=1,ay=2,ry=3e3,oy=3001,iy=3007,ny=3002,dy=3004,ly=3005,py=3006,cy=3200,my=3201,uy={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){for(var ix=[],nx=0;256>nx;nx++)ix[nx]=(16>nx?"0":"")+nx.toString(16).toUpperCase();return function(){var sx=0|4294967295*Math.random(),dx=0|4294967295*Math.random(),lx=0|4294967295*Math.random(),px=0|4294967295*Math.random();return ix[255&sx]+ix[255&sx>>8]+ix[255&sx>>16]+ix[255&sx>>24]+"-"+ix[255&dx]+ix[255&dx>>8]+"-"+ix[64|15&dx>>16]+ix[255&dx>>24]+"-"+ix[128|63&lx]+ix[255&lx>>8]+"-"+ix[255&lx>>16]+ix[255&lx>>24]+ix[255&px]+ix[255&px>>8]+ix[255&px>>16]+ix[255&px>>24]}}(),clamp:function(ix,nx,sx){return Math.max(nx,Math.min(sx,ix))},euclideanModulo:function(ix,nx){return(ix%nx+nx)%nx},mapLinear:function(ix,nx,sx,dx,lx){return dx+(ix-nx)*(lx-dx)/(sx-nx)},lerp:function(ix,nx,sx){return(1-sx)*ix+sx*nx},smoothstep:function(ix,nx,sx){return ix<=nx?0:ix>=sx?1:(ix=(ix-nx)/(sx-nx))*ix*(3-2*ix)},smootherstep:function(ix,nx,sx){return ix<=nx?0:ix>=sx?1:(ix=(ix-nx)/(sx-nx))*ix*ix*(ix*(6*ix-15)+10)},randInt:function(ix,nx){return ix+Math.floor(Math.random()*(nx-ix+1))},randFloat:function(ix,nx){return ix+Math.random()*(nx-ix)},randFloatSpread:function(ix){return ix*(.5-Math.random())},degToRad:function(ix){return ix*uy.DEG2RAD},radToDeg:function(ix){return ix*uy.RAD2DEG},isPowerOfTwo:function(ix){return 0==(ix&ix-1)&&0!==ix},ceilPowerOfTwo:function(ix){return Math.pow(2,Math.ceil(Math.log(ix)/Math.LN2))},floorPowerOfTwo:function(ix){return Math.pow(2,Math.floor(Math.log(ix)/Math.LN2))}};Object.defineProperties(od.prototype,{width:{get:function(){return this.x},set:function(ix){this.x=ix}},height:{get:function(){return this.y},set:function(ix){this.y=ix}}}),Object.assign(od.prototype,{isVector2:!0,set:function(ix,nx){return this.x=ix,this.y=nx,this},setScalar:function(ix){return this.x=ix,this.y=ix,this},setX:function(ix){return this.x=ix,this},setY:function(ix){return this.y=ix,this},setComponent:function(ix,nx){switch(ix){case 0:this.x=nx;break;case 1:this.y=nx;break;default:throw new Error("index is out of range: "+ix);}return this},getComponent:function(ix){switch(ix){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+ix);}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(ix){return this.x=ix.x,this.y=ix.y,this},add:function(ix,nx){return void 0===nx?(this.x+=ix.x,this.y+=ix.y,this):(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(ix,nx))},addScalar:function(ix){return this.x+=ix,this.y+=ix,this},addVectors:function(ix,nx){return this.x=ix.x+nx.x,this.y=ix.y+nx.y,this},addScaledVector:function(ix,nx){return this.x+=ix.x*nx,this.y+=ix.y*nx,this},sub:function(ix,nx){return void 0===nx?(this.x-=ix.x,this.y-=ix.y,this):(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(ix,nx))},subScalar:function(ix){return this.x-=ix,this.y-=ix,this},subVectors:function(ix,nx){return this.x=ix.x-nx.x,this.y=ix.y-nx.y,this},multiply:function(ix){return this.x*=ix.x,this.y*=ix.y,this},multiplyScalar:function(ix){return this.x*=ix,this.y*=ix,this},divide:function(ix){return this.x/=ix.x,this.y/=ix.y,this},divideScalar:function(ix){return this.multiplyScalar(1/ix)},applyMatrix3:function(ix){var nx=this.x,sx=this.y,dx=ix.elements;return this.x=dx[0]*nx+dx[3]*sx+dx[6],this.y=dx[1]*nx+dx[4]*sx+dx[7],this},min:function(ix){return this.x=Math.min(this.x,ix.x),this.y=Math.min(this.y,ix.y),this},max:function(ix){return this.x=Math.max(this.x,ix.x),this.y=Math.max(this.y,ix.y),this},clamp:function(ix,nx){return this.x=Math.max(ix.x,Math.min(nx.x,this.x)),this.y=Math.max(ix.y,Math.min(nx.y,this.y)),this},clampScalar:function(){var ix=new od,nx=new od;return function(sx,dx){return ix.set(sx,sx),nx.set(dx,dx),this.clamp(ix,nx)}}(),clampLength:function(ix,nx){var sx=this.length();return this.divideScalar(sx||1).multiplyScalar(Math.max(ix,Math.min(nx,sx)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x),this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(ix){return this.x*ix.x+this.y*ix.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){var ix=Math.atan2(this.y,this.x);return 0>ix&&(ix+=2*Math.PI),ix},distanceTo:function(ix){return Math.sqrt(this.distanceToSquared(ix))},distanceToSquared:function(ix){var nx=this.x-ix.x,sx=this.y-ix.y;return nx*nx+sx*sx},manhattanDistanceTo:function(ix){return Math.abs(this.x-ix.x)+Math.abs(this.y-ix.y)},setLength:function(ix){return this.normalize().multiplyScalar(ix)},lerp:function(ix,nx){return this.x+=(ix.x-this.x)*nx,this.y+=(ix.y-this.y)*nx,this},lerpVectors:function(ix,nx,sx){return this.subVectors(nx,ix).multiplyScalar(sx).add(ix)},equals:function(ix){return ix.x===this.x&&ix.y===this.y},fromArray:function(ix,nx){return void 0===nx&&(nx=0),this.x=ix[nx],this.y=ix[nx+1],this},toArray:function(ix,nx){return void 0===ix&&(ix=[]),void 0===nx&&(nx=0),ix[nx]=this.x,ix[nx+1]=this.y,ix},fromBufferAttribute:function(ix,nx,sx){return void 0!==sx&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=ix.getX(nx),this.y=ix.getY(nx),this},rotateAround:function(ix,nx){var sx=Math.cos(nx),dx=Math.sin(nx),lx=this.x-ix.x,px=this.y-ix.y;return this.x=lx*sx-px*dx+ix.x,this.y=lx*dx+px*sx+ix.y,this}}),Object.assign(id.prototype,{isMatrix4:!0,set:function(ix,nx,sx,dx,lx,px,cx,mx,ux,gx,hx,fx,yx,xx,vx,Lx){var bx=this.elements;return bx[0]=ix,bx[4]=nx,bx[8]=sx,bx[12]=dx,bx[1]=lx,bx[5]=px,bx[9]=cx,bx[13]=mx,bx[2]=ux,bx[6]=gx,bx[10]=hx,bx[14]=fx,bx[3]=yx,bx[7]=xx,bx[11]=vx,bx[15]=Lx,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return new id().fromArray(this.elements)},copy:function(ix){var nx=this.elements,sx=ix.elements;return nx[0]=sx[0],nx[1]=sx[1],nx[2]=sx[2],nx[3]=sx[3],nx[4]=sx[4],nx[5]=sx[5],nx[6]=sx[6],nx[7]=sx[7],nx[8]=sx[8],nx[9]=sx[9],nx[10]=sx[10],nx[11]=sx[11],nx[12]=sx[12],nx[13]=sx[13],nx[14]=sx[14],nx[15]=sx[15],this},copyPosition:function(ix){var nx=this.elements,sx=ix.elements;return nx[12]=sx[12],nx[13]=sx[13],nx[14]=sx[14],this},extractBasis:function(ix,nx,sx){return ix.setFromMatrixColumn(this,0),nx.setFromMatrixColumn(this,1),sx.setFromMatrixColumn(this,2),this},makeBasis:function(ix,nx,sx){return this.set(ix.x,nx.x,sx.x,0,ix.y,nx.y,sx.y,0,ix.z,nx.z,sx.z,0,0,0,0,1),this},extractRotation:function(){var ix=new sd;return function(nx){var sx=this.elements,dx=nx.elements,lx=1/ix.setFromMatrixColumn(nx,0).length(),px=1/ix.setFromMatrixColumn(nx,1).length(),cx=1/ix.setFromMatrixColumn(nx,2).length();return sx[0]=dx[0]*lx,sx[1]=dx[1]*lx,sx[2]=dx[2]*lx,sx[4]=dx[4]*px,sx[5]=dx[5]*px,sx[6]=dx[6]*px,sx[8]=dx[8]*cx,sx[9]=dx[9]*cx,sx[10]=dx[10]*cx,this}}(),makeRotationFromEuler:function(ix){ix&&ix.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var nx=this.elements,sx=ix.x,dx=ix.y,lx=ix.z,px=Math.cos(sx),cx=Math.sin(sx),mx=Math.cos(dx),ux=Math.sin(dx),gx=Math.cos(lx),hx=Math.sin(lx);if("XYZ"===ix.order){var fx=px*gx,yx=px*hx,xx=cx*gx,vx=cx*hx;nx[0]=mx*gx,nx[4]=-mx*hx,nx[8]=ux,nx[1]=yx+xx*ux,nx[5]=fx-vx*ux,nx[9]=-cx*mx,nx[2]=vx-fx*ux,nx[6]=xx+yx*ux,nx[10]=px*mx}else if("YXZ"===ix.order){var Lx=mx*gx,bx=mx*hx,_x=ux*gx,Ax=ux*hx;nx[0]=Lx+Ax*cx,nx[4]=_x*cx-bx,nx[8]=px*ux,nx[1]=px*hx,nx[5]=px*gx,nx[9]=-cx,nx[2]=bx*cx-_x,nx[6]=Ax+Lx*cx,nx[10]=px*mx}else if("ZXY"===ix.order)Lx=mx*gx,bx=mx*hx,_x=ux*gx,Ax=ux*hx,nx[0]=Lx-Ax*cx,nx[4]=-px*hx,nx[8]=_x+bx*cx,nx[1]=bx+_x*cx,nx[5]=px*gx,nx[9]=Ax-Lx*cx,nx[2]=-px*ux,nx[6]=cx,nx[10]=px*mx;else if("ZYX"===ix.order)fx=px*gx,yx=px*hx,xx=cx*gx,vx=cx*hx,nx[0]=mx*gx,nx[4]=xx*ux-yx,nx[8]=fx*ux+vx,nx[1]=mx*hx,nx[5]=vx*ux+fx,nx[9]=yx*ux-xx,nx[2]=-ux,nx[6]=cx*mx,nx[10]=px*mx;else if("YZX"===ix.order){var Ex=px*mx,Sx=px*ux,Tx=cx*mx,Mx=cx*ux;nx[0]=mx*gx,nx[4]=Mx-Ex*hx,nx[8]=Tx*hx+Sx,nx[1]=hx,nx[5]=px*gx,nx[9]=-cx*gx,nx[2]=-ux*gx,nx[6]=Sx*hx+Tx,nx[10]=Ex-Mx*hx}else"XZY"===ix.order&&(Ex=px*mx,Sx=px*ux,Tx=cx*mx,Mx=cx*ux,nx[0]=mx*gx,nx[4]=-hx,nx[8]=ux*gx,nx[1]=Ex*hx+Mx,nx[5]=px*gx,nx[9]=Sx*hx-Tx,nx[2]=Tx*hx-Sx,nx[6]=cx*gx,nx[10]=Mx*hx+Ex);return nx[3]=0,nx[7]=0,nx[11]=0,nx[12]=0,nx[13]=0,nx[14]=0,nx[15]=1,this},makeRotationFromQuaternion:function(ix){var nx=this.elements,sx=ix._x,dx=ix._y,lx=ix._z,px=ix._w,cx=sx+sx,mx=dx+dx,ux=lx+lx,gx=sx*cx,hx=sx*mx,fx=sx*ux,yx=dx*mx,xx=dx*ux,vx=lx*ux,Lx=px*cx,bx=px*mx,_x=px*ux;return nx[0]=1-(yx+vx),nx[4]=hx-_x,nx[8]=fx+bx,nx[1]=hx+_x,nx[5]=1-(gx+vx),nx[9]=xx-Lx,nx[2]=fx-bx,nx[6]=xx+Lx,nx[10]=1-(gx+yx),nx[3]=0,nx[7]=0,nx[11]=0,nx[12]=0,nx[13]=0,nx[14]=0,nx[15]=1,this},lookAt:function(){var ix=new sd,nx=new sd,sx=new sd;return function(dx,lx,px){var cx=this.elements;return sx.subVectors(dx,lx),0===sx.lengthSq()&&(sx.z=1),sx.normalize(),ix.crossVectors(px,sx),0===ix.lengthSq()&&(1===Math.abs(px.z)?sx.x+=1e-4:sx.z+=1e-4,sx.normalize(),ix.crossVectors(px,sx)),ix.normalize(),nx.crossVectors(sx,ix),cx[0]=ix.x,cx[4]=nx.x,cx[8]=sx.x,cx[1]=ix.y,cx[5]=nx.y,cx[9]=sx.y,cx[2]=ix.z,cx[6]=nx.z,cx[10]=sx.z,this}}(),multiply:function(ix,nx){return void 0===nx?this.multiplyMatrices(this,ix):(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(ix,nx))},premultiply:function(ix){return this.multiplyMatrices(ix,this)},multiplyMatrices:function(ix,nx){var sx=ix.elements,dx=nx.elements,lx=this.elements,px=sx[0],cx=sx[4],mx=sx[8],ux=sx[12],gx=sx[1],hx=sx[5],fx=sx[9],yx=sx[13],xx=sx[2],vx=sx[6],Lx=sx[10],bx=sx[14],_x=sx[3],Ax=sx[7],Ex=sx[11],Sx=sx[15],Tx=dx[0],Mx=dx[4],wx=dx[8],Rx=dx[12],Px=dx[1],Cx=dx[5],Ox=dx[9],Ix=dx[13],Dx=dx[2],Fx=dx[6],Bx=dx[10],Ux=dx[14],Nx=dx[3],Wx=dx[7],zx=dx[11],Hx=dx[15];return lx[0]=px*Tx+cx*Px+mx*Dx+ux*Nx,lx[4]=px*Mx+cx*Cx+mx*Fx+ux*Wx,lx[8]=px*wx+cx*Ox+mx*Bx+ux*zx,lx[12]=px*Rx+cx*Ix+mx*Ux+ux*Hx,lx[1]=gx*Tx+hx*Px+fx*Dx+yx*Nx,lx[5]=gx*Mx+hx*Cx+fx*Fx+yx*Wx,lx[9]=gx*wx+hx*Ox+fx*Bx+yx*zx,lx[13]=gx*Rx+hx*Ix+fx*Ux+yx*Hx,lx[2]=xx*Tx+vx*Px+Lx*Dx+bx*Nx,lx[6]=xx*Mx+vx*Cx+Lx*Fx+bx*Wx,lx[10]=xx*wx+vx*Ox+Lx*Bx+bx*zx,lx[14]=xx*Rx+vx*Ix+Lx*Ux+bx*Hx,lx[3]=_x*Tx+Ax*Px+Ex*Dx+Sx*Nx,lx[7]=_x*Mx+Ax*Cx+Ex*Fx+Sx*Wx,lx[11]=_x*wx+Ax*Ox+Ex*Bx+Sx*zx,lx[15]=_x*Rx+Ax*Ix+Ex*Ux+Sx*Hx,this},multiplyScalar:function(ix){var nx=this.elements;return nx[0]*=ix,nx[4]*=ix,nx[8]*=ix,nx[12]*=ix,nx[1]*=ix,nx[5]*=ix,nx[9]*=ix,nx[13]*=ix,nx[2]*=ix,nx[6]*=ix,nx[10]*=ix,nx[14]*=ix,nx[3]*=ix,nx[7]*=ix,nx[11]*=ix,nx[15]*=ix,this},applyToBufferAttribute:function(){var ix=new sd;return function(nx){for(var sx=0,dx=nx.count;sx<dx;sx++)ix.x=nx.getX(sx),ix.y=nx.getY(sx),ix.z=nx.getZ(sx),ix.applyMatrix4(this),nx.setXYZ(sx,ix.x,ix.y,ix.z);return nx}}(),determinant:function(){var ix=this.elements,nx=ix[0],sx=ix[4],dx=ix[8],lx=ix[12],px=ix[1],cx=ix[5],mx=ix[9],ux=ix[13],gx=ix[2],hx=ix[6],fx=ix[10],yx=ix[14];return ix[3]*(+lx*mx*hx-dx*ux*hx-lx*cx*fx+sx*ux*fx+dx*cx*yx-sx*mx*yx)+ix[7]*(+nx*mx*yx-nx*ux*fx+lx*px*fx-dx*px*yx+dx*ux*gx-lx*mx*gx)+ix[11]*(+nx*ux*hx-nx*cx*yx-lx*px*hx+sx*px*yx+lx*cx*gx-sx*ux*gx)+ix[15]*(-dx*cx*gx-nx*mx*hx+nx*cx*fx+dx*px*hx-sx*px*fx+sx*mx*gx)},transpose:function(){var nx=this.elements,ix;return ix=nx[1],nx[1]=nx[4],nx[4]=ix,ix=nx[2],nx[2]=nx[8],nx[8]=ix,ix=nx[6],nx[6]=nx[9],nx[9]=ix,ix=nx[3],nx[3]=nx[12],nx[12]=ix,ix=nx[7],nx[7]=nx[13],nx[13]=ix,ix=nx[11],nx[11]=nx[14],nx[14]=ix,this},setPosition:function(ix){var nx=this.elements;return nx[12]=ix.x,nx[13]=ix.y,nx[14]=ix.z,this},getInverse:function(ix,nx){var sx=this.elements,dx=ix.elements,lx=dx[0],px=dx[1],cx=dx[2],mx=dx[3],ux=dx[4],gx=dx[5],hx=dx[6],fx=dx[7],yx=dx[8],xx=dx[9],vx=dx[10],Lx=dx[11],bx=dx[12],_x=dx[13],Ax=dx[14],Ex=dx[15],Sx=xx*Ax*fx-_x*vx*fx+_x*hx*Lx-gx*Ax*Lx-xx*hx*Ex+gx*vx*Ex,Tx=bx*vx*fx-yx*Ax*fx-bx*hx*Lx+ux*Ax*Lx+yx*hx*Ex-ux*vx*Ex,Mx=yx*_x*fx-bx*xx*fx+bx*gx*Lx-ux*_x*Lx-yx*gx*Ex+ux*xx*Ex,wx=bx*xx*hx-yx*_x*hx-bx*gx*vx+ux*_x*vx+yx*gx*Ax-ux*xx*Ax,Rx=lx*Sx+px*Tx+cx*Mx+mx*wx;if(0==Rx){var Px="THREE.Matrix4: .getInverse() can't invert matrix, determinant is 0";if(!0===nx)throw new Error(Px);return console.warn(Px),this.identity()}var Cx=1/Rx;return sx[0]=Sx*Cx,sx[1]=(_x*vx*mx-xx*Ax*mx-_x*cx*Lx+px*Ax*Lx+xx*cx*Ex-px*vx*Ex)*Cx,sx[2]=(gx*Ax*mx-_x*hx*mx+_x*cx*fx-px*Ax*fx-gx*cx*Ex+px*hx*Ex)*Cx,sx[3]=(xx*hx*mx-gx*vx*mx-xx*cx*fx+px*vx*fx+gx*cx*Lx-px*hx*Lx)*Cx,sx[4]=Tx*Cx,sx[5]=(yx*Ax*mx-bx*vx*mx+bx*cx*Lx-lx*Ax*Lx-yx*cx*Ex+lx*vx*Ex)*Cx,sx[6]=(bx*hx*mx-ux*Ax*mx-bx*cx*fx+lx*Ax*fx+ux*cx*Ex-lx*hx*Ex)*Cx,sx[7]=(ux*vx*mx-yx*hx*mx+yx*cx*fx-lx*vx*fx-ux*cx*Lx+lx*hx*Lx)*Cx,sx[8]=Mx*Cx,sx[9]=(bx*xx*mx-yx*_x*mx-bx*px*Lx+lx*_x*Lx+yx*px*Ex-lx*xx*Ex)*Cx,sx[10]=(ux*_x*mx-bx*gx*mx+bx*px*fx-lx*_x*fx-ux*px*Ex+lx*gx*Ex)*Cx,sx[11]=(yx*gx*mx-ux*xx*mx-yx*px*fx+lx*xx*fx+ux*px*Lx-lx*gx*Lx)*Cx,sx[12]=wx*Cx,sx[13]=(yx*_x*cx-bx*xx*cx+bx*px*vx-lx*_x*vx-yx*px*Ax+lx*xx*Ax)*Cx,sx[14]=(bx*gx*cx-ux*_x*cx-bx*px*hx+lx*_x*hx+ux*px*Ax-lx*gx*Ax)*Cx,sx[15]=(ux*xx*cx-yx*gx*cx+yx*px*hx-lx*xx*hx-ux*px*vx+lx*gx*vx)*Cx,this},scale:function(ix){var nx=this.elements,sx=ix.x,dx=ix.y,lx=ix.z;return nx[0]*=sx,nx[4]*=dx,nx[8]*=lx,nx[1]*=sx,nx[5]*=dx,nx[9]*=lx,nx[2]*=sx,nx[6]*=dx,nx[10]*=lx,nx[3]*=sx,nx[7]*=dx,nx[11]*=lx,this},getMaxScaleOnAxis:function(){var ix=this.elements,nx=ix[0]*ix[0]+ix[1]*ix[1]+ix[2]*ix[2],sx=ix[4]*ix[4]+ix[5]*ix[5]+ix[6]*ix[6],dx=ix[8]*ix[8]+ix[9]*ix[9]+ix[10]*ix[10];return Math.sqrt(Math.max(nx,sx,dx))},makeTranslation:function(ix,nx,sx){return this.set(1,0,0,ix,0,1,0,nx,0,0,1,sx,0,0,0,1),this},makeRotationX:function(ix){var nx=Math.cos(ix),sx=Math.sin(ix);return this.set(1,0,0,0,0,nx,-sx,0,0,sx,nx,0,0,0,0,1),this},makeRotationY:function(ix){var nx=Math.cos(ix),sx=Math.sin(ix);return this.set(nx,0,sx,0,0,1,0,0,-sx,0,nx,0,0,0,0,1),this},makeRotationZ:function(ix){var nx=Math.cos(ix),sx=Math.sin(ix);return this.set(nx,-sx,0,0,sx,nx,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(ix,nx){var sx=Math.cos(nx),dx=Math.sin(nx),lx=1-sx,px=ix.x,cx=ix.y,mx=ix.z,ux=lx*px,gx=lx*cx;return this.set(ux*px+sx,ux*cx-dx*mx,ux*mx+dx*cx,0,ux*cx+dx*mx,gx*cx+sx,gx*mx-dx*px,0,ux*mx-dx*cx,gx*mx+dx*px,lx*mx*mx+sx,0,0,0,0,1),this},makeScale:function(ix,nx,sx){return this.set(ix,0,0,0,0,nx,0,0,0,0,sx,0,0,0,0,1),this},makeShear:function(ix,nx,sx){return this.set(1,nx,sx,0,ix,1,sx,0,ix,nx,1,0,0,0,0,1),this},compose:function(ix,nx,sx){return this.makeRotationFromQuaternion(nx),this.scale(sx),this.setPosition(ix),this},decompose:function(){var ix=new sd,nx=new id;return function(sx,dx,lx){var px=this.elements,cx=ix.set(px[0],px[1],px[2]).length(),mx=ix.set(px[4],px[5],px[6]).length(),ux=ix.set(px[8],px[9],px[10]).length();0>this.determinant()&&(cx=-cx),sx.x=px[12],sx.y=px[13],sx.z=px[14],nx.copy(this);var gx=1/cx,hx=1/mx,fx=1/ux;return nx.elements[0]*=gx,nx.elements[1]*=gx,nx.elements[2]*=gx,nx.elements[4]*=hx,nx.elements[5]*=hx,nx.elements[6]*=hx,nx.elements[8]*=fx,nx.elements[9]*=fx,nx.elements[10]*=fx,dx.setFromRotationMatrix(nx),lx.x=cx,lx.y=mx,lx.z=ux,this}}(),makePerspective:function(ix,nx,sx,dx,lx,px){void 0===px&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var cx=this.elements;return cx[0]=2*lx/(nx-ix),cx[4]=0,cx[8]=(nx+ix)/(nx-ix),cx[12]=0,cx[1]=0,cx[5]=2*lx/(sx-dx),cx[9]=(sx+dx)/(sx-dx),cx[13]=0,cx[2]=0,cx[6]=0,cx[10]=-(px+lx)/(px-lx),cx[14]=-2*px*lx/(px-lx),cx[3]=0,cx[7]=0,cx[11]=-1,cx[15]=0,this},makeOrthographic:function(ix,nx,sx,dx,lx,px){var cx=this.elements,mx=1/(nx-ix),ux=1/(sx-dx),gx=1/(px-lx);return cx[0]=2*mx,cx[4]=0,cx[8]=0,cx[12]=-((nx+ix)*mx),cx[1]=0,cx[5]=2*ux,cx[9]=0,cx[13]=-((sx+dx)*ux),cx[2]=0,cx[6]=0,cx[10]=-2*gx,cx[14]=-((px+lx)*gx),cx[3]=0,cx[7]=0,cx[11]=0,cx[15]=1,this},equals:function(ix){for(var nx=this.elements,sx=ix.elements,dx=0;16>dx;dx++)if(nx[dx]!==sx[dx])return!1;return!0},fromArray:function(ix,nx){void 0===nx&&(nx=0);for(var sx=0;16>sx;sx++)this.elements[sx]=ix[sx+nx];return this},toArray:function(ix,nx){void 0===ix&&(ix=[]),void 0===nx&&(nx=0);var sx=this.elements;return ix[nx]=sx[0],ix[nx+1]=sx[1],ix[nx+2]=sx[2],ix[nx+3]=sx[3],ix[nx+4]=sx[4],ix[nx+5]=sx[5],ix[nx+6]=sx[6],ix[nx+7]=sx[7],ix[nx+8]=sx[8],ix[nx+9]=sx[9],ix[nx+10]=sx[10],ix[nx+11]=sx[11],ix[nx+12]=sx[12],ix[nx+13]=sx[13],ix[nx+14]=sx[14],ix[nx+15]=sx[15],ix}}),Object.assign(nd,{slerp:function(ix,nx,sx,dx){return sx.copy(ix).slerp(nx,dx)},slerpFlat:function(ix,nx,sx,dx,lx,px,cx){var mx=sx[dx+0],ux=sx[dx+1],gx=sx[dx+2],hx=sx[dx+3],fx=lx[px+0],yx=lx[px+1],xx=lx[px+2],vx=lx[px+3];if(hx!==vx||mx!==fx||ux!==yx||gx!==xx){var Lx=1-cx,bx=mx*fx+ux*yx+gx*xx+hx*vx,_x=0<=bx?1:-1,Ax=1-bx*bx;if(Ax>Number.EPSILON){var Ex=Math.sqrt(Ax),Sx=Math.atan2(Ex,bx*_x);Lx=Math.sin(Lx*Sx)/Ex,cx=Math.sin(cx*Sx)/Ex}var Tx=cx*_x;if(mx=mx*Lx+fx*Tx,ux=ux*Lx+yx*Tx,gx=gx*Lx+xx*Tx,hx=hx*Lx+vx*Tx,Lx==1-cx){var Mx=1/Math.sqrt(mx*mx+ux*ux+gx*gx+hx*hx);mx*=Mx,ux*=Mx,gx*=Mx,hx*=Mx}}ix[nx]=mx,ix[nx+1]=ux,ix[nx+2]=gx,ix[nx+3]=hx}}),Object.defineProperties(nd.prototype,{x:{get:function(){return this._x},set:function(ix){this._x=ix,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(ix){this._y=ix,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(ix){this._z=ix,this.onChangeCallback()}},w:{get:function(){return this._w},set:function(ix){this._w=ix,this.onChangeCallback()}}}),Object.assign(nd.prototype,{set:function(ix,nx,sx,dx){return this._x=ix,this._y=nx,this._z=sx,this._w=dx,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(ix){return this._x=ix.x,this._y=ix.y,this._z=ix.z,this._w=ix.w,this.onChangeCallback(),this},setFromEuler:function(ix,nx){if(!ix||!ix.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var sx=ix._x,dx=ix._y,lx=ix._z,px=ix.order,cx=Math.cos,mx=Math.sin,ux=cx(sx/2),gx=cx(dx/2),hx=cx(lx/2),fx=mx(sx/2),yx=mx(dx/2),xx=mx(lx/2);return"XYZ"===px?(this._x=fx*gx*hx+ux*yx*xx,this._y=ux*yx*hx-fx*gx*xx,this._z=ux*gx*xx+fx*yx*hx,this._w=ux*gx*hx-fx*yx*xx):"YXZ"===px?(this._x=fx*gx*hx+ux*yx*xx,this._y=ux*yx*hx-fx*gx*xx,this._z=ux*gx*xx-fx*yx*hx,this._w=ux*gx*hx+fx*yx*xx):"ZXY"===px?(this._x=fx*gx*hx-ux*yx*xx,this._y=ux*yx*hx+fx*gx*xx,this._z=ux*gx*xx+fx*yx*hx,this._w=ux*gx*hx-fx*yx*xx):"ZYX"===px?(this._x=fx*gx*hx-ux*yx*xx,this._y=ux*yx*hx+fx*gx*xx,this._z=ux*gx*xx-fx*yx*hx,this._w=ux*gx*hx+fx*yx*xx):"YZX"===px?(this._x=fx*gx*hx+ux*yx*xx,this._y=ux*yx*hx+fx*gx*xx,this._z=ux*gx*xx-fx*yx*hx,this._w=ux*gx*hx-fx*yx*xx):"XZY"===px&&(this._x=fx*gx*hx-ux*yx*xx,this._y=ux*yx*hx-fx*gx*xx,this._z=ux*gx*xx+fx*yx*hx,this._w=ux*gx*hx+fx*yx*xx),!1!==nx&&this.onChangeCallback(),this},setFromAxisAngle:function(ix,nx){var sx=nx/2,dx=Math.sin(sx);return this._x=ix.x*dx,this._y=ix.y*dx,this._z=ix.z*dx,this._w=Math.cos(sx),this.onChangeCallback(),this},setFromRotationMatrix:function(ix){var sx=ix.elements,dx=sx[0],lx=sx[4],px=sx[8],cx=sx[1],mx=sx[5],ux=sx[9],gx=sx[2],hx=sx[6],fx=sx[10],yx=dx+mx+fx,nx;return 0<yx?(nx=.5/Math.sqrt(yx+1),this._w=.25/nx,this._x=(hx-ux)*nx,this._y=(px-gx)*nx,this._z=(cx-lx)*nx):dx>mx&&dx>fx?(nx=2*Math.sqrt(1+dx-mx-fx),this._w=(hx-ux)/nx,this._x=.25*nx,this._y=(lx+cx)/nx,this._z=(px+gx)/nx):mx>fx?(nx=2*Math.sqrt(1+mx-dx-fx),this._w=(px-gx)/nx,this._x=(lx+cx)/nx,this._y=.25*nx,this._z=(ux+hx)/nx):(nx=2*Math.sqrt(1+fx-dx-mx),this._w=(cx-lx)/nx,this._x=(px+gx)/nx,this._y=(ux+hx)/nx,this._z=.25*nx),this.onChangeCallback(),this},setFromUnitVectors:function(){var nx=new sd,ix;return function(sx,dx){return void 0===nx&&(nx=new sd),1e-6>(ix=sx.dot(dx)+1)?(ix=0,Math.abs(sx.x)>Math.abs(sx.z)?nx.set(-sx.y,sx.x,0):nx.set(0,-sx.z,sx.y)):nx.crossVectors(sx,dx),this._x=nx.x,this._y=nx.y,this._z=nx.z,this._w=ix,this.normalize()}}(),inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this.onChangeCallback(),this},dot:function(ix){return this._x*ix._x+this._y*ix._y+this._z*ix._z+this._w*ix._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var ix=this.length();return 0===ix?(this._x=0,this._y=0,this._z=0,this._w=1):(ix=1/ix,this._x*=ix,this._y*=ix,this._z*=ix,this._w*=ix),this.onChangeCallback(),this},multiply:function(ix,nx){return void 0===nx?this.multiplyQuaternions(this,ix):(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(ix,nx))},premultiply:function(ix){return this.multiplyQuaternions(ix,this)},multiplyQuaternions:function(ix,nx){var sx=ix._x,dx=ix._y,lx=ix._z,px=ix._w,cx=nx._x,mx=nx._y,ux=nx._z,gx=nx._w;return this._x=sx*gx+px*cx+dx*ux-lx*mx,this._y=dx*gx+px*mx+lx*cx-sx*ux,this._z=lx*gx+px*ux+sx*mx-dx*cx,this._w=px*gx-sx*cx-dx*mx-lx*ux,this.onChangeCallback(),this},slerp:function(ix,nx){if(0===nx)return this;if(1===nx)return this.copy(ix);var sx=this._x,dx=this._y,lx=this._z,px=this._w,cx=px*ix._w+sx*ix._x+dx*ix._y+lx*ix._z;if(0>cx?(this._w=-ix._w,this._x=-ix._x,this._y=-ix._y,this._z=-ix._z,cx=-cx):this.copy(ix),1<=cx)return this._w=px,this._x=sx,this._y=dx,this._z=lx,this;var mx=Math.sqrt(1-cx*cx);if(.001>Math.abs(mx))return this._w=.5*(px+this._w),this._x=.5*(sx+this._x),this._y=.5*(dx+this._y),this._z=.5*(lx+this._z),this;var ux=Math.atan2(mx,cx),gx=Math.sin((1-nx)*ux)/mx,hx=Math.sin(nx*ux)/mx;return this._w=px*gx+this._w*hx,this._x=sx*gx+this._x*hx,this._y=dx*gx+this._y*hx,this._z=lx*gx+this._z*hx,this.onChangeCallback(),this},equals:function(ix){return ix._x===this._x&&ix._y===this._y&&ix._z===this._z&&ix._w===this._w},fromArray:function(ix,nx){return void 0===nx&&(nx=0),this._x=ix[nx],this._y=ix[nx+1],this._z=ix[nx+2],this._w=ix[nx+3],this.onChangeCallback(),this},toArray:function(ix,nx){return void 0===ix&&(ix=[]),void 0===nx&&(nx=0),ix[nx]=this._x,ix[nx+1]=this._y,ix[nx+2]=this._z,ix[nx+3]=this._w,ix},onChange:function(ix){return this.onChangeCallback=ix,this},onChangeCallback:function(){}}),Object.assign(sd.prototype,{isVector3:!0,set:function(ix,nx,sx){return this.x=ix,this.y=nx,this.z=sx,this},setScalar:function(ix){return this.x=ix,this.y=ix,this.z=ix,this},setX:function(ix){return this.x=ix,this},setY:function(ix){return this.y=ix,this},setZ:function(ix){return this.z=ix,this},setComponent:function(ix,nx){switch(ix){case 0:this.x=nx;break;case 1:this.y=nx;break;case 2:this.z=nx;break;default:throw new Error("index is out of range: "+ix);}return this},getComponent:function(ix){switch(ix){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+ix);}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(ix){return this.x=ix.x,this.y=ix.y,this.z=ix.z,this},add:function(ix,nx){return void 0===nx?(this.x+=ix.x,this.y+=ix.y,this.z+=ix.z,this):(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(ix,nx))},addScalar:function(ix){return this.x+=ix,this.y+=ix,this.z+=ix,this},addVectors:function(ix,nx){return this.x=ix.x+nx.x,this.y=ix.y+nx.y,this.z=ix.z+nx.z,this},addScaledVector:function(ix,nx){return this.x+=ix.x*nx,this.y+=ix.y*nx,this.z+=ix.z*nx,this},sub:function(ix,nx){return void 0===nx?(this.x-=ix.x,this.y-=ix.y,this.z-=ix.z,this):(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(ix,nx))},subScalar:function(ix){return this.x-=ix,this.y-=ix,this.z-=ix,this},subVectors:function(ix,nx){return this.x=ix.x-nx.x,this.y=ix.y-nx.y,this.z=ix.z-nx.z,this},multiply:function(ix,nx){return void 0===nx?(this.x*=ix.x,this.y*=ix.y,this.z*=ix.z,this):(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(ix,nx))},multiplyScalar:function(ix){return this.x*=ix,this.y*=ix,this.z*=ix,this},multiplyVectors:function(ix,nx){return this.x=ix.x*nx.x,this.y=ix.y*nx.y,this.z=ix.z*nx.z,this},applyEuler:function(){var ix=new nd;return function(nx){return nx&&nx.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(ix.setFromEuler(nx))}}(),applyAxisAngle:function(){var ix=new nd;return function(nx,sx){return this.applyQuaternion(ix.setFromAxisAngle(nx,sx))}}(),applyMatrix3:function(ix){var nx=this.x,sx=this.y,dx=this.z,lx=ix.elements;return this.x=lx[0]*nx+lx[3]*sx+lx[6]*dx,this.y=lx[1]*nx+lx[4]*sx+lx[7]*dx,this.z=lx[2]*nx+lx[5]*sx+lx[8]*dx,this},applyMatrix4:function(ix){var nx=this.x,sx=this.y,dx=this.z,lx=ix.elements,px=1/(lx[3]*nx+lx[7]*sx+lx[11]*dx+lx[15]);return this.x=(lx[0]*nx+lx[4]*sx+lx[8]*dx+lx[12])*px,this.y=(lx[1]*nx+lx[5]*sx+lx[9]*dx+lx[13])*px,this.z=(lx[2]*nx+lx[6]*sx+lx[10]*dx+lx[14])*px,this},applyQuaternion:function(ix){var nx=this.x,sx=this.y,dx=this.z,lx=ix.x,px=ix.y,cx=ix.z,mx=ix.w,ux=mx*nx+px*dx-cx*sx,gx=mx*sx+cx*nx-lx*dx,hx=mx*dx+lx*sx-px*nx,fx=-lx*nx-px*sx-cx*dx;return this.x=ux*mx+fx*-lx+gx*-cx-hx*-px,this.y=gx*mx+fx*-px+hx*-lx-ux*-cx,this.z=hx*mx+fx*-cx+ux*-px-gx*-lx,this},project:function(){var ix=new id;return function(nx){return ix.multiplyMatrices(nx.projectionMatrix,ix.getInverse(nx.matrixWorld)),this.applyMatrix4(ix)}}(),unproject:function(){var ix=new id;return function(nx){return ix.multiplyMatrices(nx.matrixWorld,ix.getInverse(nx.projectionMatrix)),this.applyMatrix4(ix)}}(),transformDirection:function(ix){var nx=this.x,sx=this.y,dx=this.z,lx=ix.elements;return this.x=lx[0]*nx+lx[4]*sx+lx[8]*dx,this.y=lx[1]*nx+lx[5]*sx+lx[9]*dx,this.z=lx[2]*nx+lx[6]*sx+lx[10]*dx,this.normalize()},divide:function(ix){return this.x/=ix.x,this.y/=ix.y,this.z/=ix.z,this},divideScalar:function(ix){return this.multiplyScalar(1/ix)},min:function(ix){return this.x=Math.min(this.x,ix.x),this.y=Math.min(this.y,ix.y),this.z=Math.min(this.z,ix.z),this},max:function(ix){return this.x=Math.max(this.x,ix.x),this.y=Math.max(this.y,ix.y),this.z=Math.max(this.z,ix.z),this},clamp:function(ix,nx){return this.x=Math.max(ix.x,Math.min(nx.x,this.x)),this.y=Math.max(ix.y,Math.min(nx.y,this.y)),this.z=Math.max(ix.z,Math.min(nx.z,this.z)),this},clampScalar:function(){var ix=new sd,nx=new sd;return function(sx,dx){return ix.set(sx,sx,sx),nx.set(dx,dx,dx),this.clamp(ix,nx)}}(),clampLength:function(ix,nx){var sx=this.length();return this.divideScalar(sx||1).multiplyScalar(Math.max(ix,Math.min(nx,sx)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x),this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y),this.z=0>this.z?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(ix){return this.x*ix.x+this.y*ix.y+this.z*ix.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(ix){return this.normalize().multiplyScalar(ix)},lerp:function(ix,nx){return this.x+=(ix.x-this.x)*nx,this.y+=(ix.y-this.y)*nx,this.z+=(ix.z-this.z)*nx,this},lerpVectors:function(ix,nx,sx){return this.subVectors(nx,ix).multiplyScalar(sx).add(ix)},cross:function(ix,nx){return void 0===nx?this.crossVectors(this,ix):(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(ix,nx))},crossVectors:function(ix,nx){var sx=ix.x,dx=ix.y,lx=ix.z,px=nx.x,cx=nx.y,mx=nx.z;return this.x=dx*mx-lx*cx,this.y=lx*px-sx*mx,this.z=sx*cx-dx*px,this},projectOnVector:function(ix){var nx=ix.dot(this)/ix.lengthSq();return this.copy(ix).multiplyScalar(nx)},projectOnPlane:function(){var ix=new sd;return function(nx){return ix.copy(this).projectOnVector(nx),this.sub(ix)}}(),reflect:function(){var ix=new sd;return function(nx){return this.sub(ix.copy(nx).multiplyScalar(2*this.dot(nx)))}}(),angleTo:function(ix){var nx=this.dot(ix)/Math.sqrt(this.lengthSq()*ix.lengthSq());return Math.acos(uy.clamp(nx,-1,1))},distanceTo:function(ix){return Math.sqrt(this.distanceToSquared(ix))},distanceToSquared:function(ix){var nx=this.x-ix.x,sx=this.y-ix.y,dx=this.z-ix.z;return nx*nx+sx*sx+dx*dx},manhattanDistanceTo:function(ix){return Math.abs(this.x-ix.x)+Math.abs(this.y-ix.y)+Math.abs(this.z-ix.z)},setFromSpherical:function(ix){var nx=Math.sin(ix.phi)*ix.radius;return this.x=nx*Math.sin(ix.theta),this.y=Math.cos(ix.phi)*ix.radius,this.z=nx*Math.cos(ix.theta),this},setFromCylindrical:function(ix){return this.x=ix.radius*Math.sin(ix.theta),this.y=ix.y,this.z=ix.radius*Math.cos(ix.theta),this},setFromMatrixPosition:function(ix){var nx=ix.elements;return this.x=nx[12],this.y=nx[13],this.z=nx[14],this},setFromMatrixScale:function(ix){var nx=this.setFromMatrixColumn(ix,0).length(),sx=this.setFromMatrixColumn(ix,1).length(),dx=this.setFromMatrixColumn(ix,2).length();return this.x=nx,this.y=sx,this.z=dx,this},setFromMatrixColumn:function(ix,nx){return this.fromArray(ix.elements,4*nx)},equals:function(ix){return ix.x===this.x&&ix.y===this.y&&ix.z===this.z},fromArray:function(ix,nx){return void 0===nx&&(nx=0),this.x=ix[nx],this.y=ix[nx+1],this.z=ix[nx+2],this},toArray:function(ix,nx){return void 0===ix&&(ix=[]),void 0===nx&&(nx=0),ix[nx]=this.x,ix[nx+1]=this.y,ix[nx+2]=this.z,ix},fromBufferAttribute:function(ix,nx,sx){return void 0!==sx&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=ix.getX(nx),this.y=ix.getY(nx),this.z=ix.getZ(nx),this}}),Object.assign(dd.prototype,{isMatrix3:!0,set:function(ix,nx,sx,dx,lx,px,cx,mx,ux){var gx=this.elements;return gx[0]=ix,gx[1]=dx,gx[2]=cx,gx[3]=nx,gx[4]=lx,gx[5]=mx,gx[6]=sx,gx[7]=px,gx[8]=ux,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return new this.constructor().fromArray(this.elements)},copy:function(ix){var nx=this.elements,sx=ix.elements;return nx[0]=sx[0],nx[1]=sx[1],nx[2]=sx[2],nx[3]=sx[3],nx[4]=sx[4],nx[5]=sx[5],nx[6]=sx[6],nx[7]=sx[7],nx[8]=sx[8],this},setFromMatrix4:function(ix){var nx=ix.elements;return this.set(nx[0],nx[4],nx[8],nx[1],nx[5],nx[9],nx[2],nx[6],nx[10]),this},applyToBufferAttribute:function(){var ix=new sd;return function(nx){for(var sx=0,dx=nx.count;sx<dx;sx++)ix.x=nx.getX(sx),ix.y=nx.getY(sx),ix.z=nx.getZ(sx),ix.applyMatrix3(this),nx.setXYZ(sx,ix.x,ix.y,ix.z);return nx}}(),multiply:function(ix){return this.multiplyMatrices(this,ix)},premultiply:function(ix){return this.multiplyMatrices(ix,this)},multiplyMatrices:function(ix,nx){var sx=ix.elements,dx=nx.elements,lx=this.elements,px=sx[0],cx=sx[3],mx=sx[6],ux=sx[1],gx=sx[4],hx=sx[7],fx=sx[2],yx=sx[5],xx=sx[8],vx=dx[0],Lx=dx[3],bx=dx[6],_x=dx[1],Ax=dx[4],Ex=dx[7],Sx=dx[2],Tx=dx[5],Mx=dx[8];return lx[0]=px*vx+cx*_x+mx*Sx,lx[3]=px*Lx+cx*Ax+mx*Tx,lx[6]=px*bx+cx*Ex+mx*Mx,lx[1]=ux*vx+gx*_x+hx*Sx,lx[4]=ux*Lx+gx*Ax+hx*Tx,lx[7]=ux*bx+gx*Ex+hx*Mx,lx[2]=fx*vx+yx*_x+xx*Sx,lx[5]=fx*Lx+yx*Ax+xx*Tx,lx[8]=fx*bx+yx*Ex+xx*Mx,this},multiplyScalar:function(ix){var nx=this.elements;return nx[0]*=ix,nx[3]*=ix,nx[6]*=ix,nx[1]*=ix,nx[4]*=ix,nx[7]*=ix,nx[2]*=ix,nx[5]*=ix,nx[8]*=ix,this},determinant:function(){var ix=this.elements,nx=ix[0],sx=ix[1],dx=ix[2],lx=ix[3],px=ix[4],cx=ix[5],mx=ix[6],ux=ix[7],gx=ix[8];return nx*px*gx-nx*cx*ux-sx*lx*gx+sx*cx*mx+dx*lx*ux-dx*px*mx},getInverse:function(ix,nx){ix&&ix.isMatrix4&&console.error("THREE.Matrix3: .getInverse() no longer takes a Matrix4 argument.");var sx=ix.elements,dx=this.elements,lx=sx[0],px=sx[1],cx=sx[2],mx=sx[3],ux=sx[4],gx=sx[5],hx=sx[6],fx=sx[7],yx=sx[8],xx=yx*ux-gx*fx,vx=gx*hx-yx*mx,Lx=fx*mx-ux*hx,bx=lx*xx+px*vx+cx*Lx;if(0==bx){var _x="THREE.Matrix3: .getInverse() can't invert matrix, determinant is 0";if(!0===nx)throw new Error(_x);return console.warn(_x),this.identity()}var Ax=1/bx;return dx[0]=xx*Ax,dx[1]=(cx*fx-yx*px)*Ax,dx[2]=(gx*px-cx*ux)*Ax,dx[3]=vx*Ax,dx[4]=(yx*lx-cx*hx)*Ax,dx[5]=(cx*mx-gx*lx)*Ax,dx[6]=Lx*Ax,dx[7]=(px*hx-fx*lx)*Ax,dx[8]=(ux*lx-px*mx)*Ax,this},transpose:function(){var nx=this.elements,ix;return ix=nx[1],nx[1]=nx[3],nx[3]=ix,ix=nx[2],nx[2]=nx[6],nx[6]=ix,ix=nx[5],nx[5]=nx[7],nx[7]=ix,this},getNormalMatrix:function(ix){return this.setFromMatrix4(ix).getInverse(this).transpose()},transposeIntoArray:function(ix){var nx=this.elements;return ix[0]=nx[0],ix[1]=nx[3],ix[2]=nx[6],ix[3]=nx[1],ix[4]=nx[4],ix[5]=nx[7],ix[6]=nx[2],ix[7]=nx[5],ix[8]=nx[8],this},setUvTransform:function(ix,nx,sx,dx,lx,px,cx){var mx=Math.cos(lx),ux=Math.sin(lx);this.set(sx*mx,sx*ux,-sx*(mx*px+ux*cx)+px+ix,-dx*ux,dx*mx,-dx*(-ux*px+mx*cx)+cx+nx,0,0,1)},scale:function(ix,nx){var sx=this.elements;return sx[0]*=ix,sx[3]*=ix,sx[6]*=ix,sx[1]*=nx,sx[4]*=nx,sx[7]*=nx,this},rotate:function(ix){var nx=Math.cos(ix),sx=Math.sin(ix),dx=this.elements,lx=dx[0],px=dx[3],cx=dx[6],mx=dx[1],ux=dx[4],gx=dx[7];return dx[0]=nx*lx+sx*mx,dx[3]=nx*px+sx*ux,dx[6]=nx*cx+sx*gx,dx[1]=-sx*lx+nx*mx,dx[4]=-sx*px+nx*ux,dx[7]=-sx*cx+nx*gx,this},translate:function(ix,nx){var sx=this.elements;return sx[0]+=ix*sx[2],sx[3]+=ix*sx[5],sx[6]+=ix*sx[8],sx[1]+=nx*sx[2],sx[4]+=nx*sx[5],sx[7]+=nx*sx[8],this},equals:function(ix){for(var nx=this.elements,sx=ix.elements,dx=0;9>dx;dx++)if(nx[dx]!==sx[dx])return!1;return!0},fromArray:function(ix,nx){void 0===nx&&(nx=0);for(var sx=0;9>sx;sx++)this.elements[sx]=ix[sx+nx];return this},toArray:function(ix,nx){void 0===ix&&(ix=[]),void 0===nx&&(nx=0);var sx=this.elements;return ix[nx]=sx[0],ix[nx+1]=sx[1],ix[nx+2]=sx[2],ix[nx+3]=sx[3],ix[nx+4]=sx[4],ix[nx+5]=sx[5],ix[nx+6]=sx[6],ix[nx+7]=sx[7],ix[nx+8]=sx[8],ix}});var gy=0;ld.DEFAULT_IMAGE=void 0,ld.DEFAULT_MAPPING=Nh,ld.prototype=Object.assign(Object.create(rd.prototype),{constructor:ld,isTexture:!0,clone:function(){return new this.constructor().copy(this)},copy:function(ix){return this.name=ix.name,this.image=ix.image,this.mipmaps=ix.mipmaps.slice(0),this.mapping=ix.mapping,this.wrapS=ix.wrapS,this.wrapT=ix.wrapT,this.magFilter=ix.magFilter,this.minFilter=ix.minFilter,this.anisotropy=ix.anisotropy,this.format=ix.format,this.type=ix.type,this.offset.copy(ix.offset),this.repeat.copy(ix.repeat),this.center.copy(ix.center),this.rotation=ix.rotation,this.matrixAutoUpdate=ix.matrixAutoUpdate,this.matrix.copy(ix.matrix),this.generateMipmaps=ix.generateMipmaps,this.premultiplyAlpha=ix.premultiplyAlpha,this.flipY=ix.flipY,this.unpackAlignment=ix.unpackAlignment,this.encoding=ix.encoding,this},toJSON:function(ix){var nx=void 0===ix||"string"==typeof ix;if(!nx&&void 0!==ix.textures[this.uuid])return ix.textures[this.uuid];var sx={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY};if(void 0!==this.image){var dx=this.image;void 0===dx.uuid&&(dx.uuid=uy.generateUUID()),nx||void 0!==ix.images[dx.uuid]||(ix.images[dx.uuid]={uuid:dx.uuid,url:function(lx){var px;if(lx instanceof HTMLCanvasElement)px=lx;else{(px=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")).width=lx.width,px.height=lx.height;var cx=px.getContext("2d");lx instanceof ImageData?cx.putImageData(lx,0,0):cx.drawImage(lx,0,0,lx.width,lx.height)}return 2048<px.width||2048<px.height?px.toDataURL("image/jpeg",.6):px.toDataURL("image/png")}(dx)}),sx.image=dx.uuid}return nx||(ix.textures[this.uuid]=sx),sx},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(ix){if(this.mapping===Nh){if(ix.applyMatrix3(this.matrix),0>ix.x||1<ix.x)switch(this.wrapS){case Yh:ix.x-=Math.floor(ix.x);break;case Xh:ix.x=0>ix.x?0:1;break;case qh:1===Math.abs(Math.floor(ix.x)%2)?ix.x=Math.ceil(ix.x)-ix.x:ix.x-=Math.floor(ix.x);}if(0>ix.y||1<ix.y)switch(this.wrapT){case Yh:ix.y-=Math.floor(ix.y);break;case Xh:ix.y=0>ix.y?0:1;break;case qh:1===Math.abs(Math.floor(ix.y)%2)?ix.y=Math.ceil(ix.y)-ix.y:ix.y-=Math.floor(ix.y);}this.flipY&&(ix.y=1-ix.y)}}}),Object.defineProperty(ld.prototype,"needsUpdate",{set:function(ix){!0===ix&&this.version++}}),Object.assign(pd.prototype,{isVector4:!0,set:function(ix,nx,sx,dx){return this.x=ix,this.y=nx,this.z=sx,this.w=dx,this},setScalar:function(ix){return this.x=ix,this.y=ix,this.z=ix,this.w=ix,this},setX:function(ix){return this.x=ix,this},setY:function(ix){return this.y=ix,this},setZ:function(ix){return this.z=ix,this},setW:function(ix){return this.w=ix,this},setComponent:function(ix,nx){switch(ix){case 0:this.x=nx;break;case 1:this.y=nx;break;case 2:this.z=nx;break;case 3:this.w=nx;break;default:throw new Error("index is out of range: "+ix);}return this},getComponent:function(ix){switch(ix){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+ix);}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(ix){return this.x=ix.x,this.y=ix.y,this.z=ix.z,this.w=void 0===ix.w?1:ix.w,this},add:function(ix,nx){return void 0===nx?(this.x+=ix.x,this.y+=ix.y,this.z+=ix.z,this.w+=ix.w,this):(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(ix,nx))},addScalar:function(ix){return this.x+=ix,this.y+=ix,this.z+=ix,this.w+=ix,this},addVectors:function(ix,nx){return this.x=ix.x+nx.x,this.y=ix.y+nx.y,this.z=ix.z+nx.z,this.w=ix.w+nx.w,this},addScaledVector:function(ix,nx){return this.x+=ix.x*nx,this.y+=ix.y*nx,this.z+=ix.z*nx,this.w+=ix.w*nx,this},sub:function(ix,nx){return void 0===nx?(this.x-=ix.x,this.y-=ix.y,this.z-=ix.z,this.w-=ix.w,this):(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(ix,nx))},subScalar:function(ix){return this.x-=ix,this.y-=ix,this.z-=ix,this.w-=ix,this},subVectors:function(ix,nx){return this.x=ix.x-nx.x,this.y=ix.y-nx.y,this.z=ix.z-nx.z,this.w=ix.w-nx.w,this},multiplyScalar:function(ix){return this.x*=ix,this.y*=ix,this.z*=ix,this.w*=ix,this},applyMatrix4:function(ix){var nx=this.x,sx=this.y,dx=this.z,lx=this.w,px=ix.elements;return this.x=px[0]*nx+px[4]*sx+px[8]*dx+px[12]*lx,this.y=px[1]*nx+px[5]*sx+px[9]*dx+px[13]*lx,this.z=px[2]*nx+px[6]*sx+px[10]*dx+px[14]*lx,this.w=px[3]*nx+px[7]*sx+px[11]*dx+px[15]*lx,this},divideScalar:function(ix){return this.multiplyScalar(1/ix)},setAxisAngleFromQuaternion:function(ix){this.w=2*Math.acos(ix.w);var nx=Math.sqrt(1-ix.w*ix.w);return 1e-4>nx?(this.x=1,this.y=0,this.z=0):(this.x=ix.x/nx,this.y=ix.y/nx,this.z=ix.z/nx),this},setAxisAngleFromRotationMatrix:function(ix){var px=ix.elements,cx=px[0],mx=px[4],ux=px[8],gx=px[1],hx=px[5],fx=px[9],yx=px[2],xx=px[6],vx=px[10],nx,sx,dx,lx;if(.01>Math.abs(mx-gx)&&.01>Math.abs(ux-yx)&&.01>Math.abs(fx-xx)){if(.1>Math.abs(mx+gx)&&.1>Math.abs(ux+yx)&&.1>Math.abs(fx+xx)&&.1>Math.abs(cx+hx+vx-3))return this.set(1,0,0,0),this;nx=Math.PI;var Lx=(cx+1)/2,bx=(hx+1)/2,_x=(vx+1)/2,Ax=(mx+gx)/4,Ex=(ux+yx)/4,Sx=(fx+xx)/4;return Lx>bx&&Lx>_x?.01>Lx?(sx=0,dx=.707106781,lx=.707106781):(dx=Ax/(sx=Math.sqrt(Lx)),lx=Ex/sx):bx>_x?.01>bx?(sx=.707106781,dx=0,lx=.707106781):(sx=Ax/(dx=Math.sqrt(bx)),lx=Sx/dx):.01>_x?(sx=.707106781,dx=.707106781,lx=0):(sx=Ex/(lx=Math.sqrt(_x)),dx=Sx/lx),this.set(sx,dx,lx,nx),this}var Tx=Math.sqrt((xx-fx)*(xx-fx)+(ux-yx)*(ux-yx)+(gx-mx)*(gx-mx));return .001>Math.abs(Tx)&&(Tx=1),this.x=(xx-fx)/Tx,this.y=(ux-yx)/Tx,this.z=(gx-mx)/Tx,this.w=Math.acos((cx+hx+vx-1)/2),this},min:function(ix){return this.x=Math.min(this.x,ix.x),this.y=Math.min(this.y,ix.y),this.z=Math.min(this.z,ix.z),this.w=Math.min(this.w,ix.w),this},max:function(ix){return this.x=Math.max(this.x,ix.x),this.y=Math.max(this.y,ix.y),this.z=Math.max(this.z,ix.z),this.w=Math.max(this.w,ix.w),this},clamp:function(ix,nx){return this.x=Math.max(ix.x,Math.min(nx.x,this.x)),this.y=Math.max(ix.y,Math.min(nx.y,this.y)),this.z=Math.max(ix.z,Math.min(nx.z,this.z)),this.w=Math.max(ix.w,Math.min(nx.w,this.w)),this},clampScalar:function(){var ix,nx;return function(sx,dx){return void 0===ix&&(ix=new pd,nx=new pd),ix.set(sx,sx,sx,sx),nx.set(dx,dx,dx,dx),this.clamp(ix,nx)}}(),clampLength:function(ix,nx){var sx=this.length();return this.divideScalar(sx||1).multiplyScalar(Math.max(ix,Math.min(nx,sx)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x),this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y),this.z=0>this.z?Math.ceil(this.z):Math.floor(this.z),this.w=0>this.w?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(ix){return this.x*ix.x+this.y*ix.y+this.z*ix.z+this.w*ix.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(ix){return this.normalize().multiplyScalar(ix)},lerp:function(ix,nx){return this.x+=(ix.x-this.x)*nx,this.y+=(ix.y-this.y)*nx,this.z+=(ix.z-this.z)*nx,this.w+=(ix.w-this.w)*nx,this},lerpVectors:function(ix,nx,sx){return this.subVectors(nx,ix).multiplyScalar(sx).add(ix)},equals:function(ix){return ix.x===this.x&&ix.y===this.y&&ix.z===this.z&&ix.w===this.w},fromArray:function(ix,nx){return void 0===nx&&(nx=0),this.x=ix[nx],this.y=ix[nx+1],this.z=ix[nx+2],this.w=ix[nx+3],this},toArray:function(ix,nx){return void 0===ix&&(ix=[]),void 0===nx&&(nx=0),ix[nx]=this.x,ix[nx+1]=this.y,ix[nx+2]=this.z,ix[nx+3]=this.w,ix},fromBufferAttribute:function(ix,nx,sx){return void 0!==sx&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=ix.getX(nx),this.y=ix.getY(nx),this.z=ix.getZ(nx),this.w=ix.getW(nx),this}}),cd.prototype=Object.assign(Object.create(rd.prototype),{constructor:cd,isWebGLRenderTarget:!0,setSize:function(ix,nx){this.width===ix&&this.height===nx||(this.width=ix,this.height=nx,this.dispose()),this.viewport.set(0,0,ix,nx),this.scissor.set(0,0,ix,nx)},clone:function(){return new this.constructor().copy(this)},copy:function(ix){return this.width=ix.width,this.height=ix.height,this.viewport.copy(ix.viewport),this.texture=ix.texture.clone(),this.depthBuffer=ix.depthBuffer,this.stencilBuffer=ix.stencilBuffer,this.depthTexture=ix.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),md.prototype=Object.create(cd.prototype),md.prototype.constructor=md,md.prototype.isWebGLRenderTargetCube=!0,ud.prototype=Object.create(ld.prototype),ud.prototype.constructor=ud,ud.prototype.isDataTexture=!0,gd.prototype=Object.create(ld.prototype),gd.prototype.constructor=gd,gd.prototype.isCubeTexture=!0,Object.defineProperty(gd.prototype,"images",{get:function(){return this.image},set:function(ix){this.image=ix}});var hy=new ld,fy=new gd,yy=[],xy=[],vy=new Float32Array(16),Ly=new Float32Array(9);Vd.prototype.setValue=function(ix,nx){for(var sx=this.seq,dx=0,lx=sx.length,px;dx!==lx;++dx)px=sx[dx],px.setValue(ix,nx[px.id])};var by=/([\w\d_]+)(\])?(\[|\.)?/g;Yd.prototype.setValue=function(ix,nx,sx){var dx=this.map[nx];void 0!==dx&&dx.setValue(ix,sx,this.renderer)},Yd.prototype.setOptional=function(ix,nx,sx){var dx=nx[sx];void 0!==dx&&this.setValue(ix,sx,dx)},Yd.upload=function(ix,nx,sx,dx){for(var lx=0,px=nx.length;lx!==px;++lx){var cx=nx[lx],mx=sx[cx.id];!1!==mx.needsUpdate&&cx.setValue(ix,mx.value,dx)}},Yd.seqWithValue=function(ix,nx){for(var sx=[],dx=0,lx=ix.length,px;dx!==lx;++dx)px=ix[dx],px.id in nx&&sx.push(px);return sx};var _y={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Object.assign(Xd.prototype,{isColor:!0,r:1,g:1,b:1,set:function(ix){return ix&&ix.isColor?this.copy(ix):"number"==typeof ix?this.setHex(ix):"string"==typeof ix&&this.setStyle(ix),this},setScalar:function(ix){return this.r=ix,this.g=ix,this.b=ix,this},setHex:function(ix){return ix=Math.floor(ix),this.r=(255&ix>>16)/255,this.g=(255&ix>>8)/255,this.b=(255&ix)/255,this},setRGB:function(ix,nx,sx){return this.r=ix,this.g=nx,this.b=sx,this},setHSL:function(){function ix(nx,sx,dx){return 0>dx&&(dx+=1),1<dx&&(dx-=1),dx<1/6?nx+6*(sx-nx)*dx:.5>dx?sx:dx<2/3?nx+6*(sx-nx)*(2/3-dx):nx}return function(nx,sx,dx){if(nx=uy.euclideanModulo(nx,1),sx=uy.clamp(sx,0,1),dx=uy.clamp(dx,0,1),0===sx)this.r=this.g=this.b=dx;else{var lx=.5>=dx?dx*(1+sx):dx+sx-dx*sx,px=2*dx-lx;this.r=ix(px,lx,nx+1/3),this.g=ix(px,lx,nx),this.b=ix(px,lx,nx-1/3)}return this}}(),setStyle:function(ix){function nx(fx){void 0!==fx&&1>parseFloat(fx)&&console.warn("THREE.Color: Alpha component of "+ix+" will be ignored.")}var sx;if(sx=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(ix)){var lx=sx[1],px=sx[2],dx;switch(lx){case"rgb":case"rgba":if(dx=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(px))return this.r=Math.min(255,parseInt(dx[1],10))/255,this.g=Math.min(255,parseInt(dx[2],10))/255,this.b=Math.min(255,parseInt(dx[3],10))/255,nx(dx[5]),this;if(dx=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(px))return this.r=Math.min(100,parseInt(dx[1],10))/100,this.g=Math.min(100,parseInt(dx[2],10))/100,this.b=Math.min(100,parseInt(dx[3],10))/100,nx(dx[5]),this;break;case"hsl":case"hsla":if(dx=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(px)){var cx=parseFloat(dx[1])/360,mx=parseInt(dx[2],10)/100,ux=parseInt(dx[3],10)/100;return nx(dx[5]),this.setHSL(cx,mx,ux)}}}else if(sx=/^\#([A-Fa-f0-9]+)$/.exec(ix)){var hx=(gx=sx[1]).length,gx;if(3===hx)return this.r=parseInt(gx.charAt(0)+gx.charAt(0),16)/255,this.g=parseInt(gx.charAt(1)+gx.charAt(1),16)/255,this.b=parseInt(gx.charAt(2)+gx.charAt(2),16)/255,this;if(6===hx)return this.r=parseInt(gx.charAt(0)+gx.charAt(1),16)/255,this.g=parseInt(gx.charAt(2)+gx.charAt(3),16)/255,this.b=parseInt(gx.charAt(4)+gx.charAt(5),16)/255,this}return ix&&0<ix.length&&(void 0===(gx=_y[ix])?console.warn("THREE.Color: Unknown color "+ix):this.setHex(gx)),this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(ix){return this.r=ix.r,this.g=ix.g,this.b=ix.b,this},copyGammaToLinear:function(ix,nx){return void 0===nx&&(nx=2),this.r=Math.pow(ix.r,nx),this.g=Math.pow(ix.g,nx),this.b=Math.pow(ix.b,nx),this},copyLinearToGamma:function(ix,nx){void 0===nx&&(nx=2);var sx=0<nx?1/nx:1;return this.r=Math.pow(ix.r,sx),this.g=Math.pow(ix.g,sx),this.b=Math.pow(ix.b,sx),this},convertGammaToLinear:function(){var ix=this.r,nx=this.g,sx=this.b;return this.r=ix*ix,this.g=nx*nx,this.b=sx*sx,this},convertLinearToGamma:function(){return this.r=Math.sqrt(this.r),this.g=Math.sqrt(this.g),this.b=Math.sqrt(this.b),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(ix){var dx=ix||{h:0,s:0,l:0},lx=this.r,px=this.g,cx=this.b,mx=Math.max(lx,px,cx),ux=Math.min(lx,px,cx),gx=(ux+mx)/2,nx,sx;if(ux===mx)nx=0,sx=0;else{var hx=mx-ux;switch(sx=.5>=gx?hx/(mx+ux):hx/(2-mx-ux),mx){case lx:nx=(px-cx)/hx+(px<cx?6:0);break;case px:nx=(cx-lx)/hx+2;break;case cx:nx=(lx-px)/hx+4;}nx/=6}return dx.h=nx,dx.s=sx,dx.l=gx,dx},getStyle:function(){return"rgb("+(0|255*this.r)+","+(0|255*this.g)+","+(0|255*this.b)+")"},offsetHSL:function(ix,nx,sx){var dx=this.getHSL();return dx.h+=ix,dx.s+=nx,dx.l+=sx,this.setHSL(dx.h,dx.s,dx.l),this},add:function(ix){return this.r+=ix.r,this.g+=ix.g,this.b+=ix.b,this},addColors:function(ix,nx){return this.r=ix.r+nx.r,this.g=ix.g+nx.g,this.b=ix.b+nx.b,this},addScalar:function(ix){return this.r+=ix,this.g+=ix,this.b+=ix,this},sub:function(ix){return this.r=Math.max(0,this.r-ix.r),this.g=Math.max(0,this.g-ix.g),this.b=Math.max(0,this.b-ix.b),this},multiply:function(ix){return this.r*=ix.r,this.g*=ix.g,this.b*=ix.b,this},multiplyScalar:function(ix){return this.r*=ix,this.g*=ix,this.b*=ix,this},lerp:function(ix,nx){return this.r+=(ix.r-this.r)*nx,this.g+=(ix.g-this.g)*nx,this.b+=(ix.b-this.b)*nx,this},equals:function(ix){return ix.r===this.r&&ix.g===this.g&&ix.b===this.b},fromArray:function(ix,nx){return void 0===nx&&(nx=0),this.r=ix[nx],this.g=ix[nx+1],this.b=ix[nx+2],this},toArray:function(ix,nx){return void 0===ix&&(ix=[]),void 0===nx&&(nx=0),ix[nx]=this.r,ix[nx+1]=this.g,ix[nx+2]=this.b,ix},toJSON:function(){return this.getHex()}});var Ay={common:{diffuse:{value:new Xd(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new dd},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new od(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Xd(16777215)}},lights:{ambientLightColor:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new Xd(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},uvTransform:{value:new dd}}},Ey={merge:function(ix){for(var nx={},sx=0,dx;sx<ix.length;sx++)for(var lx in dx=this.clone(ix[sx]),dx)nx[lx]=dx[lx];return nx},clone:function(ix){var nx={};for(var sx in ix)for(var dx in nx[sx]={},ix[sx]){var lx=ix[sx][dx];nx[sx][dx]=lx&&(lx.isColor||lx.isMatrix3||lx.isMatrix4||lx.isVector2||lx.isVector3||lx.isVector4||lx.isTexture)?lx.clone():Array.isArray(lx)?lx.slice():lx}return nx}},Sy={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif\n",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif\n",alphatest_fragment:"#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif\n",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif\n",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"\nvec3 transformed = vec3( position );\n",beginnormal_vertex:"\nvec3 objectNormal = vec3( normal );\n",bsdfs:"float punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\tif( decayExponent > 0.0 ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tfloat maxDistanceCutoffFactor = pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\treturn distanceFalloff * maxDistanceCutoffFactor;\n#else\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n#endif\n\t}\n\treturn 1.0;\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNL = saturate( dot( geometry.normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE  = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS  = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nvec3 BRDF_Specular_GGX_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 AB = vec2( -1.04, 1.04 ) * a004 + r.zw;\n\treturn specularColor * AB.x + AB.y;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif\n",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vViewPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vViewPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\tif ( clipped ) discard;\n\t#endif\n#endif\n",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\t#if ! defined( PHYSICAL ) && ! defined( PHONG )\n\t\tvarying vec3 vViewPosition;\n\t#endif\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif\n",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n\tvarying vec3 vViewPosition;\n#endif\n",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n",color_fragment:"#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif\n",color_pars_vertex:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_vertex:"#ifdef USE_COLOR\n\tvColor.xyz = color.xyz;\n#endif",common:"#define PI 3.14159265359\n#define PI2 6.28318530718\n#define PI_HALF 1.5707963267949\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#define whiteCompliment(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\n",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n#define cubeUV_textureSize (1024.0)\nint getFaceFromDirection(vec3 direction) {\n\tvec3 absDirection = abs(direction);\n\tint face = -1;\n\tif( absDirection.x > absDirection.z ) {\n\t\tif(absDirection.x > absDirection.y )\n\t\t\tface = direction.x > 0.0 ? 0 : 3;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\telse {\n\t\tif(absDirection.z > absDirection.y )\n\t\t\tface = direction.z > 0.0 ? 2 : 5;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\treturn face;\n}\n#define cubeUV_maxLods1  (log2(cubeUV_textureSize*0.25) - 1.0)\n#define cubeUV_rangeClamp (exp2((6.0 - 1.0) * 2.0))\nvec2 MipLevelInfo( vec3 vec, float roughnessLevel, float roughness ) {\n\tfloat scale = exp2(cubeUV_maxLods1 - roughnessLevel);\n\tfloat dxRoughness = dFdx(roughness);\n\tfloat dyRoughness = dFdy(roughness);\n\tvec3 dx = dFdx( vec * scale * dxRoughness );\n\tvec3 dy = dFdy( vec * scale * dyRoughness );\n\tfloat d = max( dot( dx, dx ), dot( dy, dy ) );\n\td = clamp(d, 1.0, cubeUV_rangeClamp);\n\tfloat mipLevel = 0.5 * log2(d);\n\treturn vec2(floor(mipLevel), fract(mipLevel));\n}\n#define cubeUV_maxLods2 (log2(cubeUV_textureSize*0.25) - 2.0)\n#define cubeUV_rcpTextureSize (1.0 / cubeUV_textureSize)\nvec2 getCubeUV(vec3 direction, float roughnessLevel, float mipLevel) {\n\tmipLevel = roughnessLevel > cubeUV_maxLods2 - 3.0 ? 0.0 : mipLevel;\n\tfloat a = 16.0 * cubeUV_rcpTextureSize;\n\tvec2 exp2_packed = exp2( vec2( roughnessLevel, mipLevel ) );\n\tvec2 rcp_exp2_packed = vec2( 1.0 ) / exp2_packed;\n\tfloat powScale = exp2_packed.x * exp2_packed.y;\n\tfloat scale = rcp_exp2_packed.x * rcp_exp2_packed.y * 0.25;\n\tfloat mipOffset = 0.75*(1.0 - rcp_exp2_packed.y) * rcp_exp2_packed.x;\n\tbool bRes = mipLevel == 0.0;\n\tscale =  bRes && (scale < a) ? a : scale;\n\tvec3 r;\n\tvec2 offset;\n\tint face = getFaceFromDirection(direction);\n\tfloat rcpPowScale = 1.0 / powScale;\n\tif( face == 0) {\n\t\tr = vec3(direction.x, -direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 1) {\n\t\tr = vec3(direction.y, direction.x, direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 2) {\n\t\tr = vec3(direction.z, direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 3) {\n\t\tr = vec3(direction.x, direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse if( face == 4) {\n\t\tr = vec3(direction.y, direction.x, -direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse {\n\t\tr = vec3(direction.z, -direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\tr = normalize(r);\n\tfloat texelOffset = 0.5 * cubeUV_rcpTextureSize;\n\tvec2 s = ( r.yz / abs( r.x ) + vec2( 1.0 ) ) * 0.5;\n\tvec2 base = offset + vec2( texelOffset );\n\treturn base + s * ( scale - 2.0 * texelOffset );\n}\n#define cubeUV_maxLods3 (log2(cubeUV_textureSize*0.25) - 3.0)\nvec4 textureCubeUV(vec3 reflectedDirection, float roughness ) {\n\tfloat roughnessVal = roughness* cubeUV_maxLods3;\n\tfloat r1 = floor(roughnessVal);\n\tfloat r2 = r1 + 1.0;\n\tfloat t = fract(roughnessVal);\n\tvec2 mipInfo = MipLevelInfo(reflectedDirection, r1, roughness);\n\tfloat s = mipInfo.y;\n\tfloat level0 = mipInfo.x;\n\tfloat level1 = level0 + 1.0;\n\tlevel1 = level1 > 5.0 ? 5.0 : level1;\n\tlevel0 += min( floor( s + 0.5 ), 5.0 );\n\tvec2 uv_10 = getCubeUV(reflectedDirection, r1, level0);\n\tvec4 color10 = envMapTexelToLinear(texture2D(envMap, uv_10));\n\tvec2 uv_20 = getCubeUV(reflectedDirection, r2, level0);\n\tvec4 color20 = envMapTexelToLinear(texture2D(envMap, uv_20));\n\tvec4 result = mix(color10, color20, t);\n\treturn vec4(result.rgb, 1.0);\n}\n#endif\n",defaultnormal_vertex:"vec3 transformedNormal = normalMatrix * objectNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif\n",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, uv ).x * displacementScale + displacementBias );\n#endif\n",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif\n",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif\n",encodings_fragment:"  gl_FragColor = linearToOutputTexel( gl_FragColor );\n",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.xyz, vec3( gammaFactor ) ), value.w );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.xyz, vec3( 1.0 / gammaFactor ) ), value.w );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.xyz * value.w * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.x, max( value.g, value.b ) );\n\tfloat M      = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM            = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.x, max( value.g, value.b ) );\n\tfloat D      = max( maxRange / maxRGB, 1.0 );\n\tD            = min( floor( D ) / 255.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n\tvec3 Xp_Y_XYZp = value.rgb * cLogLuvM;\n\tXp_Y_XYZp = max(Xp_Y_XYZp, vec3(1e-6, 1e-6, 1e-6));\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract(Le);\n\tvResult.z = (Le - (floor(vResult.w*255.0))/255.0)/255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2((Le - 127.0) / 2.0);\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = Xp_Y_XYZp.rgb * cLogLuvInverseM;\n\treturn vec4( max(vRGB, 0.0), 1.0 );\n}\n",envmap_fragment:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\tvec2 sampleUV;\n\t\treflectVec = normalize( reflectVec );\n\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\treflectVec = normalize( reflectVec );\n\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\tenvColor = envMapTexelToLinear( envColor );\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif\n",envmap_pars_fragment:"#if defined( USE_ENVMAP ) || defined( PHYSICAL )\n\tuniform float reflectivity;\n\tuniform float envMapIntensity;\n#endif\n#ifdef USE_ENVMAP\n\t#if ! defined( PHYSICAL ) && ( defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) )\n\t\tvarying vec3 vWorldPosition;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\tuniform float flipEnvMap;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( PHYSICAL )\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif\n",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif\n",envmap_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif\n",fog_vertex:"\n#ifdef USE_FOG\nfogDepth = -mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n  varying float fogDepth;\n#endif\n",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * fogDepth * fogDepth * LOG2 ) );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif\n",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif\n",gradientmap_pars_fragment:"#ifdef TOON\n\tuniform sampler2D gradientMap;\n\tvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\t\tfloat dotNL = dot( normal, lightDirection );\n\t\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t\t#ifdef USE_GRADIENTMAP\n\t\t\treturn texture2D( gradientMap, coord ).rgb;\n\t\t#else\n\t\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t\t#endif\n\t}\n#endif\n",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\treflectedLight.indirectDiffuse += PI * texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n#endif\n",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvLightFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n#endif\n",lights_pars:"uniform vec3 ambientLightColor;\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t\tfloat shadowCameraNear;\n\t\tfloat shadowCameraFar;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif\n#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( queryVec, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + 0.79248 - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in GeometricContext geometry, const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( -geometry.viewDir, geometry.normal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( -geometry.viewDir, geometry.normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( blinnShininessExponent, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\tvec4 envMapColor = textureCubeUV(queryReflectVec, BlinnExponentToGGXRoughness(blinnShininessExponent));\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV;\n\t\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif\n",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;\n",lights_phong_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifdef TOON\n\t\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#else\n\t\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\t\tvec3 irradiance = dotNL * directLight.color;\n\t#endif\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)\n",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nmaterial.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );\n#ifdef STANDARD\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.clearCoat = saturate( clearCoat );\tmaterial.clearCoatRoughness = clamp( clearCoatRoughness, 0.04, 1.0 );\n#endif\n",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3\tdiffuseColor;\n\tfloat\tspecularRoughness;\n\tvec3\tspecularColor;\n\t#ifndef STANDARD\n\t\tfloat clearCoat;\n\t\tfloat clearCoatRoughness;\n\t#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearCoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos - halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos + halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos + halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos - halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifndef STANDARD\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.directSpecular += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry, material.specularColor, material.specularRoughness );\n\treflectedLight.directDiffuse += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\t#ifndef STANDARD\n\t\treflectedLight.directSpecular += irradiance * material.clearCoat * BRDF_Specular_GGX( directLight, geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 clearCoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifndef STANDARD\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\tfloat dotNL = dotNV;\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.indirectSpecular += ( 1.0 - clearCoatDHR ) * radiance * BRDF_Specular_GGX_Environment( geometry, material.specularColor, material.specularRoughness );\n\t#ifndef STANDARD\n\t\treflectedLight.indirectSpecular += clearCoatRadiance * material.clearCoat * BRDF_Specular_GGX_Environment( geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\n#define Material_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.specularRoughness )\n#define Material_ClearCoat_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.clearCoatRoughness )\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}\n",lights_template:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = normalize( vViewPosition );\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( pointLight.shadow, directLight.visible ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( spotLight.shadow, directLight.visible ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( directionalLight.shadow, directLight.visible ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#ifdef USE_LIGHTMAP\n\t\tvec3 lightMapIrradiance = texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tirradiance += getLightProbeIndirectIrradiance( geometry, 8 );\n\t#endif\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tvec3 radiance = getLightProbeIndirectRadiance( geometry, Material_BlinnShininessExponent( material ), 8 );\n\t#ifndef STANDARD\n\t\tvec3 clearCoatRadiance = getLightProbeIndirectRadiance( geometry, Material_ClearCoat_BlinnShininessExponent( material ), 8 );\n\t#else\n\t\tvec3 clearCoatRadiance = vec3( 0.0 );\n\t#endif\n\tRE_IndirectSpecular( radiance, clearCoatRadiance, geometry, material, reflectedLight );\n#endif\n",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#ifdef USE_LOGDEPTHBUF\n\tuniform float logDepthBufFC;\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n#endif\n",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n\tuniform float logDepthBufFC;\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t#else\n\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\tgl_Position.z *= gl_Position.w;\n\t#endif\n#endif\n",map_fragment:"#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif\n",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n",map_particle_fragment:"#ifdef USE_MAP\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n",map_particle_pars_fragment:"#ifdef USE_MAP\n\tuniform mat3 uvTransform;\n\tuniform sampler2D map;\n#endif\n",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif\n",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n\tobjectNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n\tobjectNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n\tobjectNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n#endif\n",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\t#ifndef USE_MORPHNORMALS\n\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\n\ttransformed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\n\ttransformed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\n\ttransformed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\ttransformed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\n\ttransformed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\n\ttransformed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\n\ttransformed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n\t#endif\n#endif\n",normal_fragment:"#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n#endif\n#ifdef USE_NORMALMAP\n\tnormal = perturbNormal2Arb( -vViewPosition, normal );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif\n",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 S = normalize( q0 * st1.t - q1 * st0.t );\n\t\tvec3 T = normalize( -q0 * st1.s + q1 * st0.s );\n\t\tvec3 N = normalize( surf_norm );\n\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\tmapN.xy = normalScale * mapN.xy;\n\t\tmat3 tsn = mat3( S, T, N );\n\t\treturn normalize( tsn * mapN );\n\t}\n#endif\n",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}\n",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif\n",project_vertex:"vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\ngl_Position = projectionMatrix * mvPosition;\n",dithering_fragment:"#if defined( DITHERING )\n  gl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif\n",dithering_pars_fragment:"#if defined( DITHERING )\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif\n",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif\n",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tfloat texture2DShadowLerp( sampler2D depths, vec2 size, vec2 uv, float compare ) {\n\t\tconst vec2 offset = vec2( 0.0, 1.0 );\n\t\tvec2 texelSize = vec2( 1.0 ) / size;\n\t\tvec2 centroidUV = floor( uv * size + 0.5 ) / size;\n\t\tfloat lb = texture2DCompare( depths, centroidUV + texelSize * offset.xx, compare );\n\t\tfloat lt = texture2DCompare( depths, centroidUV + texelSize * offset.xy, compare );\n\t\tfloat rb = texture2DCompare( depths, centroidUV + texelSize * offset.yx, compare );\n\t\tfloat rt = texture2DCompare( depths, centroidUV + texelSize * offset.yy, compare );\n\t\tvec2 f = fract( uv * size + 0.5 );\n\t\tfloat a = mix( lb, lt, f.y );\n\t\tfloat b = mix( rb, rt, f.y );\n\t\tfloat c = mix( a, b, f.x );\n\t\treturn c;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif\n",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n#endif\n",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n#endif\n",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tDirectionalLight directionalLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tshadow *= bool( directionalLight.shadow ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tSpotLight spotLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tshadow *= bool( spotLight.shadow ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tPointLight pointLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tshadow *= bool( pointLight.shadow ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#endif\n\t#endif\n\treturn shadow;\n}\n",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif\n",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif\n",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n#endif\n",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n  gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif\n",tonemapping_pars_fragment:"#ifndef saturate\n\t#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nuniform float toneMappingWhitePoint;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\nvec3 Uncharted2ToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\n",uv_pars_fragment:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\n",uv_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = uv2;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n\tvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\n#endif\n",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldPosition;\nvoid main() {\n\tgl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );\n\tgl_FragColor.a *= opacity;\n}\n",cube_vert:"varying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}\n",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( gl_FragCoord.z ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( gl_FragCoord.z );\n\t#endif\n}\n",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}\n",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}\n",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}\n",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldPosition );\n\tvec2 sampleUV;\n\tsampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n}\n",equirect_vert:"varying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}\n",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\tvLineDistance = scale * lineDistance;\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}\n",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\treflectedLight.indirectDiffuse += texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}\n",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <bsdfs>\n#include <lights_pars>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_template>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",meshphysical_frag:"#define PHYSICAL\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifndef STANDARD\n\tuniform float clearCoat;\n\tuniform float clearCoatRoughness;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <lights_pars>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_template>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",meshphysical_vert:"#define PHYSICAL\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",normal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}\n",normal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}\n",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#ifdef USE_SIZEATTENUATION\n\t\tgl_PointSize = size * ( scale / - mvPosition.z );\n\t#else\n\t\tgl_PointSize = size;\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <fog_fragment>\n}\n",shadow_vert:"#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n"},Ty={basic:{uniforms:Ey.merge([Ay.common,Ay.specularmap,Ay.envmap,Ay.aomap,Ay.lightmap,Ay.fog]),vertexShader:Sy.meshbasic_vert,fragmentShader:Sy.meshbasic_frag},lambert:{uniforms:Ey.merge([Ay.common,Ay.specularmap,Ay.envmap,Ay.aomap,Ay.lightmap,Ay.emissivemap,Ay.fog,Ay.lights,{emissive:{value:new Xd(0)}}]),vertexShader:Sy.meshlambert_vert,fragmentShader:Sy.meshlambert_frag},phong:{uniforms:Ey.merge([Ay.common,Ay.specularmap,Ay.envmap,Ay.aomap,Ay.lightmap,Ay.emissivemap,Ay.bumpmap,Ay.normalmap,Ay.displacementmap,Ay.gradientmap,Ay.fog,Ay.lights,{emissive:{value:new Xd(0)},specular:{value:new Xd(1118481)},shininess:{value:30}}]),vertexShader:Sy.meshphong_vert,fragmentShader:Sy.meshphong_frag},standard:{uniforms:Ey.merge([Ay.common,Ay.envmap,Ay.aomap,Ay.lightmap,Ay.emissivemap,Ay.bumpmap,Ay.normalmap,Ay.displacementmap,Ay.roughnessmap,Ay.metalnessmap,Ay.fog,Ay.lights,{emissive:{value:new Xd(0)},roughness:{value:.5},metalness:{value:.5},envMapIntensity:{value:1}}]),vertexShader:Sy.meshphysical_vert,fragmentShader:Sy.meshphysical_frag},points:{uniforms:Ey.merge([Ay.points,Ay.fog]),vertexShader:Sy.points_vert,fragmentShader:Sy.points_frag},dashed:{uniforms:Ey.merge([Ay.common,Ay.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Sy.linedashed_vert,fragmentShader:Sy.linedashed_frag},depth:{uniforms:Ey.merge([Ay.common,Ay.displacementmap]),vertexShader:Sy.depth_vert,fragmentShader:Sy.depth_frag},normal:{uniforms:Ey.merge([Ay.common,Ay.bumpmap,Ay.normalmap,Ay.displacementmap,{opacity:{value:1}}]),vertexShader:Sy.normal_vert,fragmentShader:Sy.normal_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Sy.cube_vert,fragmentShader:Sy.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Sy.equirect_vert,fragmentShader:Sy.equirect_frag},distanceRGBA:{uniforms:Ey.merge([Ay.common,Ay.displacementmap,{referencePosition:{value:new sd},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Sy.distanceRGBA_vert,fragmentShader:Sy.distanceRGBA_frag},shadow:{uniforms:Ey.merge([Ay.lights,Ay.fog,{color:{value:new Xd(0)},opacity:{value:1}}]),vertexShader:Sy.shadow_vert,fragmentShader:Sy.shadow_frag}};Ty.physical={uniforms:Ey.merge([Ty.standard.uniforms,{clearCoat:{value:0},clearCoatRoughness:{value:0}}]),vertexShader:Sy.meshphysical_vert,fragmentShader:Sy.meshphysical_frag},qd.prototype=Object.create(ld.prototype),qd.prototype.constructor=qd;var My=0;Zd.prototype=Object.assign(Object.create(rd.prototype),{constructor:Zd,isMaterial:!0,onBeforeCompile:function(){},setValues:function(ix){if(void 0!==ix)for(var nx in ix){var sx=ix[nx];if(!(void 0!==sx))console.warn("THREE.Material: '"+nx+"' parameter is undefined.");else if("shading"!=nx){var dx=this[nx];void 0===dx?console.warn("THREE."+this.type+": '"+nx+"' is not a property of this material."):dx&&dx.isColor?dx.set(sx):dx&&dx.isVector3&&sx&&sx.isVector3?dx.copy(sx):this[nx]="overdraw"==nx?+sx:sx}else console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=sx===Zg}},toJSON:function(ix){function nx(cx){var mx=[];for(var ux in cx){var gx=cx[ux];delete gx.metadata,mx.push(gx)}return mx}var sx=void 0===ix||"string"==typeof ix;sx&&(ix={textures:{},images:{}});var dx={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};if(dx.uuid=this.uuid,dx.type=this.type,""!==this.name&&(dx.name=this.name),this.color&&this.color.isColor&&(dx.color=this.color.getHex()),void 0!==this.roughness&&(dx.roughness=this.roughness),void 0!==this.metalness&&(dx.metalness=this.metalness),this.emissive&&this.emissive.isColor&&(dx.emissive=this.emissive.getHex()),1!==this.emissiveIntensity&&(dx.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(dx.specular=this.specular.getHex()),void 0!==this.shininess&&(dx.shininess=this.shininess),void 0!==this.clearCoat&&(dx.clearCoat=this.clearCoat),void 0!==this.clearCoatRoughness&&(dx.clearCoatRoughness=this.clearCoatRoughness),this.map&&this.map.isTexture&&(dx.map=this.map.toJSON(ix).uuid),this.alphaMap&&this.alphaMap.isTexture&&(dx.alphaMap=this.alphaMap.toJSON(ix).uuid),this.lightMap&&this.lightMap.isTexture&&(dx.lightMap=this.lightMap.toJSON(ix).uuid),this.bumpMap&&this.bumpMap.isTexture&&(dx.bumpMap=this.bumpMap.toJSON(ix).uuid,dx.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(dx.normalMap=this.normalMap.toJSON(ix).uuid,dx.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(dx.displacementMap=this.displacementMap.toJSON(ix).uuid,dx.displacementScale=this.displacementScale,dx.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(dx.roughnessMap=this.roughnessMap.toJSON(ix).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(dx.metalnessMap=this.metalnessMap.toJSON(ix).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(dx.emissiveMap=this.emissiveMap.toJSON(ix).uuid),this.specularMap&&this.specularMap.isTexture&&(dx.specularMap=this.specularMap.toJSON(ix).uuid),this.envMap&&this.envMap.isTexture&&(dx.envMap=this.envMap.toJSON(ix).uuid,dx.reflectivity=this.reflectivity),this.gradientMap&&this.gradientMap.isTexture&&(dx.gradientMap=this.gradientMap.toJSON(ix).uuid),void 0!==this.size&&(dx.size=this.size),void 0!==this.sizeAttenuation&&(dx.sizeAttenuation=this.sizeAttenuation),this.blending!==th&&(dx.blending=this.blending),!0===this.flatShading&&(dx.flatShading=this.flatShading),this.side!==Yg&&(dx.side=this.side),this.vertexColors!==Kg&&(dx.vertexColors=this.vertexColors),1>this.opacity&&(dx.opacity=this.opacity),!0===this.transparent&&(dx.transparent=this.transparent),dx.depthFunc=this.depthFunc,dx.depthTest=this.depthTest,dx.depthWrite=this.depthWrite,0!==this.rotation&&(dx.rotation=this.rotation),1!==this.linewidth&&(dx.linewidth=this.linewidth),void 0!==this.dashSize&&(dx.dashSize=this.dashSize),void 0!==this.gapSize&&(dx.gapSize=this.gapSize),void 0!==this.scale&&(dx.scale=this.scale),!0===this.dithering&&(dx.dithering=!0),0<this.alphaTest&&(dx.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(dx.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(dx.wireframe=this.wireframe),1<this.wireframeLinewidth&&(dx.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(dx.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(dx.wireframeLinejoin=this.wireframeLinejoin),!0===this.morphTargets&&(dx.morphTargets=!0),!0===this.skinning&&(dx.skinning=!0),!1===this.visible&&(dx.visible=!1),"{}"!==JSON.stringify(this.userData)&&(dx.userData=this.userData),sx){var lx=nx(ix.textures),px=nx(ix.images);0<lx.length&&(dx.textures=lx),0<px.length&&(dx.images=px)}return dx},clone:function(){return new this.constructor().copy(this)},copy:function(ix){this.name=ix.name,this.fog=ix.fog,this.lights=ix.lights,this.blending=ix.blending,this.side=ix.side,this.flatShading=ix.flatShading,this.vertexColors=ix.vertexColors,this.opacity=ix.opacity,this.transparent=ix.transparent,this.blendSrc=ix.blendSrc,this.blendDst=ix.blendDst,this.blendEquation=ix.blendEquation,this.blendSrcAlpha=ix.blendSrcAlpha,this.blendDstAlpha=ix.blendDstAlpha,this.blendEquationAlpha=ix.blendEquationAlpha,this.depthFunc=ix.depthFunc,this.depthTest=ix.depthTest,this.depthWrite=ix.depthWrite,this.colorWrite=ix.colorWrite,this.precision=ix.precision,this.polygonOffset=ix.polygonOffset,this.polygonOffsetFactor=ix.polygonOffsetFactor,this.polygonOffsetUnits=ix.polygonOffsetUnits,this.dithering=ix.dithering,this.alphaTest=ix.alphaTest,this.premultipliedAlpha=ix.premultipliedAlpha,this.overdraw=ix.overdraw,this.visible=ix.visible,this.userData=JSON.parse(JSON.stringify(ix.userData)),this.clipShadows=ix.clipShadows,this.clipIntersection=ix.clipIntersection;var nx=ix.clippingPlanes,sx=null;if(null!==nx){var dx=nx.length;sx=Array(dx);for(var lx=0;lx!==dx;++lx)sx[lx]=nx[lx].clone()}return this.clippingPlanes=sx,this.shadowSide=ix.shadowSide,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Jd.prototype=Object.create(Zd.prototype),Jd.prototype.constructor=Jd,Jd.prototype.isMeshDepthMaterial=!0,Jd.prototype.copy=function(ix){return Zd.prototype.copy.call(this,ix),this.depthPacking=ix.depthPacking,this.skinning=ix.skinning,this.morphTargets=ix.morphTargets,this.map=ix.map,this.alphaMap=ix.alphaMap,this.displacementMap=ix.displacementMap,this.displacementScale=ix.displacementScale,this.displacementBias=ix.displacementBias,this.wireframe=ix.wireframe,this.wireframeLinewidth=ix.wireframeLinewidth,this},Kd.prototype=Object.create(Zd.prototype),Kd.prototype.constructor=Kd,Kd.prototype.isMeshDistanceMaterial=!0,Kd.prototype.copy=function(ix){return Zd.prototype.copy.call(this,ix),this.referencePosition.copy(ix.referencePosition),this.nearDistance=ix.nearDistance,this.farDistance=ix.farDistance,this.skinning=ix.skinning,this.morphTargets=ix.morphTargets,this.map=ix.map,this.alphaMap=ix.alphaMap,this.displacementMap=ix.displacementMap,this.displacementScale=ix.displacementScale,this.displacementBias=ix.displacementBias,this},Object.assign(Qd.prototype,{isBox3:!0,set:function(ix,nx){return this.min.copy(ix),this.max.copy(nx),this},setFromArray:function(ix){for(var nx=1/0,sx=1/0,dx=1/0,lx=-1/0,px=-1/0,cx=-1/0,mx=0,ux=ix.length;mx<ux;mx+=3){var gx=ix[mx],hx=ix[mx+1],fx=ix[mx+2];gx<nx&&(nx=gx),hx<sx&&(sx=hx),fx<dx&&(dx=fx),gx>lx&&(lx=gx),hx>px&&(px=hx),fx>cx&&(cx=fx)}return this.min.set(nx,sx,dx),this.max.set(lx,px,cx),this},setFromBufferAttribute:function(ix){for(var nx=1/0,sx=1/0,dx=1/0,lx=-1/0,px=-1/0,cx=-1/0,mx=0,ux=ix.count;mx<ux;mx++){var gx=ix.getX(mx),hx=ix.getY(mx),fx=ix.getZ(mx);gx<nx&&(nx=gx),hx<sx&&(sx=hx),fx<dx&&(dx=fx),gx>lx&&(lx=gx),hx>px&&(px=hx),fx>cx&&(cx=fx)}return this.min.set(nx,sx,dx),this.max.set(lx,px,cx),this},setFromPoints:function(ix){this.makeEmpty();for(var nx=0,sx=ix.length;nx<sx;nx++)this.expandByPoint(ix[nx]);return this},setFromCenterAndSize:function(){var ix=new sd;return function(nx,sx){var dx=ix.copy(sx).multiplyScalar(.5);return this.min.copy(nx).sub(dx),this.max.copy(nx).add(dx),this}}(),setFromObject:function(ix){return this.makeEmpty(),this.expandByObject(ix)},clone:function(){return new this.constructor().copy(this)},copy:function(ix){return this.min.copy(ix.min),this.max.copy(ix.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(ix){var nx=ix||new sd;return this.isEmpty()?nx.set(0,0,0):nx.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(ix){var nx=ix||new sd;return this.isEmpty()?nx.set(0,0,0):nx.subVectors(this.max,this.min)},expandByPoint:function(ix){return this.min.min(ix),this.max.max(ix),this},expandByVector:function(ix){return this.min.sub(ix),this.max.add(ix),this},expandByScalar:function(ix){return this.min.addScalar(-ix),this.max.addScalar(ix),this},expandByObject:function(){function ix(px){var cx=px.geometry;if(void 0!==cx)if(cx.isGeometry){var mx=cx.vertices;for(sx=0,dx=mx.length;sx<dx;sx++)lx.copy(mx[sx]),lx.applyMatrix4(px.matrixWorld),nx.expandByPoint(lx)}else if(cx.isBufferGeometry){var ux=cx.attributes.position;if(void 0!==ux)for(sx=0,dx=ux.count;sx<dx;sx++)lx.fromBufferAttribute(ux,sx).applyMatrix4(px.matrixWorld),nx.expandByPoint(lx)}}var lx=new sd,nx,sx,dx;return function(px){return nx=this,px.updateMatrixWorld(!0),px.traverse(ix),this}}(),containsPoint:function(ix){return!(ix.x<this.min.x||ix.x>this.max.x||ix.y<this.min.y||ix.y>this.max.y||ix.z<this.min.z||ix.z>this.max.z)},containsBox:function(ix){return this.min.x<=ix.min.x&&ix.max.x<=this.max.x&&this.min.y<=ix.min.y&&ix.max.y<=this.max.y&&this.min.z<=ix.min.z&&ix.max.z<=this.max.z},getParameter:function(ix,nx){return(nx||new sd).set((ix.x-this.min.x)/(this.max.x-this.min.x),(ix.y-this.min.y)/(this.max.y-this.min.y),(ix.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(ix){return!(ix.max.x<this.min.x||ix.min.x>this.max.x||ix.max.y<this.min.y||ix.min.y>this.max.y||ix.max.z<this.min.z||ix.min.z>this.max.z)},intersectsSphere:function(){var ix=new sd;return function(nx){return this.clampPoint(nx.center,ix),ix.distanceToSquared(nx.center)<=nx.radius*nx.radius}}(),intersectsPlane:function(ix){var nx,sx;return 0<ix.normal.x?(nx=ix.normal.x*this.min.x,sx=ix.normal.x*this.max.x):(nx=ix.normal.x*this.max.x,sx=ix.normal.x*this.min.x),0<ix.normal.y?(nx+=ix.normal.y*this.min.y,sx+=ix.normal.y*this.max.y):(nx+=ix.normal.y*this.max.y,sx+=ix.normal.y*this.min.y),0<ix.normal.z?(nx+=ix.normal.z*this.min.z,sx+=ix.normal.z*this.max.z):(nx+=ix.normal.z*this.max.z,sx+=ix.normal.z*this.min.z),nx<=ix.constant&&sx>=ix.constant},intersectsTriangle:function(){function ix(fx){var yx,xx;for(yx=0,xx=fx.length-3;yx<=xx;yx+=3){mx.fromArray(fx,yx);var vx=gx.x*Math.abs(mx.x)+gx.y*Math.abs(mx.y)+gx.z*Math.abs(mx.z),Lx=nx.dot(mx),bx=sx.dot(mx),_x=dx.dot(mx);if(Math.max(-Math.max(Lx,bx,_x),Math.min(Lx,bx,_x))>vx)return!1}return!0}var nx=new sd,sx=new sd,dx=new sd,lx=new sd,px=new sd,cx=new sd,mx=new sd,ux=new sd,gx=new sd,hx=new sd;return function(fx){if(this.isEmpty())return!1;this.getCenter(ux),gx.subVectors(this.max,ux),nx.subVectors(fx.a,ux),sx.subVectors(fx.b,ux),dx.subVectors(fx.c,ux),lx.subVectors(sx,nx),px.subVectors(dx,sx),cx.subVectors(nx,dx);var yx=[0,-lx.z,lx.y,0,-px.z,px.y,0,-cx.z,cx.y,lx.z,0,-lx.x,px.z,0,-px.x,cx.z,0,-cx.x,-lx.y,lx.x,0,-px.y,px.x,0,-cx.y,cx.x,0];return!!ix(yx)&&!!ix(yx=[1,0,0,0,1,0,0,0,1])&&(hx.crossVectors(lx,px),ix(yx=[hx.x,hx.y,hx.z]))}}(),clampPoint:function(ix,nx){return(nx||new sd).copy(ix).clamp(this.min,this.max)},distanceToPoint:function(){var ix=new sd;return function(nx){return ix.copy(nx).clamp(this.min,this.max).sub(nx).length()}}(),getBoundingSphere:function(){var ix=new sd;return function(nx){var sx=nx||new $d;return this.getCenter(sx.center),sx.radius=.5*this.getSize(ix).length(),sx}}(),intersect:function(ix){return this.min.max(ix.min),this.max.min(ix.max),this.isEmpty()&&this.makeEmpty(),this},union:function(ix){return this.min.min(ix.min),this.max.max(ix.max),this},applyMatrix4:function(){var ix=[new sd,new sd,new sd,new sd,new sd,new sd,new sd,new sd];return function(nx){return this.isEmpty()?this:(ix[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(nx),ix[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(nx),ix[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(nx),ix[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(nx),ix[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(nx),ix[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(nx),ix[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(nx),ix[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(nx),this.setFromPoints(ix),this)}}(),translate:function(ix){return this.min.add(ix),this.max.add(ix),this},equals:function(ix){return ix.min.equals(this.min)&&ix.max.equals(this.max)}}),Object.assign($d.prototype,{set:function(ix,nx){return this.center.copy(ix),this.radius=nx,this},setFromPoints:function(){var ix=new Qd;return function(nx,sx){var dx=this.center;void 0===sx?ix.setFromPoints(nx).getCenter(dx):dx.copy(sx);for(var lx=0,px=0,cx=nx.length;px<cx;px++)lx=Math.max(lx,dx.distanceToSquared(nx[px]));return this.radius=Math.sqrt(lx),this}}(),clone:function(){return new this.constructor().copy(this)},copy:function(ix){return this.center.copy(ix.center),this.radius=ix.radius,this},empty:function(){return 0>=this.radius},containsPoint:function(ix){return ix.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(ix){return ix.distanceTo(this.center)-this.radius},intersectsSphere:function(ix){var nx=this.radius+ix.radius;return ix.center.distanceToSquared(this.center)<=nx*nx},intersectsBox:function(ix){return ix.intersectsSphere(this)},intersectsPlane:function(ix){return Math.abs(ix.distanceToPoint(this.center))<=this.radius},clampPoint:function(ix,nx){var sx=this.center.distanceToSquared(ix),dx=nx||new sd;return dx.copy(ix),sx>this.radius*this.radius&&(dx.sub(this.center).normalize(),dx.multiplyScalar(this.radius).add(this.center)),dx},getBoundingBox:function(ix){var nx=ix||new Qd;return nx.set(this.center,this.center),nx.expandByScalar(this.radius),nx},applyMatrix4:function(ix){return this.center.applyMatrix4(ix),this.radius*=ix.getMaxScaleOnAxis(),this},translate:function(ix){return this.center.add(ix),this},equals:function(ix){return ix.center.equals(this.center)&&ix.radius===this.radius}}),Object.assign(el.prototype,{set:function(ix,nx){return this.normal.copy(ix),this.constant=nx,this},setComponents:function(ix,nx,sx,dx){return this.normal.set(ix,nx,sx),this.constant=dx,this},setFromNormalAndCoplanarPoint:function(ix,nx){return this.normal.copy(ix),this.constant=-nx.dot(this.normal),this},setFromCoplanarPoints:function(){var ix=new sd,nx=new sd;return function(sx,dx,lx){var px=ix.subVectors(lx,dx).cross(nx.subVectors(sx,dx)).normalize();return this.setFromNormalAndCoplanarPoint(px,sx),this}}(),clone:function(){return new this.constructor().copy(this)},copy:function(ix){return this.normal.copy(ix.normal),this.constant=ix.constant,this},normalize:function(){var ix=1/this.normal.length();return this.normal.multiplyScalar(ix),this.constant*=ix,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(ix){return this.normal.dot(ix)+this.constant},distanceToSphere:function(ix){return this.distanceToPoint(ix.center)-ix.radius},projectPoint:function(ix,nx){return(nx||new sd).copy(this.normal).multiplyScalar(-this.distanceToPoint(ix)).add(ix)},intersectLine:function(){var ix=new sd;return function(nx,sx){var dx=sx||new sd,lx=nx.delta(ix),px=this.normal.dot(lx);if(0===px)return 0===this.distanceToPoint(nx.start)?dx.copy(nx.start):void 0;var cx=-(nx.start.dot(this.normal)+this.constant)/px;return 0>cx||1<cx?void 0:dx.copy(lx).multiplyScalar(cx).add(nx.start)}}(),intersectsLine:function(ix){var nx=this.distanceToPoint(ix.start),sx=this.distanceToPoint(ix.end);return 0>nx&&0<sx||0>sx&&0<nx},intersectsBox:function(ix){return ix.intersectsPlane(this)},intersectsSphere:function(ix){return ix.intersectsPlane(this)},coplanarPoint:function(ix){return(ix||new sd).copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var ix=new sd,nx=new dd;return function(sx,dx){var lx=dx||nx.getNormalMatrix(sx),px=this.coplanarPoint(ix).applyMatrix4(sx),cx=this.normal.applyMatrix3(lx).normalize();return this.constant=-px.dot(cx),this}}(),translate:function(ix){return this.constant-=ix.dot(this.normal),this},equals:function(ix){return ix.normal.equals(this.normal)&&ix.constant===this.constant}}),Object.assign(tl.prototype,{set:function(ix,nx,sx,dx,lx,px){var cx=this.planes;return cx[0].copy(ix),cx[1].copy(nx),cx[2].copy(sx),cx[3].copy(dx),cx[4].copy(lx),cx[5].copy(px),this},clone:function(){return new this.constructor().copy(this)},copy:function(ix){for(var nx=this.planes,sx=0;6>sx;sx++)nx[sx].copy(ix.planes[sx]);return this},setFromMatrix:function(ix){var nx=this.planes,sx=ix.elements,dx=sx[0],lx=sx[1],px=sx[2],cx=sx[3],mx=sx[4],ux=sx[5],gx=sx[6],hx=sx[7],fx=sx[8],yx=sx[9],xx=sx[10],vx=sx[11],Lx=sx[12],bx=sx[13],_x=sx[14],Ax=sx[15];return nx[0].setComponents(cx-dx,hx-mx,vx-fx,Ax-Lx).normalize(),nx[1].setComponents(cx+dx,hx+mx,vx+fx,Ax+Lx).normalize(),nx[2].setComponents(cx+lx,hx+ux,vx+yx,Ax+bx).normalize(),nx[3].setComponents(cx-lx,hx-ux,vx-yx,Ax-bx).normalize(),nx[4].setComponents(cx-px,hx-gx,vx-xx,Ax-_x).normalize(),nx[5].setComponents(cx+px,hx+gx,vx+xx,Ax+_x).normalize(),this},intersectsObject:function(){var ix=new $d;return function(nx){var sx=nx.geometry;return null===sx.boundingSphere&&sx.computeBoundingSphere(),ix.copy(sx.boundingSphere).applyMatrix4(nx.matrixWorld),this.intersectsSphere(ix)}}(),intersectsSprite:function(){var ix=new $d;return function(nx){return ix.center.set(0,0,0),ix.radius=.7071067811865476,ix.applyMatrix4(nx.matrixWorld),this.intersectsSphere(ix)}}(),intersectsSphere:function(ix){for(var nx=this.planes,sx=ix.center,dx=-ix.radius,lx=0;6>lx;lx++)if(nx[lx].distanceToPoint(sx)<dx)return!1;return!0},intersectsBox:function(){var ix=new sd,nx=new sd;return function(sx){for(var dx=this.planes,lx=0,px;6>lx;lx++){px=dx[lx],ix.x=0<px.normal.x?sx.min.x:sx.max.x,nx.x=0<px.normal.x?sx.max.x:sx.min.x,ix.y=0<px.normal.y?sx.min.y:sx.max.y,nx.y=0<px.normal.y?sx.max.y:sx.min.y,ix.z=0<px.normal.z?sx.min.z:sx.max.z,nx.z=0<px.normal.z?sx.max.z:sx.min.z;var cx=px.distanceToPoint(ix),mx=px.distanceToPoint(nx);if(0>cx&&0>mx)return!1}return!0}}(),containsPoint:function(ix){for(var nx=this.planes,sx=0;6>sx;sx++)if(0>nx[sx].distanceToPoint(ix))return!1;return!0}}),rl.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],rl.DefaultOrder="XYZ",Object.defineProperties(rl.prototype,{x:{get:function(){return this._x},set:function(ix){this._x=ix,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(ix){this._y=ix,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(ix){this._z=ix,this.onChangeCallback()}},order:{get:function(){return this._order},set:function(ix){this._order=ix,this.onChangeCallback()}}}),Object.assign(rl.prototype,{isEuler:!0,set:function(ix,nx,sx,dx){return this._x=ix,this._y=nx,this._z=sx,this._order=dx||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(ix){return this._x=ix._x,this._y=ix._y,this._z=ix._z,this._order=ix._order,this.onChangeCallback(),this},setFromRotationMatrix:function(ix,nx,sx){var dx=uy.clamp,lx=ix.elements,px=lx[0],cx=lx[4],mx=lx[8],ux=lx[1],gx=lx[5],hx=lx[9],fx=lx[2],yx=lx[6],xx=lx[10];return"XYZ"===(nx=nx||this._order)?(this._y=Math.asin(dx(mx,-1,1)),.99999>Math.abs(mx)?(this._x=Math.atan2(-hx,xx),this._z=Math.atan2(-cx,px)):(this._x=Math.atan2(yx,gx),this._z=0)):"YXZ"===nx?(this._x=Math.asin(-dx(hx,-1,1)),.99999>Math.abs(hx)?(this._y=Math.atan2(mx,xx),this._z=Math.atan2(ux,gx)):(this._y=Math.atan2(-fx,px),this._z=0)):"ZXY"===nx?(this._x=Math.asin(dx(yx,-1,1)),.99999>Math.abs(yx)?(this._y=Math.atan2(-fx,xx),this._z=Math.atan2(-cx,gx)):(this._y=0,this._z=Math.atan2(ux,px))):"ZYX"===nx?(this._y=Math.asin(-dx(fx,-1,1)),.99999>Math.abs(fx)?(this._x=Math.atan2(yx,xx),this._z=Math.atan2(ux,px)):(this._x=0,this._z=Math.atan2(-cx,gx))):"YZX"===nx?(this._z=Math.asin(dx(ux,-1,1)),.99999>Math.abs(ux)?(this._x=Math.atan2(-hx,gx),this._y=Math.atan2(-fx,px)):(this._x=0,this._y=Math.atan2(mx,xx))):"XZY"===nx?(this._z=Math.asin(-dx(cx,-1,1)),.99999>Math.abs(cx)?(this._x=Math.atan2(yx,gx),this._y=Math.atan2(mx,px)):(this._x=Math.atan2(-hx,xx),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+nx),this._order=nx,!1!==sx&&this.onChangeCallback(),this},setFromQuaternion:function(){var ix=new id;return function(nx,sx,dx){return ix.makeRotationFromQuaternion(nx),this.setFromRotationMatrix(ix,sx,dx)}}(),setFromVector3:function(ix,nx){return this.set(ix.x,ix.y,ix.z,nx||this._order)},reorder:function(){var ix=new nd;return function(nx){return ix.setFromEuler(this),this.setFromQuaternion(ix,nx)}}(),equals:function(ix){return ix._x===this._x&&ix._y===this._y&&ix._z===this._z&&ix._order===this._order},fromArray:function(ix){return this._x=ix[0],this._y=ix[1],this._z=ix[2],void 0!==ix[3]&&(this._order=ix[3]),this.onChangeCallback(),this},toArray:function(ix,nx){return void 0===ix&&(ix=[]),void 0===nx&&(nx=0),ix[nx]=this._x,ix[nx+1]=this._y,ix[nx+2]=this._z,ix[nx+3]=this._order,ix},toVector3:function(ix){return ix?ix.set(this._x,this._y,this._z):new sd(this._x,this._y,this._z)},onChange:function(ix){return this.onChangeCallback=ix,this},onChangeCallback:function(){}}),Object.assign(ol.prototype,{set:function(ix){this.mask=0|1<<ix},enable:function(ix){this.mask|=0|1<<ix},toggle:function(ix){this.mask^=0|1<<ix},disable:function(ix){this.mask&=~(0|1<<ix)},test:function(ix){return 0!=(this.mask&ix.mask)}});var wy=0;il.DefaultUp=new sd(0,1,0),il.DefaultMatrixAutoUpdate=!0,il.prototype=Object.assign(Object.create(rd.prototype),{constructor:il,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix:function(ix){this.matrix.multiplyMatrices(ix,this.matrix),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(ix){return this.quaternion.premultiply(ix),this},setRotationFromAxisAngle:function(ix,nx){this.quaternion.setFromAxisAngle(ix,nx)},setRotationFromEuler:function(ix){this.quaternion.setFromEuler(ix,!0)},setRotationFromMatrix:function(ix){this.quaternion.setFromRotationMatrix(ix)},setRotationFromQuaternion:function(ix){this.quaternion.copy(ix)},rotateOnAxis:function(){var ix=new nd;return function(nx,sx){return ix.setFromAxisAngle(nx,sx),this.quaternion.multiply(ix),this}}(),rotateOnWorldAxis:function(){var ix=new nd;return function(nx,sx){return ix.setFromAxisAngle(nx,sx),this.quaternion.premultiply(ix),this}}(),rotateX:function(){var ix=new sd(1,0,0);return function(nx){return this.rotateOnAxis(ix,nx)}}(),rotateY:function(){var ix=new sd(0,1,0);return function(nx){return this.rotateOnAxis(ix,nx)}}(),rotateZ:function(){var ix=new sd(0,0,1);return function(nx){return this.rotateOnAxis(ix,nx)}}(),translateOnAxis:function(){var ix=new sd;return function(nx,sx){return ix.copy(nx).applyQuaternion(this.quaternion),this.position.add(ix.multiplyScalar(sx)),this}}(),translateX:function(){var ix=new sd(1,0,0);return function(nx){return this.translateOnAxis(ix,nx)}}(),translateY:function(){var ix=new sd(0,1,0);return function(nx){return this.translateOnAxis(ix,nx)}}(),translateZ:function(){var ix=new sd(0,0,1);return function(nx){return this.translateOnAxis(ix,nx)}}(),localToWorld:function(ix){return ix.applyMatrix4(this.matrixWorld)},worldToLocal:function(){var ix=new id;return function(nx){return nx.applyMatrix4(ix.getInverse(this.matrixWorld))}}(),lookAt:function(){var ix=new id,nx=new sd;return function(sx,dx,lx){sx.isVector3?nx.copy(sx):nx.set(sx,dx,lx),this.isCamera?ix.lookAt(this.position,nx,this.up):ix.lookAt(nx,this.position,this.up),this.quaternion.setFromRotationMatrix(ix)}}(),add:function(ix){if(1<arguments.length){for(var nx=0;nx<arguments.length;nx++)this.add(arguments[nx]);return this}return ix===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",ix),this):(ix&&ix.isObject3D?(null!==ix.parent&&ix.parent.remove(ix),ix.parent=this,ix.dispatchEvent({type:"added"}),this.children.push(ix)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",ix),this)},remove:function(ix){if(1<arguments.length){for(var nx=0;nx<arguments.length;nx++)this.remove(arguments[nx]);return this}var sx=this.children.indexOf(ix);return-1!==sx&&(ix.parent=null,ix.dispatchEvent({type:"removed"}),this.children.splice(sx,1)),this},getObjectById:function(ix){return this.getObjectByProperty("id",ix)},getObjectByName:function(ix){return this.getObjectByProperty("name",ix)},getObjectByProperty:function(ix,nx){if(this[ix]===nx)return this;for(var sx=0,dx=this.children.length,lx;sx<dx;sx++)if(lx=this.children[sx].getObjectByProperty(ix,nx),void 0!==lx)return lx},getWorldPosition:function(ix){var nx=ix||new sd;return this.updateMatrixWorld(!0),nx.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(){var ix=new sd,nx=new sd;return function(sx){var dx=sx||new nd;return this.updateMatrixWorld(!0),this.matrixWorld.decompose(ix,dx,nx),dx}}(),getWorldRotation:function(){var ix=new nd;return function(nx){var sx=nx||new rl;return this.getWorldQuaternion(ix),sx.setFromQuaternion(ix,this.rotation.order,!1)}}(),getWorldScale:function(){var ix=new sd,nx=new nd;return function(sx){var dx=sx||new sd;return this.updateMatrixWorld(!0),this.matrixWorld.decompose(ix,nx,dx),dx}}(),getWorldDirection:function(){var ix=new nd;return function(nx){var sx=nx||new sd;return this.getWorldQuaternion(ix),sx.set(0,0,1).applyQuaternion(ix)}}(),raycast:function(){},traverse:function(ix){ix(this);for(var nx=this.children,sx=0,dx=nx.length;sx<dx;sx++)nx[sx].traverse(ix)},traverseVisible:function(ix){if(!1!==this.visible){ix(this);for(var nx=this.children,sx=0,dx=nx.length;sx<dx;sx++)nx[sx].traverseVisible(ix)}},traverseAncestors:function(ix){var nx=this.parent;null!==nx&&(ix(nx),nx.traverseAncestors(ix))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(ix){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||ix)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,ix=!0);for(var nx=this.children,sx=0,dx=nx.length;sx<dx;sx++)nx[sx].updateMatrixWorld(ix)},toJSON:function(ix){function nx(bx,_x){return void 0===bx[_x.uuid]&&(bx[_x.uuid]=_x.toJSON(ix)),_x.uuid}function sx(bx){var _x=[];for(var Ax in bx){var Ex=bx[Ax];delete Ex.metadata,_x.push(Ex)}return _x}var dx=void 0===ix||"string"==typeof ix,lx={};dx&&(ix={geometries:{},materials:{},textures:{},images:{},shapes:{}},lx.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var px={};if(px.uuid=this.uuid,px.type=this.type,""!==this.name&&(px.name=this.name),!0===this.castShadow&&(px.castShadow=!0),!0===this.receiveShadow&&(px.receiveShadow=!0),!1===this.visible&&(px.visible=!1),"{}"!==JSON.stringify(this.userData)&&(px.userData=this.userData),px.matrix=this.matrix.toArray(),void 0!==this.geometry){px.geometry=nx(ix.geometries,this.geometry);var cx=this.geometry.parameters;if(void 0!==cx&&void 0!==cx.shapes){var mx=cx.shapes;if(Array.isArray(mx))for(var ux=0,gx=mx.length,hx;ux<gx;ux++)hx=mx[ux],nx(ix.shapes,hx);else nx(ix.shapes,mx)}}if(void 0!==this.material)if(Array.isArray(this.material)){var fx=[];for(ux=0,gx=this.material.length;ux<gx;ux++)fx.push(nx(ix.materials,this.material[ux]));px.material=fx}else px.material=nx(ix.materials,this.material);if(0<this.children.length)for(px.children=[],ux=0;ux<this.children.length;ux++)px.children.push(this.children[ux].toJSON(ix).object);if(dx){var yx=sx(ix.geometries),xx=sx(ix.materials),vx=sx(ix.textures),Lx=sx(ix.images);mx=sx(ix.shapes),0<yx.length&&(lx.geometries=yx),0<xx.length&&(lx.materials=xx),0<vx.length&&(lx.textures=vx),0<Lx.length&&(lx.images=Lx),0<mx.length&&(lx.shapes=mx)}return lx.object=px,lx},clone:function(ix){return new this.constructor().copy(this,ix)},copy:function(ix,nx){if(void 0===nx&&(nx=!0),this.name=ix.name,this.up.copy(ix.up),this.position.copy(ix.position),this.quaternion.copy(ix.quaternion),this.scale.copy(ix.scale),this.matrix.copy(ix.matrix),this.matrixWorld.copy(ix.matrixWorld),this.matrixAutoUpdate=ix.matrixAutoUpdate,this.matrixWorldNeedsUpdate=ix.matrixWorldNeedsUpdate,this.layers.mask=ix.layers.mask,this.visible=ix.visible,this.castShadow=ix.castShadow,this.receiveShadow=ix.receiveShadow,this.frustumCulled=ix.frustumCulled,this.renderOrder=ix.renderOrder,this.userData=JSON.parse(JSON.stringify(ix.userData)),!0===nx)for(var sx=0,dx;sx<ix.children.length;sx++)dx=ix.children[sx],this.add(dx.clone());return this}}),nl.prototype=Object.assign(Object.create(il.prototype),{constructor:nl,isCamera:!0,copy:function(ix,nx){return il.prototype.copy.call(this,ix,nx),this.matrixWorldInverse.copy(ix.matrixWorldInverse),this.projectionMatrix.copy(ix.projectionMatrix),this},getWorldDirection:function(){var ix=new nd;return function(nx){var sx=nx||new sd;return this.getWorldQuaternion(ix),sx.set(0,0,-1).applyQuaternion(ix)}}(),updateMatrixWorld:function(ix){il.prototype.updateMatrixWorld.call(this,ix),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return new this.constructor().copy(this)}}),sl.prototype=Object.assign(Object.create(nl.prototype),{constructor:sl,isOrthographicCamera:!0,copy:function(ix,nx){return nl.prototype.copy.call(this,ix,nx),this.left=ix.left,this.right=ix.right,this.top=ix.top,this.bottom=ix.bottom,this.near=ix.near,this.far=ix.far,this.zoom=ix.zoom,this.view=null===ix.view?null:Object.assign({},ix.view),this},setViewOffset:function(ix,nx,sx,dx,lx,px){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=ix,this.view.fullHeight=nx,this.view.offsetX=sx,this.view.offsetY=dx,this.view.width=lx,this.view.height=px,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var ix=(this.right-this.left)/(2*this.zoom),nx=(this.top-this.bottom)/(2*this.zoom),sx=(this.right+this.left)/2,dx=(this.top+this.bottom)/2,lx=sx-ix,px=sx+ix,cx=dx+nx,mx=dx-nx;if(null!==this.view&&this.view.enabled){var ux=this.zoom/(this.view.width/this.view.fullWidth),gx=this.zoom/(this.view.height/this.view.fullHeight),hx=(this.right-this.left)/this.view.width,fx=(this.top-this.bottom)/this.view.height;px=(lx+=hx*(this.view.offsetX/ux))+hx*(this.view.width/ux),mx=(cx-=fx*(this.view.offsetY/gx))-fx*(this.view.height/gx)}this.projectionMatrix.makeOrthographic(lx,px,cx,mx,this.near,this.far)},toJSON:function(ix){var nx=il.prototype.toJSON.call(this,ix);return nx.object.zoom=this.zoom,nx.object.left=this.left,nx.object.right=this.right,nx.object.top=this.top,nx.object.bottom=this.bottom,nx.object.near=this.near,nx.object.far=this.far,null!==this.view&&(nx.object.view=Object.assign({},this.view)),nx}}),Object.assign(dl.prototype,{clone:function(){return new this.constructor().copy(this)},copy:function(ix){this.a=ix.a,this.b=ix.b,this.c=ix.c,this.normal.copy(ix.normal),this.color.copy(ix.color),this.materialIndex=ix.materialIndex;for(var nx=0,sx=ix.vertexNormals.length;nx<sx;nx++)this.vertexNormals[nx]=ix.vertexNormals[nx].clone();for(nx=0,sx=ix.vertexColors.length;nx<sx;nx++)this.vertexColors[nx]=ix.vertexColors[nx].clone();return this}});var Ry=0;ll.prototype=Object.assign(Object.create(rd.prototype),{constructor:ll,isGeometry:!0,applyMatrix:function(ix){for(var nx=new dd().getNormalMatrix(ix),sx=0,dx=this.vertices.length;sx<dx;sx++)this.vertices[sx].applyMatrix4(ix);for(sx=0,dx=this.faces.length;sx<dx;sx++){var lx=this.faces[sx];lx.normal.applyMatrix3(nx).normalize();for(var px=0,cx=lx.vertexNormals.length;px<cx;px++)lx.vertexNormals[px].applyMatrix3(nx).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:function(){var ix=new id;return function(nx){return ix.makeRotationX(nx),this.applyMatrix(ix),this}}(),rotateY:function(){var ix=new id;return function(nx){return ix.makeRotationY(nx),this.applyMatrix(ix),this}}(),rotateZ:function(){var ix=new id;return function(nx){return ix.makeRotationZ(nx),this.applyMatrix(ix),this}}(),translate:function(){var ix=new id;return function(nx,sx,dx){return ix.makeTranslation(nx,sx,dx),this.applyMatrix(ix),this}}(),scale:function(){var ix=new id;return function(nx,sx,dx){return ix.makeScale(nx,sx,dx),this.applyMatrix(ix),this}}(),lookAt:function(){var ix=new il;return function(nx){ix.lookAt(nx),ix.updateMatrix(),this.applyMatrix(ix.matrix)}}(),fromBufferGeometry:function(ix){function nx(Ex,Sx,Tx,Mx){var wx=new dl(Ex,Sx,Tx,void 0===cx?[]:[hx[Ex].clone(),hx[Sx].clone(),hx[Tx].clone()],void 0===mx?[]:[sx.colors[Ex].clone(),sx.colors[Sx].clone(),sx.colors[Tx].clone()],Mx);sx.faces.push(wx),void 0!==ux&&sx.faceVertexUvs[0].push([fx[Ex].clone(),fx[Sx].clone(),fx[Tx].clone()]),void 0!==gx&&sx.faceVertexUvs[1].push([yx[Ex].clone(),yx[Sx].clone(),yx[Tx].clone()])}var sx=this,dx=null===ix.index?void 0:ix.index.array,lx=ix.attributes,px=lx.position.array,cx=void 0===lx.normal?void 0:lx.normal.array,mx=void 0===lx.color?void 0:lx.color.array,ux=void 0===lx.uv?void 0:lx.uv.array,gx=void 0===lx.uv2?void 0:lx.uv2.array;void 0!==gx&&(this.faceVertexUvs[1]=[]);for(var hx=[],fx=[],yx=[],xx=0,vx=0;xx<px.length;xx+=3,vx+=2)sx.vertices.push(new sd(px[xx],px[xx+1],px[xx+2])),void 0!==cx&&hx.push(new sd(cx[xx],cx[xx+1],cx[xx+2])),void 0!==mx&&sx.colors.push(new Xd(mx[xx],mx[xx+1],mx[xx+2])),void 0!==ux&&fx.push(new od(ux[vx],ux[vx+1])),void 0!==gx&&yx.push(new od(gx[vx],gx[vx+1]));var Lx=ix.groups;if(0<Lx.length)for(xx=0;xx<Lx.length;xx++)for(var bx=Lx[xx],_x=bx.start,Ax=(vx=_x,_x+bx.count);vx<Ax;vx+=3)void 0===dx?nx(vx,vx+1,vx+2,bx.materialIndex):nx(dx[vx],dx[vx+1],dx[vx+2],bx.materialIndex);else if(void 0!==dx)for(xx=0;xx<dx.length;xx+=3)nx(dx[xx],dx[xx+1],dx[xx+2]);else for(xx=0;xx<px.length/3;xx+=3)nx(xx,xx+1,xx+2);return this.computeFaceNormals(),null!==ix.boundingBox&&(this.boundingBox=ix.boundingBox.clone()),null!==ix.boundingSphere&&(this.boundingSphere=ix.boundingSphere.clone()),this},center:function(){this.computeBoundingBox();var ix=this.boundingBox.getCenter().negate();return this.translate(ix.x,ix.y,ix.z),ix},normalize:function(){this.computeBoundingSphere();var ix=this.boundingSphere.center,nx=this.boundingSphere.radius,sx=0===nx?1:1/nx,dx=new id;return dx.set(sx,0,0,-sx*ix.x,0,sx,0,-sx*ix.y,0,0,sx,-sx*ix.z,0,0,0,1),this.applyMatrix(dx),this},computeFaceNormals:function(){for(var ix=new sd,nx=new sd,sx=0,dx=this.faces.length;sx<dx;sx++){var lx=this.faces[sx],px=this.vertices[lx.a],cx=this.vertices[lx.b],mx=this.vertices[lx.c];ix.subVectors(mx,cx),nx.subVectors(px,cx),ix.cross(nx),ix.normalize(),lx.normal.copy(ix)}},computeVertexNormals:function(ix){var nx,sx,dx,lx,px,cx;for(void 0===ix&&(ix=!0),cx=Array(this.vertices.length),nx=0,sx=this.vertices.length;nx<sx;nx++)cx[nx]=new sd;if(ix){var hx=new sd,fx=new sd,mx,ux,gx;for(dx=0,lx=this.faces.length;dx<lx;dx++)px=this.faces[dx],mx=this.vertices[px.a],ux=this.vertices[px.b],gx=this.vertices[px.c],hx.subVectors(gx,ux),fx.subVectors(mx,ux),hx.cross(fx),cx[px.a].add(hx),cx[px.b].add(hx),cx[px.c].add(hx)}else for(this.computeFaceNormals(),dx=0,lx=this.faces.length;dx<lx;dx++)cx[(px=this.faces[dx]).a].add(px.normal),cx[px.b].add(px.normal),cx[px.c].add(px.normal);for(nx=0,sx=this.vertices.length;nx<sx;nx++)cx[nx].normalize();for(dx=0,lx=this.faces.length;dx<lx;dx++){var yx=(px=this.faces[dx]).vertexNormals;3===yx.length?(yx[0].copy(cx[px.a]),yx[1].copy(cx[px.b]),yx[2].copy(cx[px.c])):(yx[0]=cx[px.a].clone(),yx[1]=cx[px.b].clone(),yx[2]=cx[px.c].clone())}0<this.faces.length&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){var ix,nx,sx;for(this.computeFaceNormals(),ix=0,nx=this.faces.length;ix<nx;ix++){var dx=(sx=this.faces[ix]).vertexNormals;3===dx.length?(dx[0].copy(sx.normal),dx[1].copy(sx.normal),dx[2].copy(sx.normal)):(dx[0]=sx.normal.clone(),dx[1]=sx.normal.clone(),dx[2]=sx.normal.clone())}0<this.faces.length&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var ix,nx,sx,dx,lx;for(sx=0,dx=this.faces.length;sx<dx;sx++)for((lx=this.faces[sx]).__originalFaceNormal?lx.__originalFaceNormal.copy(lx.normal):lx.__originalFaceNormal=lx.normal.clone(),lx.__originalVertexNormals||(lx.__originalVertexNormals=[]),ix=0,nx=lx.vertexNormals.length;ix<nx;ix++)lx.__originalVertexNormals[ix]?lx.__originalVertexNormals[ix].copy(lx.vertexNormals[ix]):lx.__originalVertexNormals[ix]=lx.vertexNormals[ix].clone();var px=new ll;for(px.faces=this.faces,ix=0,nx=this.morphTargets.length;ix<nx;ix++){if(!this.morphNormals[ix]){this.morphNormals[ix]={},this.morphNormals[ix].faceNormals=[],this.morphNormals[ix].vertexNormals=[];var cx=this.morphNormals[ix].faceNormals,mx=this.morphNormals[ix].vertexNormals;for(sx=0,dx=this.faces.length;sx<dx;sx++)ux=new sd,gx={a:new sd,b:new sd,c:new sd},cx.push(ux),mx.push(gx)}var hx=this.morphNormals[ix],ux,gx;for(px.vertices=this.morphTargets[ix].vertices,px.computeFaceNormals(),px.computeVertexNormals(),sx=0,dx=this.faces.length;sx<dx;sx++)lx=this.faces[sx],ux=hx.faceNormals[sx],gx=hx.vertexNormals[sx],ux.copy(lx.normal),gx.a.copy(lx.vertexNormals[0]),gx.b.copy(lx.vertexNormals[1]),gx.c.copy(lx.vertexNormals[2])}for(sx=0,dx=this.faces.length;sx<dx;sx++)(lx=this.faces[sx]).normal=lx.__originalFaceNormal,lx.vertexNormals=lx.__originalVertexNormals},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new Qd),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new $d),this.boundingSphere.setFromPoints(this.vertices)},merge:function(ix,nx,sx){if(ix&&ix.isGeometry){var lx=this.vertices.length,px=this.vertices,cx=ix.vertices,mx=this.faces,ux=ix.faces,gx=this.faceVertexUvs[0],hx=ix.faceVertexUvs[0],fx=this.colors,yx=ix.colors,dx;void 0===sx&&(sx=0),void 0!==nx&&(dx=new dd().getNormalMatrix(nx));for(var xx=0,vx=cx.length,Lx;xx<vx;xx++)Lx=cx[xx].clone(),void 0!==nx&&Lx.applyMatrix4(nx),px.push(Lx);for(xx=0,vx=yx.length;xx<vx;xx++)fx.push(yx[xx].clone());for(xx=0,vx=ux.length;xx<vx;xx++){var Ex=ux[xx],Sx=Ex.vertexNormals,Tx=Ex.vertexColors,bx,_x,Ax;(bx=new dl(Ex.a+lx,Ex.b+lx,Ex.c+lx)).normal.copy(Ex.normal),void 0!==dx&&bx.normal.applyMatrix3(dx).normalize();for(var Mx=0,wx=Sx.length;Mx<wx;Mx++)_x=Sx[Mx].clone(),void 0!==dx&&_x.applyMatrix3(dx).normalize(),bx.vertexNormals.push(_x);for(bx.color.copy(Ex.color),Mx=0,wx=Tx.length;Mx<wx;Mx++)Ax=Tx[Mx],bx.vertexColors.push(Ax.clone());bx.materialIndex=Ex.materialIndex+sx,mx.push(bx)}for(xx=0,vx=hx.length;xx<vx;xx++){var Rx=hx[xx],Px=[];if(void 0!==Rx){for(Mx=0,wx=Rx.length;Mx<wx;Mx++)Px.push(Rx[Mx].clone());gx.push(Px)}}}else console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",ix)},mergeMesh:function(ix){ix&&ix.isMesh?(ix.matrixAutoUpdate&&ix.updateMatrix(),this.merge(ix.geometry,ix.matrix)):console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",ix)},mergeVertices:function(){var ux={},gx=[],hx=[],fx=Math.pow(10,4),ix,nx,sx,dx,lx,px,cx,mx;for(sx=0,dx=this.vertices.length;sx<dx;sx++)ix=this.vertices[sx],void 0===ux[nx=Math.round(ix.x*fx)+"_"+Math.round(ix.y*fx)+"_"+Math.round(ix.z*fx)]?(ux[nx]=sx,gx.push(this.vertices[sx]),hx[sx]=gx.length-1):hx[sx]=hx[ux[nx]];var yx=[];for(sx=0,dx=this.faces.length;sx<dx;sx++){(lx=this.faces[sx]).a=hx[lx.a],lx.b=hx[lx.b],lx.c=hx[lx.c],px=[lx.a,lx.b,lx.c];for(var xx=0;3>xx;xx++)if(px[xx]===px[(xx+1)%3]){yx.push(sx);break}}for(sx=yx.length-1;0<=sx;sx--){var vx=yx[sx];for(this.faces.splice(vx,1),cx=0,mx=this.faceVertexUvs.length;cx<mx;cx++)this.faceVertexUvs[cx].splice(vx,1)}var Lx=this.vertices.length-gx.length;return this.vertices=gx,Lx},setFromPoints:function(ix){this.vertices=[];for(var nx=0,sx=ix.length,dx;nx<sx;nx++)dx=ix[nx],this.vertices.push(new sd(dx.x,dx.y,dx.z||0));return this},sortFacesByMaterialIndex:function(){for(var ix=this.faces,nx=ix.length,sx=0;sx<nx;sx++)ix[sx]._id=sx;ix.sort(function(ux,gx){return ux.materialIndex-gx.materialIndex});var px=this.faceVertexUvs[0],cx=this.faceVertexUvs[1],dx,lx;for(px&&px.length===nx&&(dx=[]),cx&&cx.length===nx&&(lx=[]),sx=0;sx<nx;sx++){var mx=ix[sx]._id;dx&&dx.push(px[mx]),lx&&lx.push(cx[mx])}dx&&(this.faceVertexUvs[0]=dx),lx&&(this.faceVertexUvs[1]=lx)},toJSON:function(){function ix(Ox,Ix,Dx){return Dx?Ox|1<<Ix:Ox&~(1<<Ix)}function nx(Ox){var Ix=Ox.x.toString()+Ox.y.toString()+Ox.z.toString();return void 0===yx[Ix]?(yx[Ix]=fx.length/3,fx.push(Ox.x,Ox.y,Ox.z),yx[Ix]):yx[Ix]}function sx(Ox){var Ix=Ox.r.toString()+Ox.g.toString()+Ox.b.toString();return void 0===vx[Ix]?(vx[Ix]=xx.length,xx.push(Ox.getHex()),vx[Ix]):vx[Ix]}function dx(Ox){var Ix=Ox.x.toString()+Ox.y.toString();return void 0===bx[Ix]?(bx[Ix]=Lx.length/2,Lx.push(Ox.x,Ox.y),bx[Ix]):bx[Ix]}var lx={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(lx.uuid=this.uuid,lx.type=this.type,""!==this.name&&(lx.name=this.name),void 0!==this.parameters){var px=this.parameters;for(var cx in px)void 0!==px[cx]&&(lx[cx]=px[cx]);return lx}for(var mx=[],ux=0,gx;ux<this.vertices.length;ux++)gx=this.vertices[ux],mx.push(gx.x,gx.y,gx.z);var hx=[],fx=[],yx={},xx=[],vx={},Lx=[],bx={};for(ux=0;ux<this.faces.length;ux++){var _x=this.faces[ux],Ax=void 0!==this.faceVertexUvs[0][ux],Ex=0<_x.normal.length(),Sx=0<_x.vertexNormals.length,Tx=1!==_x.color.r||1!==_x.color.g||1!==_x.color.b,Mx=0<_x.vertexColors.length,wx=0;if(wx=ix(wx=ix(wx=ix(wx=ix(wx=ix(wx=ix(wx=ix(wx=ix(wx,0,0),1,!0),2,!1),3,Ax),4,Ex),5,Sx),6,Tx),7,Mx),hx.push(wx),hx.push(_x.a,_x.b,_x.c),hx.push(_x.materialIndex),Ax){var Rx=this.faceVertexUvs[0][ux];hx.push(dx(Rx[0]),dx(Rx[1]),dx(Rx[2]))}if(Ex&&hx.push(nx(_x.normal)),Sx){var Px=_x.vertexNormals;hx.push(nx(Px[0]),nx(Px[1]),nx(Px[2]))}if(Tx&&hx.push(sx(_x.color)),Mx){var Cx=_x.vertexColors;hx.push(sx(Cx[0]),sx(Cx[1]),sx(Cx[2]))}}return lx.data={},lx.data.vertices=mx,lx.data.normals=fx,0<xx.length&&(lx.data.colors=xx),0<Lx.length&&(lx.data.uvs=[Lx]),lx.data.faces=hx,lx},clone:function(){return new ll().copy(this)},copy:function(ix){var nx,sx,dx,lx,px,cx;this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=ix.name;var mx=ix.vertices;for(nx=0,sx=mx.length;nx<sx;nx++)this.vertices.push(mx[nx].clone());var ux=ix.colors;for(nx=0,sx=ux.length;nx<sx;nx++)this.colors.push(ux[nx].clone());var gx=ix.faces;for(nx=0,sx=gx.length;nx<sx;nx++)this.faces.push(gx[nx].clone());for(nx=0,sx=ix.faceVertexUvs.length;nx<sx;nx++){var hx=ix.faceVertexUvs[nx];for(void 0===this.faceVertexUvs[nx]&&(this.faceVertexUvs[nx]=[]),dx=0,lx=hx.length;dx<lx;dx++){var fx=hx[dx],yx=[];for(px=0,cx=fx.length;px<cx;px++){var xx=fx[px];yx.push(xx.clone())}this.faceVertexUvs[nx].push(yx)}}var vx=ix.morphTargets;for(nx=0,sx=vx.length;nx<sx;nx++){var Lx={};if(Lx.name=vx[nx].name,void 0!==vx[nx].vertices)for(Lx.vertices=[],dx=0,lx=vx[nx].vertices.length;dx<lx;dx++)Lx.vertices.push(vx[nx].vertices[dx].clone());if(void 0!==vx[nx].normals)for(Lx.normals=[],dx=0,lx=vx[nx].normals.length;dx<lx;dx++)Lx.normals.push(vx[nx].normals[dx].clone());this.morphTargets.push(Lx)}var bx=ix.morphNormals;for(nx=0,sx=bx.length;nx<sx;nx++){var _x={};if(void 0!==bx[nx].vertexNormals)for(_x.vertexNormals=[],dx=0,lx=bx[nx].vertexNormals.length;dx<lx;dx++){var Ax=bx[nx].vertexNormals[dx],Ex={};Ex.a=Ax.a.clone(),Ex.b=Ax.b.clone(),Ex.c=Ax.c.clone(),_x.vertexNormals.push(Ex)}if(void 0!==bx[nx].faceNormals)for(_x.faceNormals=[],dx=0,lx=bx[nx].faceNormals.length;dx<lx;dx++)_x.faceNormals.push(bx[nx].faceNormals[dx].clone());this.morphNormals.push(_x)}var Sx=ix.skinWeights;for(nx=0,sx=Sx.length;nx<sx;nx++)this.skinWeights.push(Sx[nx].clone());var Tx=ix.skinIndices;for(nx=0,sx=Tx.length;nx<sx;nx++)this.skinIndices.push(Tx[nx].clone());var Mx=ix.lineDistances;for(nx=0,sx=Mx.length;nx<sx;nx++)this.lineDistances.push(Mx[nx]);var wx=ix.boundingBox;null!==wx&&(this.boundingBox=wx.clone());var Rx=ix.boundingSphere;return null!==Rx&&(this.boundingSphere=Rx.clone()),this.elementsNeedUpdate=ix.elementsNeedUpdate,this.verticesNeedUpdate=ix.verticesNeedUpdate,this.uvsNeedUpdate=ix.uvsNeedUpdate,this.normalsNeedUpdate=ix.normalsNeedUpdate,this.colorsNeedUpdate=ix.colorsNeedUpdate,this.lineDistancesNeedUpdate=ix.lineDistancesNeedUpdate,this.groupsNeedUpdate=ix.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(pl.prototype,"needsUpdate",{set:function(ix){!0===ix&&this.version++}}),Object.assign(pl.prototype,{isBufferAttribute:!0,setArray:function(ix){if(Array.isArray(ix))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.count=void 0===ix?0:ix.length/this.itemSize,this.array=ix},setDynamic:function(ix){return this.dynamic=ix,this},copy:function(ix){return this.array=new ix.array.constructor(ix.array),this.itemSize=ix.itemSize,this.count=ix.count,this.normalized=ix.normalized,this.dynamic=ix.dynamic,this},copyAt:function(ix,nx,sx){ix*=this.itemSize,sx*=nx.itemSize;for(var dx=0,lx=this.itemSize;dx<lx;dx++)this.array[ix+dx]=nx.array[sx+dx];return this},copyArray:function(ix){return this.array.set(ix),this},copyColorsArray:function(ix){for(var nx=this.array,sx=0,dx=0,lx=ix.length,px;dx<lx;dx++)px=ix[dx],void 0===px&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",dx),px=new Xd),nx[sx++]=px.r,nx[sx++]=px.g,nx[sx++]=px.b;return this},copyIndicesArray:function(ix){for(var nx=this.array,sx=0,dx=0,lx=ix.length,px;dx<lx;dx++)px=ix[dx],nx[sx++]=px.a,nx[sx++]=px.b,nx[sx++]=px.c;return this},copyVector2sArray:function(ix){for(var nx=this.array,sx=0,dx=0,lx=ix.length,px;dx<lx;dx++)px=ix[dx],void 0===px&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",dx),px=new od),nx[sx++]=px.x,nx[sx++]=px.y;return this},copyVector3sArray:function(ix){for(var nx=this.array,sx=0,dx=0,lx=ix.length,px;dx<lx;dx++)px=ix[dx],void 0===px&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",dx),px=new sd),nx[sx++]=px.x,nx[sx++]=px.y,nx[sx++]=px.z;return this},copyVector4sArray:function(ix){for(var nx=this.array,sx=0,dx=0,lx=ix.length,px;dx<lx;dx++)px=ix[dx],void 0===px&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",dx),px=new pd),nx[sx++]=px.x,nx[sx++]=px.y,nx[sx++]=px.z,nx[sx++]=px.w;return this},set:function(ix,nx){return void 0===nx&&(nx=0),this.array.set(ix,nx),this},getX:function(ix){return this.array[ix*this.itemSize]},setX:function(ix,nx){return this.array[ix*this.itemSize]=nx,this},getY:function(ix){return this.array[ix*this.itemSize+1]},setY:function(ix,nx){return this.array[ix*this.itemSize+1]=nx,this},getZ:function(ix){return this.array[ix*this.itemSize+2]},setZ:function(ix,nx){return this.array[ix*this.itemSize+2]=nx,this},getW:function(ix){return this.array[ix*this.itemSize+3]},setW:function(ix,nx){return this.array[ix*this.itemSize+3]=nx,this},setXY:function(ix,nx,sx){return ix*=this.itemSize,this.array[ix+0]=nx,this.array[ix+1]=sx,this},setXYZ:function(ix,nx,sx,dx){return ix*=this.itemSize,this.array[ix+0]=nx,this.array[ix+1]=sx,this.array[ix+2]=dx,this},setXYZW:function(ix,nx,sx,dx,lx){return ix*=this.itemSize,this.array[ix+0]=nx,this.array[ix+1]=sx,this.array[ix+2]=dx,this.array[ix+3]=lx,this},onUpload:function(ix){return this.onUploadCallback=ix,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)}}),cl.prototype=Object.create(pl.prototype),cl.prototype.constructor=cl,ml.prototype=Object.create(pl.prototype),ml.prototype.constructor=ml,ul.prototype=Object.create(pl.prototype),ul.prototype.constructor=ul,gl.prototype=Object.create(pl.prototype),gl.prototype.constructor=gl,hl.prototype=Object.create(pl.prototype),hl.prototype.constructor=hl,fl.prototype=Object.create(pl.prototype),fl.prototype.constructor=fl,yl.prototype=Object.create(pl.prototype),yl.prototype.constructor=yl,xl.prototype=Object.create(pl.prototype),xl.prototype.constructor=xl,vl.prototype=Object.create(pl.prototype),vl.prototype.constructor=vl,Object.assign(Ll.prototype,{computeGroups:function(ix){for(var sx=[],dx=void 0,lx=ix.faces,px=0,nx,cx;px<lx.length;px++)cx=lx[px],cx.materialIndex!==dx&&(dx=cx.materialIndex,void 0!=nx&&(nx.count=3*px-nx.start,sx.push(nx)),nx={start:3*px,materialIndex:dx});void 0!==nx&&(nx.count=3*px-nx.start,sx.push(nx)),this.groups=sx},fromGeometry:function(ix){var sx=ix.faces,dx=ix.vertices,lx=ix.faceVertexUvs,px=lx[0]&&0<lx[0].length,cx=lx[1]&&0<lx[1].length,mx=ix.morphTargets,ux=mx.length,nx;if(0<ux){nx=[];for(var gx=0;gx<ux;gx++)nx[gx]=[];this.morphTargets.position=nx}var fx=ix.morphNormals,yx=fx.length,hx;if(0<yx){for(hx=[],gx=0;gx<yx;gx++)hx[gx]=[];this.morphTargets.normal=hx}var xx=ix.skinIndices,vx=ix.skinWeights,Lx=xx.length===dx.length,bx=vx.length===dx.length;for(gx=0;gx<sx.length;gx++){var _x=sx[gx];this.vertices.push(dx[_x.a],dx[_x.b],dx[_x.c]);var Ax=_x.vertexNormals;if(3===Ax.length)this.normals.push(Ax[0],Ax[1],Ax[2]);else{var Ex=_x.normal;this.normals.push(Ex,Ex,Ex)}var Tx=_x.vertexColors,Sx;if(3===Tx.length)this.colors.push(Tx[0],Tx[1],Tx[2]);else{var Mx=_x.color;this.colors.push(Mx,Mx,Mx)}!0===px&&(void 0===(Sx=lx[0][gx])?(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",gx),this.uvs.push(new od,new od,new od)):this.uvs.push(Sx[0],Sx[1],Sx[2])),!0===cx&&(void 0===(Sx=lx[1][gx])?(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",gx),this.uvs2.push(new od,new od,new od)):this.uvs2.push(Sx[0],Sx[1],Sx[2]));for(var wx=0,Rx;wx<ux;wx++)Rx=mx[wx].vertices,nx[wx].push(Rx[_x.a],Rx[_x.b],Rx[_x.c]);for(wx=0;wx<yx;wx++){var Px=fx[wx].vertexNormals[gx];hx[wx].push(Px.a,Px.b,Px.c)}Lx&&this.skinIndices.push(xx[_x.a],xx[_x.b],xx[_x.c]),bx&&this.skinWeights.push(vx[_x.a],vx[_x.b],vx[_x.c])}return this.computeGroups(ix),this.verticesNeedUpdate=ix.verticesNeedUpdate,this.normalsNeedUpdate=ix.normalsNeedUpdate,this.colorsNeedUpdate=ix.colorsNeedUpdate,this.uvsNeedUpdate=ix.uvsNeedUpdate,this.groupsNeedUpdate=ix.groupsNeedUpdate,this}});var Py=1;_l.prototype=Object.assign(Object.create(rd.prototype),{constructor:_l,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(ix){this.index=Array.isArray(ix)?new(65535<bl(ix)?yl:hl)(ix,1):ix},addAttribute:function(ix,nx){return nx&&nx.isBufferAttribute||nx&&nx.isInterleavedBufferAttribute?"index"===ix?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),void this.setIndex(nx)):(this.attributes[ix]=nx,this):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),void this.addAttribute(ix,new pl(arguments[1],arguments[2])))},getAttribute:function(ix){return this.attributes[ix]},removeAttribute:function(ix){return delete this.attributes[ix],this},addGroup:function(ix,nx,sx){this.groups.push({start:ix,count:nx,materialIndex:void 0===sx?0:sx})},clearGroups:function(){this.groups=[]},setDrawRange:function(ix,nx){this.drawRange.start=ix,this.drawRange.count=nx},applyMatrix:function(ix){var nx=this.attributes.position;void 0!==nx&&(ix.applyToBufferAttribute(nx),nx.needsUpdate=!0);var sx=this.attributes.normal;return void 0!==sx&&(new dd().getNormalMatrix(ix).applyToBufferAttribute(sx),sx.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(){var ix=new id;return function(nx){return ix.makeRotationX(nx),this.applyMatrix(ix),this}}(),rotateY:function(){var ix=new id;return function(nx){return ix.makeRotationY(nx),this.applyMatrix(ix),this}}(),rotateZ:function(){var ix=new id;return function(nx){return ix.makeRotationZ(nx),this.applyMatrix(ix),this}}(),translate:function(){var ix=new id;return function(nx,sx,dx){return ix.makeTranslation(nx,sx,dx),this.applyMatrix(ix),this}}(),scale:function(){var ix=new id;return function(nx,sx,dx){return ix.makeScale(nx,sx,dx),this.applyMatrix(ix),this}}(),lookAt:function(){var ix=new il;return function(nx){ix.lookAt(nx),ix.updateMatrix(),this.applyMatrix(ix.matrix)}}(),center:function(){this.computeBoundingBox();var ix=this.boundingBox.getCenter().negate();return this.translate(ix.x,ix.y,ix.z),ix},setFromObject:function(ix){var nx=ix.geometry;if(ix.isPoints||ix.isLine){var sx=new xl(3*nx.vertices.length,3),dx=new xl(3*nx.colors.length,3);if(this.addAttribute("position",sx.copyVector3sArray(nx.vertices)),this.addAttribute("color",dx.copyColorsArray(nx.colors)),nx.lineDistances&&nx.lineDistances.length===nx.vertices.length){var lx=new xl(nx.lineDistances.length,1);this.addAttribute("lineDistance",lx.copyArray(nx.lineDistances))}null!==nx.boundingSphere&&(this.boundingSphere=nx.boundingSphere.clone()),null!==nx.boundingBox&&(this.boundingBox=nx.boundingBox.clone())}else ix.isMesh&&nx&&nx.isGeometry&&this.fromGeometry(nx);return this},setFromPoints:function(ix){for(var nx=[],sx=0,dx=ix.length,lx;sx<dx;sx++)lx=ix[sx],nx.push(lx.x,lx.y,lx.z||0);return this.addAttribute("position",new xl(nx,3)),this},updateFromObject:function(ix){var sx=ix.geometry,nx;if(ix.isMesh){var dx=sx.__directGeometry;if(!0===sx.elementsNeedUpdate&&(dx=void 0,sx.elementsNeedUpdate=!1),void 0===dx)return this.fromGeometry(sx);dx.verticesNeedUpdate=sx.verticesNeedUpdate,dx.normalsNeedUpdate=sx.normalsNeedUpdate,dx.colorsNeedUpdate=sx.colorsNeedUpdate,dx.uvsNeedUpdate=sx.uvsNeedUpdate,dx.groupsNeedUpdate=sx.groupsNeedUpdate,sx.verticesNeedUpdate=!1,sx.normalsNeedUpdate=!1,sx.colorsNeedUpdate=!1,sx.uvsNeedUpdate=!1,sx.groupsNeedUpdate=!1,sx=dx}return!0===sx.verticesNeedUpdate&&(void 0!==(nx=this.attributes.position)&&(nx.copyVector3sArray(sx.vertices),nx.needsUpdate=!0),sx.verticesNeedUpdate=!1),!0===sx.normalsNeedUpdate&&(void 0!==(nx=this.attributes.normal)&&(nx.copyVector3sArray(sx.normals),nx.needsUpdate=!0),sx.normalsNeedUpdate=!1),!0===sx.colorsNeedUpdate&&(void 0!==(nx=this.attributes.color)&&(nx.copyColorsArray(sx.colors),nx.needsUpdate=!0),sx.colorsNeedUpdate=!1),sx.uvsNeedUpdate&&(void 0!==(nx=this.attributes.uv)&&(nx.copyVector2sArray(sx.uvs),nx.needsUpdate=!0),sx.uvsNeedUpdate=!1),sx.lineDistancesNeedUpdate&&(void 0!==(nx=this.attributes.lineDistance)&&(nx.copyArray(sx.lineDistances),nx.needsUpdate=!0),sx.lineDistancesNeedUpdate=!1),sx.groupsNeedUpdate&&(sx.computeGroups(ix.geometry),this.groups=sx.groups,sx.groupsNeedUpdate=!1),this},fromGeometry:function(ix){return ix.__directGeometry=new Ll().fromGeometry(ix),this.fromDirectGeometry(ix.__directGeometry)},fromDirectGeometry:function(ix){var nx=new Float32Array(3*ix.vertices.length);if(this.addAttribute("position",new pl(nx,3).copyVector3sArray(ix.vertices)),0<ix.normals.length){var sx=new Float32Array(3*ix.normals.length);this.addAttribute("normal",new pl(sx,3).copyVector3sArray(ix.normals))}if(0<ix.colors.length){var dx=new Float32Array(3*ix.colors.length);this.addAttribute("color",new pl(dx,3).copyColorsArray(ix.colors))}if(0<ix.uvs.length){var lx=new Float32Array(2*ix.uvs.length);this.addAttribute("uv",new pl(lx,2).copyVector2sArray(ix.uvs))}if(0<ix.uvs2.length){var px=new Float32Array(2*ix.uvs2.length);this.addAttribute("uv2",new pl(px,2).copyVector2sArray(ix.uvs2))}if(0<ix.indices.length){var cx=new(65535<bl(ix.indices)?Uint32Array:Uint16Array)(3*ix.indices.length);this.setIndex(new pl(cx,1).copyIndicesArray(ix.indices))}for(var mx in this.groups=ix.groups,ix.morphTargets){for(var ux=[],gx=ix.morphTargets[mx],hx=0,fx=gx.length;hx<fx;hx++){var yx=gx[hx],xx=new xl(3*yx.length,3);ux.push(xx.copyVector3sArray(yx))}this.morphAttributes[mx]=ux}if(0<ix.skinIndices.length){var vx=new xl(4*ix.skinIndices.length,4);this.addAttribute("skinIndex",vx.copyVector4sArray(ix.skinIndices))}if(0<ix.skinWeights.length){var Lx=new xl(4*ix.skinWeights.length,4);this.addAttribute("skinWeight",Lx.copyVector4sArray(ix.skinWeights))}return null!==ix.boundingSphere&&(this.boundingSphere=ix.boundingSphere.clone()),null!==ix.boundingBox&&(this.boundingBox=ix.boundingBox.clone()),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new Qd);var ix=this.attributes.position;void 0===ix?this.boundingBox.makeEmpty():this.boundingBox.setFromBufferAttribute(ix),(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error("THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The \"position\" attribute is likely to have NaN values.",this)},computeBoundingSphere:function(){var ix=new Qd,nx=new sd;return function(){null===this.boundingSphere&&(this.boundingSphere=new $d);var sx=this.attributes.position;if(sx){var dx=this.boundingSphere.center;ix.setFromBufferAttribute(sx),ix.getCenter(dx);for(var lx=0,px=0,cx=sx.count;px<cx;px++)nx.x=sx.getX(px),nx.y=sx.getY(px),nx.z=sx.getZ(px),lx=Math.max(lx,dx.distanceToSquared(nx));this.boundingSphere.radius=Math.sqrt(lx),isNaN(this.boundingSphere.radius)&&console.error("THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The \"position\" attribute is likely to have NaN values.",this)}}}(),computeFaceNormals:function(){},computeVertexNormals:function(){var ix=this.index,nx=this.attributes,sx=this.groups;if(nx.position){var dx=nx.position.array;if(void 0===nx.normal)this.addAttribute("normal",new pl(new Float32Array(dx.length),3));else for(var lx=nx.normal.array,px=0,cx=lx.length;px<cx;px++)lx[px]=0;var hx=nx.normal.array,fx=new sd,yx=new sd,xx=new sd,vx=new sd,Lx=new sd,mx,ux,gx;if(ix){var bx=ix.array;0===sx.length&&this.addGroup(0,bx.length);for(var _x=0,Ax=sx.length;_x<Ax;++_x){var Ex=sx[_x],Sx=Ex.start;for(px=Sx,cx=Sx+Ex.count;px<cx;px+=3)mx=3*bx[px+0],ux=3*bx[px+1],gx=3*bx[px+2],fx.fromArray(dx,mx),yx.fromArray(dx,ux),xx.fromArray(dx,gx),vx.subVectors(xx,yx),Lx.subVectors(fx,yx),vx.cross(Lx),hx[mx]+=vx.x,hx[mx+1]+=vx.y,hx[mx+2]+=vx.z,hx[ux]+=vx.x,hx[ux+1]+=vx.y,hx[ux+2]+=vx.z,hx[gx]+=vx.x,hx[gx+1]+=vx.y,hx[gx+2]+=vx.z}}else for(px=0,cx=dx.length;px<cx;px+=9)fx.fromArray(dx,px),yx.fromArray(dx,px+3),xx.fromArray(dx,px+6),vx.subVectors(xx,yx),Lx.subVectors(fx,yx),vx.cross(Lx),hx[px]=vx.x,hx[px+1]=vx.y,hx[px+2]=vx.z,hx[px+3]=vx.x,hx[px+4]=vx.y,hx[px+5]=vx.z,hx[px+6]=vx.x,hx[px+7]=vx.y,hx[px+8]=vx.z;this.normalizeNormals(),nx.normal.needsUpdate=!0}},merge:function(ix,nx){if(ix&&ix.isBufferGeometry){void 0===nx&&(nx=0);var sx=this.attributes;for(var dx in sx)if(void 0!==ix.attributes[dx])for(var lx=sx[dx].array,px=ix.attributes[dx],cx=px.array,mx=0,ux=px.itemSize*nx;mx<cx.length;mx++,ux++)lx[ux]=cx[mx];return this}console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",ix)},normalizeNormals:function(){var ix=new sd;return function(){for(var nx=this.attributes.normal,sx=0,dx=nx.count;sx<dx;sx++)ix.x=nx.getX(sx),ix.y=nx.getY(sx),ix.z=nx.getZ(sx),ix.normalize(),nx.setXYZ(sx,ix.x,ix.y,ix.z)}}(),toNonIndexed:function(){if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var ix=new _l,nx=this.index.array,sx=this.attributes;for(var dx in sx){for(var lx=sx[dx],px=lx.array,cx=lx.itemSize,mx=new px.constructor(nx.length*cx),ux=0,gx=0,hx=0,fx=nx.length;hx<fx;hx++){ux=nx[hx]*cx;for(var yx=0;yx<cx;yx++)mx[gx++]=px[ux++]}ix.addAttribute(dx,new pl(mx,cx))}return ix},toJSON:function(){var ix={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(ix.uuid=this.uuid,ix.type=this.type,""!==this.name&&(ix.name=this.name),void 0!==this.parameters){var nx=this.parameters;for(var sx in nx)void 0!==nx[sx]&&(ix[sx]=nx[sx]);return ix}ix.data={attributes:{}};var dx=this.index;if(null!==dx){var lx=Array.prototype.slice.call(dx.array);ix.data.index={type:dx.array.constructor.name,array:lx}}var px=this.attributes;for(var sx in px){var cx=px[sx];lx=Array.prototype.slice.call(cx.array),ix.data.attributes[sx]={itemSize:cx.itemSize,type:cx.array.constructor.name,array:lx,normalized:cx.normalized}}var mx=this.groups;0<mx.length&&(ix.data.groups=JSON.parse(JSON.stringify(mx)));var ux=this.boundingSphere;return null!==ux&&(ix.data.boundingSphere={center:ux.center.toArray(),radius:ux.radius}),ix},clone:function(){return new _l().copy(this)},copy:function(ix){var nx,sx,dx;this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.name=ix.name;var lx=ix.index;null!==lx&&this.setIndex(lx.clone());var px=ix.attributes;for(nx in px){var cx=px[nx];this.addAttribute(nx,cx.clone())}var mx=ix.morphAttributes;for(nx in mx){var ux=[],gx=mx[nx];for(sx=0,dx=gx.length;sx<dx;sx++)ux.push(gx[sx].clone());this.morphAttributes[nx]=ux}var hx=ix.groups;for(sx=0,dx=hx.length;sx<dx;sx++){var fx=hx[sx];this.addGroup(fx.start,fx.count,fx.materialIndex)}var yx=ix.boundingBox;null!==yx&&(this.boundingBox=yx.clone());var xx=ix.boundingSphere;return null!==xx&&(this.boundingSphere=xx.clone()),this.drawRange.start=ix.drawRange.start,this.drawRange.count=ix.drawRange.count,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Al.prototype=Object.create(ll.prototype),Al.prototype.constructor=Al,El.prototype=Object.create(_l.prototype),El.prototype.constructor=El,Sl.prototype=Object.create(ll.prototype),Sl.prototype.constructor=Sl,Tl.prototype=Object.create(_l.prototype),Tl.prototype.constructor=Tl,Ml.prototype=Object.create(Zd.prototype),Ml.prototype.constructor=Ml,Ml.prototype.isMeshBasicMaterial=!0,Ml.prototype.copy=function(ix){return Zd.prototype.copy.call(this,ix),this.color.copy(ix.color),this.map=ix.map,this.lightMap=ix.lightMap,this.lightMapIntensity=ix.lightMapIntensity,this.aoMap=ix.aoMap,this.aoMapIntensity=ix.aoMapIntensity,this.specularMap=ix.specularMap,this.alphaMap=ix.alphaMap,this.envMap=ix.envMap,this.combine=ix.combine,this.reflectivity=ix.reflectivity,this.refractionRatio=ix.refractionRatio,this.wireframe=ix.wireframe,this.wireframeLinewidth=ix.wireframeLinewidth,this.wireframeLinecap=ix.wireframeLinecap,this.wireframeLinejoin=ix.wireframeLinejoin,this.skinning=ix.skinning,this.morphTargets=ix.morphTargets,this},wl.prototype=Object.create(Zd.prototype),wl.prototype.constructor=wl,wl.prototype.isShaderMaterial=!0,wl.prototype.copy=function(ix){return Zd.prototype.copy.call(this,ix),this.fragmentShader=ix.fragmentShader,this.vertexShader=ix.vertexShader,this.uniforms=Ey.clone(ix.uniforms),this.defines=ix.defines,this.wireframe=ix.wireframe,this.wireframeLinewidth=ix.wireframeLinewidth,this.lights=ix.lights,this.clipping=ix.clipping,this.skinning=ix.skinning,this.morphTargets=ix.morphTargets,this.morphNormals=ix.morphNormals,this.extensions=ix.extensions,this},wl.prototype.toJSON=function(ix){var nx=Zd.prototype.toJSON.call(this,ix);return nx.uniforms=this.uniforms,nx.vertexShader=this.vertexShader,nx.fragmentShader=this.fragmentShader,nx},Object.assign(Rl.prototype,{set:function(ix,nx){return this.origin.copy(ix),this.direction.copy(nx),this},clone:function(){return new this.constructor().copy(this)},copy:function(ix){return this.origin.copy(ix.origin),this.direction.copy(ix.direction),this},at:function(ix,nx){return(nx||new sd).copy(this.direction).multiplyScalar(ix).add(this.origin)},lookAt:function(ix){return this.direction.copy(ix).sub(this.origin).normalize(),this},recast:function(){var ix=new sd;return function(nx){return this.origin.copy(this.at(nx,ix)),this}}(),closestPointToPoint:function(ix,nx){var sx=nx||new sd;sx.subVectors(ix,this.origin);var dx=sx.dot(this.direction);return 0>dx?sx.copy(this.origin):sx.copy(this.direction).multiplyScalar(dx).add(this.origin)},distanceToPoint:function(ix){return Math.sqrt(this.distanceSqToPoint(ix))},distanceSqToPoint:function(){var ix=new sd;return function(nx){var sx=ix.subVectors(nx,this.origin).dot(this.direction);return 0>sx?this.origin.distanceToSquared(nx):(ix.copy(this.direction).multiplyScalar(sx).add(this.origin),ix.distanceToSquared(nx))}}(),distanceSqToSegment:function(){var ix=new sd,nx=new sd,sx=new sd;return function(dx,lx,px,cx){ix.copy(dx).add(lx).multiplyScalar(.5),nx.copy(lx).sub(dx).normalize(),sx.copy(this.origin).sub(ix);var fx=.5*dx.distanceTo(lx),yx=-this.direction.dot(nx),xx=sx.dot(this.direction),vx=-sx.dot(nx),Lx=sx.lengthSq(),bx=Math.abs(1-yx*yx),mx,ux,gx,hx;if(!(0<bx))ux=0<yx?-fx:fx,gx=-(mx=Math.max(0,-(yx*ux+xx)))*mx+ux*(ux+2*vx)+Lx;else if(!(ux=yx*xx-vx,hx=fx*bx,0<=(mx=yx*vx-xx)))ux<=-hx?gx=-(mx=Math.max(0,-(-yx*fx+xx)))*mx+(ux=0<mx?-fx:Math.min(Math.max(-fx,-vx),fx))*(ux+2*vx)+Lx:ux<=hx?(mx=0,gx=(ux=Math.min(Math.max(-fx,-vx),fx))*(ux+2*vx)+Lx):gx=-(mx=Math.max(0,-(yx*fx+xx)))*mx+(ux=0<mx?fx:Math.min(Math.max(-fx,-vx),fx))*(ux+2*vx)+Lx;else if(!(ux>=-hx))ux=-fx,gx=-(mx=Math.max(0,-(yx*ux+xx)))*mx+ux*(ux+2*vx)+Lx;else if(ux<=hx){var _x=1/bx;gx=(mx*=_x)*(mx+yx*(ux*=_x)+2*xx)+ux*(yx*mx+ux+2*vx)+Lx}else ux=fx,gx=-(mx=Math.max(0,-(yx*ux+xx)))*mx+ux*(ux+2*vx)+Lx;return px&&px.copy(this.direction).multiplyScalar(mx).add(this.origin),cx&&cx.copy(nx).multiplyScalar(ux).add(ix),gx}}(),intersectSphere:function(){var ix=new sd;return function(nx,sx){ix.subVectors(nx.center,this.origin);var dx=ix.dot(this.direction),lx=ix.dot(ix)-dx*dx,px=nx.radius*nx.radius;if(lx>px)return null;var cx=Math.sqrt(px-lx),mx=dx-cx,ux=dx+cx;return 0>mx&&0>ux?null:0>mx?this.at(ux,sx):this.at(mx,sx)}}(),intersectsSphere:function(ix){return this.distanceToPoint(ix.center)<=ix.radius},distanceToPlane:function(ix){var nx=ix.normal.dot(this.direction);if(0===nx)return 0===ix.distanceToPoint(this.origin)?0:null;var sx=-(this.origin.dot(ix.normal)+ix.constant)/nx;return 0<=sx?sx:null},intersectPlane:function(ix,nx){var sx=this.distanceToPlane(ix);return null===sx?null:this.at(sx,nx)},intersectsPlane:function(ix){var nx=ix.distanceToPoint(this.origin);return 0===nx||0>ix.normal.dot(this.direction)*nx},intersectBox:function(ix,nx){var ux=1/this.direction.x,gx=1/this.direction.y,hx=1/this.direction.z,fx=this.origin,sx,dx,lx,px,cx,mx;return 0<=ux?(sx=(ix.min.x-fx.x)*ux,dx=(ix.max.x-fx.x)*ux):(sx=(ix.max.x-fx.x)*ux,dx=(ix.min.x-fx.x)*ux),0<=gx?(lx=(ix.min.y-fx.y)*gx,px=(ix.max.y-fx.y)*gx):(lx=(ix.max.y-fx.y)*gx,px=(ix.min.y-fx.y)*gx),sx>px||lx>dx?null:((lx>sx||sx!=sx)&&(sx=lx),(px<dx||dx!=dx)&&(dx=px),0<=hx?(cx=(ix.min.z-fx.z)*hx,mx=(ix.max.z-fx.z)*hx):(cx=(ix.max.z-fx.z)*hx,mx=(ix.min.z-fx.z)*hx),sx>mx||cx>dx?null:((cx>sx||sx!=sx)&&(sx=cx),(mx<dx||dx!=dx)&&(dx=mx),0>dx?null:this.at(0<=sx?sx:dx,nx)))},intersectsBox:function(){var ix=new sd;return function(nx){return null!==this.intersectBox(nx,ix)}}(),intersectTriangle:function(){var ix=new sd,nx=new sd,sx=new sd,dx=new sd;return function(lx,px,cx,mx,ux){nx.subVectors(px,lx),sx.subVectors(cx,lx),dx.crossVectors(nx,sx);var hx=this.direction.dot(dx),gx;if(0<hx){if(mx)return null;gx=1}else{if(!(0>hx))return null;gx=-1,hx=-hx}ix.subVectors(this.origin,lx);var fx=gx*this.direction.dot(sx.crossVectors(ix,sx));if(0>fx)return null;var yx=gx*this.direction.dot(nx.cross(ix));if(0>yx)return null;if(fx+yx>hx)return null;var xx=-gx*ix.dot(dx);return 0>xx?null:this.at(xx/hx,ux)}}(),applyMatrix4:function(ix){return this.origin.applyMatrix4(ix),this.direction.transformDirection(ix),this},equals:function(ix){return ix.origin.equals(this.origin)&&ix.direction.equals(this.direction)}}),Object.assign(Pl.prototype,{set:function(ix,nx){return this.start.copy(ix),this.end.copy(nx),this},clone:function(){return new this.constructor().copy(this)},copy:function(ix){return this.start.copy(ix.start),this.end.copy(ix.end),this},getCenter:function(ix){return(ix||new sd).addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(ix){return(ix||new sd).subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(ix,nx){var sx=nx||new sd;return this.delta(sx).multiplyScalar(ix).add(this.start)},closestPointToPointParameter:function(){var ix=new sd,nx=new sd;return function(sx,dx){ix.subVectors(sx,this.start),nx.subVectors(this.end,this.start);var lx=nx.dot(nx),px=nx.dot(ix)/lx;return dx&&(px=uy.clamp(px,0,1)),px}}(),closestPointToPoint:function(ix,nx,sx){var dx=this.closestPointToPointParameter(ix,nx),lx=sx||new sd;return this.delta(lx).multiplyScalar(dx).add(this.start)},applyMatrix4:function(ix){return this.start.applyMatrix4(ix),this.end.applyMatrix4(ix),this},equals:function(ix){return ix.start.equals(this.start)&&ix.end.equals(this.end)}}),Object.assign(Cl,{normal:function(){var ix=new sd;return function(nx,sx,dx,lx){var px=lx||new sd;px.subVectors(dx,sx),ix.subVectors(nx,sx),px.cross(ix);var cx=px.lengthSq();return 0<cx?px.multiplyScalar(1/Math.sqrt(cx)):px.set(0,0,0)}}(),barycoordFromPoint:function(){var ix=new sd,nx=new sd,sx=new sd;return function(dx,lx,px,cx,mx){ix.subVectors(cx,lx),nx.subVectors(px,lx),sx.subVectors(dx,lx);var ux=ix.dot(ix),gx=ix.dot(nx),hx=ix.dot(sx),fx=nx.dot(nx),yx=nx.dot(sx),xx=ux*fx-gx*gx,vx=mx||new sd;if(0==xx)return vx.set(-2,-1,-1);var Lx=1/xx,bx=(fx*hx-gx*yx)*Lx,_x=(ux*yx-gx*hx)*Lx;return vx.set(1-bx-_x,_x,bx)}}(),containsPoint:function(){var ix=new sd;return function(nx,sx,dx,lx){var px=Cl.barycoordFromPoint(nx,sx,dx,lx,ix);return 0<=px.x&&0<=px.y&&1>=px.x+px.y}}()}),Object.assign(Cl.prototype,{set:function(ix,nx,sx){return this.a.copy(ix),this.b.copy(nx),this.c.copy(sx),this},setFromPointsAndIndices:function(ix,nx,sx,dx){return this.a.copy(ix[nx]),this.b.copy(ix[sx]),this.c.copy(ix[dx]),this},clone:function(){return new this.constructor().copy(this)},copy:function(ix){return this.a.copy(ix.a),this.b.copy(ix.b),this.c.copy(ix.c),this},area:function(){var ix=new sd,nx=new sd;return function(){return ix.subVectors(this.c,this.b),nx.subVectors(this.a,this.b),.5*ix.cross(nx).length()}}(),midpoint:function(ix){return(ix||new sd).addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},normal:function(ix){return Cl.normal(this.a,this.b,this.c,ix)},plane:function(ix){return(ix||new el).setFromCoplanarPoints(this.a,this.b,this.c)},barycoordFromPoint:function(ix,nx){return Cl.barycoordFromPoint(ix,this.a,this.b,this.c,nx)},containsPoint:function(ix){return Cl.containsPoint(ix,this.a,this.b,this.c)},intersectsBox:function(ix){return ix.intersectsTriangle(this)},closestPointToPoint:function(){var ix=new el,nx=[new Pl,new Pl,new Pl],sx=new sd,dx=new sd;return function(lx,px){var cx=px||new sd,mx=1/0;if(ix.setFromCoplanarPoints(this.a,this.b,this.c),ix.projectPoint(lx,sx),!0===this.containsPoint(sx))cx.copy(sx);else{nx[0].set(this.a,this.b),nx[1].set(this.b,this.c),nx[2].set(this.c,this.a);for(var ux=0;ux<nx.length;ux++){nx[ux].closestPointToPoint(sx,!0,dx);var gx=sx.distanceToSquared(dx);gx<mx&&(mx=gx,cx.copy(dx))}}return cx}}(),equals:function(ix){return ix.a.equals(this.a)&&ix.b.equals(this.b)&&ix.c.equals(this.c)}}),Ol.prototype=Object.assign(Object.create(il.prototype),{constructor:Ol,isMesh:!0,setDrawMode:function(ix){this.drawMode=ix},copy:function(ix){return il.prototype.copy.call(this,ix),this.drawMode=ix.drawMode,void 0!==ix.morphTargetInfluences&&(this.morphTargetInfluences=ix.morphTargetInfluences.slice()),void 0!==ix.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},ix.morphTargetDictionary)),this},updateMorphTargets:function(){var dx=this.geometry,ix,nx,sx;if(dx.isBufferGeometry){var lx=dx.morphAttributes,px=Object.keys(lx);if(0<px.length){var cx=lx[px[0]];if(void 0!==cx)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},ix=0,nx=cx.length;ix<nx;ix++)sx=cx[ix].name||ix+"",this.morphTargetInfluences.push(0),this.morphTargetDictionary[sx]=ix}}else{var mx=dx.morphTargets;if(void 0!==mx&&0<mx.length)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},ix=0,nx=mx.length;ix<nx;ix++)sx=mx[ix].name||ix+"",this.morphTargetInfluences.push(0),this.morphTargetDictionary[sx]=ix}},raycast:function(){function ix(Ax,Ex,Sx,Tx,Mx,wx,Rx){return Cl.barycoordFromPoint(Ax,Ex,Sx,Tx,Lx),Mx.multiplyScalar(Lx.x),wx.multiplyScalar(Lx.y),Rx.multiplyScalar(Lx.z),Mx.add(wx).add(Rx),Mx.clone()}function nx(Ax,Ex,Sx,Tx,Mx,wx,Rx,Px){if(null===(Ex.side===Xg?Tx.intersectTriangle(Rx,wx,Mx,!0,Px):Tx.intersectTriangle(Mx,wx,Rx,Ex.side!==qg,Px)))return null;_x.copy(Px),_x.applyMatrix4(Ax.matrixWorld);var Cx=Sx.ray.origin.distanceTo(_x);return Cx<Sx.near||Cx>Sx.far?null:{distance:Cx,point:_x.clone(),object:Ax}}function sx(Ax,Ex,Sx,Tx,Mx,wx,Rx,Px){cx.fromBufferAttribute(Tx,wx),mx.fromBufferAttribute(Tx,Rx),ux.fromBufferAttribute(Tx,Px);var Cx=nx(Ax,Ax.material,Ex,Sx,cx,mx,ux,bx);return Cx&&(Mx&&(yx.fromBufferAttribute(Mx,wx),xx.fromBufferAttribute(Mx,Rx),vx.fromBufferAttribute(Mx,Px),Cx.uv=ix(bx,cx,mx,ux,yx,xx,vx)),Cx.face=new dl(wx,Rx,Px,Cl.normal(cx,mx,ux)),Cx.faceIndex=wx),Cx}var dx=new id,lx=new Rl,px=new $d,cx=new sd,mx=new sd,ux=new sd,gx=new sd,hx=new sd,fx=new sd,yx=new od,xx=new od,vx=new od,Lx=new sd,bx=new sd,_x=new sd;return function(Ax,Ex){var Tx=this.geometry,Mx=this.material,wx=this.matrixWorld,Sx;if(void 0!==Mx&&(null===Tx.boundingSphere&&Tx.computeBoundingSphere(),px.copy(Tx.boundingSphere),px.applyMatrix4(wx),!1!==Ax.ray.intersectsSphere(px)&&(dx.getInverse(wx),lx.copy(Ax.ray).applyMatrix4(dx),null===Tx.boundingBox||!1!==lx.intersectsBox(Tx.boundingBox))))if(Tx.isBufferGeometry){var Dx=Tx.index,Fx=Tx.attributes.position,Bx=Tx.attributes.uv,Rx,Px,Cx,Ox,Ix;if(null!==Dx)for(Ox=0,Ix=Dx.count;Ox<Ix;Ox+=3)Rx=Dx.getX(Ox),Px=Dx.getX(Ox+1),Cx=Dx.getX(Ox+2),(Sx=sx(this,Ax,lx,Fx,Bx,Rx,Px,Cx))&&(Sx.faceIndex=Math.floor(Ox/3),Ex.push(Sx));else if(void 0!==Fx)for(Ox=0,Ix=Fx.count;Ox<Ix;Ox+=3)(Sx=sx(this,Ax,lx,Fx,Bx,Rx=Ox,Px=Ox+1,Cx=Ox+2))&&(Sx.index=Rx,Ex.push(Sx))}else if(Tx.isGeometry){var Hx=Array.isArray(Mx),Gx=Tx.vertices,Vx=Tx.faces,kx=Tx.faceVertexUvs[0],Ux,Nx,Wx,zx;0<kx.length&&(zx=kx);for(var jx=0,Yx=Vx.length;jx<Yx;jx++){var Xx=Vx[jx],qx=Hx?Mx[Xx.materialIndex]:Mx;if(void 0!==qx){if(Ux=Gx[Xx.a],Nx=Gx[Xx.b],Wx=Gx[Xx.c],!0===qx.morphTargets){var Zx=Tx.morphTargets,Jx=this.morphTargetInfluences;cx.set(0,0,0),mx.set(0,0,0),ux.set(0,0,0);for(var Kx=0,Qx=Zx.length,$x;Kx<Qx;Kx++)if($x=Jx[Kx],0!==$x){var ev=Zx[Kx].vertices;cx.addScaledVector(gx.subVectors(ev[Xx.a],Ux),$x),mx.addScaledVector(hx.subVectors(ev[Xx.b],Nx),$x),ux.addScaledVector(fx.subVectors(ev[Xx.c],Wx),$x)}cx.add(Ux),mx.add(Nx),ux.add(Wx),Ux=cx,Nx=mx,Wx=ux}if(Sx=nx(this,qx,Ax,lx,Ux,Nx,Wx,bx)){if(zx&&zx[jx]){var tv=zx[jx];yx.copy(tv[0]),xx.copy(tv[1]),vx.copy(tv[2]),Sx.uv=ix(bx,Ux,Nx,Wx,yx,xx,vx)}Sx.face=Xx,Sx.faceIndex=jx,Ex.push(Sx)}}}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var Cy=0;Yl.prototype=Object.assign(Object.create(nl.prototype),{constructor:Yl,isPerspectiveCamera:!0,copy:function(ix,nx){return nl.prototype.copy.call(this,ix,nx),this.fov=ix.fov,this.zoom=ix.zoom,this.near=ix.near,this.far=ix.far,this.focus=ix.focus,this.aspect=ix.aspect,this.view=null===ix.view?null:Object.assign({},ix.view),this.filmGauge=ix.filmGauge,this.filmOffset=ix.filmOffset,this},setFocalLength:function(ix){var nx=.5*this.getFilmHeight()/ix;this.fov=2*uy.RAD2DEG*Math.atan(nx),this.updateProjectionMatrix()},getFocalLength:function(){var ix=Math.tan(.5*uy.DEG2RAD*this.fov);return .5*this.getFilmHeight()/ix},getEffectiveFOV:function(){return 2*uy.RAD2DEG*Math.atan(Math.tan(.5*uy.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(ix,nx,sx,dx,lx,px){this.aspect=ix/nx,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=ix,this.view.fullHeight=nx,this.view.offsetX=sx,this.view.offsetY=dx,this.view.width=lx,this.view.height=px,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var ix=this.near,nx=ix*Math.tan(.5*uy.DEG2RAD*this.fov)/this.zoom,sx=2*nx,dx=this.aspect*sx,lx=-.5*dx,px=this.view;if(null!==this.view&&this.view.enabled){var cx=px.fullWidth,mx=px.fullHeight;lx+=px.offsetX*dx/cx,nx-=px.offsetY*sx/mx,dx*=px.width/cx,sx*=px.height/mx}var ux=this.filmOffset;0!==ux&&(lx+=ix*ux/this.getFilmWidth()),this.projectionMatrix.makePerspective(lx,lx+dx,nx,nx-sx,ix,this.far)},toJSON:function(ix){var nx=il.prototype.toJSON.call(this,ix);return nx.object.fov=this.fov,nx.object.zoom=this.zoom,nx.object.near=this.near,nx.object.far=this.far,nx.object.focus=this.focus,nx.object.aspect=this.aspect,null!==this.view&&(nx.object.view=Object.assign({},this.view)),nx.object.filmGauge=this.filmGauge,nx.object.filmOffset=this.filmOffset,nx}}),Xl.prototype=Object.assign(Object.create(Yl.prototype),{constructor:Xl,isArrayCamera:!0});var Oy=0;Ql.prototype.isFogExp2=!0,Ql.prototype.clone=function(){return new Ql(this.color.getHex(),this.density)},Ql.prototype.toJSON=function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}},$l.prototype.isFog=!0,$l.prototype.clone=function(){return new $l(this.color.getHex(),this.near,this.far)},$l.prototype.toJSON=function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}},ep.prototype=Object.assign(Object.create(il.prototype),{constructor:ep,copy:function(ix,nx){return il.prototype.copy.call(this,ix,nx),null!==ix.background&&(this.background=ix.background.clone()),null!==ix.fog&&(this.fog=ix.fog.clone()),null!==ix.overrideMaterial&&(this.overrideMaterial=ix.overrideMaterial.clone()),this.autoUpdate=ix.autoUpdate,this.matrixAutoUpdate=ix.matrixAutoUpdate,this},toJSON:function(ix){var nx=il.prototype.toJSON.call(this,ix);return null!==this.background&&(nx.object.background=this.background.toJSON(ix)),null!==this.fog&&(nx.object.fog=this.fog.toJSON()),nx}}),tp.prototype=Object.create(Zd.prototype),tp.prototype.constructor=tp,tp.prototype.isSpriteMaterial=!0,tp.prototype.copy=function(ix){return Zd.prototype.copy.call(this,ix),this.color.copy(ix.color),this.map=ix.map,this.rotation=ix.rotation,this},ap.prototype=Object.assign(Object.create(il.prototype),{constructor:ap,isSprite:!0,raycast:function(){var ix=new sd,nx=new sd,sx=new sd;return function(dx,lx){nx.setFromMatrixPosition(this.matrixWorld),dx.ray.closestPointToPoint(nx,ix),sx.setFromMatrixScale(this.matrixWorld);var px=sx.x*sx.y/4;if(!(nx.distanceToSquared(ix)>px)){var cx=dx.ray.origin.distanceTo(ix);cx<dx.near||cx>dx.far||lx.push({distance:cx,point:ix.clone(),face:null,object:this})}}}(),clone:function(){return new this.constructor(this.material).copy(this)},copy:function(ix){return il.prototype.copy.call(this,ix),void 0!==ix.center&&this.center.copy(ix.center),this}}),rp.prototype=Object.assign(Object.create(il.prototype),{constructor:rp,copy:function(ix){il.prototype.copy.call(this,ix,!1);for(var nx=ix.levels,sx=0,dx=nx.length,lx;sx<dx;sx++)lx=nx[sx],this.addLevel(lx.object.clone(),lx.distance);return this},addLevel:function(ix,nx){void 0===nx&&(nx=0),nx=Math.abs(nx);for(var sx=this.levels,dx=0;dx<sx.length&&!(nx<sx[dx].distance);dx++);sx.splice(dx,0,{distance:nx,object:ix}),this.add(ix)},getObjectForDistance:function(ix){for(var nx=this.levels,sx=1,dx=nx.length;sx<dx&&!(ix<nx[sx].distance);sx++);return nx[sx-1].object},raycast:function(){var ix=new sd;return function(nx,sx){ix.setFromMatrixPosition(this.matrixWorld);var dx=nx.ray.origin.distanceTo(ix);this.getObjectForDistance(dx).raycast(nx,sx)}}(),update:function(){var ix=new sd,nx=new sd;return function(sx){var dx=this.levels;if(1<dx.length){ix.setFromMatrixPosition(sx.matrixWorld),nx.setFromMatrixPosition(this.matrixWorld);var lx=ix.distanceTo(nx);dx[0].object.visible=!0;for(var px=1,cx=dx.length;px<cx&&lx>=dx[px].distance;px++)dx[px-1].object.visible=!1,dx[px].object.visible=!0;for(;px<cx;px++)dx[px].object.visible=!1}}}(),toJSON:function(ix){var nx=il.prototype.toJSON.call(this,ix);nx.object.levels=[];for(var sx=this.levels,dx=0,lx=sx.length,px;dx<lx;dx++)px=sx[dx],nx.object.levels.push({object:px.object.uuid,distance:px.distance});return nx}}),Object.assign(op.prototype,{calculateInverses:function(){this.boneInverses=[];for(var ix=0,nx=this.bones.length,sx;ix<nx;ix++)sx=new id,this.bones[ix]&&sx.getInverse(this.bones[ix].matrixWorld),this.boneInverses.push(sx)},pose:function(){var ix,nx,sx;for(nx=0,sx=this.bones.length;nx<sx;nx++)(ix=this.bones[nx])&&ix.matrixWorld.getInverse(this.boneInverses[nx]);for(nx=0,sx=this.bones.length;nx<sx;nx++)(ix=this.bones[nx])&&(ix.parent&&ix.parent.isBone?(ix.matrix.getInverse(ix.parent.matrixWorld),ix.matrix.multiply(ix.matrixWorld)):ix.matrix.copy(ix.matrixWorld),ix.matrix.decompose(ix.position,ix.quaternion,ix.scale))},update:function(){var ix=new id,nx=new id;return function(){for(var sx=this.bones,dx=this.boneInverses,lx=this.boneMatrices,px=this.boneTexture,cx=0,mx=sx.length,ux;cx<mx;cx++)ux=sx[cx]?sx[cx].matrixWorld:nx,ix.multiplyMatrices(ux,dx[cx]),ix.toArray(lx,16*cx);void 0!==px&&(px.needsUpdate=!0)}}(),clone:function(){return new op(this.bones,this.boneInverses)},getBoneByName:function(ix){for(var nx=0,sx=this.bones.length,dx;nx<sx;nx++)if(dx=this.bones[nx],dx.name===ix)return dx}}),ip.prototype=Object.assign(Object.create(il.prototype),{constructor:ip,isBone:!0}),np.prototype=Object.assign(Object.create(Ol.prototype),{constructor:np,isSkinnedMesh:!0,initBones:function(){var lx=[],ix,nx,sx,dx;if(this.geometry&&void 0!==this.geometry.bones){for(sx=0,dx=this.geometry.bones.length;sx<dx;sx++)nx=this.geometry.bones[sx],ix=new ip,lx.push(ix),ix.name=nx.name,ix.position.fromArray(nx.pos),ix.quaternion.fromArray(nx.rotq),void 0!==nx.scl&&ix.scale.fromArray(nx.scl);for(sx=0,dx=this.geometry.bones.length;sx<dx;sx++)-1!==(nx=this.geometry.bones[sx]).parent&&null!==nx.parent&&void 0!==lx[nx.parent]?lx[nx.parent].add(lx[sx]):this.add(lx[sx])}return this.updateMatrixWorld(!0),lx},bind:function(ix,nx){this.skeleton=ix,void 0===nx&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),nx=this.matrixWorld),this.bindMatrix.copy(nx),this.bindMatrixInverse.getInverse(nx)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){var ix,nx;if(this.geometry&&this.geometry.isGeometry)for(nx=0;nx<this.geometry.skinWeights.length;nx++){var sx=this.geometry.skinWeights[nx];(ix=1/sx.manhattanLength())==1/0?sx.set(1,0,0,0):sx.multiplyScalar(ix)}else if(this.geometry&&this.geometry.isBufferGeometry){var dx=new pd,lx=this.geometry.attributes.skinWeight;for(nx=0;nx<lx.count;nx++)dx.x=lx.getX(nx),dx.y=lx.getY(nx),dx.z=lx.getZ(nx),dx.w=lx.getW(nx),(ix=1/dx.manhattanLength())==1/0?dx.set(1,0,0,0):dx.multiplyScalar(ix),lx.setXYZW(nx,dx.x,dx.y,dx.z,dx.w)}},updateMatrixWorld:function(ix){Ol.prototype.updateMatrixWorld.call(this,ix),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),sp.prototype=Object.create(Zd.prototype),sp.prototype.constructor=sp,sp.prototype.isLineBasicMaterial=!0,sp.prototype.copy=function(ix){return Zd.prototype.copy.call(this,ix),this.color.copy(ix.color),this.linewidth=ix.linewidth,this.linecap=ix.linecap,this.linejoin=ix.linejoin,this},dp.prototype=Object.assign(Object.create(il.prototype),{constructor:dp,isLine:!0,computeLineDistances:function(){var ix=new sd,nx=new sd;return function(){var sx=this.geometry;if(sx.isBufferGeometry){if(null===sx.index){for(var dx=sx.attributes.position,lx=[0],px=1,cx=dx.count;px<cx;px++)ix.fromBufferAttribute(dx,px-1),nx.fromBufferAttribute(dx,px),lx[px]=lx[px-1],lx[px]+=ix.distanceTo(nx);sx.addAttribute("lineDistance",new THREE.Float32BufferAttribute(lx,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");}else if(sx.isGeometry){var mx=sx.vertices;for((lx=sx.lineDistances)[0]=0,px=1,cx=mx.length;px<cx;px++)lx[px]=lx[px-1],lx[px]+=mx[px-1].distanceTo(mx[px])}return this}}(),raycast:function(){var ix=new id,nx=new Rl,sx=new $d;return function(dx,lx){var px=dx.linePrecision,cx=px*px,mx=this.geometry,ux=this.matrixWorld;if(null===mx.boundingSphere&&mx.computeBoundingSphere(),sx.copy(mx.boundingSphere),sx.applyMatrix4(ux),!1!==dx.ray.intersectsSphere(sx)){ix.getInverse(ux),nx.copy(dx.ray).applyMatrix4(ix);var gx=new sd,hx=new sd,fx=new sd,yx=new sd,xx=this&&this.isLineSegments?2:1;if(mx.isBufferGeometry){var vx=mx.index,Lx=mx.attributes.position.array;if(null!==vx)for(var bx=vx.array,_x=0,Ax=bx.length-1;_x<Ax;_x+=xx){var Ex=bx[_x],Sx=bx[_x+1];gx.fromArray(Lx,3*Ex),hx.fromArray(Lx,3*Sx),nx.distanceSqToSegment(gx,hx,yx,fx)>cx||(yx.applyMatrix4(this.matrixWorld),(wx=dx.ray.origin.distanceTo(yx))<dx.near||wx>dx.far||lx.push({distance:wx,point:fx.clone().applyMatrix4(this.matrixWorld),index:_x,face:null,faceIndex:null,object:this}))}else for(_x=0,Ax=Lx.length/3-1;_x<Ax;_x+=xx)gx.fromArray(Lx,3*_x),hx.fromArray(Lx,3*_x+3),nx.distanceSqToSegment(gx,hx,yx,fx)>cx||(yx.applyMatrix4(this.matrixWorld),(wx=dx.ray.origin.distanceTo(yx))<dx.near||wx>dx.far||lx.push({distance:wx,point:fx.clone().applyMatrix4(this.matrixWorld),index:_x,face:null,faceIndex:null,object:this}))}else if(mx.isGeometry){var Tx=mx.vertices,Mx=Tx.length;for(_x=0;_x<Mx-1;_x+=xx){var wx;nx.distanceSqToSegment(Tx[_x],Tx[_x+1],yx,fx)>cx||(yx.applyMatrix4(this.matrixWorld),(wx=dx.ray.origin.distanceTo(yx))<dx.near||wx>dx.far||lx.push({distance:wx,point:fx.clone().applyMatrix4(this.matrixWorld),index:_x,face:null,faceIndex:null,object:this}))}}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),lp.prototype=Object.assign(Object.create(dp.prototype),{constructor:lp,isLineSegments:!0,computeLineDistances:function(){var ix=new sd,nx=new sd;return function(){var sx=this.geometry;if(sx.isBufferGeometry){if(null===sx.index){for(var dx=sx.attributes.position,lx=[],px=0,cx=dx.count;px<cx;px+=2)ix.fromBufferAttribute(dx,px),nx.fromBufferAttribute(dx,px+1),lx[px]=0===px?0:lx[px-1],lx[px+1]=lx[px]+ix.distanceTo(nx);sx.addAttribute("lineDistance",new THREE.Float32BufferAttribute(lx,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");}else if(sx.isGeometry){var mx=sx.vertices;for(lx=sx.lineDistances,px=0,cx=mx.length;px<cx;px+=2)ix.copy(mx[px]),nx.copy(mx[px+1]),lx[px]=0==px?0:lx[px-1],lx[px+1]=lx[px]+ix.distanceTo(nx)}return this}}()}),pp.prototype=Object.assign(Object.create(dp.prototype),{constructor:pp,isLineLoop:!0}),cp.prototype=Object.create(Zd.prototype),cp.prototype.constructor=cp,cp.prototype.isPointsMaterial=!0,cp.prototype.copy=function(ix){return Zd.prototype.copy.call(this,ix),this.color.copy(ix.color),this.map=ix.map,this.size=ix.size,this.sizeAttenuation=ix.sizeAttenuation,this},mp.prototype=Object.assign(Object.create(il.prototype),{constructor:mp,isPoints:!0,raycast:function(){var ix=new id,nx=new Rl,sx=new $d;return function(dx,lx){function px(Tx,Mx){var wx=nx.distanceSqToPoint(Tx);if(wx<fx){var Rx=nx.closestPointToPoint(Tx);Rx.applyMatrix4(ux);var Px=dx.ray.origin.distanceTo(Rx);if(Px<dx.near||Px>dx.far)return;lx.push({distance:Px,distanceToRay:Math.sqrt(wx),point:Rx.clone(),index:Mx,face:null,object:cx})}}var cx=this,mx=this.geometry,ux=this.matrixWorld,gx=dx.params.Points.threshold;if(null===mx.boundingSphere&&mx.computeBoundingSphere(),sx.copy(mx.boundingSphere),sx.applyMatrix4(ux),sx.radius+=gx,!1!==dx.ray.intersectsSphere(sx)){ix.getInverse(ux),nx.copy(dx.ray).applyMatrix4(ix);var hx=gx/((this.scale.x+this.scale.y+this.scale.z)/3),fx=hx*hx,yx=new sd;if(mx.isBufferGeometry){var xx=mx.index,vx=mx.attributes.position.array;if(null!==xx)for(var Lx=xx.array,bx=0,_x=Lx.length,Ax;bx<_x;bx++)Ax=Lx[bx],yx.fromArray(vx,3*Ax),px(yx,Ax);else{bx=0;for(var Ex=vx.length/3;bx<Ex;bx++)yx.fromArray(vx,3*bx),px(yx,bx)}}else{var Sx=mx.vertices;for(bx=0,Ex=Sx.length;bx<Ex;bx++)px(Sx[bx],bx)}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),up.prototype=Object.assign(Object.create(il.prototype),{constructor:up,isGroup:!0}),gp.prototype=Object.assign(Object.create(ld.prototype),{constructor:gp,isVideoTexture:!0,update:function(){var ix=this.image;ix.readyState>=ix.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}),hp.prototype=Object.create(ld.prototype),hp.prototype.constructor=hp,hp.prototype.isCompressedTexture=!0,fp.prototype=Object.create(ld.prototype),fp.prototype.constructor=fp,fp.prototype.isDepthTexture=!0,yp.prototype=Object.create(_l.prototype),yp.prototype.constructor=yp,xp.prototype=Object.create(ll.prototype),xp.prototype.constructor=xp,vp.prototype=Object.create(_l.prototype),vp.prototype.constructor=vp,Lp.prototype=Object.create(ll.prototype),Lp.prototype.constructor=Lp,bp.prototype=Object.create(_l.prototype),bp.prototype.constructor=bp,_p.prototype=Object.create(ll.prototype),_p.prototype.constructor=_p,Ap.prototype=Object.create(bp.prototype),Ap.prototype.constructor=Ap,Ep.prototype=Object.create(ll.prototype),Ep.prototype.constructor=Ep,Sp.prototype=Object.create(bp.prototype),Sp.prototype.constructor=Sp,Tp.prototype=Object.create(ll.prototype),Tp.prototype.constructor=Tp,Mp.prototype=Object.create(bp.prototype),Mp.prototype.constructor=Mp,wp.prototype=Object.create(ll.prototype),wp.prototype.constructor=wp,Rp.prototype=Object.create(bp.prototype),Rp.prototype.constructor=Rp,Pp.prototype=Object.create(ll.prototype),Pp.prototype.constructor=Pp,Cp.prototype=Object.create(_l.prototype),Cp.prototype.constructor=Cp,Op.prototype=Object.create(ll.prototype),Op.prototype.constructor=Op,Ip.prototype=Object.create(_l.prototype),Ip.prototype.constructor=Ip,Dp.prototype=Object.create(ll.prototype),Dp.prototype.constructor=Dp,Fp.prototype=Object.create(_l.prototype),Fp.prototype.constructor=Fp;var Iy={area:function(ix){for(var nx=ix.length,sx=0,dx=nx-1,lx=0;lx<nx;dx=lx++)sx+=ix[dx].x*ix[lx].y-ix[lx].x*ix[dx].y;return .5*sx},isClockWise:function(ix){return 0>Iy.area(ix)},triangulateShape:function(ix,nx){var sx=[],dx=[],lx=[];Ic(ix),Dc(sx,ix);var px=ix.length;nx.forEach(Ic);for(var cx=0;cx<nx.length;cx++)dx.push(px),px+=nx[cx].length,Dc(sx,nx[cx]);var mx=function(ux,gx,hx){hx=hx||2;var Ax=gx&&gx.length,Ex=Ax?gx[0]*hx:ux.length,Sx=Bp(ux,0,Ex,hx,!0),Tx=[],fx,yx,xx,vx,Lx,bx,_x;if(!Sx)return Tx;if(Ax&&(Sx=function(wx,Rx,Px,Cx){var Fx=[],Ox,Ix,Dx;for(Ox=0,Ix=Rx.length;Ox<Ix;Ox++)(Dx=Bp(wx,Rx[Ox]*Cx,Ox<Ix-1?Rx[Ox+1]*Cx:wx.length,Cx,!1))===Dx.next&&(Dx.steiner=!0),Fx.push(Yp(Dx));for(Fx.sort(Vp),Ox=0;Ox<Fx.length;Ox++)kp(Fx[Ox],Px),Px=Up(Px,Px.next);return Px}(ux,gx,Sx,hx)),ux.length>80*hx){fx=xx=ux[0],yx=vx=ux[1];for(var Mx=hx;Mx<Ex;Mx+=hx)Lx=ux[Mx],bx=ux[Mx+1],Lx<fx&&(fx=Lx),bx<yx&&(yx=bx),Lx>xx&&(xx=Lx),bx>vx&&(vx=bx);_x=0===(_x=Math.max(xx-fx,vx-yx))?0:1/_x}return Np(Sx,Tx,hx,fx,yx,_x),Tx}(sx,dx);for(cx=0;cx<mx.length;cx+=3)lx.push(mx.slice(cx,cx+3));return lx}};Fc.prototype=Object.create(ll.prototype),Fc.prototype.constructor=Fc,Bc.prototype=Object.create(_l.prototype),Bc.prototype.constructor=Bc,Bc.prototype.getArrays=function(){var ix=this.getAttribute("position"),nx=ix?Array.prototype.slice.call(ix.array):[],sx=this.getAttribute("uv"),dx=sx?Array.prototype.slice.call(sx.array):[],lx=this.index;return{position:nx,uv:dx,index:lx?Array.prototype.slice.call(lx.array):[]}},Bc.prototype.addShapeList=function(ix,nx){var sx=ix.length;nx.arrays=this.getArrays();for(var dx=0,lx;dx<sx;dx++)lx=ix[dx],this.addShape(lx,nx);this.setIndex(nx.arrays.index),this.addAttribute("position",new xl(nx.arrays.position,3)),this.addAttribute("uv",new xl(nx.arrays.uv,2))},Bc.prototype.addShape=function(ix,nx){function sx(sv,dv,lv){return dv||console.error("THREE.ExtrudeGeometry: vec does not exist"),dv.clone().multiplyScalar(lv).add(sv)}function dx(sv,dv,lv){var uv=sv.x-dv.x,gv=sv.y-dv.y,hv=lv.x-sv.x,fv=lv.y-sv.y,yv=uv*uv+gv*gv,pv,cv,mv;if(Math.abs(uv*fv-gv*hv)>Number.EPSILON){var vv=Math.sqrt(yv),Lv=Math.sqrt(hv*hv+fv*fv),bv=dv.x-gv/vv,_v=dv.y+uv/vv,Av=((lv.x-fv/Lv-bv)*fv-(lv.y+hv/Lv-_v)*hv)/(uv*fv-gv*hv),Ev=(pv=bv+uv*Av-sv.x)*pv+(cv=_v+gv*Av-sv.y)*cv;if(2>=Ev)return new od(pv,cv);mv=Math.sqrt(Ev/2)}else{var Sv=!1;uv>Number.EPSILON?hv>Number.EPSILON&&(Sv=!0):uv<-Number.EPSILON?hv<-Number.EPSILON&&(Sv=!0):Math.sign(gv)===Math.sign(fv)&&(Sv=!0),Sv?(pv=-gv,cv=uv,mv=Math.sqrt(yv)):(pv=uv,cv=gv,mv=Math.sqrt(yv/2))}return new od(pv/mv,cv/mv)}function lx(sv,dv){var lv,pv;for($x=sv.length;0<=--$x;){lv=$x,0>(pv=$x-1)&&(pv=sv.length-1);var cv=0,mv=Dx+2*Cx;for(cv=0;cv<mv;cv++){var uv=Jx*cv,gv=Jx*(cv+1);mx(dv+lv+uv,dv+pv+uv,dv+pv+gv,dv+lv+gv)}}}function px(sv,dv,lv){Mx.push(sv),Mx.push(dv),Mx.push(lv)}function cx(sv,dv,lv){ux(sv),ux(dv),ux(lv);var pv=Ex.length/3,cv=Ux.generateTopUV(Nx,Ex,pv-3,pv-2,pv-1);gx(cv[0]),gx(cv[1]),gx(cv[2])}function mx(sv,dv,lv,pv){ux(sv),ux(dv),ux(pv),ux(dv),ux(lv),ux(pv);var cv=Ex.length/3,mv=Ux.generateSideWallUV(Nx,Ex,cv-6,cv-3,cv-2,cv-1);gx(mv[0]),gx(mv[1]),gx(mv[3]),gx(mv[1]),gx(mv[2]),gx(mv[3])}function ux(sv){Sx.push(Ex.length/3),Ex.push(Mx[3*sv+0]),Ex.push(Mx[3*sv+1]),Ex.push(Mx[3*sv+2])}function gx(sv){Tx.push(sv.x),Tx.push(sv.y)}var Ax=nx.arrays?nx.arrays:this.getArrays(),Ex=Ax.position,Sx=Ax.index,Tx=Ax.uv,Mx=[],wx=void 0===nx.amount?100:nx.amount,Rx=void 0===nx.bevelThickness?6:nx.bevelThickness,Px=void 0===nx.bevelSize?Rx-2:nx.bevelSize,Cx=void 0===nx.bevelSegments?3:nx.bevelSegments,Ox=void 0===nx.bevelEnabled||nx.bevelEnabled,Ix=void 0===nx.curveSegments?12:nx.curveSegments,Dx=void 0===nx.steps?1:nx.steps,Fx=nx.extrudePath,Bx=!1,Ux=void 0===nx.UVGenerator?Fc.WorldUVGenerator:nx.UVGenerator,hx,fx,yx,xx,vx,Lx,bx,_x;Fx&&(hx=Fx.getSpacedPoints(Dx),Bx=!0,Ox=!1,fx=void 0===nx.frames?Fx.computeFrenetFrames(Dx,!1):nx.frames,yx=new sd,xx=new sd,vx=new sd),Ox||(Cx=0,Rx=0,Px=0);var Nx=this,Wx=ix.extractPoints(Ix),zx=Wx.shape,Hx=Wx.holes;if(!Iy.isClockWise(zx))for(zx=zx.reverse(),bx=0,_x=Hx.length;bx<_x;bx++)Lx=Hx[bx],Iy.isClockWise(Lx)&&(Hx[bx]=Lx.reverse());var Gx=Iy.triangulateShape(zx,Hx),Vx=zx;for(bx=0,_x=Hx.length;bx<_x;bx++)Lx=Hx[bx],zx=zx.concat(Lx);for(var Jx=zx.length,Kx=Gx.length,Qx=[],$x=0,ev=Vx.length,tv=ev-1,av=$x+1,kx,jx,Yx,Xx,qx,Zx;$x<ev;$x++,tv++,av++)tv===ev&&(tv=0),av===ev&&(av=0),Qx[$x]=dx(Vx[$x],Vx[tv],Vx[av]);var iv=[],nv=Qx.concat(),rv,ov;for(bx=0,_x=Hx.length;bx<_x;bx++){for(Lx=Hx[bx],rv=[],$x=0,tv=(ev=Lx.length)-1,av=$x+1;$x<ev;$x++,tv++,av++)tv===ev&&(tv=0),av===ev&&(av=0),rv[$x]=dx(Lx[$x],Lx[tv],Lx[av]);iv.push(rv),nv=nv.concat(rv)}for(kx=0;kx<Cx;kx++){for(Yx=kx/Cx,Xx=Rx*Math.cos(Yx*Math.PI/2),jx=Px*Math.sin(Yx*Math.PI/2),$x=0,ev=Vx.length;$x<ev;$x++)px((qx=sx(Vx[$x],Qx[$x],jx)).x,qx.y,-Xx);for(bx=0,_x=Hx.length;bx<_x;bx++)for(Lx=Hx[bx],rv=iv[bx],$x=0,ev=Lx.length;$x<ev;$x++)px((qx=sx(Lx[$x],rv[$x],jx)).x,qx.y,-Xx)}for(jx=Px,$x=0;$x<Jx;$x++)qx=Ox?sx(zx[$x],nv[$x],jx):zx[$x],Bx?(xx.copy(fx.normals[0]).multiplyScalar(qx.x),yx.copy(fx.binormals[0]).multiplyScalar(qx.y),vx.copy(hx[0]).add(xx).add(yx),px(vx.x,vx.y,vx.z)):px(qx.x,qx.y,0);for(ov=1;ov<=Dx;ov++)for($x=0;$x<Jx;$x++)qx=Ox?sx(zx[$x],nv[$x],jx):zx[$x],Bx?(xx.copy(fx.normals[ov]).multiplyScalar(qx.x),yx.copy(fx.binormals[ov]).multiplyScalar(qx.y),vx.copy(hx[ov]).add(xx).add(yx),px(vx.x,vx.y,vx.z)):px(qx.x,qx.y,wx/Dx*ov);for(kx=Cx-1;0<=kx;kx--){for(Yx=kx/Cx,Xx=Rx*Math.cos(Yx*Math.PI/2),jx=Px*Math.sin(Yx*Math.PI/2),$x=0,ev=Vx.length;$x<ev;$x++)px((qx=sx(Vx[$x],Qx[$x],jx)).x,qx.y,wx+Xx);for(bx=0,_x=Hx.length;bx<_x;bx++)for(Lx=Hx[bx],rv=iv[bx],$x=0,ev=Lx.length;$x<ev;$x++)qx=sx(Lx[$x],rv[$x],jx),Bx?px(qx.x,qx.y+hx[Dx-1].y,hx[Dx-1].x+Xx):px(qx.x,qx.y,wx+Xx)}!function(){var sv=Ex.length/3;if(Ox){var dv=0,lv=Jx*dv;for($x=0;$x<Kx;$x++)cx((Zx=Gx[$x])[2]+lv,Zx[1]+lv,Zx[0]+lv);for(lv=Jx*(dv=Dx+2*Cx),$x=0;$x<Kx;$x++)cx((Zx=Gx[$x])[0]+lv,Zx[1]+lv,Zx[2]+lv)}else{for($x=0;$x<Kx;$x++)cx((Zx=Gx[$x])[2],Zx[1],Zx[0]);for($x=0;$x<Kx;$x++)cx((Zx=Gx[$x])[0]+Jx*Dx,Zx[1]+Jx*Dx,Zx[2]+Jx*Dx)}Nx.addGroup(sv,Ex.length/3-sv,void 0===nx.material?0:nx.material)}(),function(){var sv=Ex.length/3,dv=0;for(lx(Vx,dv),dv+=Vx.length,bx=0,_x=Hx.length;bx<_x;bx++)lx(Lx=Hx[bx],dv),dv+=Lx.length;Nx.addGroup(sv,Ex.length/3-sv,void 0===nx.extrudeMaterial?1:nx.extrudeMaterial)}(),nx.arrays||(this.setIndex(Sx),this.addAttribute("position",new xl(Ex,3)),this.addAttribute("uv",new xl(Tx,2)))},Fc.WorldUVGenerator={generateTopUV:function(ix,nx,sx,dx,lx){var px=nx[3*sx],cx=nx[3*sx+1],mx=nx[3*dx],ux=nx[3*dx+1],gx=nx[3*lx],hx=nx[3*lx+1];return[new od(px,cx),new od(mx,ux),new od(gx,hx)]},generateSideWallUV:function(ix,nx,sx,dx,lx,px){var cx=nx[3*sx],mx=nx[3*sx+1],ux=nx[3*sx+2],gx=nx[3*dx],hx=nx[3*dx+1],fx=nx[3*dx+2],yx=nx[3*lx],xx=nx[3*lx+1],vx=nx[3*lx+2],Lx=nx[3*px],bx=nx[3*px+1],_x=nx[3*px+2];return .01>Math.abs(mx-hx)?[new od(cx,1-ux),new od(gx,1-fx),new od(yx,1-vx),new od(Lx,1-_x)]:[new od(mx,1-ux),new od(hx,1-fx),new od(xx,1-vx),new od(bx,1-_x)]}},Uc.prototype=Object.create(ll.prototype),Uc.prototype.constructor=Uc,Nc.prototype=Object.create(Bc.prototype),Nc.prototype.constructor=Nc,Wc.prototype=Object.create(ll.prototype),Wc.prototype.constructor=Wc,zc.prototype=Object.create(_l.prototype),zc.prototype.constructor=zc,Hc.prototype=Object.create(ll.prototype),Hc.prototype.constructor=Hc,Gc.prototype=Object.create(_l.prototype),Gc.prototype.constructor=Gc,Vc.prototype=Object.create(ll.prototype),Vc.prototype.constructor=Vc,kc.prototype=Object.create(_l.prototype),kc.prototype.constructor=kc,jc.prototype=Object.create(ll.prototype),jc.prototype.constructor=jc,jc.prototype.toJSON=function(){var ix=ll.prototype.toJSON.call(this);return Xc(this.parameters.shapes,ix)},Yc.prototype=Object.create(_l.prototype),Yc.prototype.constructor=Yc,Yc.prototype.toJSON=function(){var ix=_l.prototype.toJSON.call(this);return Xc(this.parameters.shapes,ix)},qc.prototype=Object.create(_l.prototype),qc.prototype.constructor=qc,Zc.prototype=Object.create(ll.prototype),Zc.prototype.constructor=Zc,Jc.prototype=Object.create(_l.prototype),Jc.prototype.constructor=Jc,Kc.prototype=Object.create(Zc.prototype),Kc.prototype.constructor=Kc,Qc.prototype=Object.create(Jc.prototype),Qc.prototype.constructor=Qc,$c.prototype=Object.create(ll.prototype),$c.prototype.constructor=$c,em.prototype=Object.create(_l.prototype),em.prototype.constructor=em;var Dy=Object.freeze({WireframeGeometry:yp,ParametricGeometry:xp,ParametricBufferGeometry:vp,TetrahedronGeometry:_p,TetrahedronBufferGeometry:Ap,OctahedronGeometry:Ep,OctahedronBufferGeometry:Sp,IcosahedronGeometry:Tp,IcosahedronBufferGeometry:Mp,DodecahedronGeometry:wp,DodecahedronBufferGeometry:Rp,PolyhedronGeometry:Lp,PolyhedronBufferGeometry:bp,TubeGeometry:Pp,TubeBufferGeometry:Cp,TorusKnotGeometry:Op,TorusKnotBufferGeometry:Ip,TorusGeometry:Dp,TorusBufferGeometry:Fp,TextGeometry:Uc,TextBufferGeometry:Nc,SphereGeometry:Wc,SphereBufferGeometry:zc,RingGeometry:Hc,RingBufferGeometry:Gc,PlaneGeometry:Sl,PlaneBufferGeometry:Tl,LatheGeometry:Vc,LatheBufferGeometry:kc,ShapeGeometry:jc,ShapeBufferGeometry:Yc,ExtrudeGeometry:Fc,ExtrudeBufferGeometry:Bc,EdgesGeometry:qc,ConeGeometry:Kc,ConeBufferGeometry:Qc,CylinderGeometry:Zc,CylinderBufferGeometry:Jc,CircleGeometry:$c,CircleBufferGeometry:em,BoxGeometry:Al,BoxBufferGeometry:El});tm.prototype=Object.create(Zd.prototype),tm.prototype.constructor=tm,tm.prototype.isShadowMaterial=!0,am.prototype=Object.create(wl.prototype),am.prototype.constructor=am,am.prototype.isRawShaderMaterial=!0,rm.prototype=Object.create(Zd.prototype),rm.prototype.constructor=rm,rm.prototype.isMeshStandardMaterial=!0,rm.prototype.copy=function(ix){return Zd.prototype.copy.call(this,ix),this.defines={STANDARD:""},this.color.copy(ix.color),this.roughness=ix.roughness,this.metalness=ix.metalness,this.map=ix.map,this.lightMap=ix.lightMap,this.lightMapIntensity=ix.lightMapIntensity,this.aoMap=ix.aoMap,this.aoMapIntensity=ix.aoMapIntensity,this.emissive.copy(ix.emissive),this.emissiveMap=ix.emissiveMap,this.emissiveIntensity=ix.emissiveIntensity,this.bumpMap=ix.bumpMap,this.bumpScale=ix.bumpScale,this.normalMap=ix.normalMap,this.normalScale.copy(ix.normalScale),this.displacementMap=ix.displacementMap,this.displacementScale=ix.displacementScale,this.displacementBias=ix.displacementBias,this.roughnessMap=ix.roughnessMap,this.metalnessMap=ix.metalnessMap,this.alphaMap=ix.alphaMap,this.envMap=ix.envMap,this.envMapIntensity=ix.envMapIntensity,this.refractionRatio=ix.refractionRatio,this.wireframe=ix.wireframe,this.wireframeLinewidth=ix.wireframeLinewidth,this.wireframeLinecap=ix.wireframeLinecap,this.wireframeLinejoin=ix.wireframeLinejoin,this.skinning=ix.skinning,this.morphTargets=ix.morphTargets,this.morphNormals=ix.morphNormals,this},om.prototype=Object.create(rm.prototype),om.prototype.constructor=om,om.prototype.isMeshPhysicalMaterial=!0,om.prototype.copy=function(ix){return rm.prototype.copy.call(this,ix),this.defines={PHYSICAL:""},this.reflectivity=ix.reflectivity,this.clearCoat=ix.clearCoat,this.clearCoatRoughness=ix.clearCoatRoughness,this},im.prototype=Object.create(Zd.prototype),im.prototype.constructor=im,im.prototype.isMeshPhongMaterial=!0,im.prototype.copy=function(ix){return Zd.prototype.copy.call(this,ix),this.color.copy(ix.color),this.specular.copy(ix.specular),this.shininess=ix.shininess,this.map=ix.map,this.lightMap=ix.lightMap,this.lightMapIntensity=ix.lightMapIntensity,this.aoMap=ix.aoMap,this.aoMapIntensity=ix.aoMapIntensity,this.emissive.copy(ix.emissive),this.emissiveMap=ix.emissiveMap,this.emissiveIntensity=ix.emissiveIntensity,this.bumpMap=ix.bumpMap,this.bumpScale=ix.bumpScale,this.normalMap=ix.normalMap,this.normalScale.copy(ix.normalScale),this.displacementMap=ix.displacementMap,this.displacementScale=ix.displacementScale,this.displacementBias=ix.displacementBias,this.specularMap=ix.specularMap,this.alphaMap=ix.alphaMap,this.envMap=ix.envMap,this.combine=ix.combine,this.reflectivity=ix.reflectivity,this.refractionRatio=ix.refractionRatio,this.wireframe=ix.wireframe,this.wireframeLinewidth=ix.wireframeLinewidth,this.wireframeLinecap=ix.wireframeLinecap,this.wireframeLinejoin=ix.wireframeLinejoin,this.skinning=ix.skinning,this.morphTargets=ix.morphTargets,this.morphNormals=ix.morphNormals,this},nm.prototype=Object.create(im.prototype),nm.prototype.constructor=nm,nm.prototype.isMeshToonMaterial=!0,nm.prototype.copy=function(ix){return im.prototype.copy.call(this,ix),this.gradientMap=ix.gradientMap,this},sm.prototype=Object.create(Zd.prototype),sm.prototype.constructor=sm,sm.prototype.isMeshNormalMaterial=!0,sm.prototype.copy=function(ix){return Zd.prototype.copy.call(this,ix),this.bumpMap=ix.bumpMap,this.bumpScale=ix.bumpScale,this.normalMap=ix.normalMap,this.normalScale.copy(ix.normalScale),this.displacementMap=ix.displacementMap,this.displacementScale=ix.displacementScale,this.displacementBias=ix.displacementBias,this.wireframe=ix.wireframe,this.wireframeLinewidth=ix.wireframeLinewidth,this.skinning=ix.skinning,this.morphTargets=ix.morphTargets,this.morphNormals=ix.morphNormals,this},dm.prototype=Object.create(Zd.prototype),dm.prototype.constructor=dm,dm.prototype.isMeshLambertMaterial=!0,dm.prototype.copy=function(ix){return Zd.prototype.copy.call(this,ix),this.color.copy(ix.color),this.map=ix.map,this.lightMap=ix.lightMap,this.lightMapIntensity=ix.lightMapIntensity,this.aoMap=ix.aoMap,this.aoMapIntensity=ix.aoMapIntensity,this.emissive.copy(ix.emissive),this.emissiveMap=ix.emissiveMap,this.emissiveIntensity=ix.emissiveIntensity,this.specularMap=ix.specularMap,this.alphaMap=ix.alphaMap,this.envMap=ix.envMap,this.combine=ix.combine,this.reflectivity=ix.reflectivity,this.refractionRatio=ix.refractionRatio,this.wireframe=ix.wireframe,this.wireframeLinewidth=ix.wireframeLinewidth,this.wireframeLinecap=ix.wireframeLinecap,this.wireframeLinejoin=ix.wireframeLinejoin,this.skinning=ix.skinning,this.morphTargets=ix.morphTargets,this.morphNormals=ix.morphNormals,this},lm.prototype=Object.create(sp.prototype),lm.prototype.constructor=lm,lm.prototype.isLineDashedMaterial=!0,lm.prototype.copy=function(ix){return sp.prototype.copy.call(this,ix),this.scale=ix.scale,this.dashSize=ix.dashSize,this.gapSize=ix.gapSize,this};var Fy=Object.freeze({ShadowMaterial:tm,SpriteMaterial:tp,RawShaderMaterial:am,ShaderMaterial:wl,PointsMaterial:cp,MeshPhysicalMaterial:om,MeshStandardMaterial:rm,MeshPhongMaterial:im,MeshToonMaterial:nm,MeshNormalMaterial:sm,MeshLambertMaterial:dm,MeshDepthMaterial:Jd,MeshDistanceMaterial:Kd,MeshBasicMaterial:Ml,LineDashedMaterial:lm,LineBasicMaterial:sp,Material:Zd}),By={enabled:!1,files:{},add:function(ix,nx){!1!==this.enabled&&(this.files[ix]=nx)},get:function(ix){if(!1!==this.enabled)return this.files[ix]},remove:function(ix){delete this.files[ix]},clear:function(){this.files={}}},Uy=new pm,Ny={};Object.assign(cm.prototype,{load:function(ix,nx,sx,dx){void 0===ix&&(ix=""),void 0!==this.path&&(ix=this.path+ix),ix=this.manager.resolveURL(ix);var lx=this,px=By.get(ix);if(void 0!==px)return lx.manager.itemStart(ix),setTimeout(function(){nx&&nx(px),lx.manager.itemEnd(ix)},0),px;if(void 0===Ny[ix]){var cx=ix.match(/^data:(.*?)(;base64)?,(.*)$/);if(cx){var mx=cx[1],ux=!!cx[2],gx=cx[3];gx=window.decodeURIComponent(gx),ux&&(gx=window.atob(gx));try{var fx=(this.responseType||"").toLowerCase(),hx;switch(fx){case"arraybuffer":case"blob":for(var yx=new Uint8Array(gx.length),xx=0;xx<gx.length;xx++)yx[xx]=gx.charCodeAt(xx);hx="blob"===fx?new Blob([yx.buffer],{type:mx}):yx.buffer;break;case"document":var vx=new DOMParser;hx=vx.parseFromString(gx,mx);break;case"json":hx=JSON.parse(gx);break;default:hx=gx;}window.setTimeout(function(){nx&&nx(hx),lx.manager.itemEnd(ix)},0)}catch(_x){window.setTimeout(function(){dx&&dx(_x),lx.manager.itemEnd(ix),lx.manager.itemError(ix)},0)}}else{Ny[ix]=[],Ny[ix].push({onLoad:nx,onProgress:sx,onError:dx});var Lx=new XMLHttpRequest;for(var bx in Lx.open("GET",ix,!0),Lx.addEventListener("load",function(_x){var Ax=this.response;By.add(ix,Ax);var Ex=Ny[ix];if(delete Ny[ix],200===this.status){for(var Sx=0,Tx=Ex.length;Sx<Tx;Sx++)(Mx=Ex[Sx]).onLoad&&Mx.onLoad(Ax);lx.manager.itemEnd(ix)}else if(0===this.status){for(console.warn("THREE.FileLoader: HTTP Status 0 received."),Sx=0,Tx=Ex.length;Sx<Tx;Sx++)(Mx=Ex[Sx]).onLoad&&Mx.onLoad(Ax);lx.manager.itemEnd(ix)}else{for(Sx=0,Tx=Ex.length;Sx<Tx;Sx++){var Mx;(Mx=Ex[Sx]).onError&&Mx.onError(_x)}lx.manager.itemEnd(ix),lx.manager.itemError(ix)}},!1),Lx.addEventListener("progress",function(_x){for(var Ax=Ny[ix],Ex=0,Sx=Ax.length,Tx;Ex<Sx;Ex++)Tx=Ax[Ex],Tx.onProgress&&Tx.onProgress(_x)},!1),Lx.addEventListener("error",function(_x){var Ax=Ny[ix];delete Ny[ix];for(var Ex=0,Sx=Ax.length,Tx;Ex<Sx;Ex++)Tx=Ax[Ex],Tx.onError&&Tx.onError(_x);lx.manager.itemEnd(ix),lx.manager.itemError(ix)},!1),void 0!==this.responseType&&(Lx.responseType=this.responseType),void 0!==this.withCredentials&&(Lx.withCredentials=this.withCredentials),Lx.overrideMimeType&&Lx.overrideMimeType(void 0===this.mimeType?"text/plain":this.mimeType),this.requestHeader)Lx.setRequestHeader(bx,this.requestHeader[bx]);Lx.send(null)}return lx.manager.itemStart(ix),Lx}Ny[ix].push({onLoad:nx,onProgress:sx,onError:dx})},setPath:function(ix){return this.path=ix,this},setResponseType:function(ix){return this.responseType=ix,this},setWithCredentials:function(ix){return this.withCredentials=ix,this},setMimeType:function(ix){return this.mimeType=ix,this},setRequestHeader:function(ix){return this.requestHeader=ix,this}}),Object.assign(mm.prototype,{load:function(ix,nx,sx,dx){function lx(yx){ux.load(ix[yx],function(xx){var vx=px._parser(xx,!0);cx[yx]={width:vx.width,height:vx.height,format:vx.format,mipmaps:vx.mipmaps},6==(gx+=1)&&(1===vx.mipmapCount&&(mx.minFilter=Qh),mx.format=vx.format,mx.needsUpdate=!0,nx&&nx(mx))},sx,dx)}var px=this,cx=[],mx=new hp;mx.image=cx;var ux=new cm(this.manager);if(ux.setPath(this.path),ux.setResponseType("arraybuffer"),Array.isArray(ix))for(var gx=0,hx=0,fx=ix.length;hx<fx;++hx)lx(hx);else ux.load(ix,function(yx){var xx=px._parser(yx,!0);if(xx.isCubemap)for(var vx=xx.mipmaps.length/xx.mipmapCount,Lx=0;Lx<vx;Lx++){cx[Lx]={mipmaps:[]};for(var bx=0;bx<xx.mipmapCount;bx++)cx[Lx].mipmaps.push(xx.mipmaps[Lx*xx.mipmapCount+bx]),cx[Lx].format=xx.format,cx[Lx].width=xx.width,cx[Lx].height=xx.height}else mx.image.width=xx.width,mx.image.height=xx.height,mx.mipmaps=xx.mipmaps;1===xx.mipmapCount&&(mx.minFilter=Qh),mx.format=xx.format,mx.needsUpdate=!0,nx&&nx(mx)},sx,dx);return mx},setPath:function(ix){return this.path=ix,this}}),Object.assign(um.prototype,{load:function(ix,nx,sx,dx){var lx=this,px=new ud,cx=new cm(this.manager);return cx.setResponseType("arraybuffer"),cx.load(ix,function(mx){var ux=lx._parser(mx);ux&&(void 0===ux.image?void 0!==ux.data&&(px.image.width=ux.width,px.image.height=ux.height,px.image.data=ux.data):px.image=ux.image,px.wrapS=void 0===ux.wrapS?Xh:ux.wrapS,px.wrapT=void 0===ux.wrapT?Xh:ux.wrapT,px.magFilter=void 0===ux.magFilter?Qh:ux.magFilter,px.minFilter=void 0===ux.minFilter?ef:ux.minFilter,px.anisotropy=void 0===ux.anisotropy?1:ux.anisotropy,void 0!==ux.format&&(px.format=ux.format),void 0!==ux.type&&(px.type=ux.type),void 0!==ux.mipmaps&&(px.mipmaps=ux.mipmaps),1===ux.mipmapCount&&(px.minFilter=Qh),px.needsUpdate=!0,nx&&nx(px,ux))},sx,dx),px}}),Object.assign(gm.prototype,{crossOrigin:"Anonymous",load:function(ix,nx,sx,dx){void 0===ix&&(ix=""),void 0!==this.path&&(ix=this.path+ix),ix=this.manager.resolveURL(ix);var lx=this,px=By.get(ix);if(void 0!==px)return lx.manager.itemStart(ix),setTimeout(function(){nx&&nx(px),lx.manager.itemEnd(ix)},0),px;var cx=document.createElementNS("http://www.w3.org/1999/xhtml","img");return cx.addEventListener("load",function(){By.add(ix,this),nx&&nx(this),lx.manager.itemEnd(ix)},!1),cx.addEventListener("error",function(mx){dx&&dx(mx),lx.manager.itemEnd(ix),lx.manager.itemError(ix)},!1),"data:"!==ix.substr(0,5)&&void 0!==this.crossOrigin&&(cx.crossOrigin=this.crossOrigin),lx.manager.itemStart(ix),cx.src=ix,cx},setCrossOrigin:function(ix){return this.crossOrigin=ix,this},setPath:function(ix){return this.path=ix,this}}),Object.assign(hm.prototype,{crossOrigin:"Anonymous",load:function(ix,nx,sx,dx){function lx(gx){cx.load(ix[gx],function(hx){px.images[gx]=hx,6==++mx&&(px.needsUpdate=!0,nx&&nx(px))},void 0,dx)}var px=new gd,cx=new gm(this.manager);cx.setCrossOrigin(this.crossOrigin),cx.setPath(this.path);for(var mx=0,ux=0;ux<ix.length;++ux)lx(ux);return px},setCrossOrigin:function(ix){return this.crossOrigin=ix,this},setPath:function(ix){return this.path=ix,this}}),Object.assign(fm.prototype,{crossOrigin:"Anonymous",load:function(ix,nx,sx,dx){var lx=new ld,px=new gm(this.manager);return px.setCrossOrigin(this.crossOrigin),px.setPath(this.path),px.load(ix,function(cx){lx.image=cx;var mx=0<ix.search(/\.(jpg|jpeg)$/)||0===ix.search(/^data\:image\/jpeg/);lx.format=mx?hf:ff,lx.needsUpdate=!0,void 0!==nx&&nx(lx)},sx,dx),lx},setCrossOrigin:function(ix){return this.crossOrigin=ix,this},setPath:function(ix){return this.path=ix,this}}),Object.assign(ym.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(ix,nx){var sx=this.getUtoTmapping(ix);return this.getPoint(sx,nx)},getPoints:function(ix){void 0===ix&&(ix=5);for(var nx=[],sx=0;sx<=ix;sx++)nx.push(this.getPoint(sx/ix));return nx},getSpacedPoints:function(ix){void 0===ix&&(ix=5);for(var nx=[],sx=0;sx<=ix;sx++)nx.push(this.getPointAt(sx/ix));return nx},getLength:function(){var ix=this.getLengths();return ix[ix.length-1]},getLengths:function(ix){if(void 0===ix&&(ix=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===ix+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var dx=[],lx=this.getPoint(0),px=0,nx,sx;for(dx.push(0),sx=1;sx<=ix;sx++)px+=(nx=this.getPoint(sx/ix)).distanceTo(lx),dx.push(px),lx=nx;return this.cacheArcLengths=dx,dx},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(ix,nx){var dx=this.getLengths(),lx=0,px=dx.length,sx;sx=nx||ix*dx[px-1];for(var mx=0,ux=px-1,cx;mx<=ux;)if(0>(cx=dx[lx=Math.floor(mx+(ux-mx)/2)]-sx))mx=lx+1;else{if(!(0<cx)){ux=lx;break}ux=lx-1}if(dx[lx=ux]===sx)return lx/(px-1);var gx=dx[lx];return(lx+(sx-gx)/(dx[lx+1]-gx))/(px-1)},getTangent:function(ix){var nx=ix-1e-4,sx=ix+1e-4;0>nx&&(nx=0),1<sx&&(sx=1);var dx=this.getPoint(nx);return this.getPoint(sx).clone().sub(dx).normalize()},getTangentAt:function(ix){var nx=this.getUtoTmapping(ix);return this.getTangent(nx)},computeFrenetFrames:function(ix,nx){var px=new sd,cx=[],mx=[],ux=[],gx=new sd,hx=new id,sx,dx,lx;for(sx=0;sx<=ix;sx++)dx=sx/ix,cx[sx]=this.getTangentAt(dx),cx[sx].normalize();mx[0]=new sd,ux[0]=new sd;var fx=Number.MAX_VALUE,yx=Math.abs(cx[0].x),xx=Math.abs(cx[0].y),vx=Math.abs(cx[0].z);for(yx<=fx&&(fx=yx,px.set(1,0,0)),xx<=fx&&(fx=xx,px.set(0,1,0)),vx<=fx&&px.set(0,0,1),gx.crossVectors(cx[0],px).normalize(),mx[0].crossVectors(cx[0],gx),ux[0].crossVectors(cx[0],mx[0]),sx=1;sx<=ix;sx++)mx[sx]=mx[sx-1].clone(),ux[sx]=ux[sx-1].clone(),gx.crossVectors(cx[sx-1],cx[sx]),gx.length()>Number.EPSILON&&(gx.normalize(),lx=Math.acos(uy.clamp(cx[sx-1].dot(cx[sx]),-1,1)),mx[sx].applyMatrix4(hx.makeRotationAxis(gx,lx))),ux[sx].crossVectors(cx[sx],mx[sx]);if(!0===nx)for(lx=Math.acos(uy.clamp(mx[0].dot(mx[ix]),-1,1)),lx/=ix,0<cx[0].dot(gx.crossVectors(mx[0],mx[ix]))&&(lx=-lx),sx=1;sx<=ix;sx++)mx[sx].applyMatrix4(hx.makeRotationAxis(cx[sx],lx*sx)),ux[sx].crossVectors(cx[sx],mx[sx]);return{tangents:cx,normals:mx,binormals:ux}},clone:function(){return new this.constructor().copy(this)},copy:function(ix){return this.arcLengthDivisions=ix.arcLengthDivisions,this},toJSON:function(){var ix={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return ix.arcLengthDivisions=this.arcLengthDivisions,ix.type=this.type,ix},fromJSON:function(ix){return this.arcLengthDivisions=ix.arcLengthDivisions,this}}),xm.prototype=Object.create(ym.prototype),xm.prototype.constructor=xm,xm.prototype.isEllipseCurve=!0,xm.prototype.getPoint=function(ix,nx){for(var sx=nx||new od,dx=2*Math.PI,lx=this.aEndAngle-this.aStartAngle,px=Math.abs(lx)<Number.EPSILON;0>lx;)lx+=dx;for(;lx>dx;)lx-=dx;lx<Number.EPSILON&&(lx=px?0:dx),!0!==this.aClockwise||px||(lx===dx?lx=-dx:lx-=dx);var cx=this.aStartAngle+ix*lx,mx=this.aX+this.xRadius*Math.cos(cx),ux=this.aY+this.yRadius*Math.sin(cx);if(0!==this.aRotation){var gx=Math.cos(this.aRotation),hx=Math.sin(this.aRotation),fx=mx-this.aX,yx=ux-this.aY;mx=fx*gx-yx*hx+this.aX,ux=fx*hx+yx*gx+this.aY}return sx.set(mx,ux)},xm.prototype.copy=function(ix){return ym.prototype.copy.call(this,ix),this.aX=ix.aX,this.aY=ix.aY,this.xRadius=ix.xRadius,this.yRadius=ix.yRadius,this.aStartAngle=ix.aStartAngle,this.aEndAngle=ix.aEndAngle,this.aClockwise=ix.aClockwise,this.aRotation=ix.aRotation,this},xm.prototype.toJSON=function(){var ix=ym.prototype.toJSON.call(this);return ix.aX=this.aX,ix.aY=this.aY,ix.xRadius=this.xRadius,ix.yRadius=this.yRadius,ix.aStartAngle=this.aStartAngle,ix.aEndAngle=this.aEndAngle,ix.aClockwise=this.aClockwise,ix.aRotation=this.aRotation,ix},xm.prototype.fromJSON=function(ix){return ym.prototype.fromJSON.call(this,ix),this.aX=ix.aX,this.aY=ix.aY,this.xRadius=ix.xRadius,this.yRadius=ix.yRadius,this.aStartAngle=ix.aStartAngle,this.aEndAngle=ix.aEndAngle,this.aClockwise=ix.aClockwise,this.aRotation=ix.aRotation,this},vm.prototype=Object.create(xm.prototype),vm.prototype.constructor=vm,vm.prototype.isArcCurve=!0;var Wy=new sd,zy=new Lm,Hy=new Lm,Gy=new Lm;bm.prototype=Object.create(ym.prototype),bm.prototype.constructor=bm,bm.prototype.isCatmullRomCurve3=!0,bm.prototype.getPoint=function(ix,nx){var cx=nx||new sd,mx=this.points,ux=mx.length,gx=(ux-(this.closed?0:1))*ix,hx=Math.floor(gx),fx=gx-hx,sx,dx,lx,px;if(this.closed?hx+=0<hx?0:(Math.floor(Math.abs(hx)/mx.length)+1)*mx.length:0==fx&&hx===ux-1&&(hx=ux-2,fx=1),this.closed||0<hx?sx=mx[(hx-1)%ux]:(Wy.subVectors(mx[0],mx[1]).add(mx[0]),sx=Wy),dx=mx[hx%ux],lx=mx[(hx+1)%ux],this.closed||hx+2<ux?px=mx[(hx+2)%ux]:(Wy.subVectors(mx[ux-1],mx[ux-2]).add(mx[ux-1]),px=Wy),"centripetal"===this.curveType||"chordal"===this.curveType){var yx="chordal"===this.curveType?.5:.25,xx=Math.pow(sx.distanceToSquared(dx),yx),vx=Math.pow(dx.distanceToSquared(lx),yx),Lx=Math.pow(lx.distanceToSquared(px),yx);1e-4>vx&&(vx=1),1e-4>xx&&(xx=vx),1e-4>Lx&&(Lx=vx),zy.initNonuniformCatmullRom(sx.x,dx.x,lx.x,px.x,xx,vx,Lx),Hy.initNonuniformCatmullRom(sx.y,dx.y,lx.y,px.y,xx,vx,Lx),Gy.initNonuniformCatmullRom(sx.z,dx.z,lx.z,px.z,xx,vx,Lx)}else"catmullrom"===this.curveType&&(zy.initCatmullRom(sx.x,dx.x,lx.x,px.x,this.tension),Hy.initCatmullRom(sx.y,dx.y,lx.y,px.y,this.tension),Gy.initCatmullRom(sx.z,dx.z,lx.z,px.z,this.tension));return cx.set(zy.calc(fx),Hy.calc(fx),Gy.calc(fx)),cx},bm.prototype.copy=function(ix){ym.prototype.copy.call(this,ix),this.points=[];for(var nx=0,sx=ix.points.length,dx;nx<sx;nx++)dx=ix.points[nx],this.points.push(dx.clone());return this.closed=ix.closed,this.curveType=ix.curveType,this.tension=ix.tension,this},bm.prototype.toJSON=function(){var ix=ym.prototype.toJSON.call(this);ix.points=[];for(var nx=0,sx=this.points.length,dx;nx<sx;nx++)dx=this.points[nx],ix.points.push(dx.toArray());return ix.closed=this.closed,ix.curveType=this.curveType,ix.tension=this.tension,ix},bm.prototype.fromJSON=function(ix){ym.prototype.fromJSON.call(this,ix),this.points=[];for(var nx=0,sx=ix.points.length,dx;nx<sx;nx++)dx=ix.points[nx],this.points.push(new sd().fromArray(dx));return this.closed=ix.closed,this.curveType=ix.curveType,this.tension=ix.tension,this},Sm.prototype=Object.create(ym.prototype),Sm.prototype.constructor=Sm,Sm.prototype.isCubicBezierCurve=!0,Sm.prototype.getPoint=function(ix,nx){var sx=nx||new od,dx=this.v0,lx=this.v1,px=this.v2,cx=this.v3;return sx.set(Em(ix,dx.x,lx.x,px.x,cx.x),Em(ix,dx.y,lx.y,px.y,cx.y)),sx},Sm.prototype.copy=function(ix){return ym.prototype.copy.call(this,ix),this.v0.copy(ix.v0),this.v1.copy(ix.v1),this.v2.copy(ix.v2),this.v3.copy(ix.v3),this},Sm.prototype.toJSON=function(){var ix=ym.prototype.toJSON.call(this);return ix.v0=this.v0.toArray(),ix.v1=this.v1.toArray(),ix.v2=this.v2.toArray(),ix.v3=this.v3.toArray(),ix},Sm.prototype.fromJSON=function(ix){return ym.prototype.fromJSON.call(this,ix),this.v0.fromArray(ix.v0),this.v1.fromArray(ix.v1),this.v2.fromArray(ix.v2),this.v3.fromArray(ix.v3),this},Tm.prototype=Object.create(ym.prototype),Tm.prototype.constructor=Tm,Tm.prototype.isCubicBezierCurve3=!0,Tm.prototype.getPoint=function(ix,nx){var sx=nx||new sd,dx=this.v0,lx=this.v1,px=this.v2,cx=this.v3;return sx.set(Em(ix,dx.x,lx.x,px.x,cx.x),Em(ix,dx.y,lx.y,px.y,cx.y),Em(ix,dx.z,lx.z,px.z,cx.z)),sx},Tm.prototype.copy=function(ix){return ym.prototype.copy.call(this,ix),this.v0.copy(ix.v0),this.v1.copy(ix.v1),this.v2.copy(ix.v2),this.v3.copy(ix.v3),this},Tm.prototype.toJSON=function(){var ix=ym.prototype.toJSON.call(this);return ix.v0=this.v0.toArray(),ix.v1=this.v1.toArray(),ix.v2=this.v2.toArray(),ix.v3=this.v3.toArray(),ix},Tm.prototype.fromJSON=function(ix){return ym.prototype.fromJSON.call(this,ix),this.v0.fromArray(ix.v0),this.v1.fromArray(ix.v1),this.v2.fromArray(ix.v2),this.v3.fromArray(ix.v3),this},Mm.prototype=Object.create(ym.prototype),Mm.prototype.constructor=Mm,Mm.prototype.isLineCurve=!0,Mm.prototype.getPoint=function(ix,nx){var sx=nx||new od;return 1===ix?sx.copy(this.v2):(sx.copy(this.v2).sub(this.v1),sx.multiplyScalar(ix).add(this.v1)),sx},Mm.prototype.getPointAt=function(ix,nx){return this.getPoint(ix,nx)},Mm.prototype.getTangent=function(){return this.v2.clone().sub(this.v1).normalize()},Mm.prototype.copy=function(ix){return ym.prototype.copy.call(this,ix),this.v1.copy(ix.v1),this.v2.copy(ix.v2),this},Mm.prototype.toJSON=function(){var ix=ym.prototype.toJSON.call(this);return ix.v1=this.v1.toArray(),ix.v2=this.v2.toArray(),ix},Mm.prototype.fromJSON=function(ix){return ym.prototype.fromJSON.call(this,ix),this.v1.fromArray(ix.v1),this.v2.fromArray(ix.v2),this},wm.prototype=Object.create(ym.prototype),wm.prototype.constructor=wm,wm.prototype.isLineCurve3=!0,wm.prototype.getPoint=function(ix,nx){var sx=nx||new sd;return 1===ix?sx.copy(this.v2):(sx.copy(this.v2).sub(this.v1),sx.multiplyScalar(ix).add(this.v1)),sx},wm.prototype.getPointAt=function(ix,nx){return this.getPoint(ix,nx)},wm.prototype.copy=function(ix){return ym.prototype.copy.call(this,ix),this.v1.copy(ix.v1),this.v2.copy(ix.v2),this},wm.prototype.toJSON=function(){var ix=ym.prototype.toJSON.call(this);return ix.v1=this.v1.toArray(),ix.v2=this.v2.toArray(),ix},wm.prototype.fromJSON=function(ix){return ym.prototype.fromJSON.call(this,ix),this.v1.fromArray(ix.v1),this.v2.fromArray(ix.v2),this},Rm.prototype=Object.create(ym.prototype),Rm.prototype.constructor=Rm,Rm.prototype.isQuadraticBezierCurve=!0,Rm.prototype.getPoint=function(ix,nx){var sx=nx||new od,dx=this.v0,lx=this.v1,px=this.v2;return sx.set(Am(ix,dx.x,lx.x,px.x),Am(ix,dx.y,lx.y,px.y)),sx},Rm.prototype.copy=function(ix){return ym.prototype.copy.call(this,ix),this.v0.copy(ix.v0),this.v1.copy(ix.v1),this.v2.copy(ix.v2),this},Rm.prototype.toJSON=function(){var ix=ym.prototype.toJSON.call(this);return ix.v0=this.v0.toArray(),ix.v1=this.v1.toArray(),ix.v2=this.v2.toArray(),ix},Rm.prototype.fromJSON=function(ix){return ym.prototype.fromJSON.call(this,ix),this.v0.fromArray(ix.v0),this.v1.fromArray(ix.v1),this.v2.fromArray(ix.v2),this},Pm.prototype=Object.create(ym.prototype),Pm.prototype.constructor=Pm,Pm.prototype.isQuadraticBezierCurve3=!0,Pm.prototype.getPoint=function(ix,nx){var sx=nx||new sd,dx=this.v0,lx=this.v1,px=this.v2;return sx.set(Am(ix,dx.x,lx.x,px.x),Am(ix,dx.y,lx.y,px.y),Am(ix,dx.z,lx.z,px.z)),sx},Pm.prototype.copy=function(ix){return ym.prototype.copy.call(this,ix),this.v0.copy(ix.v0),this.v1.copy(ix.v1),this.v2.copy(ix.v2),this},Pm.prototype.toJSON=function(){var ix=ym.prototype.toJSON.call(this);return ix.v0=this.v0.toArray(),ix.v1=this.v1.toArray(),ix.v2=this.v2.toArray(),ix},Pm.prototype.fromJSON=function(ix){return ym.prototype.fromJSON.call(this,ix),this.v0.fromArray(ix.v0),this.v1.fromArray(ix.v1),this.v2.fromArray(ix.v2),this},Cm.prototype=Object.create(ym.prototype),Cm.prototype.constructor=Cm,Cm.prototype.isSplineCurve=!0,Cm.prototype.getPoint=function(ix,nx){var sx=nx||new od,dx=this.points,lx=(dx.length-1)*ix,px=Math.floor(lx),cx=lx-px,mx=dx[0===px?px:px-1],ux=dx[px],gx=dx[px>dx.length-2?dx.length-1:px+1],hx=dx[px>dx.length-3?dx.length-1:px+2];return sx.set(_m(cx,mx.x,ux.x,gx.x,hx.x),_m(cx,mx.y,ux.y,gx.y,hx.y)),sx},Cm.prototype.copy=function(ix){ym.prototype.copy.call(this,ix),this.points=[];for(var nx=0,sx=ix.points.length,dx;nx<sx;nx++)dx=ix.points[nx],this.points.push(dx.clone());return this},Cm.prototype.toJSON=function(){var ix=ym.prototype.toJSON.call(this);ix.points=[];for(var nx=0,sx=this.points.length,dx;nx<sx;nx++)dx=this.points[nx],ix.points.push(dx.toArray());return ix},Cm.prototype.fromJSON=function(ix){ym.prototype.fromJSON.call(this,ix),this.points=[];for(var nx=0,sx=ix.points.length,dx;nx<sx;nx++)dx=ix.points[nx],this.points.push(new od().fromArray(dx));return this};var Vy=Object.freeze({ArcCurve:vm,CatmullRomCurve3:bm,CubicBezierCurve:Sm,CubicBezierCurve3:Tm,EllipseCurve:xm,LineCurve:Mm,LineCurve3:wm,QuadraticBezierCurve:Rm,QuadraticBezierCurve3:Pm,SplineCurve:Cm});Om.prototype=Object.assign(Object.create(ym.prototype),{constructor:Om,add:function(ix){this.curves.push(ix)},closePath:function(){var ix=this.curves[0].getPoint(0),nx=this.curves[this.curves.length-1].getPoint(1);ix.equals(nx)||this.curves.push(new Mm(nx,ix))},getPoint:function(ix){for(var nx=ix*this.getLength(),sx=this.getCurveLengths(),dx=0;dx<sx.length;){if(sx[dx]>=nx){var lx=sx[dx]-nx,px=this.curves[dx],cx=px.getLength(),mx=0===cx?0:1-lx/cx;return px.getPointAt(mx)}dx++}return null},getLength:function(){var ix=this.getCurveLengths();return ix[ix.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var ix=[],nx=0,sx=0,dx=this.curves.length;sx<dx;sx++)nx+=this.curves[sx].getLength(),ix.push(nx);return this.cacheLengths=ix,ix},getSpacedPoints:function(ix){void 0===ix&&(ix=40);for(var nx=[],sx=0;sx<=ix;sx++)nx.push(this.getPoint(sx/ix));return this.autoClose&&nx.push(nx[0]),nx},getPoints:function(ix){ix=ix||12;for(var sx=[],dx=0,lx=this.curves,nx;dx<lx.length;dx++)for(var px=lx[dx],cx=px&&px.isEllipseCurve?2*ix:px&&px.isLineCurve?1:px&&px.isSplineCurve?ix*px.points.length:ix,mx=px.getPoints(cx),ux=0,gx;ux<mx.length;ux++)gx=mx[ux],nx&&nx.equals(gx)||(sx.push(gx),nx=gx);return this.autoClose&&1<sx.length&&!sx[sx.length-1].equals(sx[0])&&sx.push(sx[0]),sx},copy:function(ix){ym.prototype.copy.call(this,ix),this.curves=[];for(var nx=0,sx=ix.curves.length,dx;nx<sx;nx++)dx=ix.curves[nx],this.curves.push(dx.clone());return this.autoClose=ix.autoClose,this},toJSON:function(){var ix=ym.prototype.toJSON.call(this);ix.autoClose=this.autoClose,ix.curves=[];for(var nx=0,sx=this.curves.length,dx;nx<sx;nx++)dx=this.curves[nx],ix.curves.push(dx.toJSON());return ix},fromJSON:function(ix){ym.prototype.fromJSON.call(this,ix),this.autoClose=ix.autoClose,this.curves=[];for(var nx=0,sx=ix.curves.length,dx;nx<sx;nx++)dx=ix.curves[nx],this.curves.push(new Vy[dx.type]().fromJSON(dx));return this}}),Im.prototype=Object.assign(Object.create(Om.prototype),{constructor:Im,setFromPoints:function(ix){this.moveTo(ix[0].x,ix[0].y);for(var nx=1,sx=ix.length;nx<sx;nx++)this.lineTo(ix[nx].x,ix[nx].y)},moveTo:function(ix,nx){this.currentPoint.set(ix,nx)},lineTo:function(ix,nx){var sx=new Mm(this.currentPoint.clone(),new od(ix,nx));this.curves.push(sx),this.currentPoint.set(ix,nx)},quadraticCurveTo:function(ix,nx,sx,dx){var lx=new Rm(this.currentPoint.clone(),new od(ix,nx),new od(sx,dx));this.curves.push(lx),this.currentPoint.set(sx,dx)},bezierCurveTo:function(ix,nx,sx,dx,lx,px){var cx=new Sm(this.currentPoint.clone(),new od(ix,nx),new od(sx,dx),new od(lx,px));this.curves.push(cx),this.currentPoint.set(lx,px)},splineThru:function(ix){var nx=new Cm([this.currentPoint.clone()].concat(ix));this.curves.push(nx),this.currentPoint.copy(ix[ix.length-1])},arc:function(ix,nx,sx,dx,lx,px){var cx=this.currentPoint.x,mx=this.currentPoint.y;this.absarc(ix+cx,nx+mx,sx,dx,lx,px)},absarc:function(ix,nx,sx,dx,lx,px){this.absellipse(ix,nx,sx,sx,dx,lx,px)},ellipse:function(ix,nx,sx,dx,lx,px,cx,mx){var ux=this.currentPoint.x,gx=this.currentPoint.y;this.absellipse(ix+ux,nx+gx,sx,dx,lx,px,cx,mx)},absellipse:function(ix,nx,sx,dx,lx,px,cx,mx){var ux=new xm(ix,nx,sx,dx,lx,px,cx,mx);if(0<this.curves.length){var gx=ux.getPoint(0);gx.equals(this.currentPoint)||this.lineTo(gx.x,gx.y)}this.curves.push(ux);var hx=ux.getPoint(1);this.currentPoint.copy(hx)},copy:function(ix){return Om.prototype.copy.call(this,ix),this.currentPoint.copy(ix.currentPoint),this},toJSON:function(){var ix=Om.prototype.toJSON.call(this);return ix.currentPoint=this.currentPoint.toArray(),ix},fromJSON:function(ix){return Om.prototype.fromJSON.call(this,ix),this.currentPoint.fromArray(ix.currentPoint),this}}),Dm.prototype=Object.assign(Object.create(Im.prototype),{constructor:Dm,getPointsHoles:function(ix){for(var nx=[],sx=0,dx=this.holes.length;sx<dx;sx++)nx[sx]=this.holes[sx].getPoints(ix);return nx},extractPoints:function(ix){return{shape:this.getPoints(ix),holes:this.getPointsHoles(ix)}},copy:function(ix){Im.prototype.copy.call(this,ix),this.holes=[];for(var nx=0,sx=ix.holes.length,dx;nx<sx;nx++)dx=ix.holes[nx],this.holes.push(dx.clone());return this},toJSON:function(){var ix=Im.prototype.toJSON.call(this);ix.uuid=this.uuid,ix.holes=[];for(var nx=0,sx=this.holes.length,dx;nx<sx;nx++)dx=this.holes[nx],ix.holes.push(dx.toJSON());return ix},fromJSON:function(ix){Im.prototype.fromJSON.call(this,ix),this.uuid=ix.uuid,this.holes=[];for(var nx=0,sx=ix.holes.length,dx;nx<sx;nx++)dx=ix.holes[nx],this.holes.push(new Im().fromJSON(dx));return this}}),Fm.prototype=Object.assign(Object.create(il.prototype),{constructor:Fm,isLight:!0,copy:function(ix){return il.prototype.copy.call(this,ix),this.color.copy(ix.color),this.intensity=ix.intensity,this},toJSON:function(ix){var nx=il.prototype.toJSON.call(this,ix);return nx.object.color=this.color.getHex(),nx.object.intensity=this.intensity,void 0!==this.groundColor&&(nx.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(nx.object.distance=this.distance),void 0!==this.angle&&(nx.object.angle=this.angle),void 0!==this.decay&&(nx.object.decay=this.decay),void 0!==this.penumbra&&(nx.object.penumbra=this.penumbra),void 0!==this.shadow&&(nx.object.shadow=this.shadow.toJSON()),nx}}),Bm.prototype=Object.assign(Object.create(Fm.prototype),{constructor:Bm,isHemisphereLight:!0,copy:function(ix){return Fm.prototype.copy.call(this,ix),this.groundColor.copy(ix.groundColor),this}}),Object.assign(Um.prototype,{copy:function(ix){return this.camera=ix.camera.clone(),this.bias=ix.bias,this.radius=ix.radius,this.mapSize.copy(ix.mapSize),this},clone:function(){return new this.constructor().copy(this)},toJSON:function(){var ix={};return 0!==this.bias&&(ix.bias=this.bias),1!==this.radius&&(ix.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(ix.mapSize=this.mapSize.toArray()),ix.camera=this.camera.toJSON(!1).object,delete ix.camera.matrix,ix}}),Nm.prototype=Object.assign(Object.create(Um.prototype),{constructor:Nm,isSpotLightShadow:!0,update:function(ix){var nx=this.camera,sx=2*uy.RAD2DEG*ix.angle,dx=this.mapSize.width/this.mapSize.height,lx=ix.distance||nx.far;sx===nx.fov&&dx===nx.aspect&&lx===nx.far||(nx.fov=sx,nx.aspect=dx,nx.far=lx,nx.updateProjectionMatrix())}}),Wm.prototype=Object.assign(Object.create(Fm.prototype),{constructor:Wm,isSpotLight:!0,copy:function(ix){return Fm.prototype.copy.call(this,ix),this.distance=ix.distance,this.angle=ix.angle,this.penumbra=ix.penumbra,this.decay=ix.decay,this.target=ix.target.clone(),this.shadow=ix.shadow.clone(),this}}),zm.prototype=Object.assign(Object.create(Fm.prototype),{constructor:zm,isPointLight:!0,copy:function(ix){return Fm.prototype.copy.call(this,ix),this.distance=ix.distance,this.decay=ix.decay,this.shadow=ix.shadow.clone(),this}}),Hm.prototype=Object.assign(Object.create(Um.prototype),{constructor:Hm}),Gm.prototype=Object.assign(Object.create(Fm.prototype),{constructor:Gm,isDirectionalLight:!0,copy:function(ix){return Fm.prototype.copy.call(this,ix),this.target=ix.target.clone(),this.shadow=ix.shadow.clone(),this}}),Vm.prototype=Object.assign(Object.create(Fm.prototype),{constructor:Vm,isAmbientLight:!0}),km.prototype=Object.assign(Object.create(Fm.prototype),{constructor:km,isRectAreaLight:!0,copy:function(ix){return Fm.prototype.copy.call(this,ix),this.width=ix.width,this.height=ix.height,this},toJSON:function(ix){var nx=Fm.prototype.toJSON.call(this,ix);return nx.object.width=this.width,nx.object.height=this.height,nx}}),jm.prototype=Object.assign(Object.create(tu.prototype),{constructor:jm,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:qf,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),Ym.prototype=Object.assign(Object.create(tu.prototype),{constructor:Ym,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:qf,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),Object.assign(Xm.prototype,{evaluate:function(ix){var nx=this.parameterPositions,sx=this._cachedIndex,dx=nx[sx],lx=nx[sx-1];t:{e:{var px;i:{n:if(!(ix<dx)){for(var cx=sx+2;;){if(void 0===dx){if(ix<lx)break n;return sx=nx.length,this._cachedIndex=sx,this.afterEnd_(sx-1,ix,lx)}if(sx===cx)break;if(lx=dx,ix<(dx=nx[++sx]))break e}px=nx.length;break i}if(ix>=lx)break t;var mx=nx[1];for(ix<mx&&(sx=2,lx=mx),cx=sx-2;;){if(void 0===lx)return this._cachedIndex=0,this.beforeStart_(0,ix,dx);if(sx===cx)break;if(dx=lx,ix>=(lx=nx[--sx-1]))break e}px=sx,sx=0}for(;sx<px;){var ux=sx+px>>>1;ix<nx[ux]?px=ux:sx=ux+1}if(dx=nx[sx],void 0===(lx=nx[sx-1]))return this._cachedIndex=0,this.beforeStart_(0,ix,dx);if(void 0===dx)return sx=nx.length,this._cachedIndex=sx,this.afterEnd_(sx-1,lx,ix)}this._cachedIndex=sx,this.intervalChanged_(sx,lx,dx)}return this.interpolate_(sx,lx,ix,dx)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(ix){for(var nx=this.resultBuffer,sx=this.sampleValues,dx=this.valueSize,px=0;px!==dx;++px)nx[px]=sx[ix*dx+px];return nx},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}}),Object.assign(Xm.prototype,{beforeStart_:Xm.prototype.copySampleValue_,afterEnd_:Xm.prototype.copySampleValue_}),qm.prototype=Object.assign(Object.create(Xm.prototype),{constructor:qm,interpolate_:function(ix,nx,sx,dx){for(var lx=this.resultBuffer,px=this.sampleValues,cx=this.valueSize,mx=ix*cx,gx=mx+cx;mx!==gx;mx+=4)nd.slerpFlat(lx,0,px,mx-cx,px,mx,(sx-nx)/(dx-nx));return lx}}),Zm.prototype=Object.assign(Object.create(tu.prototype),{constructor:Zm,ValueTypeName:"quaternion",DefaultInterpolation:Zf,InterpolantFactoryMethodLinear:function(ix){return new qm(this.times,this.values,this.getValueSize(),ix)},InterpolantFactoryMethodSmooth:void 0}),Jm.prototype=Object.assign(Object.create(tu.prototype),{constructor:Jm,ValueTypeName:"color"}),Km.prototype=Object.assign(Object.create(tu.prototype),{constructor:Km,ValueTypeName:"number"}),Qm.prototype=Object.assign(Object.create(Xm.prototype),{constructor:Qm,DefaultSettings_:{endingStart:Kf,endingEnd:Kf},intervalChanged_:function(ix,nx,sx){var dx=this.parameterPositions,lx=ix-2,px=ix+1,cx=dx[lx],mx=dx[px];if(void 0===cx)switch(this.getSettings_().endingStart){case Qf:lx=ix,cx=2*nx-sx;break;case $f:cx=nx+dx[lx=dx.length-2]-dx[lx+1];break;default:lx=ix,cx=sx;}if(void 0===mx)switch(this.getSettings_().endingEnd){case Qf:px=ix,mx=2*sx-nx;break;case $f:px=1,mx=sx+dx[1]-dx[0];break;default:px=ix-1,mx=nx;}var ux=.5*(sx-nx),gx=this.valueSize;this._weightPrev=ux/(nx-cx),this._weightNext=ux/(mx-sx),this._offsetPrev=lx*gx,this._offsetNext=px*gx},interpolate_:function(ix,nx,sx,dx){for(var lx=this.resultBuffer,px=this.sampleValues,cx=this.valueSize,mx=ix*cx,gx=this._offsetPrev,hx=this._offsetNext,fx=this._weightPrev,yx=this._weightNext,xx=(sx-nx)/(dx-nx),vx=xx*xx,Lx=vx*xx,Sx=0;Sx!==cx;++Sx)lx[Sx]=(-fx*Lx+2*fx*vx-fx*xx)*px[gx+Sx]+((1+fx)*Lx+(-1.5-2*fx)*vx+(-.5+fx)*xx+1)*px[mx-cx+Sx]+((-1-yx)*Lx+(1.5+yx)*vx+.5*xx)*px[mx+Sx]+(yx*Lx-yx*vx)*px[hx+Sx];return lx}}),$m.prototype=Object.assign(Object.create(Xm.prototype),{constructor:$m,interpolate_:function(ix,nx,sx,dx){for(var lx=this.resultBuffer,px=this.sampleValues,cx=this.valueSize,mx=ix*cx,gx=(sx-nx)/(dx-nx),fx=0;fx!==cx;++fx)lx[fx]=px[mx-cx+fx]*(1-gx)+px[mx+fx]*gx;return lx}}),eu.prototype=Object.assign(Object.create(Xm.prototype),{constructor:eu,interpolate_:function(ix){return this.copySampleValue_(ix-1)}});var ky={arraySlice:function(ix,nx,sx){return ky.isTypedArray(ix)?new ix.constructor(ix.subarray(nx,void 0===sx?ix.length:sx)):ix.slice(nx,sx)},convertArray:function(ix,nx,sx){return ix&&(sx||ix.constructor!==nx)?"number"==typeof nx.BYTES_PER_ELEMENT?new nx(ix):Array.prototype.slice.call(ix):ix},isTypedArray:function(ix){return ArrayBuffer.isView(ix)&&!(ix instanceof DataView)},getKeyframeOrder:function(ix){for(var nx=ix.length,sx=Array(nx),dx=0;dx!==nx;++dx)sx[dx]=dx;return sx.sort(function(lx,px){return ix[lx]-ix[px]}),sx},sortedArray:function(ix,nx,sx){for(var dx=ix.length,lx=new ix.constructor(dx),px=0,cx=0;cx!==dx;++px)for(var mx=sx[px]*nx,ux=0;ux!==nx;++ux)lx[cx++]=ix[mx+ux];return lx},flattenJSON:function(ix,nx,sx,dx){for(var lx=1,px=ix[0];void 0!==px&&void 0===px[dx];)px=ix[lx++];if(void 0!==px){var cx=px[dx];if(void 0!==cx)if(Array.isArray(cx))do void 0!==(cx=px[dx])&&(nx.push(px.time),sx.push.apply(sx,cx)),px=ix[lx++];while(void 0!==px);else if(void 0!==cx.toArray)do void 0!==(cx=px[dx])&&(nx.push(px.time),cx.toArray(sx,sx.length)),px=ix[lx++];while(void 0!==px);else do void 0!==(cx=px[dx])&&(nx.push(px.time),sx.push(cx)),px=ix[lx++];while(void 0!==px)}}};Object.assign(tu,{parse:function(ix){if(void 0===ix.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");var nx=tu._getTrackTypeForValueTypeName(ix.type);if(void 0===ix.times){var sx=[],dx=[];ky.flattenJSON(ix.keys,sx,dx,"value"),ix.times=sx,ix.values=dx}return void 0===nx.parse?new nx(ix.name,ix.times,ix.values,ix.interpolation):nx.parse(ix)},toJSON:function(ix){var sx=ix.constructor,nx;if(void 0!==sx.toJSON)nx=sx.toJSON(ix);else{nx={name:ix.name,times:ky.convertArray(ix.times,Array),values:ky.convertArray(ix.values,Array)};var dx=ix.getInterpolation();dx!==ix.DefaultInterpolation&&(nx.interpolation=dx)}return nx.type=ix.ValueTypeName,nx},_getTrackTypeForValueTypeName:function(ix){switch(ix.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Km;case"vector":case"vector2":case"vector3":case"vector4":return au;case"color":return Jm;case"quaternion":return Zm;case"bool":case"boolean":return Ym;case"string":return jm;}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+ix)}}),Object.assign(tu.prototype,{constructor:tu,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:Zf,InterpolantFactoryMethodDiscrete:function(ix){return new eu(this.times,this.values,this.getValueSize(),ix)},InterpolantFactoryMethodLinear:function(ix){return new $m(this.times,this.values,this.getValueSize(),ix)},InterpolantFactoryMethodSmooth:function(ix){return new Qm(this.times,this.values,this.getValueSize(),ix)},setInterpolation:function(ix){var nx;if(ix===qf?nx=this.InterpolantFactoryMethodDiscrete:ix===Zf?nx=this.InterpolantFactoryMethodLinear:ix===Jf?nx=this.InterpolantFactoryMethodSmooth:void 0,void 0!==nx)this.createInterpolant=nx;else{var sx="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(ix===this.DefaultInterpolation)throw new Error(sx);this.setInterpolation(this.DefaultInterpolation)}console.warn("THREE.KeyframeTrack:",sx)}},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return qf;case this.InterpolantFactoryMethodLinear:return Zf;case this.InterpolantFactoryMethodSmooth:return Jf;}},getValueSize:function(){return this.values.length/this.times.length},shift:function(ix){if(0!==ix)for(var nx=this.times,sx=0,dx=nx.length;sx!==dx;++sx)nx[sx]+=ix;return this},scale:function(ix){if(1!==ix)for(var nx=this.times,sx=0,dx=nx.length;sx!==dx;++sx)nx[sx]*=ix;return this},trim:function(ix,nx){for(var sx=this.times,dx=sx.length,lx=0,px=dx-1;lx!==dx&&sx[lx]<ix;)++lx;for(;-1!=px&&sx[px]>nx;)--px;if(++px,0!==lx||px!==dx){lx>=px&&(lx=(px=Math.max(px,1))-1);var cx=this.getValueSize();this.times=ky.arraySlice(sx,lx,px),this.values=ky.arraySlice(this.values,lx*cx,px*cx)}return this},validate:function(){var ix=!0,nx=this.getValueSize();0!=nx-Math.floor(nx)&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),ix=!1);var sx=this.times,dx=this.values,lx=sx.length;0===lx&&(console.error("THREE.KeyframeTrack: Track is empty.",this),ix=!1);for(var px=null,cx=0,mx;cx!==lx;cx++){if(mx=sx[cx],"number"==typeof mx&&isNaN(mx)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,cx,mx),ix=!1;break}if(null!=px&&px>mx){console.error("THREE.KeyframeTrack: Out of order keys.",this,cx,mx,px),ix=!1;break}px=mx}if(void 0!==dx&&ky.isTypedArray(dx)){cx=0;for(var ux=dx.length,gx;cx!==ux;++cx)if(gx=dx[cx],isNaN(gx)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,cx,gx),ix=!1;break}}return ix},optimize:function(){for(var ix=this.times,nx=this.values,sx=this.getValueSize(),dx=this.getInterpolation()===Jf,lx=1,px=ix.length-1,cx=1;cx<px;++cx){var mx=!1,ux=ix[cx];if(ux!==ix[cx+1]&&(1!==cx||ux!==ux[0]))if(dx)mx=!0;else for(var gx=cx*sx,yx=0,xx;yx!==sx;++yx)if(xx=nx[gx+yx],xx!==nx[gx-sx+yx]||xx!==nx[gx+sx+yx]){mx=!0;break}if(mx){if(cx!==lx){ix[lx]=ix[cx];var vx=cx*sx,Lx=lx*sx;for(yx=0;yx!==sx;++yx)nx[Lx+yx]=nx[vx+yx]}++lx}}if(0<px){for(ix[lx]=ix[px],vx=px*sx,Lx=lx*sx,yx=0;yx!==sx;++yx)nx[Lx+yx]=nx[vx+yx];++lx}return lx!==ix.length&&(this.times=ky.arraySlice(ix,0,lx),this.values=ky.arraySlice(nx,0,lx*sx)),this}}),au.prototype=Object.assign(Object.create(tu.prototype),{constructor:au,ValueTypeName:"vector"}),Object.assign(ru,{parse:function(ix){for(var nx=[],sx=ix.tracks,dx=1/(ix.fps||1),lx=0,px=sx.length;lx!==px;++lx)nx.push(tu.parse(sx[lx]).scale(dx));return new ru(ix.name,ix.duration,nx)},toJSON:function(ix){for(var nx=[],sx=ix.tracks,dx={name:ix.name,duration:ix.duration,tracks:nx},lx=0,px=sx.length;lx!==px;++lx)nx.push(tu.toJSON(sx[lx]));return dx},CreateFromMorphTargetSequence:function(ix,nx,sx,dx){for(var lx=nx.length,px=[],cx=0;cx<lx;cx++){var mx=[],ux=[];mx.push((cx+lx-1)%lx,cx,(cx+1)%lx),ux.push(0,1,0);var gx=ky.getKeyframeOrder(mx);mx=ky.sortedArray(mx,1,gx),ux=ky.sortedArray(ux,1,gx),dx||0!==mx[0]||(mx.push(lx),ux.push(ux[0])),px.push(new Km(".morphTargetInfluences["+nx[cx].name+"]",mx,ux).scale(1/sx))}return new ru(ix,-1,px)},findByName:function(ix,nx){var sx=ix;if(!Array.isArray(ix)){var dx=ix;sx=dx.geometry&&dx.geometry.animations||dx.animations}for(var lx=0;lx<sx.length;lx++)if(sx[lx].name===nx)return sx[lx];return null},CreateClipsFromMorphTargetSequences:function(ix,nx,sx){for(var dx={},lx=/^([\w-]*?)([\d]+)$/,px=0,cx=ix.length;px<cx;px++){var mx=ix[px],ux=mx.name.match(lx);if(ux&&1<ux.length){var gx=dx[fx=ux[1]];gx||(dx[fx]=gx=[]),gx.push(mx)}}var hx=[];for(var fx in dx)hx.push(ru.CreateFromMorphTargetSequence(fx,dx[fx],nx,sx));return hx},parseAnimation:function(ix,nx){if(!ix)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;for(var sx=function(Ax,Ex,Sx,Tx,Mx){if(0!==Sx.length){var wx=[],Rx=[];ky.flattenJSON(Sx,wx,Rx,Tx),0!==wx.length&&Mx.push(new Ax(Ex,wx,Rx))}},dx=[],lx=ix.name||"default",px=ix.length||-1,cx=ix.fps||30,mx=ix.hierarchy||[],ux=0,gx;ux<mx.length;ux++)if(gx=mx[ux].keys,gx&&0!==gx.length)if(gx[0].morphTargets){for(var hx={},fx=0;fx<gx.length;fx++)if(gx[fx].morphTargets)for(var yx=0;yx<gx[fx].morphTargets.length;yx++)hx[gx[fx].morphTargets[yx]]=-1;for(var xx in hx){var vx=[],Lx=[];for(yx=0;yx!==gx[fx].morphTargets.length;++yx){var bx=gx[fx];vx.push(bx.time),Lx.push(bx.morphTarget===xx?1:0)}dx.push(new Km(".morphTargetInfluence["+xx+"]",vx,Lx))}px=hx.length*(cx||1)}else{var _x=".bones["+nx[ux].name+"]";sx(au,_x+".position",gx,"pos",dx),sx(Zm,_x+".quaternion",gx,"rot",dx),sx(au,_x+".scale",gx,"scl",dx)}return 0===dx.length?null:new ru(lx,px,dx)}}),Object.assign(ru.prototype,{resetDuration:function(){for(var ix=0,nx=0,sx=this.tracks.length,dx;nx!==sx;++nx)dx=this.tracks[nx],ix=Math.max(ix,dx.times[dx.times.length-1]);this.duration=ix},trim:function(){for(var ix=0;ix<this.tracks.length;ix++)this.tracks[ix].trim(0,this.duration);return this},optimize:function(){for(var ix=0;ix<this.tracks.length;ix++)this.tracks[ix].optimize();return this}}),Object.assign(ou.prototype,{load:function(ix,nx,sx,dx){var lx=this;new cm(lx.manager).load(ix,function(px){nx(lx.parse(JSON.parse(px)))},sx,dx)},setTextures:function(ix){this.textures=ix},parse:function(ix){function nx(px){return void 0===sx[px]&&console.warn("THREE.MaterialLoader: Undefined texture",px),sx[px]}var sx=this.textures,dx=new Fy[ix.type];if(void 0!==ix.uuid&&(dx.uuid=ix.uuid),void 0!==ix.name&&(dx.name=ix.name),void 0!==ix.color&&dx.color.setHex(ix.color),void 0!==ix.roughness&&(dx.roughness=ix.roughness),void 0!==ix.metalness&&(dx.metalness=ix.metalness),void 0!==ix.emissive&&dx.emissive.setHex(ix.emissive),void 0!==ix.specular&&dx.specular.setHex(ix.specular),void 0!==ix.shininess&&(dx.shininess=ix.shininess),void 0!==ix.clearCoat&&(dx.clearCoat=ix.clearCoat),void 0!==ix.clearCoatRoughness&&(dx.clearCoatRoughness=ix.clearCoatRoughness),void 0!==ix.uniforms&&(dx.uniforms=ix.uniforms),void 0!==ix.vertexShader&&(dx.vertexShader=ix.vertexShader),void 0!==ix.fragmentShader&&(dx.fragmentShader=ix.fragmentShader),void 0!==ix.vertexColors&&(dx.vertexColors=ix.vertexColors),void 0!==ix.fog&&(dx.fog=ix.fog),void 0!==ix.flatShading&&(dx.flatShading=ix.flatShading),void 0!==ix.blending&&(dx.blending=ix.blending),void 0!==ix.side&&(dx.side=ix.side),void 0!==ix.opacity&&(dx.opacity=ix.opacity),void 0!==ix.transparent&&(dx.transparent=ix.transparent),void 0!==ix.alphaTest&&(dx.alphaTest=ix.alphaTest),void 0!==ix.depthTest&&(dx.depthTest=ix.depthTest),void 0!==ix.depthWrite&&(dx.depthWrite=ix.depthWrite),void 0!==ix.colorWrite&&(dx.colorWrite=ix.colorWrite),void 0!==ix.wireframe&&(dx.wireframe=ix.wireframe),void 0!==ix.wireframeLinewidth&&(dx.wireframeLinewidth=ix.wireframeLinewidth),void 0!==ix.wireframeLinecap&&(dx.wireframeLinecap=ix.wireframeLinecap),void 0!==ix.wireframeLinejoin&&(dx.wireframeLinejoin=ix.wireframeLinejoin),void 0!==ix.rotation&&(dx.rotation=ix.rotation),1!==ix.linewidth&&(dx.linewidth=ix.linewidth),void 0!==ix.dashSize&&(dx.dashSize=ix.dashSize),void 0!==ix.gapSize&&(dx.gapSize=ix.gapSize),void 0!==ix.scale&&(dx.scale=ix.scale),void 0!==ix.skinning&&(dx.skinning=ix.skinning),void 0!==ix.morphTargets&&(dx.morphTargets=ix.morphTargets),void 0!==ix.dithering&&(dx.dithering=ix.dithering),void 0!==ix.visible&&(dx.visible=ix.visible),void 0!==ix.userData&&(dx.userData=ix.userData),void 0!==ix.shading&&(dx.flatShading=1===ix.shading),void 0!==ix.size&&(dx.size=ix.size),void 0!==ix.sizeAttenuation&&(dx.sizeAttenuation=ix.sizeAttenuation),void 0!==ix.map&&(dx.map=nx(ix.map)),void 0!==ix.alphaMap&&(dx.alphaMap=nx(ix.alphaMap),dx.transparent=!0),void 0!==ix.bumpMap&&(dx.bumpMap=nx(ix.bumpMap)),void 0!==ix.bumpScale&&(dx.bumpScale=ix.bumpScale),void 0!==ix.normalMap&&(dx.normalMap=nx(ix.normalMap)),void 0!==ix.normalScale){var lx=ix.normalScale;!1===Array.isArray(lx)&&(lx=[lx,lx]),dx.normalScale=new od().fromArray(lx)}return void 0!==ix.displacementMap&&(dx.displacementMap=nx(ix.displacementMap)),void 0!==ix.displacementScale&&(dx.displacementScale=ix.displacementScale),void 0!==ix.displacementBias&&(dx.displacementBias=ix.displacementBias),void 0!==ix.roughnessMap&&(dx.roughnessMap=nx(ix.roughnessMap)),void 0!==ix.metalnessMap&&(dx.metalnessMap=nx(ix.metalnessMap)),void 0!==ix.emissiveMap&&(dx.emissiveMap=nx(ix.emissiveMap)),void 0!==ix.emissiveIntensity&&(dx.emissiveIntensity=ix.emissiveIntensity),void 0!==ix.specularMap&&(dx.specularMap=nx(ix.specularMap)),void 0!==ix.envMap&&(dx.envMap=nx(ix.envMap)),void 0!==ix.reflectivity&&(dx.reflectivity=ix.reflectivity),void 0!==ix.lightMap&&(dx.lightMap=nx(ix.lightMap)),void 0!==ix.lightMapIntensity&&(dx.lightMapIntensity=ix.lightMapIntensity),void 0!==ix.aoMap&&(dx.aoMap=nx(ix.aoMap)),void 0!==ix.aoMapIntensity&&(dx.aoMapIntensity=ix.aoMapIntensity),void 0!==ix.gradientMap&&(dx.gradientMap=nx(ix.gradientMap)),dx}}),Object.assign(iu.prototype,{load:function(ix,nx,sx,dx){var lx=this;new cm(lx.manager).load(ix,function(px){nx(lx.parse(JSON.parse(px)))},sx,dx)},parse:function(ix){var nx=new _l,sx=ix.data.index;if(void 0!==sx){var dx=new jy[sx.type](sx.array);nx.setIndex(new pl(dx,1))}var lx=ix.data.attributes;for(var px in lx){var cx=lx[px];dx=new jy[cx.type](cx.array),nx.addAttribute(px,new pl(dx,cx.itemSize,cx.normalized))}var mx=ix.data.groups||ix.data.drawcalls||ix.data.offsets;if(void 0!==mx)for(var ux=0,gx=mx.length,hx;ux!==gx;++ux)hx=mx[ux],nx.addGroup(hx.start,hx.count,hx.materialIndex);var fx=ix.data.boundingSphere;if(void 0!==fx){var yx=new sd;void 0!==fx.center&&yx.fromArray(fx.center),nx.boundingSphere=new $d(yx,fx.radius)}return nx}});var jy={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:"undefined"==typeof Uint8ClampedArray?Uint8Array:Uint8ClampedArray,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};nu.Handlers={handlers:[],add:function(ix,nx){this.handlers.push(ix,nx)},get:function(ix){for(var nx=this.handlers,sx=0,dx=nx.length;sx<dx;sx+=2){var lx=nx[sx],px=nx[sx+1];if(lx.test(ix))return px}return null}},Object.assign(nu.prototype,{crossOrigin:void 0,initMaterials:function(ix,nx,sx){for(var dx=[],lx=0;lx<ix.length;++lx)dx[lx]=this.createMaterial(ix[lx],nx,sx);return dx},createMaterial:function(){var ix={NoBlending:eh,NormalBlending:th,AdditiveBlending:ah,SubtractiveBlending:rh,MultiplyBlending:oh,CustomBlending:ih},nx=new Xd,sx=new fm,dx=new ou;return function(lx,px,cx){function mx(yx,xx,vx,Lx,bx){var Ax=px+yx,Ex=nu.Handlers.get(Ax),_x;null===Ex?(sx.setCrossOrigin(cx),_x=sx.load(Ax)):_x=Ex.load(Ax),void 0!==xx&&(_x.repeat.fromArray(xx),1!==xx[0]&&(_x.wrapS=Yh),1!==xx[1]&&(_x.wrapT=Yh)),void 0!==vx&&_x.offset.fromArray(vx),void 0!==Lx&&("repeat"===Lx[0]&&(_x.wrapS=Yh),"mirror"===Lx[0]&&(_x.wrapS=qh),"repeat"===Lx[1]&&(_x.wrapT=Yh),"mirror"===Lx[1]&&(_x.wrapT=qh)),void 0!==bx&&(_x.anisotropy=bx);var Sx=uy.generateUUID();return ux[Sx]=_x,Sx}var ux={},gx={uuid:uy.generateUUID(),type:"MeshLambertMaterial"};for(var hx in lx){var fx=lx[hx];switch(hx){case"DbgColor":case"DbgIndex":case"opticalDensity":case"illumination":break;case"DbgName":gx.name=fx;break;case"blending":gx.blending=ix[fx];break;case"colorAmbient":case"mapAmbient":console.warn("THREE.Loader.createMaterial:",hx,"is no longer supported.");break;case"colorDiffuse":gx.color=nx.fromArray(fx).getHex();break;case"colorSpecular":gx.specular=nx.fromArray(fx).getHex();break;case"colorEmissive":gx.emissive=nx.fromArray(fx).getHex();break;case"specularCoef":gx.shininess=fx;break;case"shading":"basic"===fx.toLowerCase()&&(gx.type="MeshBasicMaterial"),"phong"===fx.toLowerCase()&&(gx.type="MeshPhongMaterial"),"standard"===fx.toLowerCase()&&(gx.type="MeshStandardMaterial");break;case"mapDiffuse":gx.map=mx(fx,lx.mapDiffuseRepeat,lx.mapDiffuseOffset,lx.mapDiffuseWrap,lx.mapDiffuseAnisotropy);break;case"mapDiffuseRepeat":case"mapDiffuseOffset":case"mapDiffuseWrap":case"mapDiffuseAnisotropy":break;case"mapEmissive":gx.emissiveMap=mx(fx,lx.mapEmissiveRepeat,lx.mapEmissiveOffset,lx.mapEmissiveWrap,lx.mapEmissiveAnisotropy);break;case"mapEmissiveRepeat":case"mapEmissiveOffset":case"mapEmissiveWrap":case"mapEmissiveAnisotropy":break;case"mapLight":gx.lightMap=mx(fx,lx.mapLightRepeat,lx.mapLightOffset,lx.mapLightWrap,lx.mapLightAnisotropy);break;case"mapLightRepeat":case"mapLightOffset":case"mapLightWrap":case"mapLightAnisotropy":break;case"mapAO":gx.aoMap=mx(fx,lx.mapAORepeat,lx.mapAOOffset,lx.mapAOWrap,lx.mapAOAnisotropy);break;case"mapAORepeat":case"mapAOOffset":case"mapAOWrap":case"mapAOAnisotropy":break;case"mapBump":gx.bumpMap=mx(fx,lx.mapBumpRepeat,lx.mapBumpOffset,lx.mapBumpWrap,lx.mapBumpAnisotropy);break;case"mapBumpScale":gx.bumpScale=fx;break;case"mapBumpRepeat":case"mapBumpOffset":case"mapBumpWrap":case"mapBumpAnisotropy":break;case"mapNormal":gx.normalMap=mx(fx,lx.mapNormalRepeat,lx.mapNormalOffset,lx.mapNormalWrap,lx.mapNormalAnisotropy);break;case"mapNormalFactor":gx.normalScale=[fx,fx];break;case"mapNormalRepeat":case"mapNormalOffset":case"mapNormalWrap":case"mapNormalAnisotropy":break;case"mapSpecular":gx.specularMap=mx(fx,lx.mapSpecularRepeat,lx.mapSpecularOffset,lx.mapSpecularWrap,lx.mapSpecularAnisotropy);break;case"mapSpecularRepeat":case"mapSpecularOffset":case"mapSpecularWrap":case"mapSpecularAnisotropy":break;case"mapMetalness":gx.metalnessMap=mx(fx,lx.mapMetalnessRepeat,lx.mapMetalnessOffset,lx.mapMetalnessWrap,lx.mapMetalnessAnisotropy);break;case"mapMetalnessRepeat":case"mapMetalnessOffset":case"mapMetalnessWrap":case"mapMetalnessAnisotropy":break;case"mapRoughness":gx.roughnessMap=mx(fx,lx.mapRoughnessRepeat,lx.mapRoughnessOffset,lx.mapRoughnessWrap,lx.mapRoughnessAnisotropy);break;case"mapRoughnessRepeat":case"mapRoughnessOffset":case"mapRoughnessWrap":case"mapRoughnessAnisotropy":break;case"mapAlpha":gx.alphaMap=mx(fx,lx.mapAlphaRepeat,lx.mapAlphaOffset,lx.mapAlphaWrap,lx.mapAlphaAnisotropy);break;case"mapAlphaRepeat":case"mapAlphaOffset":case"mapAlphaWrap":case"mapAlphaAnisotropy":break;case"flipSided":gx.side=Xg;break;case"doubleSided":gx.side=qg;break;case"transparency":console.warn("THREE.Loader.createMaterial: transparency has been renamed to opacity"),gx.opacity=fx;break;case"depthTest":case"depthWrite":case"colorWrite":case"opacity":case"reflectivity":case"transparent":case"visible":case"wireframe":gx[hx]=fx;break;case"vertexColors":!0===fx&&(gx.vertexColors=$g),"face"===fx&&(gx.vertexColors=Qg);break;default:console.error("THREE.Loader.createMaterial: Unsupported",hx,fx);}}return"MeshBasicMaterial"===gx.type&&delete gx.emissive,"MeshPhongMaterial"!==gx.type&&delete gx.specular,1>gx.opacity&&(gx.transparent=!0),dx.setTextures(ux),dx.parse(gx)}}()});var Yy={decodeText:function(ix){if("undefined"!=typeof TextDecoder)return new TextDecoder().decode(ix);for(var nx="",sx=0,dx=ix.length;sx<dx;sx++)nx+=String.fromCharCode(ix[sx]);return decodeURIComponent(escape(nx))},extractUrlBase:function(ix){var nx=ix.split("/");return 1===nx.length?"./":(nx.pop(),nx.join("/")+"/")}};Object.assign(su.prototype,{load:function(ix,nx,sx,dx){var lx=this,px=this.texturePath&&"string"==typeof this.texturePath?this.texturePath:Yy.extractUrlBase(ix),cx=new cm(this.manager);cx.setWithCredentials(this.withCredentials),cx.load(ix,function(mx){var ux=JSON.parse(mx),gx=ux.metadata;if(void 0!==gx){var hx=gx.type;if(void 0!==hx){if("object"===hx.toLowerCase())return void console.error("THREE.JSONLoader: "+ix+" should be loaded with THREE.ObjectLoader instead.");if("scene"===hx.toLowerCase())return void console.error("THREE.JSONLoader: "+ix+" should be loaded with THREE.SceneLoader instead.")}}var fx=lx.parse(ux,px);nx(fx.geometry,fx.materials)},sx,dx)},setTexturePath:function(ix){this.texturePath=ix},parse:function(ix,nx){void 0!==ix.data&&(ix=ix.data),ix.scale=void 0===ix.scale?1:1/ix.scale;var sx=new ll;return function(dx,lx){function px(Gx,Vx){return Gx&1<<Vx}var Bx=dx.faces,Ux=dx.vertices,Nx=dx.normals,Wx=dx.colors,zx=dx.scale,Hx=0,cx,mx,ux,gx,hx,fx,yx,xx,vx,Lx,bx,_x,Ax,Ex,Sx,Tx,Mx,wx,Rx,Px,Cx,Ox,Ix,Dx,Fx;if(void 0!==dx.uvs){for(cx=0;cx<dx.uvs.length;cx++)dx.uvs[cx].length&&Hx++;for(cx=0;cx<Hx;cx++)lx.faceVertexUvs[cx]=[]}for(gx=0,hx=Ux.length;gx<hx;)(wx=new sd).x=Ux[gx++]*zx,wx.y=Ux[gx++]*zx,wx.z=Ux[gx++]*zx,lx.vertices.push(wx);for(gx=0,hx=Bx.length;gx<hx;)if(bx=px(Lx=Bx[gx++],0),_x=px(Lx,1),Ax=px(Lx,3),Ex=px(Lx,4),Sx=px(Lx,5),Tx=px(Lx,6),Mx=px(Lx,7),bx){if((Px=new dl).a=Bx[gx],Px.b=Bx[gx+1],Px.c=Bx[gx+3],(Cx=new dl).a=Bx[gx+1],Cx.b=Bx[gx+2],Cx.c=Bx[gx+3],gx+=4,_x&&(vx=Bx[gx++],Px.materialIndex=vx,Cx.materialIndex=vx),ux=lx.faces.length,Ax)for(cx=0;cx<Hx;cx++)for(Dx=dx.uvs[cx],lx.faceVertexUvs[cx][ux]=[],lx.faceVertexUvs[cx][ux+1]=[],mx=0;4>mx;mx++)Fx=new od(Dx[2*(xx=Bx[gx++])],Dx[2*xx+1]),2!==mx&&lx.faceVertexUvs[cx][ux].push(Fx),0!==mx&&lx.faceVertexUvs[cx][ux+1].push(Fx);if(Ex&&(yx=3*Bx[gx++],Px.normal.set(Nx[yx++],Nx[yx++],Nx[yx]),Cx.normal.copy(Px.normal)),Sx)for(cx=0;4>cx;cx++)yx=3*Bx[gx++],Ix=new sd(Nx[yx++],Nx[yx++],Nx[yx]),2!==cx&&Px.vertexNormals.push(Ix),0!==cx&&Cx.vertexNormals.push(Ix);if(Tx&&(Ox=Wx[fx=Bx[gx++]],Px.color.setHex(Ox),Cx.color.setHex(Ox)),Mx)for(cx=0;4>cx;cx++)Ox=Wx[fx=Bx[gx++]],2!==cx&&Px.vertexColors.push(new Xd(Ox)),0!==cx&&Cx.vertexColors.push(new Xd(Ox));lx.faces.push(Px),lx.faces.push(Cx)}else{if((Rx=new dl).a=Bx[gx++],Rx.b=Bx[gx++],Rx.c=Bx[gx++],_x&&(vx=Bx[gx++],Rx.materialIndex=vx),ux=lx.faces.length,Ax)for(cx=0;cx<Hx;cx++)for(Dx=dx.uvs[cx],lx.faceVertexUvs[cx][ux]=[],mx=0;3>mx;mx++)Fx=new od(Dx[2*(xx=Bx[gx++])],Dx[2*xx+1]),lx.faceVertexUvs[cx][ux].push(Fx);if(Ex&&(yx=3*Bx[gx++],Rx.normal.set(Nx[yx++],Nx[yx++],Nx[yx])),Sx)for(cx=0;3>cx;cx++)yx=3*Bx[gx++],Ix=new sd(Nx[yx++],Nx[yx++],Nx[yx]),Rx.vertexNormals.push(Ix);if(Tx&&(fx=Bx[gx++],Rx.color.setHex(Wx[fx])),Mx)for(cx=0;3>cx;cx++)fx=Bx[gx++],Rx.vertexColors.push(new Xd(Wx[fx]));lx.faces.push(Rx)}}(ix,sx),function(dx,lx){var px=void 0===dx.influencesPerVertex?2:dx.influencesPerVertex;if(dx.skinWeights)for(var cx=0,mx=dx.skinWeights.length;cx<mx;cx+=px){var ux=dx.skinWeights[cx],gx=1<px?dx.skinWeights[cx+1]:0,hx=2<px?dx.skinWeights[cx+2]:0,fx=3<px?dx.skinWeights[cx+3]:0;lx.skinWeights.push(new pd(ux,gx,hx,fx))}if(dx.skinIndices)for(cx=0,mx=dx.skinIndices.length;cx<mx;cx+=px){var yx=dx.skinIndices[cx],xx=1<px?dx.skinIndices[cx+1]:0,vx=2<px?dx.skinIndices[cx+2]:0,Lx=3<px?dx.skinIndices[cx+3]:0;lx.skinIndices.push(new pd(yx,xx,vx,Lx))}lx.bones=dx.bones,lx.bones&&0<lx.bones.length&&(lx.skinWeights.length!==lx.skinIndices.length||lx.skinIndices.length!==lx.vertices.length)&&console.warn("When skinning, number of vertices ("+lx.vertices.length+"), skinIndices ("+lx.skinIndices.length+"), and skinWeights ("+lx.skinWeights.length+") should match.")}(ix,sx),function(dx,lx){var px=dx.scale;if(void 0!==dx.morphTargets)for(var cx=0,mx=dx.morphTargets.length;cx<mx;cx++){lx.morphTargets[cx]={},lx.morphTargets[cx].name=dx.morphTargets[cx].name,lx.morphTargets[cx].vertices=[];for(var ux=lx.morphTargets[cx].vertices,gx=dx.morphTargets[cx].vertices,hx=0,fx=gx.length,yx;hx<fx;hx+=3)yx=new sd,yx.x=gx[hx]*px,yx.y=gx[hx+1]*px,yx.z=gx[hx+2]*px,ux.push(yx)}if(void 0!==dx.morphColors&&0<dx.morphColors.length){console.warn("THREE.JSONLoader: \"morphColors\" no longer supported. Using them as face colors.");var xx=lx.faces,vx=dx.morphColors[0].colors;for(cx=0,mx=xx.length;cx<mx;cx++)xx[cx].color.fromArray(vx,3*cx)}}(ix,sx),function(dx,lx){var px=[],cx=[];void 0!==dx.animation&&cx.push(dx.animation),void 0!==dx.animations&&(dx.animations.length?cx=cx.concat(dx.animations):cx.push(dx.animations));for(var mx=0,ux;mx<cx.length;mx++)ux=ru.parseAnimation(cx[mx],lx.bones),ux&&px.push(ux);if(lx.morphTargets){var gx=ru.CreateClipsFromMorphTargetSequences(lx.morphTargets,10);px=px.concat(gx)}0<px.length&&(lx.animations=px)}(ix,sx),sx.computeFaceNormals(),sx.computeBoundingSphere(),void 0===ix.materials||0===ix.materials.length?{geometry:sx}:{geometry:sx,materials:nu.prototype.initMaterials(ix.materials,nx,this.crossOrigin)}}}),Object.assign(du.prototype,{load:function(ix,nx,sx,dx){""===this.texturePath&&(this.texturePath=ix.substring(0,ix.lastIndexOf("/")+1));var lx=this;new cm(lx.manager).load(ix,function(px){var cx=null;try{cx=JSON.parse(px)}catch(ux){return void 0!==dx&&dx(ux),void console.error("THREE:ObjectLoader: Can't parse "+ix+".",ux.message)}var mx=cx.metadata;void 0!==mx&&void 0!==mx.type&&"geometry"!==mx.type.toLowerCase()?lx.parse(cx,nx):console.error("THREE.ObjectLoader: Can't load "+ix+". Use THREE.JSONLoader instead.")},sx,dx)},setTexturePath:function(ix){this.texturePath=ix},setCrossOrigin:function(ix){this.crossOrigin=ix},parse:function(ix,nx){var sx=this.parseShape(ix.shapes),dx=this.parseGeometries(ix.geometries,sx),lx=this.parseImages(ix.images,function(){void 0!==nx&&nx(mx)}),px=this.parseTextures(ix.textures,lx),cx=this.parseMaterials(ix.materials,px),mx=this.parseObject(ix.object,dx,cx);return ix.animations&&(mx.animations=this.parseAnimations(ix.animations)),void 0!==ix.images&&0!==ix.images.length||void 0!==nx&&nx(mx),mx},parseShape:function(ix){var nx={};if(void 0!==ix)for(var sx=0,dx=ix.length,lx;sx<dx;sx++)lx=new Dm().fromJSON(ix[sx]),nx[lx.uuid]=lx;return nx},parseGeometries:function(ix,nx){var sx={};if(void 0!==ix)for(var dx=new su,lx=new iu,px=0,cx=ix.length;px<cx;px++){var ux=ix[px],mx;switch(ux.type){case"PlaneGeometry":case"PlaneBufferGeometry":mx=new Dy[ux.type](ux.width,ux.height,ux.widthSegments,ux.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":mx=new Dy[ux.type](ux.width,ux.height,ux.depth,ux.widthSegments,ux.heightSegments,ux.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":mx=new Dy[ux.type](ux.radius,ux.segments,ux.thetaStart,ux.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":mx=new Dy[ux.type](ux.radiusTop,ux.radiusBottom,ux.height,ux.radialSegments,ux.heightSegments,ux.openEnded,ux.thetaStart,ux.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":mx=new Dy[ux.type](ux.radius,ux.height,ux.radialSegments,ux.heightSegments,ux.openEnded,ux.thetaStart,ux.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":mx=new Dy[ux.type](ux.radius,ux.widthSegments,ux.heightSegments,ux.phiStart,ux.phiLength,ux.thetaStart,ux.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":mx=new Dy[ux.type](ux.radius,ux.detail);break;case"RingGeometry":case"RingBufferGeometry":mx=new Dy[ux.type](ux.innerRadius,ux.outerRadius,ux.thetaSegments,ux.phiSegments,ux.thetaStart,ux.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":mx=new Dy[ux.type](ux.radius,ux.tube,ux.radialSegments,ux.tubularSegments,ux.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":mx=new Dy[ux.type](ux.radius,ux.tube,ux.tubularSegments,ux.radialSegments,ux.p,ux.q);break;case"LatheGeometry":case"LatheBufferGeometry":mx=new Dy[ux.type](ux.points,ux.segments,ux.phiStart,ux.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":mx=new Dy[ux.type](ux.vertices,ux.indices,ux.radius,ux.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":var gx=[];for(px=0,cx=ux.shapes.length;px<cx;px++){var hx=nx[ux.shapes[px]];gx.push(hx)}mx=new Dy[ux.type](gx,ux.curveSegments);break;case"BufferGeometry":mx=lx.parse(ux);break;case"Geometry":mx=dx.parse(ux,this.texturePath).geometry;break;default:console.warn("THREE.ObjectLoader: Unsupported geometry type \""+ux.type+"\"");continue;}mx.uuid=ux.uuid,void 0!==ux.name&&(mx.name=ux.name),sx[ux.uuid]=mx}return sx},parseMaterials:function(ix,nx){var sx={};if(void 0!==ix){var dx=new ou;dx.setTextures(nx);for(var lx=0,px=ix.length,cx;lx<px;lx++)if(cx=ix[lx],"MultiMaterial"===cx.type){for(var mx=[],ux=0;ux<cx.materials.length;ux++)mx.push(dx.parse(cx.materials[ux]));sx[cx.uuid]=mx}else sx[cx.uuid]=dx.parse(cx)}return sx},parseAnimations:function(ix){for(var nx=[],sx=0,dx;sx<ix.length;sx++)dx=ru.parse(ix[sx]),nx.push(dx);return nx},parseImages:function(ix,nx){function sx(hx){return dx.manager.itemStart(hx),px.load(hx,function(){dx.manager.itemEnd(hx)},void 0,function(){dx.manager.itemEnd(hx),dx.manager.itemError(hx)})}var dx=this,lx={};if(void 0!==ix&&0<ix.length){var px=new gm(new pm(nx));px.setCrossOrigin(this.crossOrigin);for(var cx=0,mx=ix.length;cx<mx;cx++){var ux=ix[cx],gx=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(ux.url)?ux.url:dx.texturePath+ux.url;lx[ux.uuid]=sx(gx)}}return lx},parseTextures:function(ix,nx){function sx(ux,gx){return"number"==typeof ux?ux:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",ux),gx[ux])}var dx={};if(void 0!==ix)for(var lx=0,px=ix.length,cx;lx<px;lx++){cx=ix[lx],void 0===cx.image&&console.warn("THREE.ObjectLoader: No \"image\" specified for",cx.uuid),void 0===nx[cx.image]&&console.warn("THREE.ObjectLoader: Undefined image",cx.image);var mx=new ld(nx[cx.image]);mx.needsUpdate=!0,mx.uuid=cx.uuid,void 0!==cx.name&&(mx.name=cx.name),void 0!==cx.mapping&&(mx.mapping=sx(cx.mapping,qy)),void 0!==cx.offset&&mx.offset.fromArray(cx.offset),void 0!==cx.repeat&&mx.repeat.fromArray(cx.repeat),void 0!==cx.center&&mx.center.fromArray(cx.center),void 0!==cx.rotation&&(mx.rotation=cx.rotation),void 0!==cx.wrap&&(mx.wrapS=sx(cx.wrap[0],Zy),mx.wrapT=sx(cx.wrap[1],Zy)),void 0!==cx.minFilter&&(mx.minFilter=sx(cx.minFilter,Jy)),void 0!==cx.magFilter&&(mx.magFilter=sx(cx.magFilter,Jy)),void 0!==cx.anisotropy&&(mx.anisotropy=cx.anisotropy),void 0!==cx.flipY&&(mx.flipY=cx.flipY),dx[cx.uuid]=mx}return dx},parseObject:function(ix,nx,sx){function dx(vx){return void 0===nx[vx]&&console.warn("THREE.ObjectLoader: Undefined geometry",vx),nx[vx]}function lx(vx){if(void 0!==vx){if(Array.isArray(vx)){for(var Lx=[],bx=0,_x=vx.length,Ax;bx<_x;bx++)Ax=vx[bx],void 0===sx[Ax]&&console.warn("THREE.ObjectLoader: Undefined material",Ax),Lx.push(sx[Ax]);return Lx}return void 0===sx[vx]&&console.warn("THREE.ObjectLoader: Undefined material",vx),sx[vx]}}var px;switch(ix.type){case"Scene":px=new ep,void 0!==ix.background&&Number.isInteger(ix.background)&&(px.background=new Xd(ix.background)),void 0!==ix.fog&&("Fog"===ix.fog.type?px.fog=new $l(ix.fog.color,ix.fog.near,ix.fog.far):"FogExp2"===ix.fog.type&&(px.fog=new Ql(ix.fog.color,ix.fog.density)));break;case"PerspectiveCamera":px=new Yl(ix.fov,ix.aspect,ix.near,ix.far),void 0!==ix.focus&&(px.focus=ix.focus),void 0!==ix.zoom&&(px.zoom=ix.zoom),void 0!==ix.filmGauge&&(px.filmGauge=ix.filmGauge),void 0!==ix.filmOffset&&(px.filmOffset=ix.filmOffset),void 0!==ix.view&&(px.view=Object.assign({},ix.view));break;case"OrthographicCamera":px=new sl(ix.left,ix.right,ix.top,ix.bottom,ix.near,ix.far);break;case"AmbientLight":px=new Vm(ix.color,ix.intensity);break;case"DirectionalLight":px=new Gm(ix.color,ix.intensity);break;case"PointLight":px=new zm(ix.color,ix.intensity,ix.distance,ix.decay);break;case"RectAreaLight":px=new km(ix.color,ix.intensity,ix.width,ix.height);break;case"SpotLight":px=new Wm(ix.color,ix.intensity,ix.distance,ix.angle,ix.penumbra,ix.decay);break;case"HemisphereLight":px=new Bm(ix.color,ix.groundColor,ix.intensity);break;case"SkinnedMesh":console.warn("THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.");case"Mesh":var cx=dx(ix.geometry),mx=lx(ix.material);px=cx.bones&&0<cx.bones.length?new np(cx,mx):new Ol(cx,mx);break;case"LOD":px=new rp;break;case"Line":px=new dp(dx(ix.geometry),lx(ix.material),ix.mode);break;case"LineLoop":px=new pp(dx(ix.geometry),lx(ix.material));break;case"LineSegments":px=new lp(dx(ix.geometry),lx(ix.material));break;case"PointCloud":case"Points":px=new mp(dx(ix.geometry),lx(ix.material));break;case"Sprite":px=new ap(lx(ix.material));break;case"Group":px=new up;break;default:px=new il;}if(px.uuid=ix.uuid,void 0!==ix.name&&(px.name=ix.name),void 0===ix.matrix?(void 0!==ix.position&&px.position.fromArray(ix.position),void 0!==ix.rotation&&px.rotation.fromArray(ix.rotation),void 0!==ix.quaternion&&px.quaternion.fromArray(ix.quaternion),void 0!==ix.scale&&px.scale.fromArray(ix.scale)):(px.matrix.fromArray(ix.matrix),px.matrix.decompose(px.position,px.quaternion,px.scale)),void 0!==ix.castShadow&&(px.castShadow=ix.castShadow),void 0!==ix.receiveShadow&&(px.receiveShadow=ix.receiveShadow),ix.shadow&&(void 0!==ix.shadow.bias&&(px.shadow.bias=ix.shadow.bias),void 0!==ix.shadow.radius&&(px.shadow.radius=ix.shadow.radius),void 0!==ix.shadow.mapSize&&px.shadow.mapSize.fromArray(ix.shadow.mapSize),void 0!==ix.shadow.camera&&(px.shadow.camera=this.parseObject(ix.shadow.camera))),void 0!==ix.visible&&(px.visible=ix.visible),void 0!==ix.userData&&(px.userData=ix.userData),void 0!==ix.children)for(var ux=ix.children,gx=0;gx<ux.length;gx++)px.add(this.parseObject(ux[gx],nx,sx));if("LOD"===ix.type)for(var hx=ix.levels,fx=0;fx<hx.length;fx++){var yx=hx[fx],xx=px.getObjectByProperty("uuid",yx.object);void 0!==xx&&px.addLevel(xx,yx.distance)}return px}});var qy={UVMapping:Nh,CubeReflectionMapping:Wh,CubeRefractionMapping:zh,EquirectangularReflectionMapping:Hh,EquirectangularRefractionMapping:Gh,SphericalReflectionMapping:Vh,CubeUVReflectionMapping:kh,CubeUVRefractionMapping:jh},Zy={RepeatWrapping:Yh,ClampToEdgeWrapping:Xh,MirroredRepeatWrapping:qh},Jy={NearestFilter:Zh,NearestMipMapNearestFilter:Jh,NearestMipMapLinearFilter:Kh,LinearFilter:Qh,LinearMipMapNearestFilter:$h,LinearMipMapLinearFilter:ef},Xy;lu.prototype={constructor:lu,setOptions:function(ix){return this.options=ix,this},load:function(ix,nx,sx,dx){void 0===ix&&(ix=""),void 0!==this.path&&(ix=this.path+ix);var lx=this,px=By.get(ix);return void 0===px?void fetch(ix).then(function(cx){return cx.blob()}).then(function(cx){return createImageBitmap(cx,lx.options)}).then(function(cx){By.add(ix,cx),nx&&nx(cx),lx.manager.itemEnd(ix)}).catch(function(cx){dx&&dx(cx),lx.manager.itemEnd(ix),lx.manager.itemError(ix)}):(lx.manager.itemStart(ix),setTimeout(function(){nx&&nx(px),lx.manager.itemEnd(ix)},0),px)},setCrossOrigin:function(){return this},setPath:function(ix){return this.path=ix,this}},Object.assign(pu.prototype,{moveTo:function(ix,nx){this.currentPath=new Im,this.subPaths.push(this.currentPath),this.currentPath.moveTo(ix,nx)},lineTo:function(ix,nx){this.currentPath.lineTo(ix,nx)},quadraticCurveTo:function(ix,nx,sx,dx){this.currentPath.quadraticCurveTo(ix,nx,sx,dx)},bezierCurveTo:function(ix,nx,sx,dx,lx,px){this.currentPath.bezierCurveTo(ix,nx,sx,dx,lx,px)},splineThru:function(ix){this.currentPath.splineThru(ix)},toShapes:function(ix,nx){function sx(Bx){for(var Ux=[],Nx=0,Wx=Bx.length;Nx<Wx;Nx++){var zx=Bx[Nx],Hx=new Dm;Hx.curves=zx.curves,Ux.push(Hx)}return Ux}function dx(Bx,Ux){for(var Nx=Ux.length,Wx=!1,zx=Nx-1,Hx=0;Hx<Nx;zx=Hx++){var Gx=Ux[zx],Vx=Ux[Hx],kx=Vx.x-Gx.x,jx=Vx.y-Gx.y;if(Math.abs(jx)>Number.EPSILON){if(0>jx&&(Gx=Ux[Hx],kx=-kx,Vx=Ux[zx],jx=-jx),Bx.y<Gx.y||Bx.y>Vx.y)continue;if(Bx.y!==Gx.y){var Yx=jx*(Bx.x-Gx.x)-kx*(Bx.y-Gx.y);if(0==Yx)return!0;if(0>Yx)continue;Wx=!Wx}else if(Bx.x===Gx.x)return!0}else{if(Bx.y!==Gx.y)continue;if(Vx.x<=Bx.x&&Bx.x<=Gx.x||Gx.x<=Bx.x&&Bx.x<=Vx.x)return!0}}return Wx}var lx=Iy.isClockWise,px=this.subPaths;if(0===px.length)return[];if(!0===nx)return sx(px);var gx=[],cx,mx,ux;if(1===px.length)return mx=px[0],(ux=new Dm).curves=mx.curves,gx.push(ux),gx;var hx=!lx(px[0].getPoints());hx=ix?!hx:hx;var xx=[],vx=[],Lx=[],bx=0,fx,yx;vx[bx]=void 0,Lx[bx]=[];for(var _x=0,Ax=px.length;_x<Ax;_x++)cx=lx(fx=(mx=px[_x]).getPoints()),(cx=ix?!cx:cx)?(!hx&&vx[bx]&&bx++,vx[bx]={s:new Dm,p:fx},vx[bx].s.curves=mx.curves,hx&&bx++,Lx[bx]=[]):Lx[bx].push({h:mx,p:fx[0]});if(!vx[0])return sx(px);if(1<vx.length){for(var Ex=!1,Sx=[],Tx=0,Mx=vx.length;Tx<Mx;Tx++)xx[Tx]=[];for(Tx=0,Mx=vx.length;Tx<Mx;Tx++)for(var wx=Lx[Tx],Rx=0;Rx<wx.length;Rx++){for(var Px=wx[Rx],Cx=!0,Ox=0;Ox<vx.length;Ox++)dx(Px.p,vx[Ox].p)&&(Tx!==Ox&&Sx.push({froms:Tx,tos:Ox,hole:Rx}),Cx?(Cx=!1,xx[Ox].push(Px)):Ex=!0);Cx&&xx[Tx].push(Px)}0<Sx.length&&(Ex||(Lx=xx))}_x=0;for(var Ix=vx.length;_x<Ix;_x++){ux=vx[_x].s,gx.push(ux);for(var Dx=0,Fx=(yx=Lx[_x]).length;Dx<Fx;Dx++)ux.holes.push(yx[Dx].h)}return gx}}),Object.assign(cu.prototype,{isFont:!0,generateShapes:function(ix,nx,sx){void 0===nx&&(nx=100),void 0===sx&&(sx=4);for(var dx=[],lx=function(mx,ux,gx,hx){for(var fx=(mx+"").split(""),yx=ux/hx.resolution,xx=(hx.boundingBox.yMax-hx.boundingBox.yMin+hx.underlineThickness)*yx,vx=[],Lx=0,bx=0,_x=0,Ax;_x<fx.length;_x++)if(Ax=fx[_x],"\n"===Ax)Lx=0,bx-=xx;else{var Ex=mu(Ax,0,yx,Lx,bx,hx);Lx+=Ex.offsetX,vx.push(Ex.path)}return vx}(ix,nx,0,this.data),px=0,cx=lx.length;px<cx;px++)Array.prototype.push.apply(dx,lx[px].toShapes());return dx}}),Object.assign(uu.prototype,{load:function(ix,nx,sx,dx){var lx=this,px=new cm(this.manager);px.setPath(this.path),px.load(ix,function(cx){var mx;try{mx=JSON.parse(cx)}catch(gx){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),mx=JSON.parse(cx.substring(65,cx.length-2))}var ux=lx.parse(mx);nx&&nx(ux)},sx,dx)},parse:function(ix){return new cu(ix)},setPath:function(ix){return this.path=ix,this}});var $y={getContext:function(){return void 0==Xy&&(Xy=new(window.AudioContext||window.webkitAudioContext)),Xy},setContext:function(ix){Xy=ix}},Ky,Qy;Object.assign(gu.prototype,{load:function(ix,nx,sx,dx){var lx=new cm(this.manager);lx.setResponseType("arraybuffer"),lx.load(ix,function(px){$y.getContext().decodeAudioData(px,function(cx){nx(cx)})},sx,dx)}}),Object.assign(hu.prototype,{update:function(){var ux=new id,gx=new id,ix,nx,sx,dx,lx,px,cx,mx;return function(hx){if(ix!==this||nx!==hx.focus||sx!==hx.fov||dx!==hx.aspect*this.aspect||lx!==hx.near||px!==hx.far||cx!==hx.zoom||mx!==this.eyeSep){ix=this,nx=hx.focus,sx=hx.fov,dx=hx.aspect*this.aspect,lx=hx.near,px=hx.far,cx=hx.zoom;var xx=hx.projectionMatrix.clone(),vx=(mx=this.eyeSep/2)*lx/nx,Lx=lx*Math.tan(.5*(uy.DEG2RAD*sx))/cx,fx,yx;gx.elements[12]=-mx,ux.elements[12]=mx,fx=-Lx*dx+vx,yx=Lx*dx+vx,xx.elements[0]=2*lx/(yx-fx),xx.elements[8]=(yx+fx)/(yx-fx),this.cameraL.projectionMatrix.copy(xx),fx=-Lx*dx-vx,yx=Lx*dx-vx,xx.elements[0]=2*lx/(yx-fx),xx.elements[8]=(yx+fx)/(yx-fx),this.cameraR.projectionMatrix.copy(xx)}this.cameraL.matrixWorld.copy(hx.matrixWorld).multiply(gx),this.cameraR.matrixWorld.copy(hx.matrixWorld).multiply(ux)}}()}),fu.prototype=Object.create(il.prototype),fu.prototype.constructor=fu,yu.prototype=Object.assign(Object.create(il.prototype),{constructor:yu,getInput:function(){return this.gain},removeFilter:function(){null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null)},getFilter:function(){return this.filter},setFilter:function(ix){null===this.filter?this.gain.disconnect(this.context.destination):(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)),this.filter=ix,this.gain.connect(this.filter),this.filter.connect(this.context.destination)},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(ix){this.gain.gain.value=ix},updateMatrixWorld:function(){var ix=new sd,nx=new nd,sx=new sd,dx=new sd;return function(lx){il.prototype.updateMatrixWorld.call(this,lx);var px=this.context.listener,cx=this.up;this.matrixWorld.decompose(ix,nx,sx),dx.set(0,0,-1).applyQuaternion(nx),px.positionX?(px.positionX.setValueAtTime(ix.x,this.context.currentTime),px.positionY.setValueAtTime(ix.y,this.context.currentTime),px.positionZ.setValueAtTime(ix.z,this.context.currentTime),px.forwardX.setValueAtTime(dx.x,this.context.currentTime),px.forwardY.setValueAtTime(dx.y,this.context.currentTime),px.forwardZ.setValueAtTime(dx.z,this.context.currentTime),px.upX.setValueAtTime(cx.x,this.context.currentTime),px.upY.setValueAtTime(cx.y,this.context.currentTime),px.upZ.setValueAtTime(cx.z,this.context.currentTime)):(px.setPosition(ix.x,ix.y,ix.z),px.setOrientation(dx.x,dx.y,dx.z,cx.x,cx.y,cx.z))}}()}),xu.prototype=Object.assign(Object.create(il.prototype),{constructor:xu,getOutput:function(){return this.gain},setNodeSource:function(ix){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=ix,this.connect(),this},setBuffer:function(ix){return this.buffer=ix,this.sourceType="buffer",this.autoplay&&this.play(),this},play:function(){if(!0!==this.isPlaying){if(!1!==this.hasPlaybackControl){var ix=this.context.createBufferSource();return ix.buffer=this.buffer,ix.loop=this.loop,ix.onended=this.onEnded.bind(this),ix.playbackRate.setValueAtTime(this.playbackRate,this.startTime),this.startTime=this.context.currentTime,ix.start(this.startTime,this.offset),this.isPlaying=!0,this.source=ix,this.connect()}console.warn("THREE.Audio: this Audio has no playback control.")}else console.warn("THREE.Audio: Audio is already playing.")},pause:function(){return!1===this.hasPlaybackControl?void console.warn("THREE.Audio: this Audio has no playback control."):(!0===this.isPlaying&&(this.source.stop(),this.offset+=(this.context.currentTime-this.startTime)*this.playbackRate,this.isPlaying=!1),this)},stop:function(){return!1===this.hasPlaybackControl?void console.warn("THREE.Audio: this Audio has no playback control."):(this.source.stop(),this.offset=0,this.isPlaying=!1,this)},connect:function(){if(0<this.filters.length){this.source.connect(this.filters[0]);for(var ix=1,nx=this.filters.length;ix<nx;ix++)this.filters[ix-1].connect(this.filters[ix]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(0<this.filters.length){this.source.disconnect(this.filters[0]);for(var ix=1,nx=this.filters.length;ix<nx;ix++)this.filters[ix-1].disconnect(this.filters[ix]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(ix){return ix||(ix=[]),!0===this.isPlaying?(this.disconnect(),this.filters=ix,this.connect()):this.filters=ix,this},getFilter:function(){return this.getFilters()[0]},setFilter:function(ix){return this.setFilters(ix?[ix]:[])},setPlaybackRate:function(ix){return!1===this.hasPlaybackControl?void console.warn("THREE.Audio: this Audio has no playback control."):(this.playbackRate=ix,!0===this.isPlaying&&this.source.playbackRate.setValueAtTime(this.playbackRate,this.context.currentTime),this)},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},setLoop:function(ix){return!1===this.hasPlaybackControl?void console.warn("THREE.Audio: this Audio has no playback control."):(this.loop=ix,!0===this.isPlaying&&(this.source.loop=this.loop),this)},getVolume:function(){return this.gain.gain.value},setVolume:function(ix){return this.gain.gain.value=ix,this}}),vu.prototype=Object.assign(Object.create(xu.prototype),{constructor:vu,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(ix){this.panner.refDistance=ix},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(ix){this.panner.rolloffFactor=ix},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(ix){this.panner.distanceModel=ix},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(ix){this.panner.maxDistance=ix},updateMatrixWorld:function(){var ix=new sd;return function(nx){il.prototype.updateMatrixWorld.call(this,nx),ix.setFromMatrixPosition(this.matrixWorld),this.panner.setPosition(ix.x,ix.y,ix.z)}}()}),Object.assign(Lu.prototype,{getFrequencyData:function(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function(){for(var ix=0,nx=this.getFrequencyData(),sx=0;sx<nx.length;sx++)ix+=nx[sx];return ix/nx.length}}),Object.assign(bu.prototype,{accumulate:function(ix,nx){var sx=this.buffer,dx=this.valueSize,lx=ix*dx+dx,px=this.cumulativeWeight;if(0===px){for(var cx=0;cx!==dx;++cx)sx[lx+cx]=sx[cx];px=nx}else{var mx=nx/(px+=nx);this._mixBufferRegion(sx,lx,0,mx,dx)}this.cumulativeWeight=px},apply:function(ix){var nx=this.valueSize,sx=this.buffer,dx=ix*nx+nx,lx=this.cumulativeWeight,px=this.binding;if(this.cumulativeWeight=0,1>lx){this._mixBufferRegion(sx,dx,3*nx,1-lx,nx)}for(var mx=nx;mx!==nx+nx;++mx)if(sx[mx]!==sx[mx+nx]){px.setValue(sx,dx);break}},saveOriginalState:function(){var ix=this.binding,nx=this.buffer,sx=this.valueSize,dx=3*sx;ix.getValue(nx,dx);for(var lx=sx;lx!==dx;++lx)nx[lx]=nx[dx+lx%sx];this.cumulativeWeight=0},restoreOriginalState:function(){var ix=3*this.valueSize;this.binding.setValue(this.buffer,ix)},_select:function(ix,nx,sx,dx,lx){if(.5<=dx)for(var px=0;px!==lx;++px)ix[nx+px]=ix[sx+px]},_slerp:function(ix,nx,sx,dx){nd.slerpFlat(ix,nx,ix,nx,ix,sx,dx)},_lerp:function(ix,nx,sx,dx,lx){for(var cx=0,mx;cx!==lx;++cx)mx=nx+cx,ix[mx]=ix[mx]*(1-dx)+ix[sx+cx]*dx}}),Object.assign(_u.prototype,{getValue:function(ix,nx){this.bind();var sx=this._targetGroup.nCachedObjects_,dx=this._bindings[sx];void 0!==dx&&dx.getValue(ix,nx)},setValue:function(ix,nx){for(var sx=this._bindings,dx=this._targetGroup.nCachedObjects_,lx=sx.length;dx!==lx;++dx)sx[dx].setValue(ix,nx)},bind:function(){for(var ix=this._bindings,nx=this._targetGroup.nCachedObjects_,sx=ix.length;nx!==sx;++nx)ix[nx].bind()},unbind:function(){for(var ix=this._bindings,nx=this._targetGroup.nCachedObjects_,sx=ix.length;nx!==sx;++nx)ix[nx].unbind()}}),Object.assign(Au,{Composite:_u,create:function(ix,nx,sx){return ix&&ix.isAnimationObjectGroup?new Au.Composite(ix,nx,sx):new Au(ix,nx,sx)},sanitizeNodeName:function(){var ix=/[\[\]\.:\/]/g;return function(nx){return nx.replace(/\s/g,"_").replace(ix,"")}}(),parseTrackName:function(){var ix="[^\\[\\]\\.:\\/]",nx="[^"+"\\[\\]\\.:\\/".replace("\\.","")+"]",sx=/((?:WC+[\/:])*)/.source.replace("WC",ix),dx=/(WCOD+)?/.source.replace("WCOD",nx),lx=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",ix),px=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",ix),cx=new RegExp("^"+sx+dx+lx+px+"$"),mx=["material","materials","bones"];return function(ux){var gx=cx.exec(ux);if(!gx)throw new Error("PropertyBinding: Cannot parse trackName: "+ux);var hx={nodeName:gx[2],objectName:gx[3],objectIndex:gx[4],propertyName:gx[5],propertyIndex:gx[6]},fx=hx.nodeName&&hx.nodeName.lastIndexOf(".");if(void 0!==fx&&-1!==fx){var yx=hx.nodeName.substring(fx+1);-1!==mx.indexOf(yx)&&(hx.nodeName=hx.nodeName.substring(0,fx),hx.objectName=yx)}if(null===hx.propertyName||0===hx.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+ux);return hx}}(),findNode:function(ix,nx){if(!nx||""===nx||"root"===nx||"."===nx||-1===nx||nx===ix.name||nx===ix.uuid)return ix;if(ix.skeleton){var sx=ix.skeleton.getBoneByName(nx);if(void 0!==sx)return sx}if(ix.children){var dx=function(px){for(var cx=0,mx;cx<px.length;cx++){if(mx=px[cx],mx.name===nx||mx.uuid===nx)return mx;var ux=dx(mx.children);if(ux)return ux}return null},lx=dx(ix.children);if(lx)return lx}return null}}),Object.assign(Au.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(ix,nx){ix[nx]=this.node[this.propertyName]},function(ix,nx){for(var sx=this.resolvedProperty,dx=0,lx=sx.length;dx!==lx;++dx)ix[nx++]=sx[dx]},function(ix,nx){ix[nx]=this.resolvedProperty[this.propertyIndex]},function(ix,nx){this.resolvedProperty.toArray(ix,nx)}],SetterByBindingTypeAndVersioning:[[function(ix,nx){this.targetObject[this.propertyName]=ix[nx]},function(ix,nx){this.targetObject[this.propertyName]=ix[nx],this.targetObject.needsUpdate=!0},function(ix,nx){this.targetObject[this.propertyName]=ix[nx],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(ix,nx){for(var sx=this.resolvedProperty,dx=0,lx=sx.length;dx!==lx;++dx)sx[dx]=ix[nx++]},function(ix,nx){for(var sx=this.resolvedProperty,dx=0,lx=sx.length;dx!==lx;++dx)sx[dx]=ix[nx++];this.targetObject.needsUpdate=!0},function(ix,nx){for(var sx=this.resolvedProperty,dx=0,lx=sx.length;dx!==lx;++dx)sx[dx]=ix[nx++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(ix,nx){this.resolvedProperty[this.propertyIndex]=ix[nx]},function(ix,nx){this.resolvedProperty[this.propertyIndex]=ix[nx],this.targetObject.needsUpdate=!0},function(ix,nx){this.resolvedProperty[this.propertyIndex]=ix[nx],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(ix,nx){this.resolvedProperty.fromArray(ix,nx)},function(ix,nx){this.resolvedProperty.fromArray(ix,nx),this.targetObject.needsUpdate=!0},function(ix,nx){this.resolvedProperty.fromArray(ix,nx),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(ix,nx){this.bind(),this.getValue(ix,nx)},setValue:function(ix,nx){this.bind(),this.setValue(ix,nx)},bind:function(){var ix=this.node,nx=this.parsedPath,sx=nx.objectName,dx=nx.propertyName,lx=nx.propertyIndex;if(ix||(ix=Au.findNode(this.rootNode,nx.nodeName)||this.rootNode,this.node=ix),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,ix){if(sx){var px=nx.objectIndex;switch(sx){case"materials":if(!ix.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!ix.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);ix=ix.material.materials;break;case"bones":if(!ix.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);ix=ix.skeleton.bones;for(var cx=0;cx<ix.length;cx++)if(ix[cx].name===px){px=cx;break}break;default:if(void 0===ix[sx])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);ix=ix[sx];}if(void 0!==px){if(void 0===ix[px])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,ix);ix=ix[px]}}var mx=ix[dx];if(void 0!==mx){var ux=this.Versioning.None;void 0===ix.needsUpdate?void 0!==ix.matrixWorldNeedsUpdate&&(ux=this.Versioning.MatrixWorldNeedsUpdate,this.targetObject=ix):(ux=this.Versioning.NeedsUpdate,this.targetObject=ix);var gx=this.BindingType.Direct;if(void 0!==lx){if("morphTargetInfluences"===dx){if(!ix.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(ix.geometry.isBufferGeometry){if(!ix.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);for(cx=0;cx<this.node.geometry.morphAttributes.position.length;cx++)if(ix.geometry.morphAttributes.position[cx].name===lx){lx=cx;break}}else{if(!ix.geometry.morphTargets)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphTargets.",this);for(cx=0;cx<this.node.geometry.morphTargets.length;cx++)if(ix.geometry.morphTargets[cx].name===lx){lx=cx;break}}}gx=this.BindingType.ArrayElement,this.resolvedProperty=mx,this.propertyIndex=lx}else void 0!==mx.fromArray&&void 0!==mx.toArray?(gx=this.BindingType.HasFromToArray,this.resolvedProperty=mx):Array.isArray(mx)?(gx=this.BindingType.EntireArray,this.resolvedProperty=mx):this.propertyName=dx;this.getValue=this.GetterByBindingType[gx],this.setValue=this.SetterByBindingTypeAndVersioning[gx][ux]}else{var hx=nx.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+hx+"."+dx+" but it wasn't found.",ix)}}else console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.")},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),Object.assign(Au.prototype,{_getValue_unbound:Au.prototype.getValue,_setValue_unbound:Au.prototype.setValue}),Object.assign(Eu.prototype,{isAnimationObjectGroup:!0,add:function(){for(var ix=this._objects,nx=ix.length,sx=this.nCachedObjects_,dx=this._indicesByUUID,lx=this._paths,px=this._parsedPaths,cx=this._bindings,mx=cx.length,ux=void 0,gx=0,hx=arguments.length;gx!==hx;++gx){var fx=arguments[gx],yx=fx.uuid,xx=dx[yx];if(void 0===xx){xx=nx++,dx[yx]=xx,ix.push(fx);for(var vx=0,Lx=mx;vx!==Lx;++vx)cx[vx].push(new Au(fx,lx[vx],px[vx]))}else if(xx<sx){ux=ix[xx];var bx=--sx,_x=ix[bx];for(dx[_x.uuid]=xx,ix[xx]=_x,dx[yx]=bx,ix[bx]=fx,vx=0,Lx=mx;vx!==Lx;++vx){var Ax=cx[vx],Ex=Ax[bx],Sx=Ax[xx];Ax[xx]=Ex,void 0===Sx&&(Sx=new Au(fx,lx[vx],px[vx])),Ax[bx]=Sx}}else ix[xx]!==ux&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=sx},remove:function(){for(var ix=this._objects,nx=this.nCachedObjects_,sx=this._indicesByUUID,dx=this._bindings,lx=dx.length,px=0,cx=arguments.length;px!==cx;++px){var mx=arguments[px],ux=mx.uuid,gx=sx[ux];if(void 0!==gx&&gx>=nx){var hx=nx++,fx=ix[hx];sx[fx.uuid]=gx,ix[gx]=fx,sx[ux]=hx,ix[hx]=mx;for(var yx=0;yx!==lx;++yx){var vx=dx[yx],Lx=vx[hx],bx=vx[gx];vx[gx]=Lx,vx[hx]=bx}}}this.nCachedObjects_=nx},uncache:function(){for(var ix=this._objects,nx=ix.length,sx=this.nCachedObjects_,dx=this._indicesByUUID,lx=this._bindings,px=lx.length,cx=0,mx=arguments.length;cx!==mx;++cx){var ux=arguments[cx].uuid,gx=dx[ux];if(void 0!==gx)if(delete dx[ux],gx<sx){var hx=--sx,fx=ix[hx],yx=ix[_x=--nx];dx[fx.uuid]=gx,ix[gx]=fx,dx[yx.uuid]=hx,ix[hx]=yx,ix.pop();for(var xx=0,vx=px;xx!==vx;++xx){var Lx=(Ax=lx[xx])[hx],bx=Ax[_x];Ax[gx]=Lx,Ax[hx]=bx,Ax.pop()}}else{var _x;for(dx[(yx=ix[_x=--nx]).uuid]=gx,ix[gx]=yx,ix.pop(),xx=0,vx=px;xx!==vx;++xx){var Ax;(Ax=lx[xx])[gx]=Ax[_x],Ax.pop()}}}this.nCachedObjects_=sx},subscribe_:function(ix,nx){var sx=this._bindingsIndicesByPath,dx=sx[ix],lx=this._bindings;if(void 0!==dx)return lx[dx];var px=this._paths,cx=this._parsedPaths,mx=this._objects,ux=mx.length,gx=this.nCachedObjects_,hx=Array(ux);dx=lx.length,sx[ix]=dx,px.push(ix),cx.push(nx),lx.push(hx);for(var fx=gx,yx=mx.length,xx;fx!==yx;++fx)xx=mx[fx],hx[fx]=new Au(xx,ix,nx);return hx},unsubscribe_:function(ix){var nx=this._bindingsIndicesByPath,sx=nx[ix];if(void 0!==sx){var dx=this._paths,lx=this._parsedPaths,px=this._bindings,cx=px.length-1,mx=px[cx];nx[ix[cx]]=sx,px[sx]=mx,px.pop(),lx[sx]=lx[cx],lx.pop(),dx[sx]=dx[cx],dx.pop()}}}),Object.assign(Su.prototype,{play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(ix){return this._startTime=ix,this},setLoop:function(ix,nx){return this.loop=ix,this.repetitions=nx,this},setEffectiveWeight:function(ix){return this.weight=ix,this._effectiveWeight=this.enabled?ix:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(ix){return this._scheduleFading(ix,0,1)},fadeOut:function(ix){return this._scheduleFading(ix,1,0)},crossFadeFrom:function(ix,nx,sx){if(ix.fadeOut(nx),this.fadeIn(nx),sx){var dx=this._clip.duration,lx=ix._clip.duration;ix.warp(1,lx/dx,nx),this.warp(dx/lx,1,nx)}return this},crossFadeTo:function(ix,nx,sx){return ix.crossFadeFrom(this,nx,sx)},stopFading:function(){var ix=this._weightInterpolant;return null!==ix&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(ix)),this},setEffectiveTimeScale:function(ix){return this.timeScale=ix,this._effectiveTimeScale=this.paused?0:ix,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(ix){return this.timeScale=this._clip.duration/ix,this.stopWarping()},syncWith:function(ix){return this.time=ix.time,this.timeScale=ix.timeScale,this.stopWarping()},halt:function(ix){return this.warp(this._effectiveTimeScale,0,ix)},warp:function(ix,nx,sx){var dx=this._mixer,lx=dx.time,px=this._timeScaleInterpolant,cx=this.timeScale;null===px&&(px=dx._lendControlInterpolant(),this._timeScaleInterpolant=px);var mx=px.parameterPositions,ux=px.sampleValues;return mx[0]=lx,mx[1]=lx+sx,ux[0]=ix/cx,ux[1]=nx/cx,this},stopWarping:function(){var ix=this._timeScaleInterpolant;return null!==ix&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(ix)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(ix,nx,sx,dx){if(this.enabled){var lx=this._startTime;if(null!==lx){var px=(ix-lx)*sx;if(0>px||0===sx)return;this._startTime=null,nx=sx*px}nx*=this._updateTimeScale(ix);var cx=this._updateTime(nx),mx=this._updateWeight(ix);if(0<mx)for(var ux=this._interpolants,gx=this._propertyBindings,hx=0,fx=ux.length;hx!==fx;++hx)ux[hx].evaluate(cx),gx[hx].accumulate(dx,mx)}else this._updateWeight(ix)},_updateWeight:function(ix){var nx=0;if(this.enabled){nx=this.weight;var sx=this._weightInterpolant;if(null!==sx){var dx=sx.evaluate(ix)[0];nx*=dx,ix>sx.parameterPositions[1]&&(this.stopFading(),0===dx&&(this.enabled=!1))}}return this._effectiveWeight=nx,nx},_updateTimeScale:function(ix){var nx=0;if(!this.paused){nx=this.timeScale;var sx=this._timeScaleInterpolant;null!==sx&&(nx*=sx.evaluate(ix)[0],ix>sx.parameterPositions[1]&&(this.stopWarping(),0===nx?this.paused=!0:this.timeScale=nx))}return this._effectiveTimeScale=nx,nx},_updateTime:function(ix){var nx=this.time+ix;if(0===ix)return nx;var sx=this._clip.duration,dx=this.loop,lx=this._loopCount;if(dx===jf){-1===lx&&(this._loopCount=0,this._setEndings(!0,!0,!1));t:{if(nx>=sx)nx=sx;else{if(!(0>nx))break t;nx=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this._mixer.dispatchEvent({type:"finished",action:this,direction:0>ix?-1:1})}}else{var px=dx===Xf;if(-1===lx&&(0<=ix?(lx=0,this._setEndings(!0,0===this.repetitions,px)):this._setEndings(0===this.repetitions,!0,px)),nx>=sx||0>nx){var cx=Math.floor(nx/sx);nx-=sx*cx,lx+=Math.abs(cx);var mx=this.repetitions-lx;if(0>mx)this.clampWhenFinished?this.paused=!0:this.enabled=!1,nx=0<ix?sx:0,this._mixer.dispatchEvent({type:"finished",action:this,direction:0<ix?1:-1});else{if(0==mx){var ux=0>ix;this._setEndings(ux,!ux,px)}else this._setEndings(!1,!1,px);this._loopCount=lx,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:cx})}}if(px&&1==(1&lx))return this.time=nx,sx-nx}return this.time=nx,nx},_setEndings:function(ix,nx,sx){var dx=this._interpolantSettings;sx?(dx.endingStart=Qf,dx.endingEnd=Qf):(dx.endingStart=ix?this.zeroSlopeAtStart?Qf:Kf:$f,dx.endingEnd=nx?this.zeroSlopeAtEnd?Qf:Kf:$f)},_scheduleFading:function(ix,nx,sx){var dx=this._mixer,lx=dx.time,px=this._weightInterpolant;null===px&&(px=dx._lendControlInterpolant(),this._weightInterpolant=px);var cx=px.parameterPositions,mx=px.sampleValues;return cx[0]=lx,mx[0]=nx,cx[1]=lx+ix,mx[1]=sx,this}}),Tu.prototype=Object.assign(Object.create(rd.prototype),{constructor:Tu,_bindAction:function(ix,nx){var sx=ix._localRoot||this._root,dx=ix._clip.tracks,lx=dx.length,px=ix._propertyBindings,cx=ix._interpolants,mx=sx.uuid,ux=this._bindingsByRootAndName,gx=ux[mx];void 0===gx&&(gx={},ux[mx]=gx);for(var hx=0;hx!==lx;++hx){var fx=dx[hx],yx=fx.name,xx=gx[yx];if(void 0!==xx)px[hx]=xx;else{if(void 0!==(xx=px[hx])){null===xx._cacheIndex&&(++xx.referenceCount,this._addInactiveBinding(xx,mx,yx));continue}var vx=nx&&nx._propertyBindings[hx].binding.parsedPath;++(xx=new bu(Au.create(sx,yx,vx),fx.ValueTypeName,fx.getValueSize())).referenceCount,this._addInactiveBinding(xx,mx,yx),px[hx]=xx}cx[hx].resultBuffer=xx.buffer}},_activateAction:function(ix){if(!this._isActiveAction(ix)){if(null===ix._cacheIndex){var nx=(ix._localRoot||this._root).uuid,sx=ix._clip.uuid,dx=this._actionsByClip[sx];this._bindAction(ix,dx&&dx.knownActions[0]),this._addInactiveAction(ix,sx,nx)}for(var lx=ix._propertyBindings,px=0,cx=lx.length,mx;px!==cx;++px)mx=lx[px],0==mx.useCount++&&(this._lendBinding(mx),mx.saveOriginalState());this._lendAction(ix)}},_deactivateAction:function(ix){if(this._isActiveAction(ix)){for(var nx=ix._propertyBindings,sx=0,dx=nx.length,lx;sx!==dx;++sx)lx=nx[sx],0==--lx.useCount&&(lx.restoreOriginalState(),this._takeBackBinding(lx));this._takeBackAction(ix)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var ix=this;this.stats={actions:{get total(){return ix._actions.length},get inUse(){return ix._nActiveActions}},bindings:{get total(){return ix._bindings.length},get inUse(){return ix._nActiveBindings}},controlInterpolants:{get total(){return ix._controlInterpolants.length},get inUse(){return ix._nActiveControlInterpolants}}}},_isActiveAction:function(ix){var nx=ix._cacheIndex;return null!==nx&&nx<this._nActiveActions},_addInactiveAction:function(ix,nx,sx){var dx=this._actions,lx=this._actionsByClip,px=lx[nx];if(void 0===px)px={knownActions:[ix],actionByRoot:{}},ix._byClipCacheIndex=0,lx[nx]=px;else{var cx=px.knownActions;ix._byClipCacheIndex=cx.length,cx.push(ix)}ix._cacheIndex=dx.length,dx.push(ix),px.actionByRoot[sx]=ix},_removeInactiveAction:function(ix){var nx=this._actions,sx=nx[nx.length-1],dx=ix._cacheIndex;sx._cacheIndex=dx,nx[dx]=sx,nx.pop(),ix._cacheIndex=null;var lx=ix._clip.uuid,px=this._actionsByClip,cx=px[lx],mx=cx.knownActions,ux=mx[mx.length-1],gx=ix._byClipCacheIndex;ux._byClipCacheIndex=gx,mx[gx]=ux,mx.pop(),ix._byClipCacheIndex=null,delete cx.actionByRoot[(ix._localRoot||this._root).uuid],0===mx.length&&delete px[lx],this._removeInactiveBindingsForAction(ix)},_removeInactiveBindingsForAction:function(ix){for(var nx=ix._propertyBindings,sx=0,dx=nx.length,lx;sx!==dx;++sx)lx=nx[sx],0==--lx.referenceCount&&this._removeInactiveBinding(lx)},_lendAction:function(ix){var nx=this._actions,sx=ix._cacheIndex,dx=this._nActiveActions++,lx=nx[dx];ix._cacheIndex=dx,nx[dx]=ix,lx._cacheIndex=sx,nx[sx]=lx},_takeBackAction:function(ix){var nx=this._actions,sx=ix._cacheIndex,dx=--this._nActiveActions,lx=nx[dx];ix._cacheIndex=dx,nx[dx]=ix,lx._cacheIndex=sx,nx[sx]=lx},_addInactiveBinding:function(ix,nx,sx){var dx=this._bindingsByRootAndName,lx=dx[nx],px=this._bindings;void 0===lx&&(lx={},dx[nx]=lx),lx[sx]=ix,ix._cacheIndex=px.length,px.push(ix)},_removeInactiveBinding:function(ix){var nx=this._bindings,sx=ix.binding,dx=sx.rootNode.uuid,lx=sx.path,px=this._bindingsByRootAndName,cx=px[dx],mx=nx[nx.length-1],ux=ix._cacheIndex;mx._cacheIndex=ux,nx[ux]=mx,nx.pop(),delete cx[lx];t:{for(var gx in cx)break t;delete px[dx]}},_lendBinding:function(ix){var nx=this._bindings,sx=ix._cacheIndex,dx=this._nActiveBindings++,lx=nx[dx];ix._cacheIndex=dx,nx[dx]=ix,lx._cacheIndex=sx,nx[sx]=lx},_takeBackBinding:function(ix){var nx=this._bindings,sx=ix._cacheIndex,dx=--this._nActiveBindings,lx=nx[dx];ix._cacheIndex=dx,nx[dx]=ix,lx._cacheIndex=sx,nx[sx]=lx},_lendControlInterpolant:function(){var ix=this._controlInterpolants,nx=this._nActiveControlInterpolants++,sx=ix[nx];return void 0===sx&&((sx=new $m(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer)).__cacheIndex=nx,ix[nx]=sx),sx},_takeBackControlInterpolant:function(ix){var nx=this._controlInterpolants,sx=ix.__cacheIndex,dx=--this._nActiveControlInterpolants,lx=nx[dx];ix.__cacheIndex=dx,nx[dx]=ix,lx.__cacheIndex=sx,nx[sx]=lx},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(ix,nx){var sx=nx||this._root,dx=sx.uuid,lx="string"==typeof ix?ru.findByName(sx,ix):ix,px=null===lx?ix:lx.uuid,cx=this._actionsByClip[px],mx=null;if(void 0!==cx){var ux=cx.actionByRoot[dx];if(void 0!==ux)return ux;mx=cx.knownActions[0],null===lx&&(lx=mx._clip)}if(null===lx)return null;var gx=new Su(this,lx,nx);return this._bindAction(gx,mx),this._addInactiveAction(gx,px,dx),gx},existingAction:function(ix,nx){var sx=nx||this._root,dx=sx.uuid,lx="string"==typeof ix?ru.findByName(sx,ix):ix,px=lx?lx.uuid:ix,cx=this._actionsByClip[px];return void 0!==cx&&cx.actionByRoot[dx]||null},stopAllAction:function(){var ix=this._actions,nx=this._nActiveActions,sx=this._bindings,dx=this._nActiveBindings;this._nActiveActions=0,this._nActiveBindings=0;for(var lx=0;lx!==nx;++lx)ix[lx].reset();for(lx=0;lx!==dx;++lx)sx[lx].useCount=0;return this},update:function(ix){ix*=this.timeScale;for(var nx=this._actions,sx=this._nActiveActions,dx=this.time+=ix,lx=Math.sign(ix),px=this._accuIndex^=1,cx=0;cx!==sx;++cx)nx[cx]._update(dx,ix,lx,px);var mx=this._bindings,ux=this._nActiveBindings;for(cx=0;cx!==ux;++cx)mx[cx].apply(px);return this},getRoot:function(){return this._root},uncacheClip:function(ix){var nx=this._actions,sx=ix.uuid,dx=this._actionsByClip,lx=dx[sx];if(void 0!==lx){for(var px=lx.knownActions,cx=0,mx=px.length,ux;cx!==mx;++cx){ux=px[cx],this._deactivateAction(ux);var gx=ux._cacheIndex,hx=nx[nx.length-1];ux._cacheIndex=null,ux._byClipCacheIndex=null,hx._cacheIndex=gx,nx[gx]=hx,nx.pop(),this._removeInactiveBindingsForAction(ux)}delete dx[sx]}},uncacheRoot:function(ix){var nx=ix.uuid,sx=this._actionsByClip;for(var dx in sx){var lx=sx[dx].actionByRoot[nx];void 0!==lx&&(this._deactivateAction(lx),this._removeInactiveAction(lx))}var px=this._bindingsByRootAndName[nx];if(void 0!==px)for(var cx in px){var mx=px[cx];mx.restoreOriginalState(),this._removeInactiveBinding(mx)}},uncacheAction:function(ix,nx){var sx=this.existingAction(ix,nx);null!==sx&&(this._deactivateAction(sx),this._removeInactiveAction(sx))}}),Mu.prototype.clone=function(){return new Mu(void 0===this.value.clone?this.value:this.value.clone())},wu.prototype=Object.assign(Object.create(_l.prototype),{constructor:wu,isInstancedBufferGeometry:!0,copy:function(ix){return _l.prototype.copy.call(this,ix),this.maxInstancedCount=ix.maxInstancedCount,this},clone:function(){return new this.constructor().copy(this)}}),Object.defineProperties(Ru.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}}}),Object.assign(Ru.prototype,{isInterleavedBufferAttribute:!0,setX:function(ix,nx){return this.data.array[ix*this.data.stride+this.offset]=nx,this},setY:function(ix,nx){return this.data.array[ix*this.data.stride+this.offset+1]=nx,this},setZ:function(ix,nx){return this.data.array[ix*this.data.stride+this.offset+2]=nx,this},setW:function(ix,nx){return this.data.array[ix*this.data.stride+this.offset+3]=nx,this},getX:function(ix){return this.data.array[ix*this.data.stride+this.offset]},getY:function(ix){return this.data.array[ix*this.data.stride+this.offset+1]},getZ:function(ix){return this.data.array[ix*this.data.stride+this.offset+2]},getW:function(ix){return this.data.array[ix*this.data.stride+this.offset+3]},setXY:function(ix,nx,sx){return ix=ix*this.data.stride+this.offset,this.data.array[ix+0]=nx,this.data.array[ix+1]=sx,this},setXYZ:function(ix,nx,sx,dx){return ix=ix*this.data.stride+this.offset,this.data.array[ix+0]=nx,this.data.array[ix+1]=sx,this.data.array[ix+2]=dx,this},setXYZW:function(ix,nx,sx,dx,lx){return ix=ix*this.data.stride+this.offset,this.data.array[ix+0]=nx,this.data.array[ix+1]=sx,this.data.array[ix+2]=dx,this.data.array[ix+3]=lx,this}}),Object.defineProperty(Pu.prototype,"needsUpdate",{set:function(ix){!0===ix&&this.version++}}),Object.assign(Pu.prototype,{isInterleavedBuffer:!0,setArray:function(ix){if(Array.isArray(ix))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.count=void 0===ix?0:ix.length/this.stride,this.array=ix},setDynamic:function(ix){return this.dynamic=ix,this},copy:function(ix){return this.array=new ix.array.constructor(ix.array),this.count=ix.count,this.stride=ix.stride,this.dynamic=ix.dynamic,this},copyAt:function(ix,nx,sx){ix*=this.stride,sx*=nx.stride;for(var dx=0,lx=this.stride;dx<lx;dx++)this.array[ix+dx]=nx.array[sx+dx];return this},set:function(ix,nx){return void 0===nx&&(nx=0),this.array.set(ix,nx),this},clone:function(){return new this.constructor().copy(this)},onUpload:function(ix){return this.onUploadCallback=ix,this}}),Cu.prototype=Object.assign(Object.create(Pu.prototype),{constructor:Cu,isInstancedInterleavedBuffer:!0,copy:function(ix){return Pu.prototype.copy.call(this,ix),this.meshPerAttribute=ix.meshPerAttribute,this}}),Ou.prototype=Object.assign(Object.create(pl.prototype),{constructor:Ou,isInstancedBufferAttribute:!0,copy:function(ix){return pl.prototype.copy.call(this,ix),this.meshPerAttribute=ix.meshPerAttribute,this}}),Object.assign(Iu.prototype,{linePrecision:1,set:function(ix,nx){this.ray.set(ix,nx)},setFromCamera:function(ix,nx){nx&&nx.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(nx.matrixWorld),this.ray.direction.set(ix.x,ix.y,.5).unproject(nx).sub(this.ray.origin).normalize()):nx&&nx.isOrthographicCamera?(this.ray.origin.set(ix.x,ix.y,(nx.near+nx.far)/(nx.near-nx.far)).unproject(nx),this.ray.direction.set(0,0,-1).transformDirection(nx.matrixWorld)):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(ix,nx){var sx=[];return Fu(ix,this,sx,nx),sx.sort(Du),sx},intersectObjects:function(ix,nx){var sx=[];if(!1===Array.isArray(ix))return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),sx;for(var dx=0,lx=ix.length;dx<lx;dx++)Fu(ix[dx],this,sx,nx);return sx.sort(Du),sx}}),Object.assign(Bu.prototype,{start:function(){this.startTime=("undefined"==typeof performance?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var ix=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var nx=("undefined"==typeof performance?Date:performance).now();ix=(nx-this.oldTime)/1e3,this.oldTime=nx,this.elapsedTime+=ix}return ix}}),Object.assign(Uu.prototype,{set:function(ix,nx,sx){return this.radius=ix,this.phi=nx,this.theta=sx,this},clone:function(){return new this.constructor().copy(this)},copy:function(ix){return this.radius=ix.radius,this.phi=ix.phi,this.theta=ix.theta,this},makeSafe:function(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this},setFromVector3:function(ix){return this.radius=ix.length(),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(ix.x,ix.z),this.phi=Math.acos(uy.clamp(ix.y/this.radius,-1,1))),this}}),Object.assign(Nu.prototype,{set:function(ix,nx,sx){return this.radius=ix,this.theta=nx,this.y=sx,this},clone:function(){return new this.constructor().copy(this)},copy:function(ix){return this.radius=ix.radius,this.theta=ix.theta,this.y=ix.y,this},setFromVector3:function(ix){return this.radius=Math.sqrt(ix.x*ix.x+ix.z*ix.z),this.theta=Math.atan2(ix.x,ix.z),this.y=ix.y,this}}),Object.assign(Wu.prototype,{set:function(ix,nx){return this.min.copy(ix),this.max.copy(nx),this},setFromPoints:function(ix){this.makeEmpty();for(var nx=0,sx=ix.length;nx<sx;nx++)this.expandByPoint(ix[nx]);return this},setFromCenterAndSize:function(){var ix=new od;return function(nx,sx){var dx=ix.copy(sx).multiplyScalar(.5);return this.min.copy(nx).sub(dx),this.max.copy(nx).add(dx),this}}(),clone:function(){return new this.constructor().copy(this)},copy:function(ix){return this.min.copy(ix.min),this.max.copy(ix.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(ix){var nx=ix||new od;return this.isEmpty()?nx.set(0,0):nx.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(ix){var nx=ix||new od;return this.isEmpty()?nx.set(0,0):nx.subVectors(this.max,this.min)},expandByPoint:function(ix){return this.min.min(ix),this.max.max(ix),this},expandByVector:function(ix){return this.min.sub(ix),this.max.add(ix),this},expandByScalar:function(ix){return this.min.addScalar(-ix),this.max.addScalar(ix),this},containsPoint:function(ix){return!(ix.x<this.min.x||ix.x>this.max.x||ix.y<this.min.y||ix.y>this.max.y)},containsBox:function(ix){return this.min.x<=ix.min.x&&ix.max.x<=this.max.x&&this.min.y<=ix.min.y&&ix.max.y<=this.max.y},getParameter:function(ix,nx){return(nx||new od).set((ix.x-this.min.x)/(this.max.x-this.min.x),(ix.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(ix){return!(ix.max.x<this.min.x||ix.min.x>this.max.x||ix.max.y<this.min.y||ix.min.y>this.max.y)},clampPoint:function(ix,nx){return(nx||new od).copy(ix).clamp(this.min,this.max)},distanceToPoint:function(){var ix=new od;return function(nx){return ix.copy(nx).clamp(this.min,this.max).sub(nx).length()}}(),intersect:function(ix){return this.min.max(ix.min),this.max.min(ix.max),this},union:function(ix){return this.min.min(ix.min),this.max.max(ix.max),this},translate:function(ix){return this.min.add(ix),this.max.add(ix),this},equals:function(ix){return ix.min.equals(this.min)&&ix.max.equals(this.max)}}),zu.prototype=Object.create(il.prototype),zu.prototype.constructor=zu,zu.prototype.isImmediateRenderObject=!0,Hu.prototype=Object.create(lp.prototype),Hu.prototype.constructor=Hu,Hu.prototype.update=function(){var ix=new sd,nx=new sd,sx=new dd;return function(){var dx=["a","b","c"];this.object.updateMatrixWorld(!0),sx.getNormalMatrix(this.object.matrixWorld);var lx=this.object.matrixWorld,px=this.geometry.attributes.position,cx=this.object.geometry;if(cx&&cx.isGeometry)for(var mx=cx.vertices,ux=cx.faces,gx=0,hx=0,fx=ux.length;hx<fx;hx++)for(var yx=ux[hx],xx=0,vx=yx.vertexNormals.length;xx<vx;xx++){var Lx=mx[yx[dx[xx]]],bx=yx.vertexNormals[xx];ix.copy(Lx).applyMatrix4(lx),nx.copy(bx).applyMatrix3(sx).normalize().multiplyScalar(this.size).add(ix),px.setXYZ(gx,ix.x,ix.y,ix.z),gx+=1,px.setXYZ(gx,nx.x,nx.y,nx.z),gx+=1}else if(cx&&cx.isBufferGeometry){var _x=cx.attributes.position,Ax=cx.attributes.normal;for(gx=0,xx=0,vx=_x.count;xx<vx;xx++)ix.set(_x.getX(xx),_x.getY(xx),_x.getZ(xx)).applyMatrix4(lx),nx.set(Ax.getX(xx),Ax.getY(xx),Ax.getZ(xx)),nx.applyMatrix3(sx).normalize().multiplyScalar(this.size).add(ix),px.setXYZ(gx,ix.x,ix.y,ix.z),gx+=1,px.setXYZ(gx,nx.x,nx.y,nx.z),gx+=1}px.needsUpdate=!0}}(),Gu.prototype=Object.create(il.prototype),Gu.prototype.constructor=Gu,Gu.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},Gu.prototype.update=function(){var ix=new sd,nx=new sd;return function(){this.light.updateMatrixWorld();var sx=this.light.distance?this.light.distance:1e3,dx=sx*Math.tan(this.light.angle);this.cone.scale.set(dx,dx,sx),ix.setFromMatrixPosition(this.light.matrixWorld),nx.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(nx.sub(ix)),void 0===this.color?this.cone.material.color.copy(this.light.color):this.cone.material.color.set(this.color)}}(),Vu.prototype=Object.create(lp.prototype),Vu.prototype.constructor=Vu,Vu.prototype.updateMatrixWorld=function(){var ix=new sd,nx=new id,sx=new id;return function(dx){var lx=this.bones,px=this.geometry,cx=px.getAttribute("position");sx.getInverse(this.root.matrixWorld);for(var mx=0,ux=0,gx;mx<lx.length;mx++)gx=lx[mx],gx.parent&&gx.parent.isBone&&(nx.multiplyMatrices(sx,gx.matrixWorld),ix.setFromMatrixPosition(nx),cx.setXYZ(ux,ix.x,ix.y,ix.z),nx.multiplyMatrices(sx,gx.parent.matrixWorld),ix.setFromMatrixPosition(nx),cx.setXYZ(ux+1,ix.x,ix.y,ix.z),ux+=2);px.getAttribute("position").needsUpdate=!0,il.prototype.updateMatrixWorld.call(this,dx)}}(),ku.prototype=Object.create(Ol.prototype),ku.prototype.constructor=ku,ku.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},ku.prototype.update=function(){void 0===this.color?this.material.color.copy(this.light.color):this.material.color.set(this.color)},ju.prototype=Object.create(il.prototype),ju.prototype.constructor=ju,ju.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},ju.prototype.update=function(){var ix=.5*this.light.width,nx=.5*this.light.height,sx=this.line.geometry.attributes.position,dx=sx.array;dx[0]=ix,dx[1]=-nx,dx[2]=0,dx[3]=ix,dx[4]=nx,dx[5]=0,dx[6]=-ix,dx[7]=nx,dx[8]=0,dx[9]=-ix,dx[10]=-nx,dx[11]=0,dx[12]=ix,dx[13]=-nx,dx[14]=0,sx.needsUpdate=!0,void 0===this.color?this.line.material.color.copy(this.light.color):this.line.material.color.set(this.color)},Yu.prototype=Object.create(il.prototype),Yu.prototype.constructor=Yu,Yu.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},Yu.prototype.update=function(){var ix=new sd,nx=new Xd,sx=new Xd;return function(){var dx=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{var lx=dx.geometry.getAttribute("color");nx.copy(this.light.color),sx.copy(this.light.groundColor);for(var px=0,cx=lx.count,mx;px<cx;px++)mx=px<cx/2?nx:sx,lx.setXYZ(px,mx.r,mx.g,mx.b);lx.needsUpdate=!0}dx.lookAt(ix.setFromMatrixPosition(this.light.matrixWorld).negate())}}(),Xu.prototype=Object.create(lp.prototype),Xu.prototype.constructor=Xu,qu.prototype=Object.create(lp.prototype),qu.prototype.constructor=qu,Zu.prototype=Object.create(lp.prototype),Zu.prototype.constructor=Zu,Zu.prototype.update=function(){var ix=new sd,nx=new sd,sx=new dd;return function(){this.object.updateMatrixWorld(!0),sx.getNormalMatrix(this.object.matrixWorld);for(var dx=this.object.matrixWorld,lx=this.geometry.attributes.position,px=this.object.geometry,cx=px.vertices,mx=px.faces,ux=0,gx=0,hx=mx.length;gx<hx;gx++){var fx=mx[gx],yx=fx.normal;ix.copy(cx[fx.a]).add(cx[fx.b]).add(cx[fx.c]).divideScalar(3).applyMatrix4(dx),nx.copy(yx).applyMatrix3(sx).normalize().multiplyScalar(this.size).add(ix),lx.setXYZ(ux,ix.x,ix.y,ix.z),ux+=1,lx.setXYZ(ux,nx.x,nx.y,nx.z),ux+=1}lx.needsUpdate=!0}}(),Ju.prototype=Object.create(il.prototype),Ju.prototype.constructor=Ju,Ju.prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},Ju.prototype.update=function(){var ix=new sd,nx=new sd,sx=new sd;return function(){ix.setFromMatrixPosition(this.light.matrixWorld),nx.setFromMatrixPosition(this.light.target.matrixWorld),sx.subVectors(nx,ix),this.lightPlane.lookAt(sx),void 0===this.color?(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)):(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)),this.targetLine.lookAt(sx),this.targetLine.scale.z=sx.length()}}(),Ku.prototype=Object.create(lp.prototype),Ku.prototype.constructor=Ku,Ku.prototype.update=function(){function ix(px,cx,mx,ux){dx.set(cx,mx,ux).unproject(lx);var gx=sx[px];if(void 0!==gx)for(var hx=nx.getAttribute("position"),fx=0,yx=gx.length;fx<yx;fx++)hx.setXYZ(gx[fx],dx.x,dx.y,dx.z)}var dx=new sd,lx=new nl,nx,sx;return function(){nx=this.geometry,sx=this.pointMap,lx.projectionMatrix.copy(this.camera.projectionMatrix),ix("c",0,0,-1),ix("t",0,0,1),ix("n1",-1,-1,-1),ix("n2",1,-1,-1),ix("n3",-1,1,-1),ix("n4",1,1,-1),ix("f1",-1,-1,1),ix("f2",1,-1,1),ix("f3",-1,1,1),ix("f4",1,1,1),ix("u1",.7,1.1,-1),ix("u2",-.7,1.1,-1),ix("u3",0,2,-1),ix("cf1",-1,0,1),ix("cf2",1,0,1),ix("cf3",0,-1,1),ix("cf4",0,1,1),ix("cn1",-1,0,-1),ix("cn2",1,0,-1),ix("cn3",0,-1,-1),ix("cn4",0,1,-1),nx.getAttribute("position").needsUpdate=!0}}(),Qu.prototype=Object.create(lp.prototype),Qu.prototype.constructor=Qu,Qu.prototype.update=function(){var ix=new Qd;return function(nx){if(void 0!==nx&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&ix.setFromObject(this.object),!ix.isEmpty()){var sx=ix.min,dx=ix.max,lx=this.geometry.attributes.position,px=lx.array;px[0]=dx.x,px[1]=dx.y,px[2]=dx.z,px[3]=sx.x,px[4]=dx.y,px[5]=dx.z,px[6]=sx.x,px[7]=sx.y,px[8]=dx.z,px[9]=dx.x,px[10]=sx.y,px[11]=dx.z,px[12]=dx.x,px[13]=dx.y,px[14]=sx.z,px[15]=sx.x,px[16]=dx.y,px[17]=sx.z,px[18]=sx.x,px[19]=sx.y,px[20]=sx.z,px[21]=dx.x,px[22]=sx.y,px[23]=sx.z,lx.needsUpdate=!0,this.geometry.computeBoundingSphere()}}}(),Qu.prototype.setFromObject=function(ix){return this.object=ix,this.update(),this},$u.prototype=Object.create(lp.prototype),$u.prototype.constructor=$u,$u.prototype.updateMatrixWorld=function(ix){var nx=this.box;nx.isEmpty()||(nx.getCenter(this.position),nx.getSize(this.scale),this.scale.multiplyScalar(.5),il.prototype.updateMatrixWorld.call(this,ix))},eg.prototype=Object.create(dp.prototype),eg.prototype.constructor=eg,eg.prototype.updateMatrixWorld=function(ix){var nx=-this.plane.constant;1e-8>Math.abs(nx)&&(nx=1e-8),this.scale.set(.5*this.size,.5*this.size,nx),this.lookAt(this.plane.normal),il.prototype.updateMatrixWorld.call(this,ix)},tg.prototype=Object.create(il.prototype),tg.prototype.constructor=tg,tg.prototype.setDirection=function(){var nx=new sd,ix;return function(sx){.99999<sx.y?this.quaternion.set(0,0,0,1):-.99999>sx.y?this.quaternion.set(1,0,0,0):(nx.set(sx.z,0,-sx.x).normalize(),ix=Math.acos(sx.y),this.quaternion.setFromAxisAngle(nx,ix))}}(),tg.prototype.setLength=function(ix,nx,sx){void 0===nx&&(nx=.2*ix),void 0===sx&&(sx=.2*nx),this.line.scale.set(1,Math.max(0,ix-nx),1),this.line.updateMatrix(),this.cone.scale.set(sx,nx,sx),this.cone.position.y=ix,this.cone.updateMatrix()},tg.prototype.setColor=function(ix){this.line.material.color.copy(ix),this.cone.material.color.copy(ix)},ag.prototype=Object.create(lp.prototype),ag.prototype.constructor=ag;ym.create=function(ix,nx){return console.log("THREE.Curve.create() has been deprecated"),ix.prototype=Object.create(ym.prototype),ix.prototype.constructor=ix,ix.prototype.getPoint=nx,ix},Object.assign(Om.prototype,{createPointsGeometry:function(ix){console.warn("THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var nx=this.getPoints(ix);return this.createGeometry(nx)},createSpacedPointsGeometry:function(ix){console.warn("THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var nx=this.getSpacedPoints(ix);return this.createGeometry(nx)},createGeometry:function(ix){console.warn("THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");for(var nx=new ll,sx=0,dx=ix.length,lx;sx<dx;sx++)lx=ix[sx],nx.vertices.push(new sd(lx.x,lx.y,lx.z||0));return nx}}),Object.assign(Im.prototype,{fromPoints:function(ix){console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(ix)}}),Ag.prototype=Object.create(bm.prototype),Eg.prototype=Object.create(bm.prototype),Sg.prototype=Object.create(bm.prototype),Object.assign(Sg.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}}),Xu.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},Vu.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Object.assign(nu.prototype,{extractUrlBase:function(ix){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),Yy.extractUrlBase(ix)}}),Object.assign(Wu.prototype,{center:function(ix){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(ix)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(ix){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(ix)},size:function(ix){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(ix)}}),Object.assign(Qd.prototype,{center:function(ix){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(ix)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(ix){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(ix)},isIntersectionSphere:function(ix){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(ix)},size:function(ix){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(ix)}}),Pl.prototype.center=function(ix){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(ix)},Object.assign(uy,{random16:function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},nearestPowerOfTwo:function(ix){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),uy.floorPowerOfTwo(ix)},nextPowerOfTwo:function(ix){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),uy.ceilPowerOfTwo(ix)}}),Object.assign(dd.prototype,{flattenToArrayOffset:function(ix,nx){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(ix,nx)},multiplyVector3:function(ix){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),ix.applyMatrix3(this)},multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBuffer:function(ix){return console.warn("THREE.Matrix3: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead."),this.applyToBufferAttribute(ix)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")}}),Object.assign(id.prototype,{extractPosition:function(ix){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(ix)},flattenToArrayOffset:function(ix,nx){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(ix,nx)},getPosition:function(){var ix;return function(){return void 0==ix&&(ix=new sd),console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),ix.setFromMatrixColumn(this,3)}}(),setRotationFromQuaternion:function(ix){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(ix)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(ix){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),ix.applyMatrix4(this)},multiplyVector4:function(ix){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),ix.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(ix){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),ix.transformDirection(this)},crossVector:function(ix){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),ix.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBuffer:function(ix){return console.warn("THREE.Matrix4: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead."),this.applyToBufferAttribute(ix)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(ix,nx,sx,dx,lx,px){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(ix,nx,dx,sx,lx,px)}}),el.prototype.isIntersectionLine=function(ix){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(ix)},nd.prototype.multiplyVector3=function(ix){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),ix.applyQuaternion(this)},Object.assign(Rl.prototype,{isIntersectionBox:function(ix){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(ix)},isIntersectionPlane:function(ix){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(ix)},isIntersectionSphere:function(ix){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(ix)}}),Object.assign(Dm.prototype,{extractAllPoints:function(ix){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(ix)},extrude:function(ix){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new Fc(this,ix)},makeGeometry:function(ix){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new jc(this,ix)}}),Object.assign(od.prototype,{fromAttribute:function(ix,nx,sx){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(ix,nx,sx)},distanceToManhattan:function(ix){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(ix)},lengthManhattan:function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(sd.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(ix){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(ix)},getScaleFromMatrix:function(ix){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(ix)},getColumnFromMatrix:function(ix,nx){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(nx,ix)},applyProjection:function(ix){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(ix)},fromAttribute:function(ix,nx,sx){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(ix,nx,sx)},distanceToManhattan:function(ix){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(ix)},lengthManhattan:function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(pd.prototype,{fromAttribute:function(ix,nx,sx){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(ix,nx,sx)},lengthManhattan:function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(ll.prototype,{computeTangents:function(){console.error("THREE.Geometry: .computeTangents() has been removed.")},computeLineDistances:function(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")}}),Object.assign(il.prototype,{getChildByName:function(ix){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(ix)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(ix,nx){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(nx,ix)}}),Object.defineProperties(il.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(ix){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=ix}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Object.defineProperties(rp.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(op.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),Object.defineProperty(ym.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(ix){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=ix}}),Yl.prototype.setLens=function(ix,nx){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==nx&&(this.filmGauge=nx),this.setFocalLength(ix)},Object.defineProperties(Fm.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(ix){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=ix}},shadowCameraLeft:{set:function(ix){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=ix}},shadowCameraRight:{set:function(ix){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=ix}},shadowCameraTop:{set:function(ix){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=ix}},shadowCameraBottom:{set:function(ix){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=ix}},shadowCameraNear:{set:function(ix){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=ix}},shadowCameraFar:{set:function(ix){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=ix}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(ix){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=ix}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(ix){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=ix}},shadowMapHeight:{set:function(ix){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=ix}}}),Object.defineProperties(pl.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}}}),Object.assign(_l.prototype,{addIndex:function(ix){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(ix)},addDrawCall:function(ix,nx,sx){void 0!==sx&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(ix,nx)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")}}),Object.defineProperties(_l.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.defineProperties(Mu.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Object.defineProperties(Zd.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new Xd}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(ix){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=ix===Zg}}}),Object.defineProperties(im.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(wl.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(ix){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=ix}}}),Object.assign(Kl.prototype,{getCurrentRenderTarget:function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},getMaxAnisotropy:function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},getPrecision:function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},resetGLState:function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(ix){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(ix)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},setFaceCulling:function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")}}),Object.defineProperties(Kl.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(ix){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=ix}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(ix){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=ix}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(al.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(cd.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(ix){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=ix}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(ix){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=ix}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(ix){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=ix}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(ix){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=ix}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(ix){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=ix}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(ix){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=ix}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(ix){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=ix}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(ix){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=ix}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(ix){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=ix}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(ix){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=ix}}}),Object.defineProperties(ql.prototype,{standing:{set:function(){console.warn("THREE.WebVRManager: .standing has been removed.")}}}),xu.prototype.load=function(ix){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var nx=this;return new gu().load(ix,function(sx){nx.setBuffer(sx)}),this},Lu.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},fu.prototype.updateCubeMap=function(ix,nx){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(ix,nx)};var ax={merge:function(ix,nx,sx){var dx;console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead."),nx.isMesh&&(nx.matrixAutoUpdate&&nx.updateMatrix(),dx=nx.matrix,nx=nx.geometry),ix.merge(nx,dx,sx)},center:function(ix){return console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead."),ix.center()}},rx={crossOrigin:void 0,loadTexture:function(ix,nx,sx,dx){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var lx=new fm;lx.setCrossOrigin(this.crossOrigin);var px=lx.load(ix,sx,void 0,dx);return nx&&(px.mapping=nx),px},loadTextureCube:function(ix,nx,sx,dx){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var lx=new hm;lx.setCrossOrigin(this.crossOrigin);var px=lx.load(ix,sx,void 0,dx);return nx&&(px.mapping=nx),px},loadCompressedTexture:function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},loadCompressedTextureCube:function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")}},ox={createMultiMaterialObject:function(){console.error("THREE.SceneUtils has been moved to /examples/js/utils/SceneUtils.js")},detach:function(){console.error("THREE.SceneUtils has been moved to /examples/js/utils/SceneUtils.js")},attach:function(){console.error("THREE.SceneUtils has been moved to /examples/js/utils/SceneUtils.js")}}},function(ed,td,ad){function rd(dd){return this instanceof rd?void(this.options=dd,this.init()):new rd(dd)}function od(dd,ld){return dd&&ld?function(){return dd.apply(this,arguments),ld.apply(this,arguments)}:dd||ld}function id(dd){return new rd(dd)}var nd=ad(4);td.createCodec=id,td.install=function(dd){for(var ld in dd)rd.prototype[ld]=od(rd.prototype[ld],dd[ld])},td.filter=function(dd){return nd(dd)?function(ld){function pd(cd,md){return md(cd)}return ld=ld.slice(),function(cd){return ld.reduce(pd,cd)}}(dd):dd};var sd=ad(0);rd.prototype.init=function(){var dd=this.options;return dd&&dd.uint8array&&(this.bufferish=sd.Uint8Array),this},td.preset=id({preset:!0})},function(ed){var ad={}.toString;ed.exports=Array.isArray||function(rd){return"[object Array]"==ad.call(rd)}},function(ed,td,ad){function rd(){var ld=this.options;return this.decode=function(pd){var cd=sd.getReadToken(pd);return function(md){var ud=nd(md),gd=cd[ud];if(!gd)throw new Error("Invalid type: "+(ud?"0x"+ud.toString(16):ud));return gd(md)}}(ld),ld&&ld.preset&&id.setExtUnpackers(this),this}var od=ad(9).ExtBuffer,id=ad(32),nd=ad(15).readUint8,sd=ad(31),dd=ad(3);dd.install({addExtUnpacker:function(ld,pd){(this.extUnpackers||(this.extUnpackers=[]))[ld]=dd.filter(pd)},getExtUnpacker:function(ld){return(this.extUnpackers||(this.extUnpackers=[]))[ld]||function(pd){return new od(pd,ld)}},init:rd}),td.preset=rd.call(dd.preset)},function(ed,td,ad){(function(rd){!function(od){function id(Sd,Td,Md){function wd(Vd,kd,jd,Yd){return this instanceof wd?function(Xd,qd,Zd,Jd,Kd){(vd&&Ld&&(qd instanceof Ld&&(qd=new vd(qd)),Jd instanceof Ld&&(Jd=new vd(Jd))),qd||Zd||Jd||fd)?(!ld(qd,Zd)&&(Kd=Zd,Jd=qd,Zd=0,qd=new(fd||Array)(8)),Xd.buffer=qd,Xd.offset=Zd|=0,yd!==typeof Jd&&("string"==typeof Jd?function(Qd,$d,el,tl){var al=0,rl=el.length,ol=0,il=0;"-"===el[0]&&al++;for(var nl=al,sl;al<rl&&(sl=parseInt(el[al++],tl),!!(0<=sl));)il=il*tl+sl,ol=ol*tl+Math.floor(il/Ad),il%=Ad;nl&&(ol=~ol,il?il=Ad-il:ol++),Pd(Qd,$d+Od,ol),Pd(Qd,$d+Id,il)}(qd,Zd,Jd,Kd||10):ld(Jd,Kd)?pd(qd,Zd,Jd,Kd):"number"==typeof Kd?(Pd(qd,Zd+Od,Jd),Pd(qd,Zd+Id,Kd)):0<Jd?Nd(qd,Zd,Jd):0>Jd?Wd(qd,Zd,Jd):pd(qd,Zd,bd,0))):Xd.buffer=cd(bd,0)}(this,Vd,kd,jd,Yd):new wd(Vd,kd,jd,Yd)}function Rd(){var Vd=this.buffer,kd=this.offset,jd=Cd(Vd,kd+Od),Yd=Cd(Vd,kd+Id);return Md||(jd|=0),jd?jd*Ad+Yd:Yd}function Pd(Vd,kd,jd){Vd[kd+Ud]=255&jd,jd>>=8,Vd[kd+Bd]=255&jd,jd>>=8,Vd[kd+Fd]=255&jd,jd>>=8,Vd[kd+Dd]=255&jd}function Cd(Vd,kd){return Vd[kd+Dd]*16777216+(Vd[kd+Fd]<<16)+(Vd[kd+Bd]<<8)+Vd[kd+Ud]}var Od=Td?0:4,Id=Td?4:0,Dd=Td?0:3,Fd=Td?1:2,Bd=Td?2:1,Ud=Td?3:0,Nd=Td?md:gd,Wd=Td?ud:hd,zd=wd.prototype,Hd="is"+Sd,Gd="_"+Hd;return zd.buffer=void 0,zd.offset=0,zd[Gd]=!0,zd.toNumber=Rd,zd.toString=function(Vd){var kd=this.buffer,jd=this.offset,Yd=Cd(kd,jd+Od),Xd=Cd(kd,jd+Id),qd="",Zd=!Md&&2147483648&Yd;for(Zd&&(Yd=~Yd,Xd=Ad-Xd),Vd=Vd||10;;){var Jd=Yd%Vd*Ad+Xd;if(Yd=Math.floor(Yd/Vd),Xd=Math.floor(Jd/Vd),qd=(Jd%Vd).toString(Vd)+qd,!Yd&&!Xd)break}return Zd&&(qd="-"+qd),qd},zd.toJSON=Rd,zd.toArray=nd,xd&&(zd.toBuffer=sd),vd&&(zd.toArrayBuffer=dd),wd[Hd]=function(Vd){return Vd&&Vd[Gd]},od[Sd]=wd,wd}function nd(Sd){var Td=this.buffer,Md=this.offset;return fd=null,!1!==Sd&&0===Md&&8===Td.length&&_d(Td)?Td:cd(Td,Md)}function sd(Sd){var Td=this.buffer,Md=this.offset;if(fd=xd,!1!==Sd&&0===Md&&8===Td.length&&rd.isBuffer(Td))return Td;var wd=new xd(8);return pd(wd,0,Td,Md),wd}function dd(Sd){var Td=this.buffer,Md=this.offset,wd=Td.buffer;if(fd=vd,!1!==Sd&&0===Md&&wd instanceof Ld&&8===wd.byteLength)return wd;var Rd=new vd(8);return pd(Rd,0,Td,Md),Rd.buffer}function ld(Sd,Td){var Md=Sd&&Sd.length;return Td|=0,Md&&Td+8<=Md&&"string"!=typeof Sd[Td]}function pd(Sd,Td,Md,wd){Td|=0,wd|=0;for(var Rd=0;8>Rd;Rd++)Sd[Td++]=255&Md[wd++]}function cd(Sd,Td){return Array.prototype.slice.call(Sd,Td,Td+8)}function md(Sd,Td,Md){for(var wd=Td+8;wd>Td;)Sd[--wd]=255&Md,Md/=256}function ud(Sd,Td,Md){var wd=Td+8;for(Md++;wd>Td;)Sd[--wd]=255^255&-Md,Md/=256}function gd(Sd,Td,Md){for(var wd=Td+8;Td<wd;)Sd[Td++]=255&Md,Md/=256}function hd(Sd,Td,Md){var wd=Td+8;for(Md++;Td<wd;)Sd[Td++]=255^255&-Md,Md/=256}var yd="undefined",xd=yd!=typeof rd&&rd,vd=yd!=typeof Uint8Array&&Uint8Array,Ld=yd!=typeof ArrayBuffer&&ArrayBuffer,bd=[0,0,0,0,0,0,0,0],_d=Array.isArray||function(Sd){return!!Sd&&"[object Array]"==Object.prototype.toString.call(Sd)},Ad=4294967296,fd;id("Uint64BE",!0,!0),id("Int64BE",!0,!1),id("Uint64LE",!1,!0),id("Int64LE",!1,!1)}("object"==typeof td&&"string"!=typeof td.nodeName?td:this||{})}).call(this,ad(20).Buffer)},function(ed,td,ad){function rd(pd,cd,md,ud){var gd=nd.isBuffer(this),hd=nd.isBuffer(pd);if(gd&&hd)return this.copy(pd,cd,md,ud);if(ld||gd||hd||!nd.isView(this)||!nd.isView(pd))return id.copy.call(this,pd,cd,md,ud);var fd=md||null!=ud?od.call(this,md,ud):this;return pd.set(fd,cd),fd.length}function od(pd,cd){var md=this.slice||!ld&&this.subarray;if(md)return md.call(this,pd,cd);var ud=nd.alloc.call(this,cd-pd);return rd.call(this,ud,0,pd,cd),ud}var id=ad(36);td.copy=rd,td.slice=od,td.toString=function(){return(!dd&&nd.isBuffer(this)?this.toString:id.toString).apply(this,arguments)},td.write=function(pd){return function(){return(this[pd]||id[pd]).apply(this,arguments)}}("write");var nd=ad(0),sd=nd.global,dd=nd.hasBuffer&&"TYPED_ARRAY_SUPPORT"in sd,ld=dd&&!sd.TYPED_ARRAY_SUPPORT},function(ed,td){td.read=function(ad,rd,od,id,nd){var ld=8*nd-id-1,pd=(1<<ld)-1,cd=pd>>1,md=-7,ud=od?nd-1:0,gd=od?-1:1,hd=ad[rd+ud],sd,dd;for(ud+=gd,sd=hd&(1<<-md)-1,hd>>=-md,md+=ld;0<md;sd=256*sd+ad[rd+ud],ud+=gd,md-=8);for(dd=sd&(1<<-md)-1,sd>>=-md,md+=id;0<md;dd=256*dd+ad[rd+ud],ud+=gd,md-=8);if(0===sd)sd=1-cd;else{if(sd===pd)return dd?NaN:1/0*(hd?-1:1);dd+=Math.pow(2,id),sd-=cd}return(hd?-1:1)*dd*Math.pow(2,sd-id)},td.write=function(ad,rd,od,id,nd,sd){var cd=8*sd-nd-1,md=(1<<cd)-1,ud=md>>1,gd=23===nd?Math.pow(2,-24)-Math.pow(2,-77):0,hd=id?0:sd-1,fd=id?1:-1,yd=0>rd||0===rd&&0>1/rd?1:0,dd,ld,pd;for(rd=Math.abs(rd),isNaN(rd)||rd===1/0?(ld=isNaN(rd)?1:0,dd=md):(dd=Math.floor(Math.log(rd)/Math.LN2),1>rd*(pd=Math.pow(2,-dd))&&(dd--,pd*=2),2<=(rd+=1<=dd+ud?gd/pd:gd*Math.pow(2,1-ud))*pd&&(dd++,pd/=2),dd+ud>=md?(ld=0,dd=md):1<=dd+ud?(ld=(rd*pd-1)*Math.pow(2,nd),dd+=ud):(ld=rd*Math.pow(2,ud-1)*Math.pow(2,nd),dd=0));8<=nd;ad[od+hd]=255&ld,hd+=fd,ld/=256,nd-=8);for(dd=dd<<nd|ld,cd+=nd;0<cd;ad[od+hd]=255&dd,hd+=fd,dd/=256,cd-=8);ad[od+hd-fd]|=128*yd}},function(ed,td,ad){td.ExtBuffer=function od(id,nd){return this instanceof od?void(this.buffer=rd.from(id),this.type=nd):new od(id,nd)};var rd=ad(0)},function(ed,td,ad){function rd(){var dd=this.options;return this.encode=function(ld){var pd=nd.getWriteType(ld);return function(cd,md){var ud=pd[typeof md];if(!ud)throw new Error("Unsupported type \""+typeof md+"\": "+md);ud(cd,md)}}(dd),dd&&dd.preset&&id.setExtPackers(this),this}var od=ad(9).ExtBuffer,id=ad(35),nd=ad(34),sd=ad(3);sd.install({addExtPacker:function(dd,ld,pd){function cd(ud){return pd&&(ud=pd(ud)),new od(ud,dd)}pd=sd.filter(pd);var md=ld.name;md&&"Object"!==md?(this.extPackers||(this.extPackers={}))[md]=cd:(this.extEncoderList||(this.extEncoderList=[])).unshift([ld,cd])},getExtPacker:function(dd){var ld=this.extPackers||(this.extPackers={}),pd=dd.constructor,cd=pd&&pd.name&&ld[pd.name];if(cd)return cd;for(var md=this.extEncoderList||(this.extEncoderList=[]),ud=md.length,gd=0,hd;gd<ud;gd++)if(hd=md[gd],pd===hd[0])return hd[1]},init:rd}),td.preset=rd.call(sd.preset)},function(ed,td,ad){function rd(ld,pd,cd,md){return new Promise(ud=>{new nd.OBJLoader().load(pd,gd=>{let hd;cd&&(hd=dd.load(cd,xd=>{xd.wrapS=nd.RepeatWrapping,xd.wrapT=nd.RepeatWrapping,xd.repeat.set(1,1),xd.minFilter=nd.NearestFilter,xd.magFilter=nd.NearestFilter,xd.needsUpdate=!0}));let fd=new nd.MeshLambertMaterial({map:hd}),yd=new nd.Geometry;gd.traverse(xd=>{xd instanceof nd.Mesh&&(xd.geometry.isBufferGeometry?(yd.fromBufferGeometry(xd.geometry),yd.computeFlatVertexNormals(),xd.geometry.fromGeometry(yd)):xd.geometry.computeFlatVertexNormals(),xd.material=fd)}),gd.scale.setScalar(md||1),ld.add(gd),ud()})})}function od(ld,pd,cd){let md=new nd.TextureLoader().load(pd);md.magFilter=nd.NearestFilter;let ud=new nd.SpriteMaterial({map:md,color:16777215}),gd=new nd.Sprite(ud);cd&&gd.scale.set(cd,cd,1),ld.add(gd)}function id(ld,pd,cd){let md=new nd.BoxBufferGeometry(ld,pd,cd),ud=md.getAttribute("position"),gd=md.getAttribute("uv");for(let hd=0;hd<gd.count;hd++)8>hd?gd.setXY(hd,ud.getZ(hd),ud.getY(hd)):16>hd?gd.setXY(hd,ud.getX(hd),ud.getZ(hd)):gd.setXY(hd,ud.getX(hd),ud.getY(hd));return md}let nd=ad(2);const sd=ad(1);ad(13);let dd=new nd.TextureLoader;new nd.BoxBufferGeometry(1,1,1),new nd.PlaneBufferGeometry(1,1).rotateX(-Math.PI/2),new nd.MeshLambertMaterial({color:65280}),new nd.MeshLambertMaterial({color:5592405}),ed.exports.prefabs={CRATE:{dontRound:!0,gen:ld=>rd(ld,"models/crate_0.obj","textures/crate_0.png",sd.crateScale),dummy:!1,castShadow:!0,receiveShadow:!0},STACK:{dontRound:!0,gen:ld=>rd(ld,"models/stack_0.obj","textures/stack_0.png",sd.crateScale),dummy:!1,castShadow:!0,receiveShadow:!0},BARREL:{dontRound:!0,complex:!0,gen:ld=>rd(ld,"models/barrel_0.obj","textures/barrel_0.png",sd.barrelScale),castShadow:!0,receiveShadow:!0},VEHICLE:{dontRound:!0,complex:!0,gen:ld=>rd(ld,"models/vehicle_0.obj","textures/vehicle_0.png",sd.vehicleScale),castShadow:!0,receiveShadow:!0},LADDER:{defaultSize:[2,10,4],scalable:!0,scaleWithSize:!1,hideBoundingBox:!1,texturable:!1,genGeo:async ld=>id(...ld),customDirection:!0,stepSrc:"a",dummy:!1,castShadow:!0,receiveShadow:!0},CUBE:{defaultSize:[4,4,4],scalable:!0,scaleWithSize:!1,editDarkness:!0,hideBoundingBox:!1,texturable:!0,genGeo:async ld=>id(...ld),stepSrc:"a",dummy:!1,castShadow:!0,receiveShadow:!0},RAMP:{defaultSize:[10,5,10],scalable:!0,scaleWithSize:!1,hideBoundingBox:!1,texturable:!0,genGeo:async ld=>function(pd){let ud=pd/2,gd=NaN,hd=NaN,fd=new nd.BufferGeometry,yd=new Float32Array([-ud,-hd,-gd,-ud,-hd,gd,ud,hd,gd,ud,hd,gd,ud,hd,-gd,-ud,-hd,-gd]);ud=Math.sqrt(Math.pow(ud,2)+Math.pow(hd,2));let xd=new Float32Array([-ud,-gd,-ud,gd,ud,gd,ud,gd,ud,-gd,-ud,-gd]),vd=-hd,Ld=new Float32Array([vd,gd,0,vd,gd,0,vd,gd,0,vd,gd,0,vd,gd,0,vd,gd,0]);return fd.addAttribute("position",new nd.BufferAttribute(yd,3)),fd.addAttribute("uv",new nd.BufferAttribute(xd,2)),fd.addAttribute("normal",new nd.BufferAttribute(Ld,3)),fd}(...ld),shootable:!0,customDirection:!0,stepSrc:"a",dummy:!1,castShadow:!0,receiveShadow:!0},PLANE:{defaultSize:[4,0.01,4],dontRound:!0,scalable:!0,canTerrain:!0,scaleWithSize:!1,editDarkness:!0,hideBoundingBox:!1,texturable:!0,genGeo:async ld=>function(pd,cd){let md=new nd.PlaneBufferGeometry(pd,cd);md.rotateX(-Math.PI/2);let ud=md.getAttribute("position"),gd=md.getAttribute("uv");for(let hd=0;hd<gd.count;hd++)gd.setXY(hd,ud.getX(hd),ud.getZ(hd));return md}(ld[0],ld[2]),stepSrc:"a",dummy:!1,castShadow:!0,receiveShadow:!0},SPAWN_POINT:{defaultSize:[8,8,8],scalable:!1,scaleWithSize:!1,hideBoundingBox:!0,editorGen:ld=>od(ld,"img/favicon.png",8),stepSrc:"a",assignTeam:!0,dummy:!1,castShadow:!1,receiveShadow:!1},CAMERA_POSITION:{defaultSize:[2,2,2],scalable:!1,scaleWithSize:!1,hideBoundingBox:!0,editorGen:ld=>od(ld,"img/crosshair.png",5),stepSrc:"a",dummy:!1,castShadow:!1,receiveShadow:!1}},ed.exports.texturePrefabs={DEFAULT:{src:"default",filter:nd.NearestFilter},DIRT:{src:"dirt_0",filter:nd.NearestFilter},FLOOR:{src:"floor_0",filter:nd.NearestFilter},ORANGE:{src:"orange_0",filter:nd.NearestFilter},GREY:{src:"grey_0",filter:nd.NearestFilter},WALL:{src:"wall_0",filter:nd.NearestFilter},WATER:{src:"water_0",filter:nd.NearestFilter},ROOF:{src:"roof_0",filter:nd.NearestFilter}},ed.exports.loadTexturePrefab=function(ld){let pd=ed.exports.texturePrefabs[ld];return dd.load("/textures/"+pd.src+".png",cd=>{cd.wrapS=nd.RepeatWrapping,cd.wrapT=nd.RepeatWrapping,cd.minFilter=pd.filter,cd.magFilter=pd.filter,cd.repeat.set(1/sd.worldUV,1/sd.worldUV),cd.needsUpdate=!0})}},function(ed,td,ad){const rd=ad(1);ed.exports.biomes=[{name:"Desert",sky:14477549,fog:11447982,fogD:950,light:16777215,ambient:11511205,terrain:"dirt_0",particles:function(dd,ld){dd.area(0,0,0,ld,10,{src:"fog_0",count:Math.round(ld/15),spd:.01,scl:[50,60],dir:0})}},{name:"Snow",sky:15727359,fog:15397375,fogD:800,light:16777215,ambient:10988727,terrain:"snow_0",particles:function(dd,ld){dd.area(0,0,0,ld,20,{src:"fog_0",count:Math.round(ld/15),spd:.005,scl:[50,60],dir:0}),dd.area(0,0,0,ld,100,{src:"glow_0",blending:2,count:Math.round(ld/2),spd:.01,grav:[-0.02,-0.01],scl:[0.7,1],dir:0})}},{name:"Orange",sky:14477549,fog:16772317,fogD:850,light:16772317,ambient:13417905}],ed.exports.modes=[{id:"ffa",name:"Free for All",alias:"ffa"},{id:"tdm",name:"Team Deathmatch",alias:"tdm",teams:!0}];for(var id=[{name:"Burg",modes:[0],biomes:[1],shadScale:380,camPos:[0,70,0],spawns:[[332,0,52],[255,0,215],[41,0,-271],[-309,0,-216],[-307,0,108],[94,0,-361],[263,0,-217],[-103,0,227],[332,0,-53]],objects:[{id:4,p:[0,0,0],s:[751,0,921],v:1,ter:1,t:"DIRT"},{id:0,p:[-354,0,0],s:[12,76,500],t:"WALL"},{id:0,p:[354,0,0],s:[12,76,500],t:"WALL"},{id:0,p:[0,0,257],s:[700,76,18],t:"WALL"},{id:0,p:[-1,0,0],s:[50,26,46],t:"WALL"},{id:0,p:[-2,30,0],s:[28,44,28],da:1.1,t:"WALL"},{id:0,p:[-2,26,0],s:[38,4,36],da:1.04,t:"WALL"},{id:2,p:[-75,0,-43],s:[7,8,7]},{id:0,p:[261,0,241],s:[174,70,14],da:.88,t:"WALL"},{id:0,p:[230,0,173],s:[112,70,46],da:.88,t:"WALL"},{id:0,p:[258,0,111],s:[56,70,78],da:.88,t:"WALL"},{id:0,p:[340,0,-153],s:[16,74,162],da:1.3,t:"WALL"},{id:0,p:[253,40,215],s:[158,30,38],da:.86,t:"WALL"},{id:0,p:[227,0,-173],s:[118,74,46],da:1.28,t:"WALL"},{id:0,p:[258,0,-241],s:[180,74,14],da:1.28,t:"WALL"},{id:0,p:[318,0,153],s:[64,70,162],da:.88,t:"WALL"},{id:0,p:[309,40,-134],s:[46,34,124],da:1.26,t:"WALL"},{id:0,p:[250,40,-215],s:[164,34,38],da:1.28,t:"WALL"},{id:0,p:[-230,0,-173],s:[112,90,46],da:1.21,t:"WALL"},{id:0,p:[-261,0,-274],s:[174,90,80],da:1.17,t:"WALL"},{id:0,p:[-342,0,-153],s:[20,90,162],da:1.21,t:"WALL"},{id:0,p:[-309,40,-134],s:[46,50,124],da:1.21,t:"WALL"},{id:0,p:[-253,40,-215],s:[158,50,38],da:1.19,t:"WALL"},{id:0,p:[-253,0,199],s:[158,84,98],da:1.37,t:"WALL"},{id:0,p:[-340,0,153],s:[16,84,162],da:1.37,t:"WALL"},{id:0,p:[-309,40,111],s:[46,44,78],da:1.37,t:"WALL"},{id:0,p:[7,0,-195],s:[182,86,106],da:1.23,t:"WALL"},{id:0,p:[75,0,195],s:[82,94,106],da:1.21,t:"WALL"},{id:0,p:[-134,0,-85],s:[68,94,24],da:.84,t:"WALL"},{id:0,p:[258,0,-111],s:[56,74,78],da:1.28,t:"WALL"},{id:0,p:[-258,0,-111],s:[56,54,78],da:1.06,t:"WALL"},{id:0,p:[-258,0,111],s:[56,84,78],da:1.37,t:"WALL"},{id:0,p:[-73,-1,147],s:[132,78,114],da:1.39,t:"WALL"},{id:0,p:[156,0,-74],s:[44,150,50],da:1.41,t:"WALL"},{id:1,p:[11,0,-136],s:[12,12,12]},{id:2,p:[181,0,146],s:[7,8,7]},{id:1,p:[193,0,144],s:[12,12,12]},{id:2,p:[182,0,-78],s:[7,8,7]},{id:1,p:[-90,0,-176],s:[12,12,12]},{id:2,p:[104,0,99],s:[7,8,7]},{id:1,p:[-275,0,-202],s:[12,12,12]},{id:2,p:[-291,0,124],s:[7,8,7]},{id:0,p:[-89,0,-45],s:[22,96,116],da:.84,t:"WALL"},{id:0,p:[-115,0,70],s:[118,88,40],da:1.1,t:"WALL"},{id:0,p:[-151,0,7],s:[34,70,86],da:1.32,t:"WALL"},{id:0,p:[92,0,-72],s:[84,82,38],da:1.1,t:"WALL"},{id:0,p:[89,0,51],s:[22,70,88],t:"WALL"},{id:0,p:[135,0,81],s:[70,70,28],col:1,t:"WALL"},{id:0,p:[283,0,-1],s:[132,100,70],t:"WALL"},{id:0,p:[-317,0,0],s:[64,104,66],da:1.48,t:"WALL"},{id:3,p:[116,0,196],s:[2,62,12],d:0},{id:0,p:[90,48,159],s:[78,2,60],t:"FLOOR"},{id:0,p:[170,0,102],s:[8,2,8],col:1,t:"WALL"},{id:0,p:[106,0,24],s:[4,2,8],col:1,t:"WALL"},{id:0,p:[-49,0,82],s:[8,2,8],col:1,t:"WALL"},{id:0,p:[-70,0,-97],s:[8,2,8],col:1,t:"WALL"},{id:0,p:[38,0,-84],s:[8,2,8],col:1,t:"WALL"},{id:0,p:[-235,0,27],s:[8,2,8],col:1,t:"WALL"},{id:0,p:[-178,0,42],s:[8,2,4],col:1,t:"WALL"},{id:0,p:[-174,0,-75],s:[4,2,10],col:1,t:"WALL"},{id:0,p:[-167,0,-178],s:[10,2,10],col:1,t:"WALL"},{id:0,p:[69,0,93],s:[8,2,4],col:1,t:"WALL"},{id:0,p:[36,0,-29],s:[10,2,6],col:1,t:"WALL"},{id:0,p:[-191,0,143],s:[8,2,8],col:1,t:"WALL"},{id:0,p:[-220,0,-136],s:[10,6,18],t:"WALL"},{id:0,p:[-209,0,-140],s:[4,2,8],col:1,t:"WALL"},{id:0,p:[-224,0,-120],s:[8,2,8],col:1,t:"WALL"},{id:0,p:[-107,0,-104],s:[10,2,6],col:1,t:"WALL"},{id:0,p:[163,0,-149],s:[8,2,4],col:1,da:.84,t:"WALL"},{id:0,p:[291,-1,-197],s:[8,2,8],col:1,t:"WALL"},{id:0,p:[-340,0,40],s:[8,2,6],col:1,t:"WALL"},{id:0,p:[-168,0,188],s:[8,2,14],col:1,da:1.04,t:"WALL"},{id:0,p:[-32,48,-174],s:[130,2,90],t:"FLOOR"},{id:3,p:[-84,0,-225],s:[2,62,10],d:2},{id:0,p:[63,46,135],s:[2,2,14],col:1,da:.86,t:"FLOOR"},{id:0,p:[88,46,135],s:[2,2,14],col:1,da:.84,t:"FLOOR"},{id:0,p:[110,46,135],s:[2,2,14],col:1,da:.79,t:"FLOOR"},{id:0,p:[123,46,146],s:[14,2,2],col:1,da:.86,t:"FLOOR"},{id:0,p:[123,46,163],s:[14,2,2],col:1,da:.88,t:"FLOOR"},{id:0,p:[123,46,184],s:[14,2,2],col:1,da:.84,t:"FLOOR"},{id:0,p:[-38,46,-135],s:[2,2,14],col:1,da:.88,t:"FLOOR"},{id:0,p:[-69,46,-135],s:[2,2,14],col:1,da:.82,t:"FLOOR"},{id:0,p:[-91,46,-149],s:[14,2,2],col:1,da:.88,t:"FLOOR"},{id:0,p:[-91,46,-175],s:[14,2,2],col:1,da:.84,t:"FLOOR"},{id:0,p:[-91,46,-201],s:[14,2,2],col:1,da:.86,t:"FLOOR"},{id:0,p:[-8,46,-135],s:[2,2,14],col:1,da:.88,t:"FLOOR"},{id:0,p:[24,46,-135],s:[2,2,14],col:1,da:.88,t:"FLOOR"},{id:0,p:[7,86,-195],s:[192,10,116],da:.99,t:"ROOF"},{id:0,p:[75,92,195],s:[94,8,118],da:.79,t:"ROOF"},{id:0,p:[156,107,-74],s:[52,4,10],col:1,da:.95,t:"WALL"},{id:0,p:[156,111,-74],s:[46,24,6],col:1,da:.13,t:"WALL"},{id:0,p:[156,107,-74],s:[10,4,56],col:1,da:.88,t:"WALL"},{id:0,p:[156,111,-74],s:[6,24,52],col:1,da:.13,t:"WALL"},{id:0,p:[139,150,-93],s:[10,6,12],col:1,da:1.41,t:"WALL"},{id:0,p:[138,150,-56],s:[8,6,14],col:1,da:1.41,t:"WALL"},{id:0,p:[136,150,-74],s:[4,6,8],col:1,da:1.41,t:"WALL"},{id:0,p:[176,150,-93],s:[4,6,12],col:1,da:1.41,t:"WALL"},{id:0,p:[176,150,-74],s:[4,4,16],col:1,da:1.41,t:"WALL"},{id:0,p:[169,150,-52],s:[18,6,6],col:1,da:1.41,t:"WALL"},{id:0,p:[149,150,-52],s:[6,4,6],col:1,da:1.41,t:"WALL"},{id:0,p:[159,150,-96],s:[14,6,6],col:1,da:1.41,t:"WALL"},{id:0,p:[94,82,-72],s:[94,6,44],da:.84,t:"ROOF"},{id:0,p:[232,74,-136],s:[4,6,20],col:1,da:1.28,t:"WALL"},{id:0,p:[232,74,-103],s:[4,4,18],col:1,da:1.28,t:"WALL"},{id:0,p:[239,74,-76],s:[18,4,8],col:1,da:1.28,t:"WALL"},{id:0,p:[270,74,-74],s:[18,6,4],col:1,da:1.28,t:"WALL"},{id:0,p:[298,74,-74],s:[14,6,4],col:1,da:1.28,t:"WALL"},{id:0,p:[326,74,-74],s:[22,4,4],col:1,da:1.28,t:"WALL"},{id:0,p:[204,74,-152],s:[18,6,4],col:1,da:1.28,t:"WALL"},{id:0,p:[174,74,-158],s:[12,6,16],col:1,da:1.28,t:"WALL"},{id:0,p:[171,74,-188],s:[6,4,16],col:1,da:1.28,t:"WALL"},{id:0,p:[171,74,-228],s:[6,6,24],col:1,da:1.28,t:"WALL"},{id:0,p:[98,53,-219],s:[2,20,8],col:1,da:.13,t:"WALL"},{id:0,p:[99,49,-219],s:[4,4,12],col:1,da:.79,t:"WALL"},{id:0,p:[144,70,94],s:[18,4,2],col:1,t:"WALL"},{id:0,p:[121,70,94],s:[12,6,2],col:1,t:"WALL"},{id:0,p:[105,70,94],s:[8,4,2],col:1,t:"WALL"},{id:0,p:[82,70,90],s:[8,4,10],col:1,t:"WALL"},{id:0,p:[157,70,68],s:[10,4,2],col:1,t:"WALL"},{id:0,p:[135,70,68],s:[22,2,2],col:1,t:"WALL"},{id:0,p:[112,70,68],s:[8,4,2],col:1,t:"WALL"},{id:0,p:[167,70,90],s:[6,4,10],col:1,t:"WALL"},{id:0,p:[80,70,-17],s:[4,4,10],col:1,t:"WALL"},{id:0,p:[80,70,12],s:[4,4,18],col:1,t:"WALL"},{id:0,p:[80,70,52],s:[4,4,18],col:1,t:"WALL"},{id:0,p:[98,70,38],s:[4,4,26],col:1,t:"WALL"},{id:0,p:[98,70,4],s:[4,4,8],col:1,t:"WALL"},{id:0,p:[50,40,-71],s:[2,24,6],col:1,da:.13,t:"WALL"},{id:0,p:[49,36,-71],s:[4,4,12],da:.59,t:"WALL"},{id:0,p:[-322,104,-31],s:[20,6,4],col:1,da:1.48,t:"WALL"},{id:0,p:[-295,104,-24],s:[20,6,18],col:1,da:1.48,t:"WALL"},{id:0,p:[-295,104,28],s:[20,6,10],col:1,da:1.48,t:"WALL"},{id:0,p:[-336,104,31],s:[26,8,4],col:1,da:1.48,t:"WALL"},{id:0,p:[-287,104,5],s:[4,4,20],col:1,da:1.48,t:"WALL"},{id:0,p:[-174,57,70],s:[2,24,6],col:1,da:.13,t:"WALL"},{id:0,p:[-175,53,70],s:[4,4,12],col:1,da:.79,t:"WALL"},{id:0,p:[-115,88,70],s:[124,6,46],da:1.1,t:"ROOF"},{id:0,p:[-80,96,-13],s:[4,4,22],col:1,da:.84,t:"WALL"},{id:0,p:[-80,96,-43],s:[4,4,16],col:1,da:.84,t:"WALL"},{id:0,p:[-80,96,-71],s:[4,4,18],col:1,da:.84,t:"WALL"},{id:0,p:[-84,96,-97],s:[12,6,12],col:1,da:.84,t:"WALL"},{id:0,p:[-98,96,-73],s:[4,4,24],col:1,da:.84,t:"WALL"},{id:0,p:[-95,96,1],s:[10,4,24],col:1,da:.84,t:"WALL"},{id:0,p:[-98,96,-36],s:[4,6,14],col:1,da:.84,t:"WALL"},{id:0,p:[-161,94,-93],s:[14,4,8],col:1,da:.84,t:"WALL"},{id:0,p:[-116,94,-95],s:[14,6,4],col:1,da:.84,t:"WALL"},{id:0,p:[-139,94,-95],s:[14,4,4],col:1,da:.84,t:"WALL"},{id:0,p:[-153,94,-75],s:[14,4,4],col:1,da:.84,t:"WALL"},{id:0,p:[-127,94,-75],s:[12,6,4],col:1,da:.84,t:"WALL"},{id:0,p:[240,60,205],s:[112,54,86],da:.88,t:"WALL"},{id:0,p:[295,67,172],s:[106,72,172],da:.88,t:"WALL"},{id:0,p:[294,135,172],s:[112,8,180],da:.95,t:"ROOF"},{id:0,p:[236,114,203],s:[112,8,90],da:.95,t:"ROOF"},{id:0,p:[242,100,120],s:[2,24,6],col:1,da:.13,t:"WALL"},{id:0,p:[212,77,162],s:[12,4,6],col:1,da:.95,t:"WALL"},{id:0,p:[241,96,120],s:[6,4,12],col:1,da:.95,t:"WALL"},{id:0,p:[212,81,162],s:[8,24,2],col:1,da:.13,t:"WALL"},{id:0,p:[-318,90,-111],s:[72,6,86],da:.88,t:"ROOF"},{id:0,p:[-270,90,-232],s:[198,6,172],da:.86,t:"ROOF"},{id:0,p:[-277,54,-75],s:[18,6,6],col:1,da:1.1,t:"WALL"},{id:0,p:[-255,54,-75],s:[12,4,6],col:1,da:1.08,t:"WALL"},{id:0,p:[-236,54,-78],s:[12,6,12],col:1,da:1.01,t:"WALL"},{id:0,p:[-232,54,-121],s:[4,6,22],col:1,da:1.1,t:"WALL"},{id:0,p:[-232,54,-98],s:[4,4,10],col:1,da:1.08,t:"WALL"},{id:0,p:[-232,54,-146],s:[4,4,8],col:1,da:1.06,t:"WALL"},{id:0,p:[-230,45,113],s:[2,24,8],col:1,da:.13,t:"WALL"},{id:0,p:[-229,41,113],s:[4,4,16],col:1,da:.86,t:"WALL"},{id:0,p:[-166,70,42],s:[4,6,16],col:1,da:1.32,t:"WALL"},{id:0,p:[-166,70,15],s:[4,4,12],col:1,da:1.32,t:"WALL"},{id:0,p:[-179,62,-18],s:[22,6,4],col:1,da:1.32,t:"WALL"},{id:0,p:[-161,70,-31],s:[14,6,10],col:1,da:1.32,t:"WALL"},{id:0,p:[-138,70,-22],s:[8,6,28],col:1,da:1.32,t:"WALL"},{id:0,p:[-136,70,41],s:[4,4,18],col:1,da:1.32,t:"WALL"},{id:0,p:[-136,70,13],s:[4,6,16],col:1,da:1.32,t:"WALL"},{id:0,p:[-317,66,0],s:[10,24,68],col:1,da:.13,t:"WALL"},{id:0,p:[-317,62,0],s:[16,4,74],col:1,da:1.06,t:"WALL"},{id:0,p:[-237,84,84],s:[14,6,24],col:1,da:1.37,t:"WALL"},{id:0,p:[-184,84,162],s:[20,6,24],col:1,da:1.37,t:"WALL"},{id:0,p:[-213,84,153],s:[16,8,6],col:1,da:1.37,t:"WALL"},{id:0,p:[-234,84,123],s:[8,4,20],col:1,da:1.37,t:"WALL"},{id:0,p:[-178,84,194],s:[8,4,20],col:1,da:1.37,t:"WALL"},{id:0,p:[-178,84,234],s:[8,6,20],col:1,da:1.37,t:"WALL"},{id:0,p:[-269,84,75],s:[20,8,6],col:1,da:1.37,t:"WALL"},{id:0,p:[-314,84,75],s:[36,4,6],col:1,da:1.37,t:"WALL"},{id:0,p:[234,70,82],s:[8,6,20],col:1,da:.88,t:"WALL"},{id:0,p:[232,70,137],s:[4,4,20],col:1,da:.88,t:"WALL"},{id:0,p:[176,70,231],s:[4,4,18],col:1,da:.88,t:"WALL"},{id:0,p:[176,70,189],s:[4,4,14],col:1,da:.88,t:"WALL"},{id:0,p:[181,70,153],s:[14,4,6],col:1,da:.88,t:"WALL"},{id:0,p:[261,70,75],s:[14,4,6],col:1,da:.88,t:"WALL"},{id:0,p:[302,70,74],s:[30,4,4],col:1,da:.88,t:"WALL"},{id:0,p:[221,70,153],s:[10,4,6],col:1,da:.88,t:"WALL"},{id:1,p:[-326,0,121],s:[12,12,12]},{id:0,p:[-295,0,79],s:[8,2,8],col:1,t:"WALL"},{id:0,p:[269,0,205],s:[8,2,8],col:1,t:"WALL"},{id:1,p:[210,0,228],s:[12,12,12]},{id:0,p:[-333,0,-39],s:[12,2,8],col:1,t:"WALL"},{id:1,p:[202,0,-202],s:[12,12,12]},{id:0,p:[-46,-11,384],s:[70,198,72],da:1.57,t:"WALL"},{id:0,p:[-22,187,352],s:[22,6,8],col:1,da:1.57,t:"WALL"},{id:0,p:[-46,118,346],s:[18,6,4],col:1,da:1.01,t:"WALL"},{id:0,p:[-73,187,356],s:[16,8,16],col:1,da:1.57,t:"WALL"},{id:0,p:[-77,187,390],s:[8,6,16],col:1,da:1.57,t:"WALL"},{id:0,p:[-15,187,388],s:[8,4,24],col:1,da:1.57,t:"WALL"},{id:0,p:[-46,124,348],s:[8,36,2],col:1,da:.13,t:"WALL"},{id:0,p:[-50,187,352],s:[16,4,8],col:1,da:1.57,t:"WALL"},{id:0,p:[-142,76,250],s:[32,6,4],col:1,da:1.04,t:"WALL"},{id:0,p:[-88,76,250],s:[24,4,4],col:1,da:1.04,t:"WALL"},{id:0,p:[-26,76,250],s:[20,8,4],col:1,da:1.04,t:"WALL"},{id:0,p:[142,76,250],s:[24,4,4],col:1,da:1.04,t:"WALL"},{id:0,p:[101,76,-252],s:[14,6,8],col:1,da:1.04,t:"WALL"},{id:0,p:[350,76,48],s:[4,4,20],col:1,da:1.04,t:"WALL"},{id:0,p:[350,76,-60],s:[4,4,12],col:1,da:1.04,t:"WALL"},{id:0,p:[350,76,-23],s:[4,2,22],col:1,da:1.04,t:"WALL"},{id:0,p:[-350,76,-60],s:[4,4,12],col:1,da:1.04,t:"WALL"},{id:0,p:[-350,76,37],s:[4,4,30],col:1,da:1.04,t:"WALL"},{id:0,p:[85,0,-292],s:[46,76,88],t:"WALL"},{id:0,p:[172,0,-314],s:[42,76,132],t:"WALL"},{id:0,p:[96,0,-384],s:[202,88,8],da:1.52,t:"WALL"},{id:0,p:[-64,0,-341],s:[164,88,92],da:1.48,t:"WALL"},{id:0,p:[158,76,-252],s:[14,6,8],col:1,da:1.04,t:"WALL"},{id:0,p:[105,76,-277],s:[6,6,20],col:1,da:1.04,t:"WALL"},{id:0,p:[99,76,-330],s:[18,6,12],col:1,da:1.04,t:"WALL"},{id:0,p:[154,76,-284],s:[6,4,28],col:1,da:1.04,t:"WALL"},{id:0,p:[154,76,-334],s:[6,8,18],col:1,da:1.04,t:"WALL"},{id:0,p:[76,43,-380],s:[6,20,2],col:1,da:.13,t:"WALL"},{id:0,p:[76,38,-380],s:[12,6,6],col:1,da:1.04,t:"WALL"},{id:0,p:[142,88,-382],s:[18,6,4],col:1,da:1.52,t:"WALL"},{id:0,p:[186,88,-382],s:[22,4,4],col:1,da:1.52,t:"WALL"},{id:0,p:[103,88,-382],s:[28,2,4],col:1,da:1.52,t:"WALL"},{id:0,p:[16,88,-376],s:[4,6,16],col:1,da:1.52,t:"WALL"},{id:0,p:[-2,88,-307],s:[40,6,24],col:1,da:1.52,t:"WALL"},{id:0,p:[16,88,-345],s:[4,4,24],col:1,da:1.52,t:"WALL"},{id:0,p:[-137,88,-307],s:[18,4,24],col:1,da:1.52,t:"WALL"},{id:0,p:[-49,88,-297],s:[12,6,4],col:1,da:1.52,t:"WALL"},{id:0,p:[-96,88,-297],s:[30,4,4],col:1,da:1.52,t:"WALL"},{id:1,p:[114,0,-327],s:[12,12,12]},{id:0,p:[142,0,-320],s:[8,2,6],col:1,da:.84,t:"WALL"},{id:2,p:[130,0,-95],s:[7,8,7]},{id:0,p:[49,88,-382],s:[36,4,4],col:1,da:1.52,t:"WALL"},{id:2,p:[58,0,-291],s:[7,8,7]},{id:0,p:[65,76,-302],s:[6,4,28],col:1,da:1.04,t:"WALL"},{id:0,p:[65,76,-262],s:[6,6,20],col:1,da:1.04,t:"WALL"},{id:0,p:[-160,0,-309],s:[28,76,10],da:1.01,t:"WALL"},{id:0,p:[-157,76,-306],s:[12,4,4],da:1.01,t:"WALL"},{id:1,p:[-2,0,-289],s:[12,12,12]},{id:0,p:[-86,0,-256],s:[10,2,10],col:1,t:"WALL"},{id:2,p:[-170,0,-300],s:[7,8,7]},{id:0,p:[24,0,-329],s:[10,2,10],col:1,t:"WALL"},{id:0,p:[21,79,-303],s:[8,4,4],col:1,da:.86,t:"FLOOR"},{id:0,p:[21,79,-342],s:[8,4,4],col:1,da:.86,t:"FLOOR"},{id:0,p:[-174,46,-269],s:[2,20,8],col:1,da:.13,t:"WALL"},{id:0,p:[-172,43,-269],s:[6,4,14],col:1,da:.84,t:"WALL"},{id:0,p:[5,79,-292],s:[4,4,8],col:1,da:.86,t:"FLOOR"},{id:0,p:[-31,79,-292],s:[4,4,8],col:1,da:.86,t:"FLOOR"},{id:0,p:[-64,79,-292],s:[4,4,8],col:1,da:.86,t:"FLOOR"},{id:0,p:[-97,79,-292],s:[4,4,8],col:1,da:.86,t:"FLOOR"},{id:0,p:[-133,79,-292],s:[4,4,8],col:1,da:.86,t:"FLOOR"},{id:0,p:[-256,0,0],s:[60,62,40],da:1.32,t:"WALL"},{id:0,p:[-176,0,0],s:[16,62,40],da:1.32,t:"WALL"},{id:0,p:[-205,40,0],s:[42,22,40],da:1.32,t:"WALL"},{id:0,p:[-221,62,-18],s:[28,4,4],col:1,da:1.32,t:"WALL"},{id:0,p:[-259,62,-18],s:[14,6,4],col:1,da:1.32,t:"WALL"},{id:0,p:[-278,62,18],s:[14,6,4],col:1,da:1.32,t:"WALL"},{id:0,p:[-244,62,18],s:[24,4,4],col:1,da:1.32,t:"WALL"},{id:0,p:[-198,62,18],s:[24,6,4],col:1,da:1.32,t:"WALL"},{id:0,p:[-181,56,0],s:[4,4,50],col:1,da:.86,t:"FLOOR"},{id:0,p:[-211,56,0],s:[4,4,50],col:1,da:.86,t:"FLOOR"},{id:0,p:[-242,56,0],s:[4,4,50],col:1,da:.86,t:"FLOOR"},{id:0,p:[-275,56,0],s:[4,4,50],col:1,da:.86,t:"FLOOR"},{id:0,p:[-216,0,0],s:[20,40,2],da:1.04,t:"FLOOR"},{id:0,p:[-185,0,-6],s:[2,40,18],da:1.01,t:"FLOOR"},{id:0,p:[-188,0,-233],s:[20,40,2],da:1.04,t:"FLOOR"},{id:0,p:[-179,0,-205],s:[2,40,18],da:1.04,t:"FLOOR"},{id:0,p:[172,0,-205],s:[2,40,18],da:1.04,t:"FLOOR"},{id:0,p:[180,0,-233],s:[18,40,2],da:1.04,t:"FLOOR"},{id:0,p:[287,0,-84],s:[2,40,18],da:1.04,t:"FLOOR"},{id:0,p:[323,0,-76],s:[18,40,2],da:1.04,t:"FLOOR"},{id:0,p:[-287,0,-68],s:[2,40,18],da:1.04,t:"FLOOR"},{id:0,p:[-321,0,-77],s:[22,40,2],da:1.04,t:"FLOOR"},{id:1,p:[287,0,66],s:[12,12,12]},{id:0,p:[338,70,74],s:[10,4,4],col:1,da:.88,t:"WALL"},{id:0,p:[168,70,72],s:[4,4,10],col:1,t:"WALL"},{id:0,p:[80,70,75],s:[4,2,10],col:1,t:"WALL"},{id:1,p:[30,0,-12],s:[12,12,12]},{id:1,p:[-168,0,-265],s:[12,12,12]},{id:0,p:[89,42,-15],s:[22,28,44],t:"WALL"},{id:0,p:[98,70,-36],s:[4,4,26],col:1,t:"WALL"},{id:0,p:[80,70,-47],s:[4,6,16],col:1,t:"WALL"},{id:0,p:[89,0,-46],s:[22,70,18],t:"WALL"},{id:0,p:[82,0,-3],s:[2,42,22],da:1.01,t:"FLOOR"},{id:0,p:[70,0,-36],s:[20,42,2],da:1.01,t:"FLOOR"},{id:0,p:[-15,77,194],s:[16,6,20],col:1,da:1.37,t:"WALL"},{id:0,p:[-15,77,100],s:[16,6,20],col:1,da:1.37,t:"WALL"},{id:0,p:[-131,77,188],s:[16,6,32],col:1,da:1.37,t:"WALL"},{id:0,p:[-10,77,129],s:[6,4,12],col:1,da:1.37,t:"WALL"},{id:0,p:[-10,77,156],s:[6,8,12],col:1,da:1.37,t:"WALL"},{id:0,p:[-42,77,93],s:[12,4,6],col:1,da:1.37,t:"WALL"},{id:0,p:[-39,77,201],s:[12,4,6],col:1,da:1.37,t:"WALL"},{id:0,p:[-100,77,201],s:[26,4,6],col:1,da:1.37,t:"WALL"},{id:0,p:[-65,77,201],s:[22,6,6],col:1,da:1.37,t:"WALL"},{id:0,p:[-136,77,141],s:[6,4,16],col:1,da:1.37,t:"WALL"},{id:0,p:[-136,77,98],s:[6,6,20],col:1,da:1.37,t:"WALL"},{id:0,p:[-19,66,147],s:[4,4,128],col:1,da:.86,t:"FLOOR"},{id:0,p:[-73,66,101],s:[146,4,4],col:1,da:.86,t:"FLOOR"},{id:0,p:[-73,66,132],s:[146,4,4],col:1,da:.86,t:"FLOOR"},{id:0,p:[-73,66,165],s:[146,4,4],col:1,da:.86,t:"FLOOR"},{id:0,p:[-73,66,196],s:[146,4,4],col:1,da:.86,t:"FLOOR"},{id:0,p:[-44,66,147],s:[4,4,128],col:1,da:.86,t:"FLOOR"},{id:0,p:[-71,66,147],s:[4,4,128],col:1,da:.86,t:"FLOOR"},{id:0,p:[-98,66,147],s:[4,4,128],col:1,da:.86,t:"FLOOR"},{id:0,p:[-126,66,147],s:[4,4,128],col:1,da:.86,t:"FLOOR"},{id:1,p:[-263,0,-202],s:[12,12,12]},{id:1,p:[30,0,0],s:[12,12,12]},{id:1,p:[30,12,-7],s:[12,12,12]},{id:1,p:[-1,0,174],s:[12,12,12]},{id:1,p:[231,0,-228],s:[12,12,12]},{id:1,p:[231,12,-228],s:[12,12,12]},{id:1,p:[56,0,-301],s:[12,12,12]},{id:2,p:[55,50,133],s:[7,8,7]},{id:2,p:[-30,0,-19],s:[7,8,7]},{id:1,p:[292,0,-147],s:[12,12,12]},{id:2,p:[-161,0,-101],s:[7,8,7]},{id:0,p:[-11,0,63],s:[2,24,2],t:"FLOOR"},{id:0,p:[-118,0,-106],s:[2,80,2],t:"FLOOR"},{id:0,p:[-154,0,-106],s:[2,84,2],da:.95,t:"FLOOR"},{id:0,p:[-136,36,-102],s:[34,2,10],da:.95,t:"FLOOR"},{id:0,p:[-11,0,89],s:[2,24,2],da:.88,t:"FLOOR"},{id:0,p:[235,56,87],s:[26,2,44],da:.71,t:"FLOOR"},{id:0,p:[-136,74,-102],s:[34,2,10],da:.95,t:"FLOOR"},{id:0,p:[-170,79,-164],s:[8,4,4],col:1,da:.88,t:"FLOOR"},{id:1,p:[-1,0,-136],s:[12,12,12]},{id:1,p:[3,12,-136],s:[12,12,12]},{id:0,p:[-95,0,-131],s:[2,48,2],da:.86,t:"FLOOR"},{id:0,p:[-95,0,-217],s:[2,48,2],da:.86,t:"FLOOR"},{id:0,p:[31,0,-131],s:[2,48,2],da:.86,t:"FLOOR"},{id:0,p:[53,0,131],s:[2,48,2],t:"FLOOR"},{id:0,p:[127,0,131],s:[2,48,2],t:"FLOOR"},{id:0,p:[127,0,187],s:[2,48,2],t:"FLOOR"},{id:0,p:[246,0,67],s:[2,74,2],da:.84,t:"FLOOR"},{id:0,p:[224,0,67],s:[2,64,2],da:.84,t:"FLOOR"},{id:0,p:[224,0,107],s:[2,68,2],da:.84,t:"FLOOR"},{id:0,p:[235,28,87],s:[26,2,44],da:.57,t:"FLOOR"},{id:0,p:[223,0,74],s:[8,2,8],col:1,t:"WALL"},{id:0,p:[-71,82,-1],s:[14,4,4],col:1,da:.88,t:"FLOOR"},{id:0,p:[-170,79,-195],s:[8,4,4],col:1,da:.88,t:"FLOOR"},{id:0,p:[-170,79,-231],s:[8,4,4],col:1,da:.88,t:"FLOOR"},{id:0,p:[-170,79,-267],s:[8,4,4],col:1,da:.88,t:"FLOOR"},{id:0,p:[156,98,-74],s:[4,4,64],col:1,da:.88,t:"FLOOR"},{id:0,p:[156,98,-74],s:[58,4,4],col:1,da:.88,t:"FLOOR"},{id:1,p:[162,0,-163],s:[12,12,12]},{id:0,p:[-9,7,75],s:[2,6,30],da:.86,t:"FLOOR"},{id:0,p:[-9,15,75],s:[2,6,32],da:.77,t:"FLOOR"},{id:0,p:[-102,26,32],s:[64,2,38],da:.71,t:"FLOOR"},{id:1,p:[-81,28,19],s:[12,12,12]},{id:0,p:[-72,0,8],s:[8,2,8],col:1,t:"WALL"},{id:0,p:[-60,0,44],s:[6,2,8],col:1,t:"WALL"},{id:2,p:[-130,28,46],s:[7,8,7]},{id:0,p:[-74,0,15],s:[2,30,2],da:.84,t:"FLOOR"},{id:1,p:[-93,0,19],s:[12,12,12]},{id:1,p:[-93,12,19],s:[12,12,12]},{id:0,p:[-72,0,49],s:[2,34,2],da:.84,t:"FLOOR"},{id:0,p:[-75,0,212],s:[8,2,8],col:1,da:1.04,t:"WALL"},{id:0,p:[-223,0,-230],s:[8,2,4],col:1,t:"WALL"},{id:0,p:[-133,0,15],s:[2,26,2],da:.84,t:"FLOOR"},{id:0,p:[-133,0,49],s:[2,30,2],da:.84,t:"FLOOR"},{id:3,p:[-134,0,7],s:[2,44,8],d:0},{id:1,p:[118,0,61],s:[12,12,12]},{id:1,p:[142,0,-43],s:[12,12,12]},{id:1,p:[154,0,-43],s:[12,12,12]},{id:1,p:[149,12,-43],s:[12,12,12]},{id:1,p:[147,0,8],s:[12,12,12]},{id:2,p:[156,0,9],s:[7,8,7]},{id:0,p:[320,0,-43],s:[8,2,8],col:1,t:"WALL"},{id:0,p:[177,53,79],s:[14,4,4],da:.88,t:"FLOOR"},{id:1,p:[147,12,8],s:[12,12,12]},{id:0,p:[174,0,-41],s:[4,2,8],col:1,t:"WALL"},{id:0,p:[173,26,-63],s:[26,2,44],da:.57,t:"FLOOR"},{id:0,p:[184,0,-43],s:[2,72,2],da:.84,t:"FLOOR"},{id:0,p:[184,0,-83],s:[2,70,2],da:.84,t:"FLOOR"},{id:0,p:[162,0,-43],s:[2,70,2],da:.84,t:"FLOOR"},{id:0,p:[173,64,-63],s:[26,2,44],da:.82,t:"FLOOR"},{id:2,p:[128,0,63],s:[7,8,7]},{id:2,p:[214,0,17],s:[7,8,7]},{id:0,p:[223,0,-78],s:[8,2,8],col:1,t:"WALL"},{id:1,p:[-239,0,66],s:[12,12,12]},{id:0,p:[213,0,0],s:[4,2,8],col:1,t:"WALL"},{id:0,p:[224,100,-27],s:[14,4,18],col:1,t:"WALL"},{id:0,p:[220,100,-1],s:[6,6,16],col:1,t:"WALL"},{id:0,p:[225,100,26],s:[16,4,16],col:1,t:"WALL"},{id:0,p:[266,100,31],s:[22,4,6],col:1,t:"WALL"},{id:0,p:[308,100,31],s:[28,6,6],col:1,t:"WALL"},{id:0,p:[257,100,-33],s:[22,4,6],col:1,t:"WALL"},{id:0,p:[311,100,-33],s:[36,6,6],col:1,t:"WALL"},{id:0,p:[217,54,0],s:[2,24,6],col:1,da:.13,t:"WALL"},{id:0,p:[217,50,0],s:[6,4,12],col:1,da:.95,t:"WALL"},{id:0,p:[-292,0,-160],s:[8,2,10],col:1,t:"WALL"},{id:2,p:[-281,0,24],s:[7,8,7]},{id:1,p:[-224,0,-107],s:[12,12,12]},{id:0,p:[51,0,-92],s:[2,24,2],t:"FLOOR"},{id:0,p:[51,0,-104],s:[2,22,2],t:"FLOOR"},{id:0,p:[49,5,-98],s:[2,6,18],da:.86,t:"FLOOR"},{id:0,p:[49,13,-98],s:[2,6,16],da:.86,t:"FLOOR"},{id:0,p:[-182,4,89],s:[16,6,2],da:.77,t:"FLOOR"},{id:0,p:[-182,12,89],s:[16,4,2],da:.77,t:"FLOOR"},{id:0,p:[-178,0,87],s:[2,20,2],da:.77,t:"FLOOR"},{id:0,p:[-186,0,87],s:[2,18,2],da:.77,t:"FLOOR"},{id:2,p:[-179,0,82],s:[7,8,7]},{id:0,p:[259,0,-198],s:[4,40,4],da:.86,t:"FLOOR"},{id:0,p:[331,0,-169],s:[4,40,4],da:.86,t:"FLOOR"},{id:0,p:[215,0,196],s:[4,42,4],t:"FLOOR"},{id:0,p:[249,0,234],s:[4,42,4],t:"FLOOR"},{id:0,p:[-253,0,-198],s:[4,40,4],da:.86,t:"FLOOR"},{id:0,p:[-287,0,-149],s:[4,40,4],da:.86,t:"FLOOR"},{id:0,p:[-324,0,-105],s:[8,2,10],col:1,t:"WALL"},{id:7,p:[68,0,65],s:[20,15,51],col:1,r:[0,1.57,0]},{id:7,p:[-250,0,-31],s:[51,15,20],col:1,r:[3.14,0,3.14]},{id:7,p:[161,0,-110],s:[51,15,20],col:1,r:[3.14,0,3.14]},{id:7,p:[-117,0,-285],s:[51,15,20],col:1},{id:0,p:[67,0,65],s:[16,8,48],v:1,t:"WALL"},{id:0,p:[161,0,-110],s:[48,8,18],v:1,t:"WALL"},{id:0,p:[-117,0,-286],s:[48,8,18],v:1,t:"WALL"},{id:0,p:[-250,0,-30],s:[48,8,18],v:1,t:"WALL"},{id:0,p:[-256,7,-30],s:[24,8,16],v:1,t:"WALL"},{id:0,p:[-112,7,-286],s:[24,8,16],v:1,t:"WALL"},{id:0,p:[156,7,-110],s:[24,8,16],v:1,t:"WALL"},{id:0,p:[67,7,60],s:[16,8,24],v:1,t:"WALL"},{id:7,p:[0,0,-34],s:[51,15,20],col:1,r:[3.14,0,3.14]},{id:0,p:[0,0,-33],s:[48,8,18],v:1,t:"WALL"},{id:0,p:[-6,7,-33],s:[24,8,16],v:1,t:"WALL"},{id:8,p:[-72,0,-33],s:[12,12,12]},{id:8,p:[45,0,136],s:[12,12,12]},{id:8,p:[225,0,-42],s:[12,12,12]},{id:8,p:[168,0,174],s:[12,12,12]},{id:8,p:[-168,0,-161],s:[12,12,12]},{id:8,p:[147,0,20],s:[12,12,12]},{id:8,p:[-292,0,-180],s:[12,12,12]},{id:8,p:[104,0,-211],s:[12,12,12]},{id:8,p:[-35,0,210],s:[12,12,12]},{id:0,p:[158,53,101],s:[4,4,12],da:.88,t:"FLOOR"},{id:0,p:[135,0,81],s:[70,82,28],v:1,t:"WALL"},{id:0,p:[357,0,45],s:[18,110,108],v:1,t:"WALL"},{id:0,p:[154,0,256],s:[148,114,16],v:1,t:"WALL"}]},{name:"Throwback",modes:[0,1],biomes:[0,1],shadScale:270,camPos:[0,59,0],spawns:[[-237,0,-124],[-81,0,223],[241,0,124],[75,0,-228]],objects:[{id:4,p:[0,0,0],s:[573,0,531],v:1,ter:1,t:"DEFAULT"},{id:0,p:[-74,0,-201],s:[404,76,10],da:1.32,t:"WALL"},{id:0,p:[-186,0,0],s:[22,22,250],da:1.01,t:"WALL"},{id:1,p:[-130,0,-34],s:[12,12,12]},{id:0,p:[0,0,173],s:[4,26,46],da:1.3,t:"WALL"},{id:0,p:[0,0,-173],s:[4,26,46],da:1.04,t:"WALL"},{id:0,p:[65,0,65],s:[70,92,70],da:1.37,t:"WALL"},{id:0,p:[65,0,-65],s:[70,80,70],da:1.32,t:"WALL"},{id:0,p:[-65,0,65],s:[70,58,70],da:1.34,t:"WALL"},{id:0,p:[-65,0,-65],s:[70,118,70],da:1.3,t:"WALL"},{id:0,p:[87,0,115],s:[4,26,30],da:1.06,t:"WALL"},{id:0,p:[-89,0,-115],s:[4,26,30],da:1.12,t:"WALL"},{id:1,p:[-81,0,-106],s:[12,12,12]},{id:1,p:[-8,0,175],s:[12,12,12]},{id:1,p:[-8,0,163],s:[12,12,12]},{id:1,p:[-8,12,166],s:[12,12,12]},{id:1,p:[39,0,-106],s:[12,12,12]},{id:1,p:[-24,0,39],s:[12,12,12]},{id:1,p:[40,0,-24],s:[12,12,12]},{id:1,p:[-141,0,-190],s:[12,12,12]},{id:7,p:[-28,0,-178],s:[51,15,20],col:1},{id:7,p:[60,0,110],s:[51,15,20],col:1},{id:1,p:[-97,0,-106],s:[12,12,12]},{id:2,p:[-96,0,-26],s:[7,8,7]},{id:2,p:[-95,0,-116],s:[7,8,7]},{id:2,p:[-171,0,-98],s:[7,8,7]},{id:2,p:[170,0,-121],s:[7,8,7]},{id:2,p:[104,0,36],s:[7,8,7]},{id:1,p:[146,0,190],s:[12,12,12]},{id:1,p:[134,0,190],s:[12,12,12]},{id:1,p:[137,12,190],s:[12,12,12]},{id:7,p:[152,0,-1],s:[20,15,51],col:1,r:[0,-1.57,0]},{id:8,p:[84,0,-106],s:[12,12,12]},{id:8,p:[168,0,101],s:[12,12,12]},{id:8,p:[-94,0,126],s:[12,12,12]},{id:8,p:[-169,0,-88],s:[12,12,12]},{id:1,p:[-130,0,-22],s:[12,12,12]},{id:1,p:[-130,12,-22],s:[12,12,12]},{id:1,p:[-142,0,-22],s:[12,12,12]},{id:3,p:[187,0,126],s:[8,24,2],d:1},{id:3,p:[-187,0,-126],s:[8,24,2],d:3},{id:8,p:[-190,0,131],s:[12,12,12]},{id:0,p:[90,81,65],s:[4,4,88],t:"FLOOR"},{id:0,p:[65,81,65],s:[4,4,88],t:"FLOOR"},{id:0,p:[40,81,65],s:[4,4,88],t:"FLOOR"},{id:0,p:[65,81,65],s:[88,4,4],t:"FLOOR"},{id:0,p:[65,81,88],s:[88,4,4],t:"FLOOR"},{id:0,p:[65,81,40],s:[88,4,4],t:"FLOOR"},{id:0,p:[65,69,-64],s:[4,4,88],t:"FLOOR"},{id:0,p:[89,69,-64],s:[4,4,88],t:"FLOOR"},{id:0,p:[40,69,-64],s:[4,4,88],t:"FLOOR"},{id:0,p:[65,69,-43],s:[88,4,4],t:"FLOOR"},{id:0,p:[65,69,-91],s:[88,4,4],t:"FLOOR"},{id:0,p:[65,69,-66],s:[88,4,4],t:"FLOOR"},{id:0,p:[94,92,35],s:[12,6,10],col:1,da:1.37,t:"WALL"},{id:0,p:[94,92,90],s:[12,4,20],col:1,da:1.37,t:"WALL"},{id:0,p:[36,92,37],s:[12,4,14],col:1,da:1.37,t:"WALL"},{id:0,p:[37,92,93],s:[14,6,14],col:1,da:1.37,t:"WALL"},{id:0,p:[37,80,-37],s:[14,6,14],col:1,da:1.37,t:"WALL"},{id:0,p:[37,80,-90],s:[14,6,20],col:1,da:1.37,t:"WALL"},{id:0,p:[95,80,-90],s:[10,8,20],col:1,da:1.37,t:"WALL"},{id:0,p:[92,80,-38],s:[16,6,16],col:1,da:1.37,t:"WALL"},{id:0,p:[98,92,58],s:[4,6,10],col:1,da:1.37,t:"WALL"},{id:0,p:[32,92,66],s:[4,4,18],col:1,da:1.37,t:"WALL"},{id:0,p:[64,92,32],s:[18,4,4],col:1,da:1.37,t:"WALL"},{id:0,p:[61,92,98],s:[22,4,4],col:1,da:1.37,t:"WALL"},{id:0,p:[98,80,-66],s:[4,6,18],col:1,da:1.37,t:"WALL"},{id:0,p:[32,80,-59],s:[4,6,18],col:1,da:1.37,t:"WALL"},{id:0,p:[71,80,-98],s:[18,4,4],col:1,da:1.37,t:"WALL"},{id:0,p:[64,80,-32],s:[18,4,4],col:1,da:1.37,t:"WALL"},{id:0,p:[65,51,65],s:[72,20,6],col:1,da:.13,t:"WALL"},{id:0,p:[65,42,-65],s:[72,20,6],col:1,da:.13,t:"WALL"},{id:0,p:[65,42,-65],s:[6,20,72],col:1,da:.13,t:"WALL"},{id:0,p:[65,51,65],s:[6,20,72],col:1,da:.13,t:"WALL"},{id:0,p:[65,47,65],s:[76,4,10],da:.68,t:"WALL"},{id:0,p:[65,38,-65],s:[76,4,10],da:.68,t:"WALL"},{id:0,p:[65,47,65],s:[10,4,76],da:.68,t:"WALL"},{id:0,p:[65,38,-65],s:[10,4,76],da:.68,t:"WALL"},{id:0,p:[98,0,-137],s:[4,20,4],da:.71,t:"FLOOR"},{id:0,p:[96,4,-121],s:[2,6,40],da:.71,t:"FLOOR"},{id:0,p:[98,0,-102],s:[4,22,4],da:.71,t:"FLOOR"},{id:0,p:[96,12,-121],s:[2,6,40],da:.86,t:"FLOOR"},{id:0,p:[-65,96,-65],s:[92,2,92],da:1.06,t:"FLOOR"},{id:0,p:[-65,92,-66],s:[94,4,4],t:"FLOOR"},{id:0,p:[-65,92,-37],s:[94,4,4],t:"FLOOR"},{id:0,p:[-65,92,-94],s:[94,4,4],t:"FLOOR"},{id:0,p:[-66,92,-65],s:[4,4,94],t:"FLOOR"},{id:0,p:[-39,92,-65],s:[4,4,94],t:"FLOOR"},{id:0,p:[-94,92,-65],s:[4,4,94],t:"FLOOR"},{id:0,p:[-66,72,-65],s:[4,4,110],t:"FLOOR"},{id:0,p:[-66,68,-104],s:[2,2,12],col:1,r:[0.7,0,0],t:"FLOOR"},{id:0,p:[-66,68,-27],s:[2,2,12],col:1,r:[-0.7,0,0],t:"FLOOR"},{id:0,p:[-89,26,-107],s:[4,4,14],da:1.12,t:"WALL"},{id:0,p:[0,26,-191],s:[4,6,10],da:1.04,t:"WALL"},{id:0,p:[0,26,-179],s:[4,2,14],da:1.01,t:"WALL"},{id:0,p:[87,26,105],s:[4,4,10],da:1.06,t:"WALL"},{id:0,p:[0,26,187],s:[4,4,18],da:1.3,t:"WALL"},{id:0,p:[0,26,159],s:[4,2,18],da:1.3,t:"WALL"},{id:0,p:[-87,0,102],s:[4,20,4],da:.71,t:"FLOOR"},{id:0,p:[-87,0,135],s:[4,18,4],da:.75,t:"FLOOR"},{id:0,p:[-85,3,120],s:[2,6,38],da:.75,t:"FLOOR"},{id:0,p:[-85,11,120],s:[2,6,36],da:.84,t:"FLOOR"},{id:0,p:[-37,118,-37],s:[14,6,14],col:1,da:1.37,t:"WALL"},{id:0,p:[-89,118,-37],s:[22,6,14],col:1,da:1.37,t:"WALL"},{id:0,p:[-93,118,-91],s:[14,6,18],col:1,da:1.37,t:"WALL"},{id:0,p:[-36,118,-93],s:[12,4,14],col:1,da:1.37,t:"WALL"},{id:0,p:[-69,118,-98],s:[18,4,4],col:1,da:1.37,t:"WALL"},{id:0,p:[-61,118,-32],s:[18,4,4],col:1,da:1.37,t:"WALL"},{id:0,p:[-97,118,-62],s:[6,4,16],col:1,da:1.37,t:"WALL"},{id:0,p:[-33,118,-72],s:[6,4,16],col:1,da:1.37,t:"WALL"},{id:0,p:[-101,0,106],s:[8,2,8],col:1,da:.77,t:"WALL"},{id:0,p:[-105,0,95],s:[8,2,4],col:1,da:.97,t:"WALL"},{id:0,p:[-67,0,105],s:[4,2,6],col:1,da:1.12,t:"WALL"},{id:0,p:[-30,0,106],s:[8,4,6],da:1.34,t:"WALL"},{id:0,p:[-93,0,23],s:[8,2,8],col:1,da:1.01,t:"WALL"},{id:0,p:[-45,0,20],s:[4,2,4],col:1,da:1.34,t:"WALL"},{id:0,p:[-82,0,22],s:[4,2,4],col:1,da:1.04,t:"WALL"},{id:0,p:[-92,0,115],s:[4,2,4],col:1,da:.99,t:"WALL"},{id:0,p:[-103,0,86],s:[4,2,4],col:1,da:.84,t:"WALL"},{id:0,p:[-26,0,98],s:[4,2,4],col:1,da:1.34,t:"WALL"},{id:0,p:[-26,0,29],s:[4,2,4],col:1,da:1.34,t:"WALL"},{id:0,p:[-34,0,24],s:[8,2,8],col:1,da:1.34,t:"WALL"},{id:0,p:[-95,58,36],s:[8,26,8],a:1,da:1.04,t:"FLOOR"},{id:0,p:[-32,58,85],s:[4,12,30],da:1.43,t:"WALL"},{id:0,p:[-55,58,98],s:[42,12,4],da:1.41,t:"WALL"},{id:0,p:[-98,58,73],s:[4,4,24],da:1.34,t:"WALL"},{id:0,p:[-39,58,32],s:[18,6,4],da:1.34,t:"WALL"},{id:0,p:[-32,58,41],s:[4,10,14],da:1.34,t:"WALL"},{id:0,p:[-38,58,92],s:[8,34,8],a:1,da:.97,t:"FLOOR"},{id:0,p:[-44,0,107],s:[12,10,12],da:1.34,t:"WALL"},{id:0,p:[-106,0,50],s:[8,2,8],col:1,da:1.04,t:"WALL"},{id:0,p:[-21,0,51],s:[12,2,4],col:1,da:.71,t:"FLOOR"},{id:0,p:[-77,0,113],s:[4,2,20],col:1,da:.71,t:"FLOOR"},{id:0,p:[-116,76,201],s:[38,6,10],col:1,da:1.28,t:"WALL"},{id:0,p:[-49,76,201],s:[48,6,10],col:1,da:1.28,t:"WALL"},{id:0,p:[38,76,201],s:[28,4,10],col:1,da:1.28,t:"WALL"},{id:0,p:[141,76,201],s:[42,6,10],col:1,da:1.28,t:"WALL"},{id:0,p:[48,76,-201],s:[58,8,10],col:1,da:1.28,t:"WALL"},{id:0,p:[-56,76,-201],s:[42,4,10],col:1,da:1.28,t:"WALL"},{id:0,p:[-162,76,-201],s:[38,8,10],col:1,da:1.28,t:"WALL"},{id:0,p:[-203,76,-135],s:[12,8,44],col:1,da:1.28,t:"WALL"},{id:0,p:[-203,76,-44],s:[12,6,36],col:1,da:1.28,t:"WALL"},{id:0,p:[-203,76,62],s:[12,8,42],col:1,da:1.28,t:"WALL"},{id:0,p:[-203,76,142],s:[12,6,36],col:1,da:1.28,t:"WALL"},{id:0,p:[202,76,-123],s:[12,8,40],col:1,da:1.28,t:"WALL"},{id:0,p:[202,76,-43],s:[12,8,34],col:1,da:1.28,t:"WALL"},{id:0,p:[202,76,48],s:[12,6,26],col:1,da:1.28,t:"WALL"},{id:0,p:[202,76,134],s:[12,8,52],col:1,da:1.28,t:"WALL"},{id:0,p:[-92,58,92],s:[8,10,8],a:1,da:.97,t:"FLOOR"},{id:0,p:[185,0,0],s:[22,22,250],da:1.01,t:"WALL"},{id:0,p:[-177,22,0],s:[4,8,250],da:1.21,t:"WALL"},{id:0,p:[-177,30,115],s:[4,4,20],da:1.21,t:"WALL"},{id:0,p:[-177,30,63],s:[4,2,22],da:1.12,t:"WALL"},{id:0,p:[-177,30,28],s:[4,4,18],da:1.19,t:"WALL"},{id:0,p:[-177,30,-35],s:[4,2,18],da:1.21,t:"WALL"},{id:0,p:[-177,30,-84],s:[4,2,12],da:1.15,t:"WALL"},{id:0,p:[-177,30,-119],s:[4,4,12],da:1.17,t:"WALL"},{id:0,p:[176,22,0],s:[4,8,250],da:1.17,t:"WALL"},{id:0,p:[86,0,186],s:[2,56,2],da:.71,t:"FLOOR"},{id:0,p:[48,0,186],s:[2,52,2],da:.71,t:"FLOOR"},{id:0,p:[67,24,190],s:[42,2,12],da:.71,t:"FLOOR"},{id:0,p:[67,44,190],s:[42,2,12],da:.71,t:"FLOOR"},{id:0,p:[86,0,195],s:[2,50,2],da:.71,t:"FLOOR"},{id:0,p:[48,0,195],s:[2,50,2],da:.71,t:"FLOOR"},{id:0,p:[176,30,-116],s:[4,4,18],da:1.15,t:"WALL"},{id:0,p:[176,30,-72],s:[4,2,18],da:1.15,t:"WALL"},{id:0,p:[176,30,-23],s:[4,4,14],da:1.1,t:"WALL"},{id:0,p:[176,30,22],s:[4,2,14],da:1.12,t:"WALL"},{id:0,p:[176,30,75],s:[4,4,12],da:1.15,t:"WALL"},{id:0,p:[176,30,116],s:[4,4,18],da:1.12,t:"WALL"},{id:0,p:[60,0,109],s:[48,8,16],v:1,da:1.06,t:"WALL"},{id:0,p:[-28,0,-179],s:[48,8,16],v:1,da:1.06,t:"WALL"},{id:0,p:[153,0,-1],s:[16,8,48],v:1,da:1.06,t:"WALL"},{id:0,p:[153,7,4],s:[16,8,24],v:1,da:1.06,t:"WALL"},{id:0,p:[65,7,109],s:[24,8,16],v:1,da:1.06,t:"WALL"},{id:0,p:[-23,7,-179],s:[24,8,16],v:1,da:1.06,t:"WALL"},{id:0,p:[-65,62,-65],s:[72,20,6],col:1,da:.13,t:"WALL"},{id:0,p:[-65,58,-65],s:[76,4,10],da:.68,t:"WALL"},{id:2,p:[-7,0,-165],s:[7,8,7]},{id:2,p:[6,0,-192],s:[7,8,7]},{id:2,p:[-26,0,-92],s:[7,8,7]},{id:2,p:[53,0,192],s:[7,8,7]},{id:8,p:[-125,0,190],s:[12,12,12]},{id:0,p:[-188,22,0],s:[18,2,252],da:1.01,t:"FLOOR"},{id:0,p:[187,22,0],s:[18,2,252],da:1.01,t:"FLOOR"},{id:0,p:[326,0,-34],s:[46,166,50],da:1.3,t:"WALL"},{id:0,p:[-74,0,18],s:[4,2,20],col:1,r:[0,0.87,0],da:.71,t:"FLOOR"},{id:0,p:[312,166,-52],s:[18,4,14],da:1.3,t:"WALL"},{id:0,p:[312,166,-16],s:[18,6,14],da:1.3,t:"WALL"},{id:0,p:[343,166,-52],s:[12,4,14],da:1.3,t:"WALL"},{id:0,p:[341,166,-16],s:[16,4,14],da:1.3,t:"WALL"},{id:0,p:[303,127,-33],s:[2,20,6],col:1,da:.13,t:"WALL"},{id:0,p:[-95,0,192],s:[8,72,8],da:.95,t:"FLOOR"},{id:0,p:[-95,64,172],s:[6,6,40],da:.95,t:"FLOOR"},{id:0,p:[-95,58,182],s:[4,4,20],col:1,r:[0.7,0,0],da:.95,t:"FLOOR"},{id:0,p:[79,0,-23],s:[2,56,2],da:.71,t:"FLOOR"},{id:0,p:[93,25,-36],s:[32,2,30],da:.71,t:"FLOOR"},{id:0,p:[107,0,-23],s:[2,52,2],da:.71,t:"FLOOR"},{id:0,p:[107,0,-49],s:[2,52,2],da:.71,t:"FLOOR"},{id:0,p:[93,45,-36],s:[32,2,30],da:.71,t:"FLOOR"},{id:0,p:[202,0,-56],s:[12,76,396],da:1.3,t:"WALL"},{id:0,p:[-203,0,52],s:[12,76,388],da:1.3,t:"WALL"},{id:0,p:[68,0,201],s:[420,76,10],da:1.32,t:"WALL"},{id:0,p:[233,76,201],s:[34,6,10],col:1,da:1.28,t:"WALL"},{id:0,p:[-203,0,-184],s:[12,76,24],da:1.3,t:"WALL"},{id:0,p:[202,30,157],s:[12,46,30],da:1.3,t:"WALL"},{id:0,p:[-203,30,-157],s:[12,46,30],da:1.3,t:"WALL"},{id:0,p:[202,0,184],s:[12,76,24],da:1.3,t:"WALL"},{id:0,p:[-203,0,-149],s:[2,30,14],da:.84,t:"FLOOR"},{id:0,p:[-197,0,-171],s:[14,30,2],da:.84,t:"FLOOR"},{id:0,p:[202,0,149],s:[2,30,14],da:.84,t:"FLOOR"},{id:0,p:[196,0,171],s:[14,30,2],da:.84,t:"FLOOR"},{id:0,p:[-231,76,-201],s:[20,8,10],col:1,da:1.28,t:"WALL"},{id:0,p:[-193,64,28],s:[8,4,4],t:"FLOOR"},{id:0,p:[-193,64,81],s:[8,4,4],t:"FLOOR"},{id:0,p:[-193,64,131],s:[8,4,4],t:"FLOOR"},{id:0,p:[-193,64,-22],s:[8,4,4],t:"FLOOR"},{id:0,p:[-193,64,-72],s:[8,4,4],t:"FLOOR"},{id:0,p:[-193,64,-115],s:[8,4,4],t:"FLOOR"},{id:0,p:[192,64,-115],s:[8,4,4],t:"FLOOR"},{id:0,p:[192,64,-73],s:[8,4,4],t:"FLOOR"},{id:0,p:[192,64,-32],s:[8,4,4],t:"FLOOR"},{id:0,p:[192,64,11],s:[8,4,4],t:"FLOOR"},{id:0,p:[192,64,54],s:[8,4,4],t:"FLOOR"},{id:0,p:[192,64,96],s:[8,4,4],t:"FLOOR"},{id:0,p:[-187,0,-125],s:[12,22,2],v:1,da:1.01,t:"WALL"},{id:0,p:[187,0,125],s:[12,22,2],v:1,da:1.01,t:"WALL"},{id:0,p:[-170,34,217],s:[56,2,58],da:1.01,t:"FLOOR"},{id:0,p:[-184,0,198],s:[26,22,6],da:.97,t:"WALL"},{id:0,p:[-203,76,216],s:[12,6,28],col:1,da:1.28,t:"WALL"},{id:0,p:[-131,0,251],s:[156,76,10],da:1.32,t:"WALL"},{id:0,p:[-46,0,231],s:[14,76,50],da:1.32,t:"WALL"},{id:0,p:[-194,0,191],s:[4,40,4],da:.84,t:"FLOOR"},{id:0,p:[-145,0,191],s:[4,38,4],da:.88,t:"FLOOR"},{id:0,p:[-145,0,243],s:[4,40,4],da:.88,t:"FLOOR"},{id:0,p:[-194,0,243],s:[4,40,4],da:.88,t:"FLOOR"},{id:0,p:[-191,22,198],s:[12,4,6],da:1.01,t:"WALL"},{id:0,p:[-145,0,201],s:[6,18,6],da:.99,t:"WALL"},{id:0,p:[-171,76,251],s:[38,6,10],col:1,da:1.28,t:"WALL"},{id:0,p:[-46,76,230],s:[14,6,28],col:1,da:1.28,t:"WALL"},{id:0,p:[-95,76,251],s:[24,6,10],col:1,da:1.28,t:"WALL"},{id:0,p:[162,34,-191],s:[68,2,68],da:.73,t:"FLOOR"},{id:0,p:[131,0,-160],s:[4,48,4],da:.71,t:"FLOOR"},{id:0,p:[193,0,-160],s:[4,48,4],da:.82,t:"FLOOR"},{id:0,p:[193,0,-222],s:[4,34,4],da:.71,t:"FLOOR"},{id:0,p:[131,0,-222],s:[4,38,4],da:.71,t:"FLOOR"},{id:0,p:[138,0,-201],s:[20,20,6],da:.97,t:"WALL"},{id:0,p:[135,20,-201],s:[14,6,6],da:1.04,t:"WALL"},{id:0,p:[193,0,-201],s:[6,24,6],da:.97,t:"WALL"},{id:0,p:[187,0,-201],s:[6,2,6],col:1,da:.99,t:"WALL"},{id:3,p:[196,0,-233],s:[2,50,10],d:2},{id:0,p:[125,0,-254],s:[142,76,10],da:1.32,t:"WALL"},{id:0,p:[49,0,-233],s:[10,76,54],da:1.32,t:"WALL"},{id:0,p:[202,76,-217],s:[12,8,40],col:1,da:1.28,t:"WALL"},{id:0,p:[166,76,-254],s:[26,8,10],col:1,da:1.28,t:"WALL"},{id:0,p:[93,76,-254],s:[44,8,10],col:1,da:1.28,t:"WALL"},{id:2,p:[192,36,-166],s:[7,8,7]},{id:2,p:[-194,36,197],s:[7,8,7]},{id:8,p:[-111,0,212],s:[12,12,12]},{id:1,p:[137,0,-192],s:[12,12,12]},{id:1,p:[140,0,-210],s:[12,12,12]},{id:0,p:[-270,0,-146],s:[12,76,104],da:1.3,t:"WALL"},{id:0,p:[-243,0,-90],s:[68,76,12],da:1.3,t:"WALL"},{id:0,p:[243,0,88],s:[70,76,12],da:1.3,t:"WALL"},{id:0,p:[271,0,145],s:[14,76,112],da:1.3,t:"WALL"},{id:1,p:[214,0,134],s:[12,12,12]},{id:1,p:[214,12,134],s:[12,12,12]},{id:1,p:[214,0,180],s:[12,12,12]},{id:1,p:[258,0,100],s:[12,12,12]},{id:1,p:[258,0,190],s:[12,12,12]},{id:1,p:[246,0,190],s:[12,12,12]},{id:1,p:[258,0,178],s:[12,12,12]},{id:1,p:[258,12,190],s:[12,12,12]},{id:2,p:[260,0,168],s:[7,8,7]},{id:2,p:[248,0,98],s:[7,8,7]},{id:2,p:[224,0,135],s:[7,8,7]},{id:0,p:[-212,0,-178],s:[4,40,4],da:.71,t:"FLOOR"},{id:0,p:[-261,0,-178],s:[4,40,4],da:.71,t:"FLOOR"},{id:0,p:[-237,35,-186],s:[56,2,22],da:.86,t:"FLOOR"},{id:1,p:[-258,0,-190],s:[12,12,12]},{id:1,p:[-215,0,-102],s:[12,12,12]},{id:2,p:[-261,0,-144],s:[7,8,7]},{id:0,p:[152,0,-188],s:[8,2,8],col:1,da:1.01,t:"WALL"},{id:0,p:[189,0,-214],s:[8,2,6],col:1,da:1.01,t:"WALL"},{id:0,p:[-152,0,193],s:[8,2,6],col:1,da:1.01,t:"WALL"},{id:0,p:[-178,0,207],s:[8,2,8],col:1,da:1.01,t:"WALL"},{id:0,p:[-216,0,-138],s:[8,2,8],col:1,da:1.01,t:"WALL"},{id:1,p:[190,36,-176],s:[12,12,12]},{id:1,p:[134,36,-196],s:[12,12,12]},{id:0,p:[162,39,-157],s:[68,6,2],da:.62,t:"FLOOR"},{id:3,p:[-133,0,206],s:[12,58,2],d:1},{id:0,p:[-23,0,-253],s:[72,124,66],da:.88,t:"WALL"},{id:0,p:[-88,0,-269],s:[72,104,62],da:.95,t:"WALL"},{id:0,p:[29,0,252],s:[72,124,66],da:.9,t:"WALL"},{id:0,p:[-301,0,14],s:[72,118,120],da:.86,t:"WALL"},{id:0,p:[57,124,229],s:[16,4,20],col:1,da:.9,t:"WALL"},{id:0,p:[1,124,229],s:[16,6,20],col:1,da:.9,t:"WALL"},{id:0,p:[29,124,222],s:[20,2,6],col:1,da:.9,t:"WALL"},{id:0,p:[-4,124,260],s:[6,2,20],col:1,da:.9,t:"WALL"},{id:0,p:[62,124,257],s:[6,2,12],col:1,da:.9,t:"WALL"},{id:0,p:[-269,118,3],s:[8,4,18],col:1,da:.86,t:"WALL"},{id:0,p:[-274,118,-32],s:[18,6,28],col:1,da:.86,t:"WALL"},{id:0,p:[-269,118,34],s:[8,6,22],col:1,da:.86,t:"WALL"},{id:0,p:[-274,118,66],s:[18,6,16],col:1,da:.86,t:"WALL"},{id:0,p:[-304,118,-43],s:[16,6,6],col:1,da:.86,t:"WALL"},{id:0,p:[-301,118,71],s:[16,6,6],col:1,da:.86,t:"WALL"},{id:0,p:[-332,118,-32],s:[10,6,28],col:1,da:.86,t:"WALL"},{id:0,p:[-332,118,60],s:[10,6,28],col:1,da:.86,t:"WALL"},{id:0,p:[-23,124,-222],s:[20,2,4],col:1,da:.88,t:"WALL"},{id:0,p:[6,124,-227],s:[14,4,14],col:1,da:.88,t:"WALL"},{id:0,p:[-52,124,-227],s:[14,4,14],col:1,da:.88,t:"WALL"},{id:0,p:[10,124,-251],s:[6,4,14],col:1,da:.88,t:"WALL"},{id:0,p:[6,124,-279],s:[14,4,14],col:1,da:.88,t:"WALL"},{id:0,p:[-52,124,-279],s:[14,4,14],col:1,da:.88,t:"WALL"},{id:0,p:[-56,124,-251],s:[6,4,14],col:1,da:.88,t:"WALL"},{id:0,p:[-73,104,-240],s:[18,6,4],col:1,da:.95,t:"WALL"},{id:0,p:[-97,104,-240],s:[10,4,4],col:1,da:.95,t:"WALL"},{id:0,p:[-117,104,-245],s:[14,4,14],col:1,da:.95,t:"WALL"},{id:0,p:[-122,104,-267],s:[4,2,14],col:1,da:.95,t:"WALL"},{id:0,p:[-117,104,-293],s:[14,4,14],col:1,da:.95,t:"WALL"},{id:1,p:[190,0,-131],s:[12,12,12]}]},{name:"Stockade",modes:[0],biomes:[0],shadScale:350,camPos:[172,21,93],spawns:[[-54,1,0],[291,0,77],[205,0,-199],[-166,0,-233],[-14,38,-232],[-57,1,108],[-214,0,257]],objects:[{id:4,p:[0,0,0],s:[780,0,692],ter:1,t:"DIRT"},{id:0,p:[35,0,215],s:[480,56,38],t:"WALL"},{id:0,p:[100,0,50],s:[10,60,10],t:"FLOOR"},{id:0,p:[100,0,-50],s:[10,58,10],t:"FLOOR"},{id:0,p:[-100,0,-50],s:[10,58,10],t:"FLOOR"},{id:0,p:[-100,0,50],s:[10,58,10],t:"FLOOR"},{id:0,p:[-46,0,50],s:[102,58,4],da:1.06,t:"WALL"},{id:0,p:[0,0,-50],s:[202,58,4],da:1.06,t:"WALL"},{id:0,p:[100,0,0],s:[4,58,92],da:1.06,t:"WALL"},{id:0,p:[-100,0,-34],s:[4,58,24],da:1.08,t:"WALL"},{id:0,p:[-65,58,0],s:[88,4,116],t:"FLOOR"},{id:0,p:[-40,0,-50],s:[6,58,6],t:"FLOOR"},{id:0,p:[34,0,-50],s:[6,58,6],t:"FLOOR"},{id:0,p:[34,0,50],s:[6,58,6],t:"FLOOR"},{id:0,p:[-40,0,50],s:[6,58,6],t:"FLOOR"},{id:0,p:[0,62,-53],s:[214,42,2],da:1.15,t:"WALL"},{id:0,p:[-103,62,-52],s:[10,54,10],a:1,da:.97,t:"FLOOR"},{id:0,p:[103,62,52],s:[10,60,10],a:1,da:1.01,t:"FLOOR"},{id:0,p:[103,62,-52],s:[10,64,10],a:1,da:.97,t:"FLOOR"},{id:1,p:[23,1,42],s:[12,12,12]},{id:1,p:[11,1,42],s:[12,12,12]},{id:1,p:[16,13,42],s:[12,12,12]},{id:1,p:[-29,1,42],s:[12,12,12]},{id:1,p:[-29,1,-42],s:[12,12,12]},{id:1,p:[-17,1,-42],s:[12,12,12]},{id:1,p:[-23,13,-42],s:[12,12,12]},{id:1,p:[63,1,-42],s:[12,12,12]},{id:1,p:[63,1,-30],s:[12,12,12]},{id:1,p:[59,1,19],s:[12,12,12]},{id:1,p:[59,1,7],s:[12,12,12]},{id:1,p:[71,1,19],s:[12,12,12]},{id:1,p:[71,1,7],s:[12,12,12]},{id:1,p:[59,13,19],s:[12,12,12]},{id:1,p:[63,13,-42],s:[12,12,12]},{id:2,p:[-7,1,-43],s:[7,8,7]},{id:2,p:[53,1,-44],s:[7,8,7]},{id:2,p:[58,1,29],s:[7,8,7]},{id:2,p:[-30,1,-32],s:[7,8,7]},{id:1,p:[-74,1,-27],s:[12,12,12]},{id:1,p:[-62,1,-27],s:[12,12,12]},{id:3,p:[-11,1,46],s:[10,68,2],d:3},{id:1,p:[-29,13,42],s:[12,12,12]},{id:1,p:[-29,1,30],s:[12,12,12]},{id:1,p:[-92,1,39],s:[12,12,12]},{id:0,p:[0,-1,0],s:[202,2,96],da:.86,t:"FLOOR"},{id:0,p:[0,62,53],s:[214,40,4],da:1.12,t:"WALL"},{id:0,p:[104,62,0],s:[2,40,96],a:1,da:1.15,t:"WALL"},{id:0,p:[-104,62,31],s:[2,28,32],a:1,da:1.15,t:"WALL"},{id:0,p:[24,58,52],s:[90,4,12],t:"FLOOR"},{id:0,p:[89,58,0],s:[40,4,116],t:"FLOOR"},{id:0,p:[-104,62,-31],s:[2,34,32],a:1,da:1.15,t:"WALL"},{id:1,p:[78,62,-1],s:[12,12,12]},{id:1,p:[78,62,11],s:[12,12,12]},{id:1,p:[-29,62,-46],s:[12,12,12]},{id:1,p:[-50,62,45],s:[12,12,12]},{id:2,p:[-30,62,-37],s:[7,8,7]},{id:2,p:[-100,62,40],s:[7,8,7]},{id:2,p:[-100,62,32],s:[7,8,7]},{id:0,p:[-104,90,28],s:[2,4,12],col:1,da:1.1,t:"WALL"},{id:0,p:[-104,90,43],s:[2,2,6],col:1,da:1.1,t:"WALL"},{id:0,p:[104,102,-32],s:[2,4,20],col:1,da:1.08,t:"WALL"},{id:0,p:[104,102,25],s:[2,2,30],col:1,da:1.08,t:"WALL"},{id:0,p:[104,102,-5],s:[2,2,10],col:1,da:1.15,t:"WALL"},{id:0,p:[-104,96,-38],s:[2,4,12],col:1,da:1.15,t:"WALL"},{id:0,p:[-67,104,-53],s:[38,6,2],col:1,da:1.15,t:"WALL"},{id:0,p:[-14,104,-53],s:[24,2,2],col:1,da:1.12,t:"WALL"},{id:0,p:[43,104,-53],s:[24,4,2],col:1,da:1.1,t:"WALL"},{id:0,p:[76,102,53],s:[24,6,4],col:1,da:1.1,t:"WALL"},{id:0,p:[-71,102,53],s:[24,2,4],col:1,da:1.12,t:"WALL"},{id:0,p:[22,102,53],s:[16,4,4],col:1,da:1.12,t:"WALL"},{id:0,p:[-100,38,0],s:[4,20,44],da:1.08,t:"WALL"},{id:0,p:[-103,62,52],s:[10,54,10],a:1,da:1.04,t:"FLOOR"},{id:0,p:[-111,0,-11],s:[4,2,10],col:1,da:1.01,t:"WALL"},{id:0,p:[-110,0,-32],s:[8,2,4],col:1,da:.95,t:"WALL"},{id:0,p:[-81,0,-72],s:[6,2,6],col:1,da:1.01,t:"WALL"},{id:0,p:[113,0,-52],s:[12,2,6],col:1,da:1.01,t:"WALL"},{id:1,p:[-108,0,37],s:[12,12,12]},{id:1,p:[-69,0,-58],s:[12,12,12]},{id:0,p:[-140,0,-103],s:[4,16,82],da:1.08,t:"WALL"},{id:0,p:[-140,16,-71],s:[4,4,14],da:1.08,t:"WALL"},{id:0,p:[-140,16,-134],s:[4,2,14],da:1.08,t:"WALL"},{id:0,p:[-167,0,-128],s:[4,2,4],col:1,da:.95,t:"WALL"},{id:0,p:[-18,-1,123],s:[568,2,58],da:.42,t:"WALL"},{id:7,p:[-152,1,135],s:[51,15,20],col:1},{id:0,p:[-251,0,-84],s:[42,104,356],da:1.54,t:"WALL"},{id:0,p:[-251,0,213],s:[42,104,122],da:1.54,t:"WALL"},{id:0,p:[-270,0,124],s:[6,50,86],da:.02,t:"WALL"},{id:0,p:[-251,44,123],s:[42,60,58],da:1.54,t:"WALL"},{id:0,p:[246,0,187],s:[42,78,70],da:1.21,t:"WALL"},{id:0,p:[246,44,123],s:[42,34,58],da:1.21,t:"WALL"},{id:0,p:[-100,1,-11],s:[2,38,22],da:1.01,t:"FLOOR"},{id:0,p:[-110,0,21],s:[22,38,2],da:1.1,t:"FLOOR"},{id:0,p:[-240,0,-3],s:[106,72,130],da:.97,t:"WALL"},{id:1,p:[-199,0,-153],s:[12,12,12]},{id:0,p:[24,58,-52],s:[90,4,12],t:"FLOOR"},{id:0,p:[-11,0,48],s:[12,62,4],v:1,t:"WALL"},{id:0,p:[-191,0,-74],s:[8,2,4],col:1,da:.95,t:"WALL"},{id:0,p:[0,0,198],s:[162,82,92],da:1.06,t:"WALL"},{id:0,p:[0,48,123],s:[162,34,58],da:1.06,t:"WALL"},{id:1,p:[-87,0,163],s:[12,12,12]},{id:1,p:[-87,12,163],s:[12,12,12]},{id:1,p:[-99,0,163],s:[12,12,12]},{id:8,p:[-206,0,168],s:[12,12,12]},{id:8,p:[-194,0,168],s:[12,12,12],r:[0,1.57,0]},{id:1,p:[-87,0,175],s:[12,12,12]},{id:0,p:[-14,0,-235],s:[60,38,70],t:"WALL"},{id:0,p:[-73,0,-202],s:[58,78,136],da:1.39,t:"WALL"},{id:0,p:[45,0,-216],s:[58,82,108],t:"WALL"},{id:3,p:[-28,0,-200],s:[10,38,2],d:1},{id:8,p:[10,0,-176],s:[12,12,12]},{id:8,p:[44,0,-156],s:[12,12,12],r:[0,-1.57,0]},{id:8,p:[10,38,-211],s:[12,12,12]},{id:0,p:[162,0,-173],s:[126,36,6],da:.81,t:"WALL"},{id:0,p:[166,0,-112],s:[46,122,50],da:1.72,t:"WALL"},{id:0,p:[212,0,84],s:[26,10,4],t:"WALL"},{id:0,p:[203,10,84],s:[8,2,4],t:"WALL"},{id:0,p:[217,10,84],s:[10,4,4],t:"WALL"},{id:0,p:[-142,0,-179],s:[102,54,72],da:1.59,t:"WALL"},{id:7,p:[-71,0,-124],s:[51,15,20],col:1},{id:8,p:[137,0,-97],s:[12,12,12],r:[0,-1.57,0]},{id:8,p:[137,0,-109],s:[12,12,12]},{id:0,p:[-141,0,-267],s:[78,102,26],t:"WALL"},{id:0,p:[-140,16,-104],s:[4,2,20],da:1.08,t:"WALL"},{id:0,p:[-190,0,-65],s:[8,72,8],t:"FLOOR"},{id:0,p:[-190,0,59],s:[8,72,8],t:"FLOOR"},{id:0,p:[-240,71,-3],s:[122,6,142],da:1.01,t:"ROOF"},{id:0,p:[55,0,-158],s:[8,76,8],t:"FLOOR"},{id:0,p:[55,65,-141],s:[6,6,26],t:"FLOOR"},{id:0,p:[55,59,-146],s:[4,4,20],col:1,r:[-0.7,0,0],t:"FLOOR"},{id:0,p:[-76,82,76],s:[10,6,44],col:1,da:1.06,t:"WALL"},{id:0,p:[-76,82,137],s:[10,4,24],col:1,da:1.06,t:"WALL"},{id:0,p:[-76,82,197],s:[10,6,24],col:1,da:1.06,t:"WALL"},{id:0,p:[76,82,66],s:[10,6,26],col:1,da:1.06,t:"WALL"},{id:0,p:[76,82,115],s:[10,4,32],col:1,da:1.06,t:"WALL"},{id:0,p:[76,82,155],s:[10,6,22],col:1,da:1.06,t:"WALL"},{id:0,p:[-97,0,-139],s:[6,88,6],t:"FLOOR"},{id:0,p:[-49,0,-139],s:[6,96,6],t:"FLOOR"},{id:0,p:[-182,54,-147],s:[22,4,8],col:1,da:1.54,t:"WALL"},{id:0,p:[-111,54,-145],s:[18,6,4],da:1.57,t:"WALL"},{id:0,p:[-127,54,-213],s:[18,6,4],col:1,da:1.54,t:"WALL"},{id:0,p:[-166,54,-213],s:[26,4,4],col:1,da:1.54,t:"WALL"},{id:0,p:[-191,54,-196],s:[4,4,18],col:1,da:1.57,t:"WALL"},{id:0,p:[-191,54,-167],s:[4,2,16],col:1,da:1.54,t:"WALL"},{id:0,p:[-189,0,-4],s:[6,72,6],t:"FLOOR"},{id:1,p:[120,0,-164],s:[12,12,12]},{id:1,p:[108,0,-164],s:[12,12,12]},{id:0,p:[20,0,-166],s:[6,116,6],t:"FLOOR"},{id:0,p:[70,0,-166],s:[6,116,6],t:"FLOOR"},{id:0,p:[70,0,-265],s:[6,116,6],t:"FLOOR"},{id:0,p:[20,0,-239],s:[6,116,6],t:"FLOOR"},{id:0,p:[45,105,-216],s:[58,2,110],t:"FLOOR"},{id:8,p:[80,0,-58],s:[12,12,12],r:[0,-1.57,0]},{id:2,p:[-177,0,-139],s:[7,8,7]},{id:1,p:[219,0,-108],s:[12,12,12]},{id:0,p:[180,113,-112],s:[4,4,66],t:"FLOOR"},{id:0,p:[152,113,-112],s:[4,4,64],t:"FLOOR"},{id:0,p:[166,113,-126],s:[60,4,4],t:"FLOOR"},{id:0,p:[166,113,-97],s:[60,4,4],t:"FLOOR"},{id:0,p:[149,122,-128],s:[12,4,18],col:1,da:1.65,t:"WALL"},{id:0,p:[149,122,-93],s:[12,4,12],col:1,da:1.68,t:"WALL"},{id:0,p:[183,122,-98],s:[12,4,22],col:1,da:1.65,t:"WALL"},{id:0,p:[181,122,-131],s:[16,6,12],col:1,da:1.65,t:"WALL"},{id:0,p:[145,122,-109],s:[4,4,8],col:1,da:1.65,t:"WALL"},{id:0,p:[166,81,-112],s:[48,22,6],col:1,da:.09,t:"WALL"},{id:0,p:[166,78,-112],s:[50,4,10],da:.68,t:"WALL"},{id:0,p:[166,81,-112],s:[6,22,52],col:1,da:.04,t:"WALL"},{id:0,p:[166,79,-112],s:[10,4,54],da:.71,t:"WALL"},{id:2,p:[-238,1,98],s:[7,8,7]},{id:0,p:[-191,56,202],s:[28,8,12],col:1,da:1.06,t:"WALL"},{id:0,p:[-135,56,198],s:[22,4,4],col:1,da:1.06,t:"WALL"},{id:0,p:[-85,56,198],s:[38,6,4],col:1,da:1.06,t:"WALL"},{id:0,p:[-235,104,243],s:[10,4,28],col:1,da:1.5,t:"WALL"},{id:0,p:[-235,104,111],s:[10,4,54],col:1,da:1.46,t:"WALL"},{id:0,p:[-235,104,-100],s:[10,8,30],col:1,da:1.5,t:"WALL"},{id:0,p:[-235,104,-152],s:[10,4,42],col:1,da:1.52,t:"WALL"},{id:0,p:[-100,0,34],s:[4,58,24],da:1.08,t:"WALL"},{id:0,p:[-251,77,-3],s:[142,42,140],da:.97,t:"WALL"},{id:0,p:[-192,119,52],s:[24,8,30],col:1,da:1.06,t:"WALL"},{id:0,p:[-191,119,-55],s:[22,8,36],col:1,da:1.06,t:"WALL"},{id:0,p:[-184,119,1],s:[8,4,36],col:1,da:1.06,t:"WALL"},{id:0,p:[-230,42,123],s:[6,6,66],t:"FLOOR"},{id:0,p:[-230,0,153],s:[6,42,6],t:"FLOOR"},{id:0,p:[-230,0,93],s:[6,42,6],t:"FLOOR"},{id:0,p:[-230,32,152],s:[4,20,4],col:1,r:[-0.7,0,0],da:.97,t:"FLOOR"},{id:0,p:[-230,32,94],s:[4,20,4],col:1,r:[0.7,0,0],da:1.06,t:"FLOOR"},{id:0,p:[127,36,-173],s:[30,6,6],da:.83,t:"WALL"},{id:0,p:[188,36,-173],s:[28,4,6],da:.83,t:"WALL"},{id:0,p:[218,36,-173],s:[12,2,6],da:.76,t:"WALL"},{id:0,p:[227,78,167],s:[4,6,30],col:1,t:"WALL"},{id:0,p:[200,56,198],s:[26,6,4],col:1,t:"WALL"},{id:0,p:[146,56,198],s:[34,4,4],col:1,t:"WALL"},{id:1,p:[219,0,56],s:[12,12,12]},{id:8,p:[-2,38,-211],s:[12,12,12],r:[0,1.57,0]},{id:7,p:[10,1,104],s:[51,15,20],col:1},{id:1,p:[59,1,146],s:[12,12,12]},{id:1,p:[47,1,146],s:[12,12,12]},{id:0,p:[88,0,81],s:[6,2,12],col:1,da:1.01,t:"WALL"},{id:8,p:[148,0,167],s:[12,12,12],r:[0,1.57,0]},{id:8,p:[219,0,174],s:[12,12,12],r:[-3.14,0,-3.14]},{id:0,p:[292,0,51],s:[50,78,12],da:1.19,t:"WALL"},{id:0,p:[222,0,248],s:[88,134,58],da:1.12,t:"WALL"},{id:0,p:[140,0,252],s:[84,104,40],da:.95,t:"WALL"},{id:2,p:[106,0,36],s:[7,8,7]},{id:0,p:[188,0,-145],s:[12,2,6],col:1,da:1.01,t:"WALL"},{id:0,p:[131,0,-122],s:[8,2,4],col:1,da:1.01,t:"WALL"},{id:0,p:[198,0,-82],s:[8,2,4],col:1,da:1.01,t:"WALL"},{id:0,p:[140,0,166],s:[4,50,4],t:"FLOOR"},{id:0,p:[196,0,166],s:[4,50,4],t:"FLOOR"},{id:0,p:[168,42,179],s:[64,2,34],t:"FLOOR"},{id:0,p:[-160,0,254],s:[78,104,40],da:.84,t:"WALL"},{id:0,p:[-94,0,252],s:[54,140,86],da:1.37,t:"WALL"},{id:0,p:[82,0,205],s:[50,130,54],da:1.48,t:"WALL"},{id:0,p:[167,0,-252],s:[92,106,48],da:1.7,t:"WALL"},{id:0,p:[242,0,-248],s:[58,180,62],da:1.76,t:"WALL"},{id:0,p:[60,0,50],s:[70,58,4],da:1.06,t:"WALL"},{id:0,p:[15,0,71],s:[20,26,46],da:.57,t:"WALL"},{id:0,p:[-38,0,73],s:[86,82,42],da:1.06,t:"WALL"},{id:0,p:[53,0,73],s:[56,82,42],da:1.06,t:"WALL"},{id:0,p:[15,48,71],s:[20,10,46],da:1.06,t:"WALL"},{id:0,p:[319,0,210],s:[130,118,92],da:1.1,t:"WALL"},{id:0,p:[321,0,105],s:[8,78,120],da:1.19,t:"WALL"},{id:0,p:[88,82,-245],s:[14,2,6],col:1,t:"WALL"},{id:0,p:[111,82,-245],s:[12,4,6],col:1,t:"WALL"},{id:1,p:[143,0,-222],s:[12,12,12]},{id:1,p:[155,0,-222],s:[12,12,12]},{id:0,p:[103,0,-61],s:[8,2,4],col:1,da:1.01,t:"WALL"},{id:0,p:[136,0,-80],s:[8,2,4],col:1,da:1.01,t:"WALL"},{id:0,p:[54,0,-68],s:[8,2,4],col:1,da:1.01,t:"WALL"},{id:0,p:[13,0,-156],s:[8,2,4],col:1,da:1.01,t:"WALL"},{id:0,p:[-125,0,-98],s:[8,2,4],col:1,da:.95,t:"WALL"},{id:0,p:[-178,0,-28],s:[8,2,4],col:1,da:.95,t:"WALL"},{id:0,p:[-147,0,-57],s:[4,2,8],col:1,da:.95,t:"WALL"},{id:0,p:[-195,0,69],s:[4,2,8],col:1,da:.95,t:"WALL"},{id:0,p:[-112,0,161],s:[4,2,8],col:1,da:.95,t:"WALL"},{id:0,p:[-184,0,160],s:[4,2,8],col:1,da:.95,t:"WALL"},{id:0,p:[102,0,-183],s:[8,2,4],col:1,da:1.01,t:"WALL"},{id:0,p:[197,0,-216],s:[8,2,4],col:1,da:1.01,t:"WALL"},{id:0,p:[123,0,-215],s:[4,2,6],col:1,da:1.01,t:"WALL"},{id:0,p:[78,0,-213],s:[4,2,6],col:1,da:1.01,t:"WALL"},{id:0,p:[220,0,10],s:[4,2,6],col:1,da:1.01,t:"WALL"},{id:0,p:[201,0,74],s:[8,2,8],col:1,da:1.01,t:"WALL"},{id:8,p:[311,0,158],s:[12,12,12],r:[-3.14,0,-3.14]},{id:1,p:[252,1,100],s:[12,12,12]},{id:2,p:[271,1,160],s:[7,8,7]},{id:0,p:[271,-1,101],s:[10,2,14],da:.48,t:"WALL"},{id:0,p:[269,-1,143],s:[6,2,18],da:.48,t:"WALL"},{id:0,p:[200,1,115],s:[2,12,4],t:"FLOOR"},{id:0,p:[198,6,124],s:[2,6,28],da:.84,t:"FLOOR"},{id:0,p:[200,1,133],s:[2,12,4],t:"FLOOR"},{id:0,p:[282,-1,138],s:[6,2,8],col:1,da:.48,t:"WALL"},{id:0,p:[273,-1,117],s:[6,2,8],col:1,da:.48,t:"WALL"},{id:0,p:[246,0,-79],s:[42,78,346],da:1.21,t:"WALL"},{id:0,p:[227,78,113],s:[4,4,28],col:1,t:"WALL"},{id:0,p:[265,78,134],s:[4,4,18],col:1,t:"WALL"},{id:0,p:[265,78,81],s:[4,4,18],col:1,t:"WALL"},{id:0,p:[227,78,8],s:[4,4,16],col:1,t:"WALL"},{id:0,p:[227,78,55],s:[4,6,28],col:1,t:"WALL"},{id:0,p:[227,78,-154],s:[4,2,22],col:1,t:"WALL"},{id:0,p:[227,78,-108],s:[4,4,22],col:1,t:"WALL"},{id:0,p:[227,78,-46],s:[4,2,42],col:1,t:"WALL"},{id:0,p:[227,78,-203],s:[4,4,22],col:1,t:"WALL"},{id:0,p:[304,78,55],s:[16,4,4],col:1,t:"WALL"},{id:0,p:[277,78,55],s:[10,2,4],col:1,t:"WALL"},{id:0,p:[321,78,77],s:[8,4,22],col:1,t:"WALL"},{id:0,p:[321,78,129],s:[8,2,30],col:1,t:"WALL"},{id:0,p:[-3,38,-202],s:[38,6,4],t:"WALL"},{id:0,p:[5,44,-202],s:[22,2,4],t:"WALL"},{id:0,p:[-18,44,-202],s:[8,2,4],t:"WALL"},{id:1,p:[10,38,-238],s:[12,12,12]},{id:1,p:[-181,0,14],s:[12,12,12]},{id:1,p:[-117,0,-221],s:[12,12,12]},{id:0,p:[-1,0,-94],s:[34,58,84],da:1.08,t:"WALL"},{id:0,p:[225,0,93],s:[6,42,6],t:"FLOOR"},{id:0,p:[225,0,153],s:[6,42,6],t:"FLOOR"},{id:0,p:[266,0,93],s:[6,42,6],t:"FLOOR"},{id:0,p:[266,0,153],s:[6,42,6],t:"FLOOR"},{id:0,p:[225,42,123],s:[6,6,66],t:"FLOOR"},{id:0,p:[266,42,123],s:[6,6,66],t:"FLOOR"},{id:0,p:[225,31,152],s:[4,20,4],col:1,r:[-0.7,0,0],da:1.01,t:"FLOOR"},{id:0,p:[266,31,152],s:[4,20,4],col:1,r:[-0.7,0,0],da:1.04,t:"FLOOR"},{id:0,p:[225,31,94],s:[4,20,4],col:1,r:[0.7,0,0],da:.97,t:"FLOOR"},{id:0,p:[266,31,94],s:[4,20,4],col:1,r:[0.7,0,0],da:.93,t:"FLOOR"},{id:1,p:[166,0,-81],s:[12,12,12]},{id:8,p:[22,0,-58],s:[12,12,12],r:[-3.14,0,-3.14]},{id:0,p:[-17,0,-135],s:[6,60,6],t:"FLOOR"},{id:0,p:[-1,58,-99],s:[44,4,82],t:"FLOOR"},{id:0,p:[15,0,-135],s:[6,58,6],t:"FLOOR"},{id:0,p:[83,104,-53],s:[22,2,2],col:1,da:1.1,t:"WALL"},{id:2,p:[85,0,174],s:[7,8,7]},{id:8,p:[-206,0,68],s:[12,12,12],r:[0,1.57,0]},{id:0,p:[140,0,-6],s:[76,58,54],da:1.08,t:"WALL"},{id:0,p:[146,58,-7],s:[74,4,62],t:"FLOOR"},{id:0,p:[177,0,-32],s:[6,58,6],t:"FLOOR"},{id:0,p:[177,0,20],s:[6,58,6],t:"FLOOR"},{id:1,p:[184,0,-5],s:[12,12,12]},{id:0,p:[183,0,30],s:[4,2,6],col:1,da:1.01,t:"WALL"},{id:0,p:[103,130,228],s:[6,22,6],col:1,t:"FLOOR"},{id:0,p:[103,130,182],s:[6,32,6],col:1,t:"FLOOR"},{id:0,p:[61,130,228],s:[6,34,6],col:1,t:"FLOOR"},{id:0,p:[61,130,182],s:[6,16,6],col:1,t:"FLOOR"},{id:0,p:[102,130,222],s:[10,4,20],da:1.48,t:"WALL"},{id:0,p:[67,130,188],s:[20,6,20],da:1.48,t:"WALL"},{id:0,p:[170,104,234],s:[16,4,4],col:1,t:"WALL"},{id:0,p:[143,104,234],s:[16,2,4],col:1,t:"WALL"},{id:0,p:[111,104,234],s:[22,4,4],col:1,t:"WALL"},{id:0,p:[206,89,219],s:[6,20,2],col:1,da:.04,t:"WALL"},{id:0,p:[206,85,217],s:[12,4,4],col:1,da:.75,t:"WALL"},{id:0,p:[107,90,205],s:[2,20,6],col:1,da:.04,t:"WALL"},{id:0,p:[109,88,205],s:[4,4,12],col:1,da:.75,t:"WALL"},{id:0,p:[187,134,225],s:[18,4,12],col:1,da:1.12,t:"WALL"},{id:0,p:[257,134,225],s:[18,6,12],col:1,da:1.12,t:"WALL"},{id:0,p:[218,134,222],s:[18,4,6],col:1,da:1.12,t:"WALL"},{id:1,p:[113,56,226],s:[12,12,12]},{id:1,p:[125,56,226],s:[12,12,12]},{id:1,p:[118,68,226],s:[12,12,12]},{id:0,p:[313,118,167],s:[38,6,6],col:1,t:"WALL"},{id:0,p:[263,118,179],s:[18,6,30],col:1,t:"WALL"},{id:0,p:[374,118,175],s:[20,8,22],col:1,t:"WALL"},{id:0,p:[291,68,162],s:[12,4,4],col:1,da:.75,t:"WALL"},{id:0,p:[291,73,164],s:[6,20,2],col:1,da:.04,t:"WALL"},{id:0,p:[-136,104,238],s:[30,8,8],col:1,da:.84,t:"WALL"},{id:0,p:[-175,104,238],s:[20,4,8],col:1,da:.84,t:"WALL"},{id:0,p:[-196,104,256],s:[6,6,18],col:1,da:.84,t:"WALL"},{id:0,p:[-103,62,52],s:[14,58,14],v:1,da:1.23,t:"FLOOR"},{id:0,p:[-103,62,-52],s:[14,58,14],v:1,da:1.23,t:"FLOOR"},{id:0,p:[-114,140,218],s:[14,6,18],col:1,da:1.37,t:"WALL"},{id:0,p:[-77,140,218],s:[20,6,18],col:1,da:1.37,t:"WALL"},{id:0,p:[-118,140,245],s:[6,6,18],col:1,da:1.37,t:"WALL"},{id:0,p:[-113,140,286],s:[16,6,18],col:1,da:1.37,t:"WALL"},{id:0,p:[-116,132,214],s:[6,22,6],col:1,t:"FLOOR"},{id:0,p:[-72,132,214],s:[6,34,6],col:1,t:"FLOOR"},{id:0,p:[-116,132,290],s:[6,28,6],col:1,t:"FLOOR"},{id:0,p:[-202,103,-243],s:[6,20,2],col:1,da:.04,t:"WALL"},{id:0,p:[-94,102,207],s:[12,4,4],col:1,da:.75,t:"WALL"},{id:1,p:[-152,56,228],s:[12,12,12]},{id:1,p:[-164,56,228],s:[12,12,12]},{id:0,p:[-77,1,108],s:[2,48,28],da:1.01,t:"FLOOR"},{id:0,p:[77,1,138],s:[2,48,28],da:1.01,t:"FLOOR"},{id:0,p:[-65,1,151],s:[26,48,2],da:1.01,t:"FLOOR"},{id:0,p:[65,1,95],s:[26,48,2],da:1.01,t:"FLOOR"},{id:0,p:[-79,78,-136],s:[20,4,4],col:1,da:1.39,t:"WALL"},{id:0,p:[-50,78,-147],s:[12,6,26],col:1,da:1.37,t:"WALL"},{id:0,p:[-47,78,-196],s:[6,4,30],col:1,da:1.39,t:"WALL"},{id:0,p:[-47,78,-235],s:[6,6,18],col:1,da:1.39,t:"WALL"},{id:0,p:[-99,78,-210],s:[6,6,18],col:1,da:1.37,t:"WALL"},{id:0,p:[19,82,-188],s:[6,6,26],col:1,t:"WALL"},{id:0,p:[71,82,-184],s:[6,4,18],col:1,t:"WALL"},{id:0,p:[19,82,-233],s:[6,4,26],col:1,t:"WALL"},{id:0,p:[71,82,-222],s:[6,6,32],col:1,t:"WALL"},{id:0,p:[71,82,-259],s:[6,4,22],col:1,t:"WALL"},{id:0,p:[184,41,-7],s:[12,4,4],t:"FLOOR"},{id:0,p:[-41,38,-202],s:[6,6,4],t:"WALL"},{id:0,p:[8,44,93],s:[6,4,2],da:.82,t:"WALL"},{id:0,p:[22,45,92],s:[6,4,4],da:.79,t:"WALL"},{id:0,p:[22,44,49],s:[6,4,2],da:.97,t:"WALL"},{id:0,p:[6,42,49],s:[2,6,2],da:1.06,t:"WALL"},{id:0,p:[9,26,50],s:[8,2,4],col:1,da:.97,t:"WALL"},{id:0,p:[21,26,92],s:[8,2,4],col:1,da:.68,t:"WALL"},{id:0,p:[10,16,101],s:[6,2,4],col:1,da:.95,t:"WALL"},{id:0,p:[18,24,44],s:[2,2,4],col:1,da:1.06,t:"WALL"},{id:0,p:[24,26,50],s:[2,4,4],col:1,da:.97,t:"WALL"},{id:0,p:[126,106,-234],s:[10,4,12],col:1,da:1.7,t:"WALL"},{id:0,p:[123,106,-254],s:[4,2,12],col:1,da:1.7,t:"WALL"},{id:0,p:[129,106,-272],s:[16,4,8],col:1,da:1.7,t:"WALL"},{id:0,p:[149,106,-230],s:[24,2,4],col:1,da:1.7,t:"WALL"},{id:0,p:[180,106,-230],s:[18,4,4],col:1,da:1.7,t:"WALL"},{id:0,p:[205,106,-230],s:[16,2,4],col:1,da:1.7,t:"WALL"},{id:0,p:[243,133,-215],s:[10,4,4],da:1.26,t:"WALL"},{id:0,p:[243,137,-217],s:[6,18,2],col:1,da:.13,t:"WALL"},{id:0,p:[213,137,-247],s:[2,18,6],col:1,da:.13,t:"WALL"},{id:0,p:[211,133,-247],s:[4,4,10],da:1.26,t:"WALL"},{id:0,p:[221,180,-226],s:[16,4,18],col:1,da:1.7,t:"WALL"},{id:0,p:[246,180,-220],s:[16,2,6],col:1,da:1.7,t:"WALL"},{id:0,p:[267,180,-226],s:[8,4,18],col:1,da:1.7,t:"WALL"},{id:0,p:[216,180,-254],s:[6,2,18],col:1,da:1.7,t:"WALL"},{id:0,p:[-152,1,134],s:[48,8,16],v:1,da:.95,t:"WALL"},{id:0,p:[10,1,103],s:[48,8,16],v:1,da:.95,t:"WALL"},{id:0,p:[-71,0,-125],s:[48,8,16],v:1,da:.95,t:"WALL"},{id:0,p:[-66,7,-125],s:[24,8,16],v:1,da:.95,t:"WALL"},{id:0,p:[-147,8,134],s:[24,8,16],v:1,da:.95,t:"WALL"},{id:0,p:[15,8,103],s:[24,8,16],v:1,da:.95,t:"WALL"},{id:0,p:[-201,56,228],s:[8,6,12],col:1,da:1.06,t:"WALL"},{id:0,p:[-214,0,278],s:[52,104,8],da:.84,t:"WALL"},{id:0,p:[-214,104,278],s:[20,4,8],col:1,da:.84,t:"WALL"},{id:0,p:[208,165,-247],s:[10,4,4],t:"FLOOR"},{id:0,p:[208,165,-227],s:[10,4,4],t:"FLOOR"},{id:0,p:[208,165,-268],s:[10,4,4],t:"FLOOR"},{id:0,p:[222,165,-212],s:[4,4,10],t:"FLOOR"},{id:0,p:[243,165,-212],s:[4,4,10],t:"FLOOR"},{id:0,p:[262,165,-212],s:[4,4,10],t:"FLOOR"},{id:0,p:[-29,102,53],s:[24,4,4],col:1,da:1.12,t:"WALL"},{id:0,p:[-151,54,-145],s:[14,4,4],col:1,da:1.54,t:"WALL"},{id:0,p:[-104,62,12],s:[2,6,6],a:1,da:1.15,t:"WALL"},{id:0,p:[-104,62,-14],s:[2,10,2],a:1,da:1.15,t:"WALL"},{id:0,p:[-245,0,-289],s:[130,146,92],da:.97,t:"WALL"},{id:0,p:[-154,102,-258],s:[22,6,8],col:1,t:"WALL"},{id:0,p:[-191,146,-255],s:[22,8,24],col:1,da:1.04,t:"WALL"},{id:0,p:[-288,146,-203],s:[42,8,8],col:1,da:.97,t:"WALL"},{id:0,p:[-235,146,-207],s:[28,8,16],col:1,da:.95,t:"WALL"},{id:0,p:[-185,146,-294],s:[10,6,24],col:1,da:.95,t:"WALL"},{id:0,p:[-194,146,-326],s:[28,10,18],col:1,da:.9,t:"WALL"},{id:0,p:[-94,106,209],s:[6,20,2],col:1,da:.04,t:"WALL"},{id:0,p:[-202,98,-241],s:[14,6,4],da:.53,t:"WALL"},{id:0,p:[-44,0,-282],s:[164,126,76],da:1.46,t:"WALL"},{id:0,p:[-115,126,-256],s:[22,8,24],col:1,da:1.48,t:"WALL"},{id:0,p:[-67,126,-248],s:[22,6,8],col:1,da:1.48,t:"WALL"},{id:0,p:[-25,126,-248],s:[32,2,8],col:1,da:1.52,t:"WALL"},{id:0,p:[22,126,-254],s:[32,4,20],col:1,da:1.52,t:"WALL"},{id:0,p:[34,126,-292],s:[8,6,26],col:1,da:1.5,t:"WALL"},{id:0,p:[-122,126,-306],s:[8,6,26],col:1,da:1.52,t:"WALL"},{id:0,p:[-238,119,64],s:[32,4,6],col:1,da:1.06,t:"WALL"},{id:0,p:[-287,119,64],s:[20,6,6],col:1,da:1.06,t:"WALL"},{id:0,p:[-233,119,-70],s:[36,6,6],col:1,da:1.06,t:"WALL"},{id:0,p:[-285,119,-70],s:[28,4,6],col:1,da:1.06,t:"WALL"},{id:0,p:[-235,104,186],s:[10,6,44],col:1,da:1.48,t:"WALL"},{id:0,p:[-101,96,-244],s:[6,14,2],col:1,da:.04,t:"WALL"},{id:0,p:[-101,92,-243],s:[12,4,4],da:.75,t:"WALL"},{id:1,p:[-162,54,-178],s:[12,12,12]},{id:0,p:[-1,0,-93],s:[36,60,6],t:"FLOOR"},{id:1,p:[-117,0,-137],s:[12,12,12]},{id:2,p:[-127,0,-139],s:[7,8,7]},{id:0,p:[-147,0,-126],s:[4,48,4],t:"FLOOR"},{id:0,p:[-166,42,-133],s:[44,2,20],t:"FLOOR"},{id:0,p:[-185,0,-126],s:[4,46,4],t:"FLOOR"},{id:0,p:[-265,0,-221],s:[88,146,44],da:.97,t:"WALL"},{id:0,p:[-226,146,-237],s:[10,6,12],col:1,da:.95,t:"WALL"},{id:0,p:[-223,146,-249],s:[16,6,12],col:1,da:.95,t:"WALL"},{id:0,p:[96,0,-254],s:[52,82,24],t:"WALL"},{id:1,p:[-181,0,26],s:[12,12,12]},{id:1,p:[-181,12,18],s:[12,12,12]},{id:0,p:[-222,0,-123],s:[4,2,8],col:1,da:.95,t:"WALL"},{id:0,p:[-173,0,-240],s:[4,2,8],col:1,da:.95,t:"WALL"},{id:0,p:[-203,0,-166],s:[10,2,6],col:1,da:.95,t:"WALL"}]}],nd=0;nd<id.length;++nd)for(var sd=0;sd<id[nd].objects.length;++sd)id[nd].objects[sd].id=rd.prefabIDS[id[nd].objects[sd].id];ed.exports.maps=id,ed.exports.manager=function(dd,ld,pd,cd){var md,ud;this.manager=new(ad(26).manager)(dd,pd,cd),this.maps=id,this.spawns=[],this.lastGen=null,this.getRandomMap=function(){return pd.randInt(0,this.maps.length-1)},this.getRandomMode=function(gd){return this.maps[gd].modes[pd.randInt(0,this.maps[gd].modes.length-1)]},this.getRandomBiome=function(gd){return this.maps[gd].biomes[pd.randInt(0,this.maps[gd].biomes.length-1)]},this.generate=function(gd,hd,fd,yd){var xd=this.maps[gd];dd&&(mapInfo.innerHTML=hd.alias+"_"+xd.name,curGameInfo.innerHTML=hd.name+"<div style='color:rgba(255,255,255,0.6)'>on "+xd.name+"</div>");var vd=gd+" - "+fd;if(yd||this.lastGen!==vd){var Ld=null;this.lastGen=vd,this.manager.removeAll(),ld&&ld.reset(),dd&&dd.init(xd,fd);for(var bd=0;bd<xd.objects.length;++bd){var _d=(md=xd.objects[bd]).p[0],Ad=md.p[1],Ed=md.p[2];if("CUBE"==md.id){for(var Sd=1,Td=0,Md=0;Md<xd.objects.length;++Md)if(("CUBE"==(ud=xd.objects[Md]).id||"PLANE"==ud.id)&&md!=ud&&Ad<=ud.p[1]+ud.s[1]&&Ad>=ud.p[1]&&_d+md.s[0]/2<ud.p[0]+ud.s[0]/2&&_d-md.s[0]/2>ud.p[0]-ud.s[0]/2&&Ed+md.s[2]/2<ud.p[2]+ud.s[2]/2&&Ed-md.s[2]/2>ud.p[2]-ud.s[2]/2){Sd=0;break}Sd&&(Td=Math.abs(Ad/(Ad+md.s[1]))),this.manager.addBlock(_d,Ad,Ed,md.s[0],md.s[2],md.s[1],[1,1,1,Sd,1,1],{src:md.t.toLowerCase()+"_0",darken:md.da,amb:Td,noAmb:md.a,yR:md.r?md.r[0]:0,xR:md.r?md.r[1]:0,noCol:md.col,noVis:md.v})}else"PLANE"==md.id?md.ter?Ld=md:this.manager.addPlane(_d,Ad,Ed,md.s[2]/2,md.s[0]/2,{src:md.t.toLowerCase()+"_0",scale:1,col:!md.col,noVis:md.v},0,Math.PI/2):"RAMP"==md.id?this.manager.addRamp(_d,Ad,Ed,md.s[0],md.s[1],md.s[2],md.d*Math.PI/2):"LADDER"==md.id?this.manager.addLadder(_d,Ad,Ed,md.s[1],md.d*Math.PI/2):this.manager.addMesh(_d,Ad,Ed,md.r?md.r[1]?md.r[1]:Math.PI:0,md.s[0]/2,md.s[1]/2,md.s[2]/2,md.id.toLowerCase(),md.col)}if(dd){var Rd=cd.ambScale,Pd=[],wd;for(bd=0;bd<this.manager.objects.length;++bd)if(!(md=this.manager.objects[bd]).noVis&&!md.complexMesh)for(Md=0;Md<this.manager.objects.length;++Md)if(!(ud=this.manager.objects[Md]).noVis&&!ud.complexMesh&&this.manager.collision(md,ud,0)){if(Md>bd){if(wd=pd.boxIntersection(md,ud,"x","z",[Math.PI,0,Math.PI/2,-Math.PI/2]))for(var Cd=0;Cd<wd.length;++Cd)for(var Od=pd.getIntersection(md,ud,"y"),Id=0,Dd;2>Id;Id++)Dd=(wd[Cd].d+Math.PI/2*Id)%(2*Math.PI),Rd=this.manager.limitAmb(cd.ambScale,wd[Cd],Dd,"x","z",md,ud),this.manager.addAmbient(wd[Cd].x+Rd*Math.cos(Dd),Od.y,wd[Cd].z+Rd*Math.sin(Dd),-Dd+Math.PI,0,0,Od.height,Rd,1);if(wd=pd.boxIntersection(md,ud,"z","y",[Math.PI,0,-Math.PI/2,Math.PI/2]))for(Cd=0;Cd<wd.length;++Cd)for(Od=pd.getIntersection(md,ud,"x"),Id=0;2>Id;Id++)Dd=wd[Cd].d+Math.PI/2*(Id?0:1),Rd=this.manager.limitAmb(cd.ambScale,wd[Cd],-Dd+Math.PI/2,"z","y",md,ud),this.manager.addAmbient(Od.x,wd[Cd].y+Rd*Math.cos(Dd),wd[Cd].z+Rd*Math.sin(Dd),0,Dd,-Math.PI/2,Od.width,Rd,1);if(wd=pd.boxIntersection(md,ud,"x","y",[Math.PI,0,-Math.PI/2,Math.PI/2]))for(Cd=0;Cd<wd.length;++Cd)for(Od=pd.getIntersection(md,ud,"z"),Id=0;2>Id;Id++)Dd=wd[Cd].d+Math.PI/2*(Id?0:1),Rd=this.manager.limitAmb(cd.ambScale,wd[Cd],-Dd+Math.PI/2,"x","y",md,ud),this.manager.addAmbient(wd[Cd].x+Rd*Math.sin(Dd),wd[Cd].y+Rd*Math.cos(Dd),Od.z,Math.PI/2,Dd,-Math.PI/2,Od.length,Rd,1)}var Fd=md.y+md.height>ud.y+ud.height,Bd=md.y-md.height<ud.y-ud.height;if((Fd||Bd)&&(wd=pd.boxCornerIntersection(md,ud,"x","z")))for(Cd=0;Cd<wd.length;++Cd)for(Rd=Math.sqrt(2)*cd.ambScale,Dd=wd[Cd].d-Math.PI/4,Id=0;2>Id;++Id)if((Id||Fd)&&(!Id||Bd)){var Ud=pd.limitRect(wd[Cd].x-Rd*Math.sin(Dd),wd[Cd].z-Rd*Math.cos(Dd),cd.ambScale,cd.ambScale,wd[Cd].d,ud,"x","z");Pd.push(this.manager.addAmbient(Ud.x,ud.y+(ud.height+.025)*(Id?-1:1),Ud.z,wd[Cd].d,Math.PI/2,0,Ud.width,Ud.length,0,!0)),Pd[Pd.length-1].org={x:wd[Cd].x,y:Pd[Pd.length-1].y,z:wd[Cd].z}}var Nd=md.x+md.width>ud.x+ud.width,Wd=md.x-md.width<ud.x-ud.width;if(Nd||Wd){var zd=[Math.PI/2,0,Math.PI,-Math.PI/2];if(wd=pd.boxCornerIntersection(md,ud,"z","y"))for(Cd=0;Cd<wd.length;++Cd)for(Rd=Math.sqrt(2)*cd.ambScale,Dd=wd[Cd].d-Math.PI/4,Id=0;2>Id;++Id)(Id||Nd)&&(!Id||Wd)&&(Ud=pd.limitRect(wd[Cd].z-Rd*Math.sin(Dd),wd[Cd].y-Rd*Math.cos(Dd),cd.ambScale,cd.ambScale,wd[Cd].d,ud,"z","y"),Pd.push(this.manager.addAmbient(ud.x+(ud.width+.025)*(Id?-1:1),Ud.y,Ud.z,Math.PI/2,Math.PI,zd[wd[Cd].i],Ud.length,Ud.height,0,!0)),Pd[Pd.length-1].org={x:Pd[Pd.length-1].x,y:wd[Cd].y,z:wd[Cd].z})}var Hd=md.z+md.length>ud.z+ud.length,Gd=md.z-md.length<ud.z-ud.length;if((Hd||Gd)&&(zd=[-Math.PI/2,Math.PI,0,Math.PI/2],wd=pd.boxCornerIntersection(md,ud,"x","y")))for(Cd=0;Cd<wd.length;++Cd)for(Rd=Math.sqrt(2)*cd.ambScale,Dd=wd[Cd].d-Math.PI/4,Id=0;2>Id;++Id)(Id||Hd)&&(!Id||Gd)&&(Ud=pd.limitRect(wd[Cd].x-Rd*Math.sin(Dd),wd[Cd].y-Rd*Math.cos(Dd),cd.ambScale,cd.ambScale,wd[Cd].d,ud,"x","y"),Pd.push(this.manager.addAmbient(Ud.x,Ud.y,ud.z+(ud.length+.025)*(Id?-1:1),0,0,zd[wd[Cd].i],Ud.width,Ud.height,0,!0)),Pd[Pd.length-1].org={x:wd[Cd].x,y:wd[Cd].y,z:Pd[Pd.length-1].z})}for(bd=0;bd<Pd.length;++bd){var Vd=!0;for(md=Pd[bd],Md=0;Md<Pd.length;++Md)if(bd!=Md&&pd.sharePos(md.org,Pd[Md].org)){Vd=!1;break}Vd&&this.manager.addAmbient(md.x,md.y,md.z,md.xD,md.yD,md.zD,md.w,md.h,md.i)}Pd.length=0}if(Ld){var kd=Ld.s[2]/2;Rd=Ld.s[0]/2,this.manager.addPlane(0,0,0,kd,Rd,{yOff:-kd,col:!0,scale:1,src:fd.terrain},0,-Math.PI/2),this.manager.addPlane(0,-.1,0,kd,Rd,{yOff:-kd,tilesX:Math.round(Rd/cd.terrainGrid),tilesZ:Math.round(kd/cd.terrainGrid),noise:4,margin:3,objects:this.manager.objects,scale:1,src:fd.terrain},0,-Math.PI/2),ld&&fd.particles&&fd.particles(ld,Math.max(kd,Rd))}for(this.spawns.length=0,bd=0;bd<xd.spawns.length;++bd)this.spawns.push({x:xd.spawns[bd][0],y:xd.spawns[bd][1],z:xd.spawns[bd][2]});dd&&dd.addMeshGroups()}}}},function(ed,td,ad){var rd=ad(2);const od=ad(1);ad(23);var nd={},id;ed.exports.getColor=function(md,ud){var gd=md+"-"+(ud||""),hd=nd[gd];return hd||(hd=new rd.Color(md),ud&&hd.multiplyScalar(ud),nd[gd]=hd),hd},ed.exports.colorize=function(md,ud,gd){ud=gd||ed.exports.getColor(ud);for(var hd=0;hd<md.faces.length;++hd)md.faces[hd].vertexColors[0]=ud,md.faces[hd].vertexColors[1]=ud,md.faces[hd].vertexColors[2]=ud};var sd=function(md,ud,gd,hd){for(var fd=new rd.Vector2(ud,gd).multiplyScalar(hd||1),yd=0;yd<md.faceVertexUvs.length;yd++)for(var xd=md.faceVertexUvs[yd],vd=0;vd<xd.length;vd++)for(var Ld=0,bd;3>Ld;Ld++)bd=xd[vd][Ld].multiply(fd),bd.x=.5+bd.x-fd.x/2},dd=function(md,ud,gd,hd,fd,yd){return md>=gd-fd&&md<=gd+fd&&ud>=hd-yd&&ud<=hd+yd},ld=[],pd=["a","b","c","d"];ed.exports.generatePlane=function(md,ud,gd){md*=gd.ratio||1;var hd=(gd.scale?md+"_"+ud+"_":"")+(gd.scale||"")+(gd.tilesX||"")+(gd.tilesZ||"")+(gd.color||"")+(gd.darken||"");if(!(id=ld[hd])){if(id=new rd.PlaneGeometry(1,1,gd.tilesX||1,gd.tilesZ||1),gd.noise){for(var fd={},yd=gd.margin||0,xd=0;xd<id.vertices.length;++xd){var vd=id.vertices[xd].x,Ld=id.vertices[xd].y;if(!gd.pinEdges||-.5!=vd&&.5!=vd&&-.5!=Ld&&.5!=Ld)if(gd.objects){for(var bd=0;bd<gd.objects.length;++bd)if(.1>=gd.objects[bd].y-gd.objects[bd].height&&2*gd.objects[bd].height>gd.noise&&dd(2*(-Ld*md),2*(vd*ud),gd.objects[bd].z,gd.objects[bd].x,gd.objects[bd].length+yd,gd.objects[bd].width+yd)){id.vertices[xd].z=Math.random()*gd.noise+1,fd[xd]=ed.exports.getColor(gd.color,.65);break}}else id.vertices[xd].z=Math.random()*gd.noise;fd[xd]||(fd[xd]=ed.exports.getColor(gd.color))}for(xd=0;xd<id.faces.length;xd++){for(var _d=id.faces[xd],Ad=0,Ed=0;3>Ed;Ed++)_d.vertexColors[Ed]=fd[_d[pd[Ed]]],0>=id.vertices[_d[pd[Ed]]].z&&Ad++;3<=Ad&&delete id.faces[xd]}id.faces=id.faces.filter(function(Sd){return Sd}),id.elementsNeedUpdate=!0}else gd.color?ed.exports.colorize(id,gd.color):gd.darken&&ed.exports.colorize(id,null,ed.exports.getColor(16777215,gd.darken));gd.scale&&sd(id,ud/od.worldUV,md/od.worldUV,gd.scale),ld[hd]=id}return id};var cd=[];ed.exports.generateCube=function(md,ud,gd,hd,fd){md=md||[1,1,1,1,1,1];for(var yd=(fd.scale?ud+"_"+gd+"_"+hd+"_":"")+(fd.darken||"")+(fd.scale||"")+(fd.amb||"")+(fd.noAmb||""),xd=0;xd<md.length;++xd)yd+="_"+md[xd];if(!(id=cd[yd])){fd.darken=fd.darken||1;var vd=ed.exports.getColor(16777215,fd.darken),Ld=fd.noAmb?vd:fd.amb?ed.exports.getColor(16777215,(od.ambientVal+fd.amb*(1-od.ambientVal))*fd.darken):ed.exports.getColor(16777215,od.ambientVal*fd.darken),bd=fd.noAmb||!fd.amb&&md[3]?vd:Ld;id=new rd.Geometry;var Ad=[],_d;for(md[0]&&((_d=new rd.PlaneGeometry(1,1)).rotateY(Math.PI/2),_d.translate(.5,.5,0),_d.faces[0].vertexColors=[vd,bd,vd],_d.faces[1].vertexColors=[bd,bd,vd],fd.scale&&sd(_d,hd/od.worldUV,gd/od.worldUV,fd.scale),Ad.push(_d)),md[1]&&((_d=new rd.PlaneGeometry(1,1)).rotateY(-Math.PI/2),_d.translate(-.5,.5,0),_d.faces[0].vertexColors=[vd,bd,vd],_d.faces[1].vertexColors=[bd,bd,vd],fd.scale&&sd(_d,hd/od.worldUV,gd/od.worldUV,fd.scale),Ad.push(_d)),md[2]&&((_d=new rd.PlaneGeometry(1,1)).rotateX(-Math.PI/2),_d.translate(0,1,0),_d.faces[0].vertexColors=[vd,vd,vd],_d.faces[1].vertexColors=[vd,vd,vd],fd.scale&&sd(_d,ud/od.worldUV,hd/od.worldUV,fd.scale),Ad.push(_d)),md[3]&&((_d=new rd.PlaneGeometry(1,1)).rotateX(Math.PI/2),_d.translate(0,0,0),_d.faces[0].vertexColors=[bd,bd,bd],_d.faces[1].vertexColors=[bd,bd,bd],fd.scale&&sd(_d,ud/od.worldUV,hd/od.worldUV,fd.scale),Ad.push(_d)),md[4]&&((_d=new rd.PlaneGeometry(1,1)).translate(0,.5,.5),_d.faces[0].vertexColors=[vd,bd,vd],_d.faces[1].vertexColors=[bd,bd,vd],fd.scale&&sd(_d,ud/od.worldUV,gd/od.worldUV,fd.scale),Ad.push(_d)),md[5]&&((_d=new rd.PlaneGeometry(1,1)).rotateY(Math.PI),_d.translate(0,.5,-.5),_d.faces[0].vertexColors=[vd,bd,vd],_d.faces[1].vertexColors=[bd,bd,vd],fd.scale&&sd(_d,ud/od.worldUV,gd/od.worldUV,fd.scale),Ad.push(_d)),xd=0;xd<Ad.length;xd++)id.merge(Ad[xd],new rd.Matrix4);cd[yd]=id}return id}},function(ed){!function(rd){function od(ld){for(var pd in dd)ld[pd]=dd[pd];return ld}function id(ld,pd){var cd;if(!arguments.length)delete this[sd];else if(pd){if(cd=nd(this,ld,!0)){if(!(cd=cd.filter(function(md){return md!==pd&&md.originalListener!==pd})).length)return id.call(this,ld);this[sd][ld]=cd}}else if((cd=this[sd])&&(delete cd[ld],!Object.keys(cd).length))return id.call(this);return this}function nd(ld,pd,cd){if(!cd||ld[sd]){var md=ld[sd]||(ld[sd]={});return md[pd]||(md[pd]=[])}}ed.exports=rd;var sd="listeners",dd={on:function(ld,pd){return nd(this,ld).push(pd),this},once:function(ld,pd){function cd(){id.call(md,ld,cd),pd.apply(this,arguments)}var md=this;return cd.originalListener=pd,nd(md,ld).push(cd),md},off:id,emit:function(ld,pd){var cd=this,md=nd(cd,ld,!0);if(!md)return!1;var ud=arguments.length;if(1===ud)md.forEach(function(hd){hd.call(cd)});else if(2===ud)md.forEach(function(hd){hd.call(cd,pd)});else{var gd=Array.prototype.slice.call(arguments,1);md.forEach(function(hd){hd.apply(cd,gd)})}return!!md.length}};od(rd.prototype),rd.mixin=od}(function rd(){if(!(this instanceof rd))return new rd})},function(ed,td,ad){function rd(Cd,Od){var Dd={},Fd=Array(Od),Bd=Array(Od),Ud=Cd.codec.decode,Id;for(Id=0;Id<Od;Id++)Fd[Id]=Ud(Cd),Bd[Id]=Ud(Cd);for(Id=0;Id<Od;Id++)Dd[Fd[Id]]=Bd[Id];return Dd}function od(Cd,Od){var Dd=new Map,Fd=Array(Od),Bd=Array(Od),Ud=Cd.codec.decode,Id;for(Id=0;Id<Od;Id++)Fd[Id]=Ud(Cd),Bd[Id]=Ud(Cd);for(Id=0;Id<Od;Id++)Dd.set(Fd[Id],Bd[Id]);return Dd}function id(Cd,Od){for(var Id=Array(Od),Dd=Cd.codec.decode,Fd=0;Fd<Od;Fd++)Id[Fd]=Dd(Cd);return Id}function nd(Cd,Od){var Id=Cd.reserve(Od);return wd.toString.call(Cd.buffer,"utf-8",Id,Id+Od)}function sd(Cd,Od){var Id=Cd.reserve(Od),Fd=wd.slice.call(Cd.buffer,Id,Id+Od);return Md.from(Fd)}function dd(Cd,Od){var Id=Cd.reserve(Od),Fd=wd.slice.call(Cd.buffer,Id,Id+Od);return Md.Uint8Array.from(Fd).buffer}function ld(Cd,Od){var Id=Cd.reserve(Od+1),Dd=Cd.buffer[Id++],Fd=Id+Od,Bd=Cd.codec.getExtUnpacker(Dd);if(!Bd)throw new Error("Invalid ext type: "+(Dd?"0x"+Dd.toString(16):Dd));return Bd(wd.slice.call(Cd.buffer,Id,Fd))}function pd(Cd){var Od=Cd.reserve(1);return Cd.buffer[Od]}function cd(Cd){var Od=Cd.reserve(1),Id=Cd.buffer[Od];return 128&Id?Id-256:Id}function md(Cd){var Od=Cd.reserve(2),Id=Cd.buffer;return Id[Od++]<<8|Id[Od]}function ud(Cd){var Od=Cd.reserve(2),Id=Cd.buffer,Dd=Id[Od++]<<8|Id[Od];return 32768&Dd?Dd-65536:Dd}function gd(Cd){var Od=Cd.reserve(4),Id=Cd.buffer;return 16777216*Id[Od++]+(Id[Od++]<<16)+(Id[Od++]<<8)+Id[Od]}function hd(Cd){var Od=Cd.reserve(4),Id=Cd.buffer;return Id[Od++]<<24|Id[Od++]<<16|Id[Od++]<<8|Id[Od]}function fd(Cd,Od){return function(Id){var Dd=Id.reserve(Cd);return Od.call(Id.buffer,Dd,!0)}}function yd(Cd){return new Sd(this,Cd).toNumber()}function xd(Cd){return new Td(this,Cd).toNumber()}function vd(Cd){return new Sd(this,Cd)}function Ld(Cd){return new Td(this,Cd)}function bd(Cd){return Ad.read(this,Cd,!1,23,4)}function _d(Cd){return Ad.read(this,Cd,!1,52,8)}var Ad=ad(8),Ed=ad(6),Sd=Ed.Uint64BE,Td=Ed.Int64BE;td.getReadFormat=function(Cd){var Od=Md.hasArrayBuffer&&Cd&&Cd.binarraybuffer,Id=Cd&&Cd.int64;return{map:Rd&&Cd&&Cd.usemap?od:rd,array:id,str:nd,bin:Od?dd:sd,ext:ld,uint8:pd,uint16:md,uint32:gd,uint64:fd(8,Id?vd:yd),int8:cd,int16:ud,int32:hd,int64:fd(8,Id?Ld:xd),float32:fd(4,bd),float64:fd(8,_d)}},td.readUint8=pd;var Md=ad(0),wd=ad(7),Rd="undefined"!=typeof Map},function(ed,td,ad){function rd(id){if(!(this instanceof rd))return new rd(id);if(id&&(this.options=id,id.codec)){var nd=this.codec=id.codec;nd.bufferish&&(this.bufferish=nd.bufferish)}}td.DecodeBuffer=rd;var od=ad(5).preset;ad(18).FlexDecoder.mixin(rd.prototype),rd.prototype.codec=od,rd.prototype.fetch=function(){return this.codec.decode(this)}},function(ed,td,ad){td.decode=function(od,id){var nd=new rd(id);return nd.write(od),nd.read()};var rd=ad(16).DecodeBuffer},function(ed,td,ad){function rd(){if(!(this instanceof rd))return new rd}function od(){if(!(this instanceof od))return new od}function sd(){return this.buffers&&this.buffers.length?(this.flush(),this.pull()):this.fetch()}function dd(ud){(this.buffers||(this.buffers=[])).push(ud)}function pd(ud){return function(gd){for(var hd in ud)gd[hd]=ud[hd];return gd}}td.FlexDecoder=rd,td.FlexEncoder=od;var cd=ad(0),md="BUFFER_SHORTAGE";rd.mixin=pd({bufferish:cd,write:function(ud){var gd=this.offset?cd.prototype.slice.call(this.buffer,this.offset):this.buffer;this.buffer=gd?ud?this.bufferish.concat([gd,ud]):gd:ud,this.offset=0},fetch:function(){throw new Error("method not implemented: fetch()")},flush:function(){for(;this.offset<this.buffer.length;){var gd=this.offset,ud;try{ud=this.fetch()}catch(hd){if(hd&&hd.message!=md)throw hd;this.offset=gd;break}this.push(ud)}},push:dd,pull:function(){return(this.buffers||(this.buffers=[])).shift()},read:sd,reserve:function(ud){var gd=this.offset,hd=gd+ud;if(hd>this.buffer.length)throw new Error(md);return this.offset=hd,gd},offset:0}),rd.mixin(rd.prototype),od.mixin=pd({bufferish:cd,write:function(){throw new Error("method not implemented: write()")},fetch:function(){var ud=this.start;if(ud<this.offset){var gd=this.start=this.offset;return cd.prototype.slice.call(this.buffer,ud,gd)}},flush:function(){for(;this.start<this.offset;){var ud=this.fetch();ud&&this.push(ud)}},push:dd,pull:function(){var ud=this.buffers||(this.buffers=[]),gd=1<ud.length?this.bufferish.concat(ud):ud[0];return ud.length=0,gd},read:sd,reserve:function(ud){var gd=0|ud;if(this.buffer){var hd=this.buffer.length,fd=0|this.offset,yd=fd+gd;if(yd<hd)return this.offset=yd,fd;this.flush(),ud=Math.max(ud,Math.min(2*hd,this.maxBufferSize))}return ud=Math.max(ud,this.minBufferSize),this.buffer=this.bufferish.alloc(ud),this.start=0,this.offset=gd,0},send:function(ud){var gd=ud.length;if(gd>this.minBufferSize)this.flush(),this.push(ud);else{var hd=this.reserve(gd);cd.prototype.copy.call(ud,this.buffer,hd)}},maxBufferSize:65536,minBufferSize:2048,offset:0,start:0}),od.mixin(od.prototype)},function(ed,td){function ad(id){return function(nd){var sd=nd.reserve(1);nd.buffer[sd]=id}}for(var rd=td.uint8=Array(256),od=0;255>=od;od++)rd[od]=ad(od)},function(ed,td,ad){"use strict";(function(rd){function od(){return nd.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function id(kd,jd){if(od()<jd)throw new RangeError("Invalid typed array length");return nd.TYPED_ARRAY_SUPPORT?(kd=new Uint8Array(jd)).__proto__=nd.prototype:(null===kd&&(kd=new nd(jd)),kd.length=jd),kd}function nd(kd,jd,Yd){if(!(nd.TYPED_ARRAY_SUPPORT||this instanceof nd))return new nd(kd,jd,Yd);if("number"==typeof kd){if("string"==typeof jd)throw new Error("If encoding is specified then the first argument must be a string");return ld(this,kd)}return sd(this,kd,jd,Yd)}function sd(kd,jd,Yd,Xd){if("number"==typeof jd)throw new TypeError("\"value\" argument must not be a number");return"undefined"!=typeof ArrayBuffer&&jd instanceof ArrayBuffer?function(qd,Zd,Jd,Kd){if(Zd.byteLength,0>Jd||Zd.byteLength<Jd)throw new RangeError("'offset' is out of bounds");if(Zd.byteLength<Jd+(Kd||0))throw new RangeError("'length' is out of bounds");return Zd=void 0===Jd&&void 0===Kd?new Uint8Array(Zd):void 0===Kd?new Uint8Array(Zd,Jd):new Uint8Array(Zd,Jd,Kd),nd.TYPED_ARRAY_SUPPORT?(qd=Zd).__proto__=nd.prototype:qd=pd(qd,Zd),qd}(kd,jd,Yd,Xd):"string"==typeof jd?function(qd,Zd,Jd){if("string"==typeof Jd&&""!==Jd||(Jd="utf8"),!nd.isEncoding(Jd))throw new TypeError("\"encoding\" must be a valid string encoding");var Kd=0|md(Zd,Jd),Qd=(qd=id(qd,Kd)).write(Zd,Jd);return Qd!==Kd&&(qd=qd.slice(0,Qd)),qd}(kd,jd,Yd):function(qd,Zd){if(nd.isBuffer(Zd)){var Jd=0|cd(Zd.length);return 0===(qd=id(qd,Jd)).length?qd:(Zd.copy(qd,0,0,Jd),qd)}if(Zd){if("undefined"!=typeof ArrayBuffer&&Zd.buffer instanceof ArrayBuffer||"length"in Zd)return"number"!=typeof Zd.length||function(Kd){return Kd!=Kd}(Zd.length)?id(qd,0):pd(qd,Zd);if("Buffer"===Zd.type&&Hd(Zd.data))return pd(qd,Zd.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(kd,jd)}function dd(kd){if("number"!=typeof kd)throw new TypeError("\"size\" argument must be a number");if(0>kd)throw new RangeError("\"size\" argument must not be negative")}function ld(kd,jd){if(dd(jd),kd=id(kd,0>jd?0:0|cd(jd)),!nd.TYPED_ARRAY_SUPPORT)for(var Yd=0;Yd<jd;++Yd)kd[Yd]=0;return kd}function pd(kd,jd){var Yd=0>jd.length?0:0|cd(jd.length);kd=id(kd,Yd);for(var Xd=0;Xd<Yd;Xd+=1)kd[Xd]=255&jd[Xd];return kd}function cd(kd){if(kd>=od())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+od().toString(16)+" bytes");return 0|kd}function md(kd,jd){if(nd.isBuffer(kd))return kd.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(kd)||kd instanceof ArrayBuffer))return kd.byteLength;"string"!=typeof kd&&(kd=""+kd);var Yd=kd.length;if(0===Yd)return 0;for(var Xd=!1;;)switch(jd){case"ascii":case"latin1":case"binary":return Yd;case"utf8":case"utf-8":case void 0:return Bd(kd).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*Yd;case"hex":return Yd>>>1;case"base64":return Ud(kd).length;default:if(Xd)return Bd(kd).length;jd=(""+jd).toLowerCase(),Xd=!0;}}function ud(kd,jd,Yd){var Xd=kd[jd];kd[jd]=kd[Yd],kd[Yd]=Xd}function gd(kd,jd,Yd,Xd,qd){if(0===kd.length)return-1;if("string"==typeof Yd?(Xd=Yd,Yd=0):2147483647<Yd?Yd=2147483647:-2147483648>Yd&&(Yd=-2147483648),Yd=+Yd,isNaN(Yd)&&(Yd=qd?0:kd.length-1),0>Yd&&(Yd=kd.length+Yd),Yd>=kd.length){if(qd)return-1;Yd=kd.length-1}else if(0>Yd){if(!qd)return-1;Yd=0}if("string"==typeof jd&&(jd=nd.from(jd,Xd)),nd.isBuffer(jd))return 0===jd.length?-1:hd(kd,jd,Yd,Xd,qd);if("number"==typeof jd)return jd&=255,nd.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?qd?Uint8Array.prototype.indexOf.call(kd,jd,Yd):Uint8Array.prototype.lastIndexOf.call(kd,jd,Yd):hd(kd,[jd],Yd,Xd,qd);throw new TypeError("val must be string, number or Buffer")}function hd(kd,jd,Yd,Xd,qd){function Zd(rl,ol){return 1===Kd?rl[ol]:rl.readUInt16BE(ol*Kd)}var Kd=1,Qd=kd.length,$d=jd.length,Jd;if(void 0!==Xd&&("ucs2"===(Xd=(Xd+"").toLowerCase())||"ucs-2"===Xd||"utf16le"===Xd||"utf-16le"===Xd)){if(2>kd.length||2>jd.length)return-1;Kd=2,Qd/=2,$d/=2,Yd/=2}if(qd){var el=-1;for(Jd=Yd;Jd<Qd;Jd++)if(Zd(kd,Jd)!==Zd(jd,-1==el?0:Jd-el))-1!=el&&(Jd-=Jd-el),el=-1;else if(-1==el&&(el=Jd),Jd-el+1===$d)return el*Kd}else for(Yd+$d>Qd&&(Yd=Qd-$d),Jd=Yd;0<=Jd;Jd--){for(var tl=!0,al=0;al<$d;al++)if(Zd(kd,Jd+al)!==Zd(jd,al)){tl=!1;break}if(tl)return Jd}return-1}function fd(kd,jd,Yd,Xd){Yd=+Yd||0;var qd=kd.length-Yd;Xd?(Xd=+Xd)>qd&&(Xd=qd):Xd=qd;var Zd=jd.length;if(0!=Zd%2)throw new TypeError("Invalid hex string");Xd>Zd/2&&(Xd=Zd/2);for(var Jd=0,Kd;Jd<Xd;++Jd){if(Kd=parseInt(jd.substr(2*Jd,2),16),isNaN(Kd))return Jd;kd[Yd+Jd]=Kd}return Jd}function yd(kd,jd,Yd,Xd){return Nd(Bd(jd,kd.length-Yd),kd,Yd,Xd)}function xd(kd,jd,Yd,Xd){return Nd(function(qd){for(var Zd=[],Jd=0;Jd<qd.length;++Jd)Zd.push(255&qd.charCodeAt(Jd));return Zd}(jd),kd,Yd,Xd)}function vd(kd,jd,Yd,Xd){return xd(kd,jd,Yd,Xd)}function Ld(kd,jd,Yd,Xd){return Nd(Ud(jd),kd,Yd,Xd)}function bd(kd,jd,Yd,Xd){return Nd(function(qd,Zd){for(var $d=[],el=0,Jd,Kd,Qd;el<qd.length&&!(0>(Zd-=2));++el)Kd=(Jd=qd.charCodeAt(el))>>8,Qd=Jd%256,$d.push(Qd),$d.push(Kd);return $d}(jd,kd.length-Yd),kd,Yd,Xd)}function _d(kd,jd,Yd){return 0===jd&&Yd===kd.length?Wd.fromByteArray(kd):Wd.fromByteArray(kd.slice(jd,Yd))}function Ad(kd,jd,Yd){Yd=Math.min(kd.length,Yd);for(var Xd=[],qd=jd;qd<Yd;){var $d=kd[qd],el=null,tl=239<$d?4:223<$d?3:191<$d?2:1,Zd,Jd,Kd,Qd;qd+tl<=Yd&&(1==tl?128>$d&&(el=$d):2==tl?128==(192&(Zd=kd[qd+1]))&&127<(Qd=(31&$d)<<6|63&Zd)&&(el=Qd):3==tl?(Zd=kd[qd+1],Jd=kd[qd+2],128==(192&Zd)&&128==(192&Jd)&&2047<(Qd=(15&$d)<<12|(63&Zd)<<6|63&Jd)&&(55296>Qd||57343<Qd)&&(el=Qd)):4==tl?(Zd=kd[qd+1],Jd=kd[qd+2],Kd=kd[qd+3],128==(192&Zd)&&128==(192&Jd)&&128==(192&Kd)&&65535<(Qd=(15&$d)<<18|(63&Zd)<<12|(63&Jd)<<6|63&Kd)&&1114112>Qd&&(el=Qd)):void 0);null===el?(el=65533,tl=1):65535<el&&(el-=65536,Xd.push(55296|1023&el>>>10),el=56320|1023&el),Xd.push(el),qd+=tl}return function(al){var rl=al.length;if(rl<=Gd)return String.fromCharCode.apply(String,al);for(var ol="",il=0;il<rl;)ol+=String.fromCharCode.apply(String,al.slice(il,il+=Gd));return ol}(Xd)}function Ed(kd,jd,Yd){var Xd="";Yd=Math.min(kd.length,Yd);for(var qd=jd;qd<Yd;++qd)Xd+=String.fromCharCode(127&kd[qd]);return Xd}function Sd(kd,jd,Yd){var Xd="";Yd=Math.min(kd.length,Yd);for(var qd=jd;qd<Yd;++qd)Xd+=String.fromCharCode(kd[qd]);return Xd}function Td(kd,jd,Yd){var Xd=kd.length;(!jd||0>jd)&&(jd=0),(!Yd||0>Yd||Yd>Xd)&&(Yd=Xd);for(var qd="",Zd=jd;Zd<Yd;++Zd)qd+=Fd(kd[Zd]);return qd}function Md(kd,jd,Yd){for(var Xd=kd.slice(jd,Yd),qd="",Zd=0;Zd<Xd.length;Zd+=2)qd+=String.fromCharCode(Xd[Zd]+256*Xd[Zd+1]);return qd}function wd(kd,jd,Yd){if(0!=kd%1||0>kd)throw new RangeError("offset is not uint");if(kd+jd>Yd)throw new RangeError("Trying to access beyond buffer length")}function Rd(kd,jd,Yd,Xd,qd,Zd){if(!nd.isBuffer(kd))throw new TypeError("\"buffer\" argument must be a Buffer instance");if(jd>qd||jd<Zd)throw new RangeError("\"value\" argument is out of bounds");if(Yd+Xd>kd.length)throw new RangeError("Index out of range")}function Pd(kd,jd,Yd,Xd){0>jd&&(jd=65535+jd+1);for(var qd=0,Zd=Math.min(kd.length-Yd,2);qd<Zd;++qd)kd[Yd+qd]=(jd&255<<8*(Xd?qd:1-qd))>>>8*(Xd?qd:1-qd)}function Cd(kd,jd,Yd,Xd){0>jd&&(jd=4294967295+jd+1);for(var qd=0,Zd=Math.min(kd.length-Yd,4);qd<Zd;++qd)kd[Yd+qd]=255&jd>>>8*(Xd?qd:3-qd)}function Od(kd,jd,Yd,Xd){if(Yd+Xd>kd.length)throw new RangeError("Index out of range");if(0>Yd)throw new RangeError("Index out of range")}function Id(kd,jd,Yd,Xd,qd){return qd||Od(kd,0,Yd,4),zd.write(kd,jd,Yd,Xd,23,4),Yd+4}function Dd(kd,jd,Yd,Xd,qd){return qd||Od(kd,0,Yd,8),zd.write(kd,jd,Yd,Xd,52,8),Yd+8}function Fd(kd){return 16>kd?"0"+kd.toString(16):kd.toString(16)}function Bd(kd,jd){var Yd;jd=jd||1/0;for(var Xd=kd.length,qd=null,Zd=[],Jd=0;Jd<Xd;++Jd){if(55295<(Yd=kd.charCodeAt(Jd))&&57344>Yd){if(!qd){if(56319<Yd){-1<(jd-=3)&&Zd.push(239,191,189);continue}if(Jd+1===Xd){-1<(jd-=3)&&Zd.push(239,191,189);continue}qd=Yd;continue}if(56320>Yd){-1<(jd-=3)&&Zd.push(239,191,189),qd=Yd;continue}Yd=65536+(qd-55296<<10|Yd-56320)}else qd&&-1<(jd-=3)&&Zd.push(239,191,189);if(qd=null,128>Yd){if(0>(jd-=1))break;Zd.push(Yd)}else if(2048>Yd){if(0>(jd-=2))break;Zd.push(192|Yd>>6,128|63&Yd)}else if(65536>Yd){if(0>(jd-=3))break;Zd.push(224|Yd>>12,128|63&Yd>>6,128|63&Yd)}else{if(!(1114112>Yd))throw new Error("Invalid code point");if(0>(jd-=4))break;Zd.push(240|Yd>>18,128|63&Yd>>12,128|63&Yd>>6,128|63&Yd)}}return Zd}function Ud(kd){return Wd.toByteArray(function(jd){if(2>(jd=function(Yd){return Yd.trim?Yd.trim():Yd.replace(/^\s+|\s+$/g,"")}(jd).replace(Vd,"")).length)return"";for(;0!=jd.length%4;)jd+="=";return jd}(kd))}function Nd(kd,jd,Yd,Xd){for(var qd=0;qd<Xd&&!(qd+Yd>=jd.length||qd>=kd.length);++qd)jd[qd+Yd]=kd[qd];return qd}var Wd=ad(40),zd=ad(8),Hd=ad(4);td.Buffer=nd,td.SlowBuffer=function(kd){return+kd!=kd&&(kd=0),nd.alloc(+kd)},td.INSPECT_MAX_BYTES=50,nd.TYPED_ARRAY_SUPPORT=void 0===rd.TYPED_ARRAY_SUPPORT?function(){try{var kd=new Uint8Array(1);return kd.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===kd.foo()&&"function"==typeof kd.subarray&&0===kd.subarray(1,1).byteLength}catch(jd){return!1}}():rd.TYPED_ARRAY_SUPPORT,td.kMaxLength=od(),nd.poolSize=8192,nd._augment=function(kd){return kd.__proto__=nd.prototype,kd},nd.from=function(kd,jd,Yd){return sd(null,kd,jd,Yd)},nd.TYPED_ARRAY_SUPPORT&&(nd.prototype.__proto__=Uint8Array.prototype,nd.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&nd[Symbol.species]===nd&&Object.defineProperty(nd,Symbol.species,{value:null,configurable:!0})),nd.alloc=function(kd,jd,Yd){return function(Xd,qd,Zd,Jd){return dd(qd),0>=qd?id(Xd,qd):void 0===Zd?id(Xd,qd):"string"==typeof Jd?id(Xd,qd).fill(Zd,Jd):id(Xd,qd).fill(Zd)}(null,kd,jd,Yd)},nd.allocUnsafe=function(kd){return ld(null,kd)},nd.allocUnsafeSlow=function(kd){return ld(null,kd)},nd.isBuffer=function(kd){return null!=kd&&kd._isBuffer},nd.compare=function(kd,jd){if(!nd.isBuffer(kd)||!nd.isBuffer(jd))throw new TypeError("Arguments must be Buffers");if(kd===jd)return 0;for(var Yd=kd.length,Xd=jd.length,qd=0,Zd=Math.min(Yd,Xd);qd<Zd;++qd)if(kd[qd]!==jd[qd]){Yd=kd[qd],Xd=jd[qd];break}return Yd<Xd?-1:Xd<Yd?1:0},nd.isEncoding=function(kd){switch((kd+"").toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1;}},nd.concat=function(kd,jd){if(!Hd(kd))throw new TypeError("\"list\" argument must be an Array of Buffers");if(0===kd.length)return nd.alloc(0);var Yd;if(void 0===jd)for(jd=0,Yd=0;Yd<kd.length;++Yd)jd+=kd[Yd].length;var Xd=nd.allocUnsafe(jd),qd=0;for(Yd=0;Yd<kd.length;++Yd){var Zd=kd[Yd];if(!nd.isBuffer(Zd))throw new TypeError("\"list\" argument must be an Array of Buffers");Zd.copy(Xd,qd),qd+=Zd.length}return Xd},nd.byteLength=md,nd.prototype._isBuffer=!0,nd.prototype.swap16=function(){var kd=this.length;if(0!=kd%2)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var jd=0;jd<kd;jd+=2)ud(this,jd,jd+1);return this},nd.prototype.swap32=function(){var kd=this.length;if(0!=kd%4)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var jd=0;jd<kd;jd+=4)ud(this,jd,jd+3),ud(this,jd+1,jd+2);return this},nd.prototype.swap64=function(){var kd=this.length;if(0!=kd%8)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var jd=0;jd<kd;jd+=8)ud(this,jd,jd+7),ud(this,jd+1,jd+6),ud(this,jd+2,jd+5),ud(this,jd+3,jd+4);return this},nd.prototype.toString=function(){var kd=0|this.length;return 0==kd?"":0===arguments.length?Ad(this,0,kd):function(jd,Yd,Xd){var qd=!1;if((void 0===Yd||0>Yd)&&(Yd=0),Yd>this.length)return"";if((void 0===Xd||Xd>this.length)&&(Xd=this.length),0>=Xd)return"";if((Xd>>>=0)<=(Yd>>>=0))return"";for(jd||(jd="utf8");;)switch(jd){case"hex":return Td(this,Yd,Xd);case"utf8":case"utf-8":return Ad(this,Yd,Xd);case"ascii":return Ed(this,Yd,Xd);case"latin1":case"binary":return Sd(this,Yd,Xd);case"base64":return _d(this,Yd,Xd);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Md(this,Yd,Xd);default:if(qd)throw new TypeError("Unknown encoding: "+jd);jd=(jd+"").toLowerCase(),qd=!0;}}.apply(this,arguments)},nd.prototype.equals=function(kd){if(!nd.isBuffer(kd))throw new TypeError("Argument must be a Buffer");return this===kd||0===nd.compare(this,kd)},nd.prototype.inspect=function(){var kd="",jd=td.INSPECT_MAX_BYTES;return 0<this.length&&(kd=this.toString("hex",0,jd).match(/.{2}/g).join(" "),this.length>jd&&(kd+=" ... ")),"<Buffer "+kd+">"},nd.prototype.compare=function(kd,jd,Yd,Xd,qd){if(!nd.isBuffer(kd))throw new TypeError("Argument must be a Buffer");if(void 0===jd&&(jd=0),void 0===Yd&&(Yd=kd?kd.length:0),void 0===Xd&&(Xd=0),void 0===qd&&(qd=this.length),0>jd||Yd>kd.length||0>Xd||qd>this.length)throw new RangeError("out of range index");if(Xd>=qd&&jd>=Yd)return 0;if(Xd>=qd)return-1;if(jd>=Yd)return 1;if(jd>>>=0,Yd>>>=0,Xd>>>=0,qd>>>=0,this===kd)return 0;for(var Zd=qd-Xd,Jd=Yd-jd,Kd=Math.min(Zd,Jd),Qd=this.slice(Xd,qd),$d=kd.slice(jd,Yd),el=0;el<Kd;++el)if(Qd[el]!==$d[el]){Zd=Qd[el],Jd=$d[el];break}return Zd<Jd?-1:Jd<Zd?1:0},nd.prototype.includes=function(kd,jd,Yd){return-1!==this.indexOf(kd,jd,Yd)},nd.prototype.indexOf=function(kd,jd,Yd){return gd(this,kd,jd,Yd,!0)},nd.prototype.lastIndexOf=function(kd,jd,Yd){return gd(this,kd,jd,Yd,!1)},nd.prototype.write=function(kd,jd,Yd,Xd){if(void 0===jd)Xd="utf8",Yd=this.length,jd=0;else if(void 0===Yd&&"string"==typeof jd)Xd=jd,Yd=this.length,jd=0;else{if(!isFinite(jd))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");jd|=0,isFinite(Yd)?(Yd|=0,void 0===Xd&&(Xd="utf8")):(Xd=Yd,Yd=void 0)}var qd=this.length-jd;if((void 0===Yd||Yd>qd)&&(Yd=qd),0<kd.length&&(0>Yd||0>jd)||jd>this.length)throw new RangeError("Attempt to write outside buffer bounds");Xd||(Xd="utf8");for(var Zd=!1;;)switch(Xd){case"hex":return fd(this,kd,jd,Yd);case"utf8":case"utf-8":return yd(this,kd,jd,Yd);case"ascii":return xd(this,kd,jd,Yd);case"latin1":case"binary":return vd(this,kd,jd,Yd);case"base64":return Ld(this,kd,jd,Yd);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return bd(this,kd,jd,Yd);default:if(Zd)throw new TypeError("Unknown encoding: "+Xd);Xd=(""+Xd).toLowerCase(),Zd=!0;}},nd.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var Gd=4096;nd.prototype.slice=function(kd,jd){var Xd=this.length,Yd;if(kd=~~kd,jd=void 0===jd?Xd:~~jd,0>kd?0>(kd+=Xd)&&(kd=0):kd>Xd&&(kd=Xd),0>jd?0>(jd+=Xd)&&(jd=0):jd>Xd&&(jd=Xd),jd<kd&&(jd=kd),nd.TYPED_ARRAY_SUPPORT)(Yd=this.subarray(kd,jd)).__proto__=nd.prototype;else{var qd=jd-kd;Yd=new nd(qd,void 0);for(var Zd=0;Zd<qd;++Zd)Yd[Zd]=this[Zd+kd]}return Yd},nd.prototype.readUIntLE=function(kd,jd,Yd){kd|=0,jd|=0,Yd||wd(kd,jd,this.length);for(var Xd=this[kd],qd=1,Zd=0;++Zd<jd&&(qd*=256);)Xd+=this[kd+Zd]*qd;return Xd},nd.prototype.readUIntBE=function(kd,jd,Yd){kd|=0,jd|=0,Yd||wd(kd,jd,this.length);for(var Xd=this[kd+--jd],qd=1;0<jd&&(qd*=256);)Xd+=this[kd+--jd]*qd;return Xd},nd.prototype.readUInt8=function(kd,jd){return jd||wd(kd,1,this.length),this[kd]},nd.prototype.readUInt16LE=function(kd,jd){return jd||wd(kd,2,this.length),this[kd]|this[kd+1]<<8},nd.prototype.readUInt16BE=function(kd,jd){return jd||wd(kd,2,this.length),this[kd]<<8|this[kd+1]},nd.prototype.readUInt32LE=function(kd,jd){return jd||wd(kd,4,this.length),(this[kd]|this[kd+1]<<8|this[kd+2]<<16)+16777216*this[kd+3]},nd.prototype.readUInt32BE=function(kd,jd){return jd||wd(kd,4,this.length),16777216*this[kd]+(this[kd+1]<<16|this[kd+2]<<8|this[kd+3])},nd.prototype.readIntLE=function(kd,jd,Yd){kd|=0,jd|=0,Yd||wd(kd,jd,this.length);for(var Xd=this[kd],qd=1,Zd=0;++Zd<jd&&(qd*=256);)Xd+=this[kd+Zd]*qd;return Xd>=(qd*=128)&&(Xd-=Math.pow(2,8*jd)),Xd},nd.prototype.readIntBE=function(kd,jd,Yd){kd|=0,jd|=0,Yd||wd(kd,jd,this.length);for(var Xd=jd,qd=1,Zd=this[kd+--Xd];0<Xd&&(qd*=256);)Zd+=this[kd+--Xd]*qd;return Zd>=(qd*=128)&&(Zd-=Math.pow(2,8*jd)),Zd},nd.prototype.readInt8=function(kd,jd){return jd||wd(kd,1,this.length),128&this[kd]?-1*(255-this[kd]+1):this[kd]},nd.prototype.readInt16LE=function(kd,jd){jd||wd(kd,2,this.length);var Yd=this[kd]|this[kd+1]<<8;return 32768&Yd?4294901760|Yd:Yd},nd.prototype.readInt16BE=function(kd,jd){jd||wd(kd,2,this.length);var Yd=this[kd+1]|this[kd]<<8;return 32768&Yd?4294901760|Yd:Yd},nd.prototype.readInt32LE=function(kd,jd){return jd||wd(kd,4,this.length),this[kd]|this[kd+1]<<8|this[kd+2]<<16|this[kd+3]<<24},nd.prototype.readInt32BE=function(kd,jd){return jd||wd(kd,4,this.length),this[kd]<<24|this[kd+1]<<16|this[kd+2]<<8|this[kd+3]},nd.prototype.readFloatLE=function(kd,jd){return jd||wd(kd,4,this.length),zd.read(this,kd,!0,23,4)},nd.prototype.readFloatBE=function(kd,jd){return jd||wd(kd,4,this.length),zd.read(this,kd,!1,23,4)},nd.prototype.readDoubleLE=function(kd,jd){return jd||wd(kd,8,this.length),zd.read(this,kd,!0,52,8)},nd.prototype.readDoubleBE=function(kd,jd){return jd||wd(kd,8,this.length),zd.read(this,kd,!1,52,8)},nd.prototype.writeUIntLE=function(kd,jd,Yd,Xd){kd=+kd,jd|=0,Yd|=0,Xd||Rd(this,kd,jd,Yd,Math.pow(2,8*Yd)-1,0);var qd=1,Zd=0;for(this[jd]=255&kd;++Zd<Yd&&(qd*=256);)this[jd+Zd]=255&kd/qd;return jd+Yd},nd.prototype.writeUIntBE=function(kd,jd,Yd,Xd){kd=+kd,jd|=0,Yd|=0,Xd||Rd(this,kd,jd,Yd,Math.pow(2,8*Yd)-1,0);var qd=Yd-1,Zd=1;for(this[jd+qd]=255&kd;0<=--qd&&(Zd*=256);)this[jd+qd]=255&kd/Zd;return jd+Yd},nd.prototype.writeUInt8=function(kd,jd,Yd){return kd=+kd,jd|=0,Yd||Rd(this,kd,jd,1,255,0),nd.TYPED_ARRAY_SUPPORT||(kd=Math.floor(kd)),this[jd]=255&kd,jd+1},nd.prototype.writeUInt16LE=function(kd,jd,Yd){return kd=+kd,jd|=0,Yd||Rd(this,kd,jd,2,65535,0),nd.TYPED_ARRAY_SUPPORT?(this[jd]=255&kd,this[jd+1]=kd>>>8):Pd(this,kd,jd,!0),jd+2},nd.prototype.writeUInt16BE=function(kd,jd,Yd){return kd=+kd,jd|=0,Yd||Rd(this,kd,jd,2,65535,0),nd.TYPED_ARRAY_SUPPORT?(this[jd]=kd>>>8,this[jd+1]=255&kd):Pd(this,kd,jd,!1),jd+2},nd.prototype.writeUInt32LE=function(kd,jd,Yd){return kd=+kd,jd|=0,Yd||Rd(this,kd,jd,4,4294967295,0),nd.TYPED_ARRAY_SUPPORT?(this[jd+3]=kd>>>24,this[jd+2]=kd>>>16,this[jd+1]=kd>>>8,this[jd]=255&kd):Cd(this,kd,jd,!0),jd+4},nd.prototype.writeUInt32BE=function(kd,jd,Yd){return kd=+kd,jd|=0,Yd||Rd(this,kd,jd,4,4294967295,0),nd.TYPED_ARRAY_SUPPORT?(this[jd]=kd>>>24,this[jd+1]=kd>>>16,this[jd+2]=kd>>>8,this[jd+3]=255&kd):Cd(this,kd,jd,!1),jd+4},nd.prototype.writeIntLE=function(kd,jd,Yd,Xd){if(kd=+kd,jd|=0,!Xd){var qd=Math.pow(2,8*Yd-1);Rd(this,kd,jd,Yd,qd-1,-qd)}var Zd=0,Jd=1,Kd=0;for(this[jd]=255&kd;++Zd<Yd&&(Jd*=256);)0>kd&&0==Kd&&0!==this[jd+Zd-1]&&(Kd=1),this[jd+Zd]=255&(kd/Jd>>0)-Kd;return jd+Yd},nd.prototype.writeIntBE=function(kd,jd,Yd,Xd){if(kd=+kd,jd|=0,!Xd){var qd=Math.pow(2,8*Yd-1);Rd(this,kd,jd,Yd,qd-1,-qd)}var Zd=Yd-1,Jd=1,Kd=0;for(this[jd+Zd]=255&kd;0<=--Zd&&(Jd*=256);)0>kd&&0==Kd&&0!==this[jd+Zd+1]&&(Kd=1),this[jd+Zd]=255&(kd/Jd>>0)-Kd;return jd+Yd},nd.prototype.writeInt8=function(kd,jd,Yd){return kd=+kd,jd|=0,Yd||Rd(this,kd,jd,1,127,-128),nd.TYPED_ARRAY_SUPPORT||(kd=Math.floor(kd)),0>kd&&(kd=255+kd+1),this[jd]=255&kd,jd+1},nd.prototype.writeInt16LE=function(kd,jd,Yd){return kd=+kd,jd|=0,Yd||Rd(this,kd,jd,2,32767,-32768),nd.TYPED_ARRAY_SUPPORT?(this[jd]=255&kd,this[jd+1]=kd>>>8):Pd(this,kd,jd,!0),jd+2},nd.prototype.writeInt16BE=function(kd,jd,Yd){return kd=+kd,jd|=0,Yd||Rd(this,kd,jd,2,32767,-32768),nd.TYPED_ARRAY_SUPPORT?(this[jd]=kd>>>8,this[jd+1]=255&kd):Pd(this,kd,jd,!1),jd+2},nd.prototype.writeInt32LE=function(kd,jd,Yd){return kd=+kd,jd|=0,Yd||Rd(this,kd,jd,4,2147483647,-2147483648),nd.TYPED_ARRAY_SUPPORT?(this[jd]=255&kd,this[jd+1]=kd>>>8,this[jd+2]=kd>>>16,this[jd+3]=kd>>>24):Cd(this,kd,jd,!0),jd+4},nd.prototype.writeInt32BE=function(kd,jd,Yd){return kd=+kd,jd|=0,Yd||Rd(this,kd,jd,4,2147483647,-2147483648),0>kd&&(kd=4294967295+kd+1),nd.TYPED_ARRAY_SUPPORT?(this[jd]=kd>>>24,this[jd+1]=kd>>>16,this[jd+2]=kd>>>8,this[jd+3]=255&kd):Cd(this,kd,jd,!1),jd+4},nd.prototype.writeFloatLE=function(kd,jd,Yd){return Id(this,kd,jd,!0,Yd)},nd.prototype.writeFloatBE=function(kd,jd,Yd){return Id(this,kd,jd,!1,Yd)},nd.prototype.writeDoubleLE=function(kd,jd,Yd){return Dd(this,kd,jd,!0,Yd)},nd.prototype.writeDoubleBE=function(kd,jd,Yd){return Dd(this,kd,jd,!1,Yd)},nd.prototype.copy=function(kd,jd,Yd,Xd){if(Yd||(Yd=0),Xd||0===Xd||(Xd=this.length),jd>=kd.length&&(jd=kd.length),jd||(jd=0),0<Xd&&Xd<Yd&&(Xd=Yd),Xd===Yd)return 0;if(0===kd.length||0===this.length)return 0;if(0>jd)throw new RangeError("targetStart out of bounds");if(0>Yd||Yd>=this.length)throw new RangeError("sourceStart out of bounds");if(0>Xd)throw new RangeError("sourceEnd out of bounds");Xd>this.length&&(Xd=this.length),kd.length-jd<Xd-Yd&&(Xd=kd.length-jd+Yd);var Zd=Xd-Yd,qd;if(this===kd&&Yd<jd&&jd<Xd)for(qd=Zd-1;0<=qd;--qd)kd[qd+jd]=this[qd+Yd];else if(1e3>Zd||!nd.TYPED_ARRAY_SUPPORT)for(qd=0;qd<Zd;++qd)kd[qd+jd]=this[qd+Yd];else Uint8Array.prototype.set.call(kd,this.subarray(Yd,Yd+Zd),jd);return Zd},nd.prototype.fill=function(kd,jd,Yd,Xd){if("string"==typeof kd){if("string"==typeof jd?(Xd=jd,jd=0,Yd=this.length):"string"==typeof Yd&&(Xd=Yd,Yd=this.length),1===kd.length){var qd=kd.charCodeAt(0);256>qd&&(kd=qd)}if(void 0!==Xd&&"string"!=typeof Xd)throw new TypeError("encoding must be a string");if("string"==typeof Xd&&!nd.isEncoding(Xd))throw new TypeError("Unknown encoding: "+Xd)}else"number"==typeof kd&&(kd&=255);if(0>jd||this.length<jd||this.length<Yd)throw new RangeError("Out of range index");if(Yd<=jd)return this;var Zd;if(jd>>>=0,Yd=void 0===Yd?this.length:Yd>>>0,kd||(kd=0),"number"==typeof kd)for(Zd=jd;Zd<Yd;++Zd)this[Zd]=kd;else{var Jd=nd.isBuffer(kd)?kd:Bd(new nd(kd,Xd).toString()),Kd=Jd.length;for(Zd=0;Zd<Yd-jd;++Zd)this[Zd+jd]=Jd[Zd%Kd]}return this};var Vd=/[^+\/0-9A-Za-z-_]/g}).call(this,ad(25))},function(ed,td,ad){function rd(id){if(!(this instanceof rd))return new rd(id);if(id&&(this.options=id,id.codec)){var nd=this.codec=id.codec;nd.bufferish&&(this.bufferish=nd.bufferish)}}td.EncodeBuffer=rd;var od=ad(10).preset;ad(18).FlexEncoder.mixin(rd.prototype),rd.prototype.codec=od,rd.prototype.write=function(id){this.codec.encode(this,id)}},function(ed,td,ad){td.encode=function(od,id){var nd=new rd(id);return nd.write(od),nd.read()};var rd=ad(21).EncodeBuffer},function(ed){ed.exports.keyboardMap="   CANCEL   HELP  BACK_SPACE TAB   CLEAR ENTER ENTER_SPECIAL  SHIFT CONTROL ALT PAUSE CAPS_LOCK KANA EISU JUNJA FINAL HANJA  ESCAPE CONVERT NONCONVERT ACCEPT MODECHANGE SPACE PAGE_UP PAGE_DOWN END HOME LEFT UP RIGHT DOWN SELECT PRINT EXECUTE PRINTSCREEN INSERT DELETE  0 1 2 3 4 5 6 7 8 9 COLON SEMICOLON LESS_THAN EQUALS GREATER_THAN QUESTION_MARK AT A B C D E F G H I J K L M N O P Q R S T U V W X Y Z OS_KEY  CONTEXT_MENU  SLEEP NUMPAD0 NUMPAD1 NUMPAD2 NUMPAD3 NUMPAD4 NUMPAD5 NUMPAD6 NUMPAD7 NUMPAD8 NUMPAD9 MULTIPLY ADD SEPARATOR SUBTRACT DECIMAL DIVIDE F1 F2 F3 F4 F5 F6 F7 F8 F9 F10 F11 F12 F13 F14 F15 F16 F17 F18 F19 F20 F21 F22 F23 F24         NUM_LOCK SCROLL_LOCK WIN_OEM_FJ_JISHO WIN_OEM_FJ_MASSHOU WIN_OEM_FJ_TOUROKU WIN_OEM_FJ_LOYA WIN_OEM_FJ_ROYA          CIRCUMFLEX EXCLAMATION DOUBLE_QUOTE HASH DOLLAR PERCENT AMPERSAND UNDERSCORE OPEN_PAREN CLOSE_PAREN ASTERISK PLUS PIPE HYPHEN_MINUS OPEN_CURLY_BRACKET CLOSE_CURLY_BRACKET TILDE     VOLUME_MUTE VOLUME_DOWN VOLUME_UP   SEMICOLON EQUALS COMMA MINUS PERIOD SLASH BACK_QUOTE                           OPEN_BRACKET BACK_SLASH CLOSE_BRACKET QUOTE  META ALTGR  WIN_ICO_HELP WIN_ICO_00  WIN_ICO_CLEAR   WIN_OEM_RESET WIN_OEM_JUMP WIN_OEM_PA1 WIN_OEM_PA2 WIN_OEM_PA3 WIN_OEM_WSCTRL WIN_OEM_CUSEL WIN_OEM_ATTN WIN_OEM_FINISH WIN_OEM_COPY WIN_OEM_AUTO WIN_OEM_ENLW WIN_OEM_BACKTAB ATTN CRSEL EXSEL EREOF PLAY ZOOM  PA1 WIN_OEM_CLEAR ".split(" "),Number.prototype.round=function(rd){return+this.toFixed(rd)},Number.prototype.roundToNearest=function(rd){return 0<this?Math.ceil(this/rd)*rd:0>this?Math.floor(this/rd)*rd:this},ed.exports.formatNum=function(rd){var od=Math.floor(Math.log(Math.abs(rd))/Math.log(1e3)),id="kmb"[od-1];return id?(rd/Math.pow(1e3,od)).toFixed(1)+id:""+rd},ed.exports.randInt=function(rd,od){return Math.floor(Math.random()*(od-rd+1))+rd},ed.exports.randFloat=function(rd,od){return Math.random()*(od-rd)+rd},ed.exports.getRandom=function(rd){return rd[ed.exports.randInt(0,rd.length-1)]},ed.exports.getDistance=function(rd,od,id,nd){return Math.sqrt((id-=rd)*id+(nd-=od)*nd)},ed.exports.getDistance3D=function(rd,od,id,nd,sd,dd){var ld=rd-nd,pd=od-sd,cd=id-dd;return Math.sqrt(ld*ld+pd*pd+cd*cd)},ed.exports.getAnglesSSS=function(rd,od,id){var nd=Math.acos((od*od+id*id-rd*rd)/(2*od*id)),sd=Math.acos((id*id+rd*rd-od*od)/(2*id*rd)),dd=Math.PI-nd-sd;return[-nd-Math.PI/2,sd,dd]},ed.exports.getXDir=function(rd,od,id,nd,sd,dd){var ld=Math.abs(od-sd),pd=ed.exports.getDistance3D(rd,od,id,nd,sd,dd);return Math.asin(ld/pd)*(od>sd?-1:1)},ed.exports.getAngleDist=function(rd,od){return Math.atan2(Math.sin(od-rd),Math.cos(rd-od))},ed.exports.toRad=function(rd){return rd*(Math.PI/180)},ed.exports.getDirection=function(rd,od,id,nd){return Math.atan2(od-nd,rd-id)},ed.exports.lerp=function(rd,od,id){return rd+(od-rd)*id},ed.exports.orderByScore=function(rd,od){return od.score-rd.score},ed.exports.orderByDst=function(rd,od){return rd.dst-od.dst},ed.exports.capFirst=function(rd){return rd.charAt(0).toUpperCase()+rd.slice(1)},ed.exports.truncateText=function(rd,od){return rd.length>od?rd.substring(0,od)+"...":rd},ed.exports.randomString=function(rd){for(var od="",id="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",nd=0;nd<rd;nd++)od+=id.charAt(Math.floor(Math.random()*id.length));return od},ed.exports.formatNumCash=function(rd){return parseFloat(Math.round(100*rd)/100).toFixed(2)},ed.exports.getKeyName=function(rd){return ed.exports.keyboardMap[rd]},ed.exports.getTime=function(rd){var od=Math.floor(rd/6e4),id=(rd%6e4/1e3).toFixed(0);return od+":"+(10>id?"0":"")+id},ed.exports.getReadableTime=function(rd){var od=rd/1e3/60,id=parseInt(od%60);od/=60;var nd=parseInt(od%24);od/=24;var sd=parseInt(od);return(sd?sd+"d ":"")+(nd?nd+"h ":"")+(id||0)+"m "},ed.exports.fixTo=function(rd,od){return parseFloat(rd.toFixed(od))},ed.exports.limit=function(rd,od){return rd<-od?-od:rd>od?od:rd},ed.exports.cropVal=function(rd,od){return rd<=od&&rd>=-od?0:rd},ed.exports.isNumber=function(rd){return"number"==typeof rd&&!isNaN(rd)&&isFinite(rd)},ed.exports.isString=function(rd){return rd&&"string"==typeof rd},ed.exports.lineInRect=function(rd,od,id,nd,sd,dd,ld,pd,cd,md,ud,gd){var hd=(ld-rd)*nd,fd=(md-rd)*nd,yd=(cd-id)*dd,xd=(gd-id)*dd,vd=(pd-od)*sd,Ld=(ud-od)*sd,bd=Math.max(Math.max(Math.min(hd,fd),Math.min(yd,xd)),Math.min(vd,Ld)),_d=Math.min(Math.min(Math.max(hd,fd),Math.max(yd,xd)),Math.max(vd,Ld));return!(0>_d)&&!(bd>_d)&&bd},ed.exports.pointInBox=function(rd,od,id,nd,sd,dd,ld){return ld?rd>=id&&rd<=sd&&od>=nd&&od<=dd:rd>id&&rd<sd&&od>nd&&od<dd},ed.exports.sharePos=function(rd,od,id){return id=id||0,Math.abs(rd.x-od.x)<=id&&Math.abs(rd.y-od.y)<=id&&Math.abs(rd.z-od.z)<=id},ed.exports.cdv={x:"width",y:"height",z:"length"},ed.exports.boxIntersection=function(rd,od,id,nd,sd){var dd=ed.exports.cdv[id],ld=ed.exports.cdv[nd],pd=rd[id]-rd[dd]-.025,cd=od[id]-od[dd]-.025,md=rd[id]+rd[dd]+.025,ud=od[id]+od[dd]+.025,gd=rd[nd]-rd[ld]-.025,hd=od[nd]-od[ld]-.025,fd=rd[nd]+rd[ld]+.025,yd=od[nd]+od[ld]+.025,xd=Math.max(pd,cd),vd=Math.min(md,ud);if(vd>=xd){var Ld=Math.max(gd,hd),bd=Math.min(fd,yd);if(bd>=Ld){for(var _d=[{[id]:xd,[nd]:Ld,d:sd[0]},{[id]:vd,[nd]:bd,d:sd[1]},{[id]:xd,[nd]:bd,d:sd[2]},{[id]:vd,[nd]:Ld,d:sd[3]}],Ad=_d.length-1;0<=Ad;--Ad)(_d[Ad][id]==md&&_d[Ad][id]==ud||_d[Ad][id]==pd&&_d[Ad][id]==cd||_d[Ad][nd]==fd&&_d[Ad][nd]==yd||_d[Ad][nd]==gd&&_d[Ad][nd]==hd||ed.exports.pointInBox(_d[Ad][id],_d[Ad][nd],pd,gd,md,fd)||ed.exports.pointInBox(_d[Ad][id],_d[Ad][nd],cd,hd,ud,yd))&&_d.splice(Ad,1);return _d.length?_d:null}}return null},ed.exports.boxCornerIntersection=function(rd,od,id,nd){for(var sd=ed.exports.cdv[id],dd=ed.exports.cdv[nd],ld=rd[id]-rd[sd],pd=od[id]-od[sd],cd=rd[id]+rd[sd],md=od[id]+od[sd],ud=rd[nd]-rd[dd],gd=od[nd]-od[dd],hd=rd[nd]+rd[dd],fd=od[nd]+od[dd],yd=[{[id]:ld,[nd]:ud,d:Math.PI/2},{[id]:ld,[nd]:hd,d:Math.PI},{[id]:cd,[nd]:ud,d:0},{[id]:cd,[nd]:hd,d:-Math.PI/2}],xd=yd.length-1;0<=xd;--xd)yd[xd].i=xd,ed.exports.pointInBox(yd[xd][id],yd[xd][nd],pd,gd,md,fd,!0)||yd.splice(xd,1);return yd.length?yd:null},ed.exports.getIntersection=function(rd,od,id){var nd=ed.exports.cdv[id],sd=rd[id]-rd[nd],dd=od[id]-od[nd],ld=rd[id]+rd[nd],pd=od[id]+od[nd],cd=Math.max(sd,dd),md=Math.min(ld,pd);if(md>=cd){var ud=(md-cd)/2;return{[id]:cd+ud,[nd]:ud}}return null},ed.exports.limitRectVal=function(rd,od,id){var nd=ed.exports.cdv[id];if(rd[id]-rd[nd]<od[id]-od[nd]){var sd=(od[id]-od[nd]-(rd[id]-rd[nd]))/2;rd[nd]-=sd,rd[id]+=sd}rd[id]+rd[nd]>od[id]+od[nd]&&(sd=(rd[id]+rd[nd]-(od[id]+od[nd]))/2,rd[nd]-=sd,rd[id]-=sd)},ed.exports.limitRect=function(rd,od,id,nd,sd,dd,ld,pd){var cd=ed.exports.cdv[ld],md=ed.exports.cdv[pd],ud={};if(ud[ld]=rd,ud[pd]=od,ud[cd]=id,ud[md]=nd,ed.exports.limitRectVal(ud,dd,ld),ed.exports.limitRectVal(ud,dd,pd),0==sd||sd==Math.PI){var gd=ud[cd];ud[cd]=ud[md],ud[md]=gd}return ud},ed.exports.progressOnLine=function(rd,od,id,nd,sd,dd){var ld=id-rd,pd=nd-od,cd=Math.sqrt(ld*ld+pd*pd);return((ld/=cd)*(sd-rd)+(pd/=cd)*(dd-od))/Math.sqrt(Math.pow(id-rd,2)+Math.pow(nd-od,2))},ed.exports.generateSID=function(rd){for(var od=0,id=!0;id;){id=!1,od++;for(var nd=0;nd<rd.length;++nd)if(rd[nd].sid==od){id=!0;break}}return od};var ad=function(rd,od){return rd.concat(od)};Array.prototype.flatMap=function(rd){return function(od,id){return id.map(od).reduce(ad,[])}(rd,this)}},function(ed){function ad(){throw new Error("setTimeout has not been defined")}function rd(){throw new Error("clearTimeout has not been defined")}function od(fd){if(ld===setTimeout)return setTimeout(fd,0);if((ld===ad||!ld)&&setTimeout)return ld=setTimeout,setTimeout(fd,0);try{return ld(fd,0)}catch(yd){try{return ld.call(null,fd,0)}catch(xd){return ld.call(this,fd,0)}}}function id(){gd&&md&&(gd=!1,md.length?ud=md.concat(ud):hd=-1,ud.length&&nd())}function nd(){if(!gd){var fd=od(id);gd=!0;for(var yd=ud.length;yd;){for(md=ud,ud=[];++hd<yd;)md&&md[hd].run();hd=-1,yd=ud.length}md=null,gd=!1,function(xd){if(pd===clearTimeout)return clearTimeout(xd);if((pd===rd||!pd)&&clearTimeout)return pd=clearTimeout,clearTimeout(xd);try{pd(xd)}catch(vd){try{return pd.call(null,xd)}catch(Ld){return pd.call(this,xd)}}}(fd)}}function sd(fd,yd){this.fun=fd,this.array=yd}function dd(){}var cd=ed.exports={},ld,pd;!function(){try{ld="function"==typeof setTimeout?setTimeout:ad}catch(fd){ld=ad}try{pd="function"==typeof clearTimeout?clearTimeout:rd}catch(fd){pd=rd}}();var ud=[],gd=!1,hd=-1,md;cd.nextTick=function(fd){var yd=Array(arguments.length-1);if(1<arguments.length)for(var xd=1;xd<arguments.length;xd++)yd[xd-1]=arguments[xd];ud.push(new sd(fd,yd)),1!==ud.length||gd||od(nd)},sd.prototype.run=function(){this.fun.apply(null,this.array)},cd.title="browser",cd.browser=!0,cd.env={},cd.argv=[],cd.version="",cd.versions={},cd.on=dd,cd.addListener=dd,cd.once=dd,cd.off=dd,cd.removeListener=dd,cd.removeAllListeners=dd,cd.emit=dd,cd.prependListener=dd,cd.prependOnceListener=dd,cd.listeners=function(){return[]},cd.binding=function(){throw new Error("process.binding is not supported")},cd.cwd=function(){return"/"},cd.chdir=function(){throw new Error("process.chdir is not supported")},cd.umask=function(){return 0}},function(ed){var ad=function(){return this}();try{ad=ad||Function("return this")()||(0,eval)("this")}catch(rd){"object"==typeof window&&(ad=window)}ed.exports=ad},function(ed,td,ad){var id=function(nd){this.width=nd.w,this.length=nd.l,this.height=nd.h,this.x=nd.x,this.y=nd.y,this.z=nd.z,this.dir=nd.d,this.src=nd.src,this.ramp=nd.ramp,this.ladder=nd.ladder,this.stepSrc=nd.s,this.dummy=nd.dummy,this.terrain=nd.ter,this.noVis=nd.noVis,this.complexMesh=nd.complexMesh},rd,od;ed.exports.manager=function(nd,sd,dd){var ld;nd&&(rd=ad(11).prefabs,od=ad(2)),this.objects=[],this.collision=function(pd,cd,md){return pd.x-pd.width-md<=cd.x+cd.width&&pd.x+pd.width+md>=cd.x-cd.width&&pd.z-pd.length-md<=cd.z+cd.length&&pd.z+pd.length+md>=cd.z-cd.length&&pd.y-pd.height-md<=cd.y+cd.height&&pd.y+pd.height+md>=cd.y-cd.height},this.addCylinder=function(pd,cd,md,ud,gd,hd){nd&&(hd.shadows=!0,nd.addCylinder(pd,cd,md,ud,gd,hd))},this.addLadder=function(pd,cd,md,ud,gd){var hd=dd.ladderScale,fd=dd.ladderScale;if(0==gd||gd==Math.PI?fd=dd.ladderWidth:hd=dd.ladderWidth,ld=new id({ladder:!0,complexMesh:!0,d:gd,x:pd+dd.ladderScale*Math.cos(gd),z:md+dd.ladderScale*Math.sin(gd),y:cd,w:hd,l:fd,h:ud}),this.objects.push(ld),nd){var yd={src:"floor_0",vertexColors:od.VertexColors,scale:.02,shadows:!0};nd.addCube(ld.x+dd.ladderWidth*Math.sin(gd),ld.y,ld.z+dd.ladderWidth*Math.cos(gd),2*dd.ladderScale,ud+2,2*dd.ladderScale,[1,1,1,0,1,1],yd),nd.addCube(ld.x-dd.ladderWidth*Math.sin(gd),ld.y,ld.z-dd.ladderWidth*Math.cos(gd),2*dd.ladderScale,ud+2,2*dd.ladderScale,[1,1,1,0,1,1],yd);for(var xd=Math.floor(ud/6),vd=0;vd<xd;++vd)yd.darken=dd.ambientVal+(1-dd.ambientVal)*(vd/xd),nd.addPlane(ld.x,cd+6*(vd+1)+sd.randFloat(-1,1),ld.z,dd.ladderWidth,dd.ladderScale,yd,-gd+Math.PI/2,Math.PI/2,sd.randFloat(-.1,.1))}},this.addRamp=function(pd,cd,md,ud,gd,hd,fd){var yd=ud,xd=hd;0!=fd&&fd!=Math.PI&&(yd=hd,xd=ud),this.objects.push(new id({x:pd,z:md,y:cd+gd/2,w:yd/2,l:xd/2,h:gd/2,d:fd,complexMesh:!0,ramp:{sX:pd-ud/2*Math.cos(fd),sZ:md-ud/2*Math.sin(fd),eX:pd+ud/2*Math.cos(fd),eZ:md+ud/2*Math.sin(fd)}})),nd&&nd.addRamp(pd,cd,md,hd,gd,ud/2,fd,{src:"default",scale:1.3,shadowsR:!0})},this.addBlock=function(pd,cd,md,ud,gd,hd,fd,yd){(yd=yd||{}).src=yd.src||"wall_0",yd.noCol||this.objects.push(new id({x:pd,z:md,y:cd+hd/2,w:ud/2,l:gd/2,h:hd/2,s:yd.sound,src:yd.src,noVis:yd.noVis,ter:!0})),nd&&!yd.noVis&&(yd.vertexColors=od.VertexColors,yd.scale=void 0==yd.scale?1:yd.scale,yd.shadows=!yd.shadowsR,nd.addCube(pd,cd,md,ud,hd,gd,fd,yd))},this.addMesh=function(pd,cd,md,ud,gd,hd,fd,yd,xd){cd+=hd,xd||this.objects.push(new id({complexMesh:!!rd&&rd[yd.toUpperCase()].complex,x:pd,z:md,y:cd,w:gd,l:fd,h:hd,ter:!0})),nd&&nd.loadMesh({src:yd+"_0",shadows:!0},pd,cd,md,ud,dd[yd+"Scale"],nd.scene,!0)},this.addPlane=function(pd,cd,md,ud,gd,hd,fd,yd,xd){if((hd=hd||{}).col&&this.objects.push(new id({x:pd,z:md,y:cd,w:gd,l:ud,h:0,s:hd.sound,noVis:hd.noVis})),nd&&!hd.noVis)return hd.transparent=!0,hd.vertexColors=od.VertexColors,hd.side=od.DoubleSide,hd.shadowsR=!0,nd.addPlane(pd,cd,md,gd,ud,hd,fd,(yd||0)+Math.PI/2,xd)},this.addAmbient=function(pd,cd,md,ud,gd,hd,fd,yd,xd,vd){return vd?{x:pd,y:cd,z:md,xD:ud,yD:gd,zD:hd,w:fd,h:yd,i:xd}:void this.addPlane(pd,cd,md,fd,yd,{src:"ambient_"+(xd||0),euler:"ZYX",depthWrite:!1},ud,gd,hd)},this.limitAmb=function(pd,cd,md,ud,gd,hd,fd){var yd=[sd.cdv[ud]],xd=[sd.cdv[gd]];return md==-Math.PI/2||md==Math.PI+Math.PI/2?Math.min(pd,(cd[gd]-Math.min(hd[gd]-hd[xd],fd[gd]-fd[xd]))/2):md==Math.PI/2?Math.min(pd,(Math.max(hd[gd]+hd[xd],fd[gd]+fd[xd])-cd[gd])/2):0==md?Math.min(pd,(Math.max(hd[ud]+hd[yd],fd[ud]+fd[yd])-cd[ud])/2):Math.min(pd,(cd[ud]-Math.min(hd[ud]-hd[yd],fd[ud]-fd[yd]))/2)},this.removeAll=function(){this.objects.length=0}}},function(ed,td,ad){ad(5),ad(10),td.codec={preset:ad(3).preset}},function(ed,td,ad){ad(5),ad(10),td.createCodec=ad(3).createCodec},function(ed,td,ad){function rd(nd){return this instanceof rd?void id.call(this,nd):new rd(nd)}td.Decoder=rd;var od=ad(14),id=ad(16).DecodeBuffer;rd.prototype=new id,od.mixin(rd.prototype),rd.prototype.decode=function(nd){arguments.length&&this.write(nd),this.flush()},rd.prototype.push=function(nd){this.emit("data",nd)},rd.prototype.end=function(nd){this.decode(nd),this.emit("end")}},function(ed,td,ad){function rd(nd){return this instanceof rd?void id.call(this,nd):new rd(nd)}td.Encoder=rd;var od=ad(14),id=ad(21).EncodeBuffer;rd.prototype=new id,od.mixin(rd.prototype),rd.prototype.encode=function(nd){this.write(nd),this.emit("data",this.read())},rd.prototype.end=function(nd){arguments.length&&this.encode(nd),this.flush(),this.emit("end")}},function(ed,td,ad){function rd(dd){var pd=Array(256),ld;for(ld=0;127>=ld;ld++)pd[ld]=od(ld);for(ld=128;143>=ld;ld++)pd[ld]=nd(ld-128,dd.map);for(ld=144;159>=ld;ld++)pd[ld]=nd(ld-144,dd.array);for(ld=160;191>=ld;ld++)pd[ld]=nd(ld-160,dd.str);for(pd[192]=od(null),pd[193]=null,pd[194]=od(!1),pd[195]=od(!0),pd[196]=id(dd.uint8,dd.bin),pd[197]=id(dd.uint16,dd.bin),pd[198]=id(dd.uint32,dd.bin),pd[199]=id(dd.uint8,dd.ext),pd[200]=id(dd.uint16,dd.ext),pd[201]=id(dd.uint32,dd.ext),pd[202]=dd.float32,pd[203]=dd.float64,pd[204]=dd.uint8,pd[205]=dd.uint16,pd[206]=dd.uint32,pd[207]=dd.uint64,pd[208]=dd.int8,pd[209]=dd.int16,pd[210]=dd.int32,pd[211]=dd.int64,pd[212]=nd(1,dd.ext),pd[213]=nd(2,dd.ext),pd[214]=nd(4,dd.ext),pd[215]=nd(8,dd.ext),pd[216]=nd(16,dd.ext),pd[217]=id(dd.uint8,dd.str),pd[218]=id(dd.uint16,dd.str),pd[219]=id(dd.uint32,dd.str),pd[220]=id(dd.uint16,dd.array),pd[221]=id(dd.uint32,dd.array),pd[222]=id(dd.uint16,dd.map),pd[223]=id(dd.uint32,dd.map),ld=224;255>=ld;ld++)pd[ld]=od(ld-256);return pd}function od(dd){return function(){return dd}}function id(dd,ld){return function(pd){var cd=dd(pd);return ld(pd,cd)}}function nd(dd,ld){return function(pd){return ld(pd,dd)}}var sd=ad(15);td.getReadToken=function(dd){var ld=sd.getReadFormat(dd);return dd&&dd.useraw?function(pd){var md=rd(pd).slice(),cd;for(md[217]=md[196],md[218]=md[197],md[219]=md[198],cd=160;191>=cd;cd++)md[cd]=nd(cd-160,pd.bin);return md}(ld):rd(ld)}},function(ed,td,ad){function rd(md){return dd||(dd=ad(17).decode),dd(md)}function od(md){return RegExp.apply(null,md)}function id(md){return function(ud){var gd=new md;for(var hd in cd)gd[hd]=ud[hd];return gd}}function nd(md){return function(ud){return new md(ud)}}function sd(md){return new Uint8Array(md).buffer}td.setExtUnpackers=function(md){md.addExtUnpacker(14,[rd,id(Error)]),md.addExtUnpacker(1,[rd,id(EvalError)]),md.addExtUnpacker(2,[rd,id(RangeError)]),md.addExtUnpacker(3,[rd,id(ReferenceError)]),md.addExtUnpacker(4,[rd,id(SyntaxError)]),md.addExtUnpacker(5,[rd,id(TypeError)]),md.addExtUnpacker(6,[rd,id(URIError)]),md.addExtUnpacker(10,[rd,od]),md.addExtUnpacker(11,[rd,nd(Boolean)]),md.addExtUnpacker(12,[rd,nd(String)]),md.addExtUnpacker(13,[rd,nd(Date)]),md.addExtUnpacker(15,[rd,nd(Number)]),"undefined"!=typeof Uint8Array&&(md.addExtUnpacker(17,nd(Int8Array)),md.addExtUnpacker(18,nd(Uint8Array)),md.addExtUnpacker(19,[sd,nd(Int16Array)]),md.addExtUnpacker(20,[sd,nd(Uint16Array)]),md.addExtUnpacker(21,[sd,nd(Int32Array)]),md.addExtUnpacker(22,[sd,nd(Uint32Array)]),md.addExtUnpacker(23,[sd,nd(Float32Array)]),"undefined"!=typeof Float64Array&&md.addExtUnpacker(24,[sd,nd(Float64Array)]),"undefined"!=typeof Uint8ClampedArray&&md.addExtUnpacker(25,nd(Uint8ClampedArray)),md.addExtUnpacker(26,sd),md.addExtUnpacker(29,[sd,nd(DataView)])),ld.hasBuffer&&md.addExtUnpacker(27,nd(pd))};var ld=ad(0),pd=ld.global,cd={name:1,message:1,stack:1,columnNumber:1,fileName:1,lineNumber:1},dd},function(ed,td,ad){function rd(){var bd=fd.slice();return bd[196]=od(196),bd[197]=id(197),bd[198]=nd(198),bd[199]=od(199),bd[200]=id(200),bd[201]=nd(201),bd[202]=sd(202,4,Ld.writeFloatBE||pd,!0),bd[203]=sd(203,8,Ld.writeDoubleBE||cd,!0),bd[204]=od(204),bd[205]=id(205),bd[206]=nd(206),bd[207]=sd(207,8,dd),bd[208]=od(208),bd[209]=id(209),bd[210]=nd(210),bd[211]=sd(211,8,ld),bd[217]=od(217),bd[218]=id(218),bd[219]=nd(219),bd[220]=id(220),bd[221]=nd(221),bd[222]=id(222),bd[223]=nd(223),bd}function od(bd){return function(_d,Ad){var Ed=_d.reserve(2),Sd=_d.buffer;Sd[Ed++]=bd,Sd[Ed]=Ad}}function id(bd){return function(_d,Ad){var Ed=_d.reserve(3),Sd=_d.buffer;Sd[Ed++]=bd,Sd[Ed++]=Ad>>>8,Sd[Ed]=Ad}}function nd(bd){return function(_d,Ad){var Ed=_d.reserve(5),Sd=_d.buffer;Sd[Ed++]=bd,Sd[Ed++]=Ad>>>24,Sd[Ed++]=Ad>>>16,Sd[Ed++]=Ad>>>8,Sd[Ed]=Ad}}function sd(bd,_d,Ad,Ed){return function(Sd,Td){var Md=Sd.reserve(_d+1);Sd.buffer[Md++]=bd,Ad.call(Sd.buffer,Td,Md,Ed)}}function dd(bd,_d){new gd(this,_d,bd)}function ld(bd,_d){new hd(this,_d,bd)}function pd(bd,_d){md.write(this,bd,_d,!1,23,4)}function cd(bd,_d){md.write(this,bd,_d,!1,52,8)}var md=ad(8),ud=ad(6),gd=ud.Uint64BE,hd=ud.Int64BE,fd=ad(19).uint8,yd=ad(0),xd=yd.global,vd=yd.hasBuffer&&"TYPED_ARRAY_SUPPORT"in xd&&!xd.TYPED_ARRAY_SUPPORT,Ld=yd.hasBuffer&&xd.prototype||{};td.getWriteToken=function(bd){return bd&&bd.uint8array?function(){var _d=rd();return _d[202]=sd(202,4,pd),_d[203]=sd(203,8,cd),_d}():vd||yd.hasBuffer&&bd&&bd.safe?function(){var _d=fd.slice();return _d[196]=sd(196,1,xd.prototype.writeUInt8),_d[197]=sd(197,2,xd.prototype.writeUInt16BE),_d[198]=sd(198,4,xd.prototype.writeUInt32BE),_d[199]=sd(199,1,xd.prototype.writeUInt8),_d[200]=sd(200,2,xd.prototype.writeUInt16BE),_d[201]=sd(201,4,xd.prototype.writeUInt32BE),_d[202]=sd(202,4,xd.prototype.writeFloatBE),_d[203]=sd(203,8,xd.prototype.writeDoubleBE),_d[204]=sd(204,1,xd.prototype.writeUInt8),_d[205]=sd(205,2,xd.prototype.writeUInt16BE),_d[206]=sd(206,4,xd.prototype.writeUInt32BE),_d[207]=sd(207,8,dd),_d[208]=sd(208,1,xd.prototype.writeInt8),_d[209]=sd(209,2,xd.prototype.writeInt16BE),_d[210]=sd(210,4,xd.prototype.writeInt32BE),_d[211]=sd(211,8,ld),_d[217]=sd(217,1,xd.prototype.writeUInt8),_d[218]=sd(218,2,xd.prototype.writeUInt16BE),_d[219]=sd(219,4,xd.prototype.writeUInt32BE),_d[220]=sd(220,2,xd.prototype.writeUInt16BE),_d[221]=sd(221,4,xd.prototype.writeUInt32BE),_d[222]=sd(222,2,xd.prototype.writeUInt16BE),_d[223]=sd(223,4,xd.prototype.writeUInt32BE),_d}():rd()}},function(ed,td,ad){var rd=ad(4),od=ad(6),id=od.Uint64BE,nd=od.Int64BE,sd=ad(0),dd=ad(7),ld=ad(33),pd=ad(19).uint8,cd=ad(9).ExtBuffer,md="undefined"!=typeof Uint8Array,ud="undefined"!=typeof Map,gd=[];gd[1]=212,gd[2]=213,gd[4]=214,gd[8]=215,gd[16]=216,td.getWriteType=function(hd){function fd(Td,Md){if(null===Md)return yd(Td,Md);if(Ad(Md))return Ed(Td,Md);if(rd(Md))return function(Rd,Pd){var Cd=Pd.length;Ld[16>Cd?144+Cd:65535>=Cd?220:221](Rd,Cd);for(var Od=Rd.codec.encode,Id=0;Id<Cd;Id++)Od(Rd,Pd[Id])}(Td,Md);if(id.isUint64BE(Md))return function(Rd,Pd){Ld[207](Rd,Pd.toArray())}(Td,Md);if(nd.isInt64BE(Md))return function(Rd,Pd){Ld[211](Rd,Pd.toArray())}(Td,Md);var wd=Td.codec.getExtPacker(Md);return(wd&&(Md=wd(Md)),Md instanceof cd)?function(Rd,Pd){var Cd=Pd.buffer,Od=Cd.length,Id=gd[Od]||(255>Od?199:65535>=Od?200:201);Ld[Id](Rd,Od),pd[Pd.type](Rd),Rd.send(Cd)}(Td,Md):void Sd(Td,Md)}function yd(Td,Md){Ld[192](Td,Md)}function xd(Td,Md){var wd=Md.length;Ld[255>wd?196:65535>=wd?197:198](Td,wd),Td.send(Md)}function vd(Td,Md){var wd=Object.keys(Md),Rd=wd.length;Ld[16>Rd?128+Rd:65535>=Rd?222:223](Td,Rd);var Pd=Td.codec.encode;wd.forEach(function(Cd){Pd(Td,Cd),Pd(Td,Md[Cd])})}var Ld=ld.getWriteToken(hd),bd=hd&&hd.useraw,_d=md&&hd&&hd.binarraybuffer,Ad=_d?sd.isArrayBuffer:sd.isBuffer,Ed=_d?function(Td,Md){xd(Td,new Uint8Array(Md))}:xd,Sd=ud&&hd&&hd.usemap?function(Td,Md){if(!(Md instanceof Map))return vd(Td,Md);var wd=Md.size;Ld[16>wd?128+wd:65535>=wd?222:223](Td,wd);var Rd=Td.codec.encode;Md.forEach(function(Pd,Cd){Rd(Td,Cd),Rd(Td,Pd)})}:vd;return{boolean:function(Td,Md){Ld[Md?195:194](Td,Md)},function:yd,number:function(Td,Md){var wd=0|Md;Md===wd?Ld[-32<=wd&&127>=wd?255&wd:0<=wd?255>=wd?204:65535>=wd?205:206:-128<=wd?208:-32768<=wd?209:210](Td,wd):Ld[203](Td,Md)},object:bd?function(Td,Md){return Ad(Md)?function(wd,Rd){var Pd=Rd.length;Ld[32>Pd?160+Pd:65535>=Pd?218:219](wd,Pd),wd.send(Rd)}(Td,Md):void fd(Td,Md)}:fd,string:function(Td){return function(Md,wd){var Rd=wd.length,Pd=5+3*Rd;Md.offset=Md.reserve(Pd);var Cd=Md.buffer,Od=Td(Rd),Id=Md.offset+Od;Rd=dd.write.call(Cd,wd,Id);var Dd=Td(Rd);if(Od!==Dd){var Bd=Id+Rd;dd.copy.call(Cd,Cd,Id+Dd-Od,Id,Bd)}Ld[1===Dd?160+Rd:3>=Dd?215+Dd:219](Md,Rd),Md.offset+=Rd}}(bd?function(Td){return 32>Td?1:65535>=Td?3:5}:function(Td){return 32>Td?1:255>=Td?2:65535>=Td?3:5}),symbol:yd,undefined:yd}}},function(ed,td,ad){function rd(md){return sd||(sd=ad(22).encode),sd(md)}function od(md){return md.valueOf()}function id(md){(md=RegExp.prototype.toString.call(md).split("/")).shift();var ud=[md.pop()];return ud.unshift(md.join("/")),ud}function nd(md){var ud={};for(var gd in cd)ud[gd]=md[gd];return ud}td.setExtPackers=function(md){md.addExtPacker(14,Error,[nd,rd]),md.addExtPacker(1,EvalError,[nd,rd]),md.addExtPacker(2,RangeError,[nd,rd]),md.addExtPacker(3,ReferenceError,[nd,rd]),md.addExtPacker(4,SyntaxError,[nd,rd]),md.addExtPacker(5,TypeError,[nd,rd]),md.addExtPacker(6,URIError,[nd,rd]),md.addExtPacker(10,RegExp,[id,rd]),md.addExtPacker(11,Boolean,[od,rd]),md.addExtPacker(12,String,[od,rd]),md.addExtPacker(13,Date,[Number,rd]),md.addExtPacker(15,Number,[od,rd]),"undefined"!=typeof Uint8Array&&(md.addExtPacker(17,Int8Array,pd),md.addExtPacker(18,Uint8Array,pd),md.addExtPacker(19,Int16Array,pd),md.addExtPacker(20,Uint16Array,pd),md.addExtPacker(21,Int32Array,pd),md.addExtPacker(22,Uint32Array,pd),md.addExtPacker(23,Float32Array,pd),"undefined"!=typeof Float64Array&&md.addExtPacker(24,Float64Array,pd),"undefined"!=typeof Uint8ClampedArray&&md.addExtPacker(25,Uint8ClampedArray,pd),md.addExtPacker(26,ArrayBuffer,pd),md.addExtPacker(29,DataView,pd)),dd.hasBuffer&&md.addExtPacker(27,ld,dd.from)};var dd=ad(0),ld=dd.global,pd=dd.Uint8Array.from,cd={name:1,message:1,stack:1,columnNumber:1,fileName:1,lineNumber:1},sd},function(ed,td){td.copy=function(ad,rd,od,id){var nd;od||(od=0),id||0===id||(id=this.length),rd||(rd=0);var sd=id-od;if(ad===this&&od<rd&&rd<id)for(nd=sd-1;0<=nd;nd--)ad[nd+rd]=this[nd+od];else for(nd=0;nd<sd;nd++)ad[nd+rd]=this[nd+od];return sd},td.toString=function(ad,rd,od){var id=0|rd;od||(od=this.length);for(var nd="",sd=0;id<od;)128>(sd=this[id++])?nd+=String.fromCharCode(sd):(192==(224&sd)?sd=(31&sd)<<6|63&this[id++]:224==(240&sd)?sd=(15&sd)<<12|(63&this[id++])<<6|63&this[id++]:240==(248&sd)&&(sd=(7&sd)<<18|(63&this[id++])<<12|(63&this[id++])<<6|63&this[id++]),65536<=sd?(sd-=65536,nd+=String.fromCharCode(55296+(sd>>>10),56320+(1023&sd))):nd+=String.fromCharCode(sd));return nd},td.write=function(ad,rd){for(var od=rd||(rd|=0),id=ad.length,nd=0,sd=0;sd<id;)128>(nd=ad.charCodeAt(sd++))?this[od++]=nd:2048>nd?(this[od++]=192|nd>>>6,this[od++]=128|63&nd):55296>nd||57343<nd?(this[od++]=224|nd>>>12,this[od++]=128|63&nd>>>6,this[od++]=128|63&nd):(nd=65536+(nd-55296<<10|ad.charCodeAt(sd++)-56320),this[od++]=240|nd>>>18,this[od++]=128|63&nd>>>12,this[od++]=128|63&nd>>>6,this[od++]=128|63&nd);return od-rd}},function(ed,td,ad){function rd(id){return new Uint8Array(id)}var od=ad(0);(td=ed.exports=od.hasArrayBuffer?rd(0):[]).alloc=rd,td.concat=od.concat,td.from=function(id){if(od.isView(id)){var nd=id.byteOffset,sd=id.byteLength;(id=id.buffer).byteLength!==sd&&(id.slice?id=id.slice(nd,nd+sd):(id=new Uint8Array(id)).byteLength!==sd&&(id=Array.prototype.slice.call(id,nd,nd+sd)))}else{if("string"==typeof id)return od.from.call(td,id);if("number"==typeof id)throw new TypeError("\"value\" argument must not be a number")}return new Uint8Array(id)}},function(ed,td,ad){function rd(nd){return new id(nd)}var od=ad(0),id=od.global;(td=ed.exports=od.hasBuffer?rd(0):[]).alloc=od.hasBuffer&&id.alloc||rd,td.concat=od.concat,td.from=function(nd){if(!od.isBuffer(nd)&&od.isView(nd))nd=od.Uint8Array.from(nd);else if(od.isArrayBuffer(nd))nd=new Uint8Array(nd);else{if("string"==typeof nd)return od.from.call(td,nd);if("number"==typeof nd)throw new TypeError("\"value\" argument must not be a number")}return id.from&&1!==id.from.length?id.from(nd):new id(nd)}},function(ed,td,ad){function rd(id){return Array(id)}var od=ad(0);(td=ed.exports=rd(0)).alloc=rd,td.concat=od.concat,td.from=function(id){if(!od.isBuffer(id)&&od.isView(id))id=od.Uint8Array.from(id);else if(od.isArrayBuffer(id))id=new Uint8Array(id);else{if("string"==typeof id)return od.from.call(td,id);if("number"==typeof id)throw new TypeError("\"value\" argument must not be a number")}return Array.prototype.slice.call(id)}},function(ed,td){"use strict";function rd(md){var ud=md.length;if(0<ud%4)throw new Error("Invalid string. Length must be a multiple of 4");var gd=md.indexOf("=");return-1===gd&&(gd=ud),[gd,gd===ud?0:4-gd%4]}function od(md){return nd[63&md>>18]+nd[63&md>>12]+nd[63&md>>6]+nd[63&md]}function id(md,ud,gd){for(var fd=[],yd=ud,hd;yd<gd;yd+=3)hd=(16711680&md[yd]<<16)+(65280&md[yd+1]<<8)+(255&md[yd+2]),fd.push(od(hd));return fd.join("")}td.byteLength=function(md){var ud=rd(md),gd=ud[0],hd=ud[1];return 3*(gd+hd)/4-hd},td.toByteArray=function(md){for(var gd=rd(md),hd=gd[0],fd=gd[1],yd=new dd(3*(hd+fd)/4-fd),xd=0,vd=0<fd?hd-4:hd,Ld=0,ud;Ld<vd;Ld+=4)ud=sd[md.charCodeAt(Ld)]<<18|sd[md.charCodeAt(Ld+1)]<<12|sd[md.charCodeAt(Ld+2)]<<6|sd[md.charCodeAt(Ld+3)],yd[xd++]=255&ud>>16,yd[xd++]=255&ud>>8,yd[xd++]=255&ud;return 2===fd&&(ud=sd[md.charCodeAt(Ld)]<<2|sd[md.charCodeAt(Ld+1)]>>4,yd[xd++]=255&ud),1===fd&&(ud=sd[md.charCodeAt(Ld)]<<10|sd[md.charCodeAt(Ld+1)]<<4|sd[md.charCodeAt(Ld+2)]>>2,yd[xd++]=255&ud>>8,yd[xd++]=255&ud),yd},td.fromByteArray=function(md){for(var gd=md.length,hd=gd%3,fd=[],yd=0,xd=gd-hd,ud;yd<xd;yd+=16383)fd.push(id(md,yd,yd+16383>xd?xd:yd+16383));return 1==hd?(ud=md[gd-1],fd.push(nd[ud>>2]+nd[63&ud<<4]+"==")):2==hd&&(ud=(md[gd-2]<<8)+md[gd-1],fd.push(nd[ud>>10]+nd[63&ud>>4]+nd[63&ud<<2]+"=")),fd.join("")};for(var nd=[],sd=[],dd="undefined"==typeof Uint8Array?Array:Uint8Array,ld="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",pd=0,cd=ld.length;pd<cd;++pd)nd[pd]=ld[pd],sd[ld.charCodeAt(pd)]=pd;sd["-".charCodeAt(0)]=62,sd["_".charCodeAt(0)]=63},function(ed,td,ad){(function(rd){function od(id){return id&&id.isBuffer&&id}ed.exports=od(void 0!==rd&&rd)||od(this.Buffer)||od("undefined"!=typeof window&&window.Buffer)||this.Buffer}).call(this,ad(20).Buffer)},function(ed,td,ad){td.encode=ad(22).encode,td.decode=ad(17).decode,td.Encoder=ad(30).Encoder,td.Decoder=ad(29).Decoder,td.createCodec=ad(28).createCodec,td.codec=ad(27).codec},function(ed,td,ad){var rd=ad(42),od=ad(1);ed.exports={socket:null,connected:!1,socketId:-1,connect:function(id,nd,sd){if(!this.socket){var dd=od.enableHttps?"wss:":"ws:",ld=this;try{var pd=!1;this.socket=new WebSocket(dd+id),this.socket.binaryType="arraybuffer",this.socket.onmessage=function(md){var ud=new Uint8Array(md.data),gd=rd.decode(ud),hd=gd[0];ud=gd[1],"io-init"==hd?ld.socketId=ud[0]:sd[hd].apply(void 0,ud)},this.socket.onopen=function(){ld.connected=!0,nd()},this.socket.onclose=function(){ld.connected=!1,pd||nd("Disconnected. Try connecting to another server.")},this.socket.onerror=function(){this.socket.readyState!=WebSocket.OPEN&&(pd=!0,console.error("Socket error",arguments),nd("Socket error"))}}catch(md){console.error("Socket connection error:",md),nd(md)}}},send:function(id){var nd=Array.prototype.slice.call(arguments,1),sd=rd.encode([id,nd]);this.socket.send(sd)},socketReady:function(){return this.socket&&this.connected}}},function(ed,td,ad){var rd=ad(1),od=ad(2);ed.exports=function(id,nd,sd){var dd=ad(13),ld=new id.LoadingManager,pd=new id.OBJLoader(ld);this.cubeGeo=new id.BoxGeometry(1,1,1);var cd=new id.PlaneGeometry(1,1),md=new id.CylinderGeometry(.1,1,1,4,1,!1,Math.PI/4);md.computeFlatVertexNormals();var ud=new id.TextureLoader,gd={},hd={},fd={},yd=this,xd={};this.frustum=new id.Frustum;var vd=new id.Matrix4;this.camera=new id.PerspectiveCamera(0,window.innerWidth/window.innerHeight,.2,8e3),this.weaponLean=1,this.init=function(Td,Md){this.scene=new id.Scene,ed.exports.initScene.call(this,Td,Md),this.addPlane(0,5e3,-4500,750,750,{src:"sun_0",noFog:!0,transparent:!0,mat:id.MeshBasicMaterial,noGroup:!0},0,nd.getDirection(-4500,5e3,0,0))},this.renderer=new id.WebGLRenderer,this.renderer.shadowMap.enabled=!0,this.renderer.shadowMap.type=id.BasicShadowMap,this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(window.innerWidth,window.innerHeight),document.body.appendChild(this.renderer.domElement),this.zoom=function(Td){this.camera.fov=this.fov/Td,this.camera.updateProjectionMatrix()},this.setFov=function(Td){this.fov=Td,this.camera.fov=Td},this.setFov(sd.fov),this.resize=function(){this.camera.aspect=window.innerWidth/window.innerHeight,this.camera.updateProjectionMatrix(),this.renderer.setSize(window.innerWidth,window.innerHeight)},this.setResMlt=function(Td){this.renderer.setPixelRatio(window.devicePixelRatio*Td),this.renderer.setSize(window.innerWidth,window.innerHeight)},this.updateFrustum=function(){this.frustum.setFromMatrix(vd.multiplyMatrices(this.camera.projectionMatrix,this.camera.matrixWorldInverse))},this.render=function(){this.scene&&this.renderer.render(this.scene,this.camera)},this.updateTexture=function(Td,Md){var wd=fd[Td];wd?wd.image=Md:(wd=new id.Texture(Md),fd[Td]=wd),wd.needsUpdate=!0},this.loadTexture=function(Td,Md,wd,Rd){return fd[Md]?fd[Md].mats?fd[Md].mats.push(Td):(Td[Rd||"map"]=fd[Md],Td.needsUpdate=!0):(fd[Md]={mats:[Td]},wd=wd||{},ud.load("/textures/"+Md+".png",function(Pd){Pd.wrapS=id.RepeatWrapping,Pd.wrapT=id.RepeatWrapping,Pd.repeat.set(wd.repeatX||1,wd.repeatY||1),Pd.minFilter=id.NearestFilter,Pd.magFilter=id.NearestFilter,Pd.needsUpdate=!0;for(var Cd=0;Cd<fd[Md].mats.length;++Cd)fd[Md].mats[Cd][Rd||"map"]=Pd,fd[Md].mats[Cd].needsUpdate=!0;fd[Md]=Pd})),Td},this.getMat=function(Td,Md){var wd=Td+(Md?(Md.rotation||"")+(Md.noFog||"")+(Md.opacity||"")+(Md.color||"")+(Md.ao||""):""),Rd=hd[wd];return Rd||(Rd=new(Md&&Md.mat?Md.mat:id.MeshLambertMaterial)(Md),Td&&"default"!=Td&&this.loadTexture(Rd,Td,Md),Md&&Md.emissive&&this.loadTexture(Rd,Td+"_e",Md,"emissiveMap"),Md&&Md.ao&&this.loadTexture(Rd,Td+"_ao",Md,"aoMap"),"default"==Td&&(Rd.vertexColors=id.VertexColors),Md&&Md.noFog&&(Rd.fog=!1),hd[wd]=Rd),Rd},this.offsetMesh=function(Td,Md){Td.translateZ(Md)},this.genColorCube=function(Td,Md,wd,Rd,Pd){for(var Cd="",Od=0;Od<Rd.length;++Od)Cd+=Rd[Od]+"_";var Id=gd[Cd];if(!Id){Id=new id.Geometry;var Dd=.5+(Pd||0);for(Od=0;Od<Rd.length;){var Fd=Rd[Od+1],Bd=new id.BoxGeometry(1*(4==Od?.9:1),Fd,1*(4==Od?.9:1));dd.colorize(Bd,Rd[Od]);var Ud=new id.Mesh(Bd);this.moveMesh(Ud,0,Dd-Fd/2,0),this.merge(Id,Ud),Dd-=Fd,Od+=2}gd[Cd]=Id}return Ud=new id.Mesh(Id,this.getMat("default")),this.scaleMesh(Ud,Td,Md,wd),Ud};var Ld={};this.genBody=function(Td,Md,wd,Rd){var Pd=Ld[Td];if(!Pd){Pd=new id.Geometry;var Cd=sd.playerHeight-sd.headScale-sd.legHeight,Od=this.genColorCube(sd.chestWidth,Cd,sd.chestScale,[Td,.8,Md,.2]);this.moveMesh(Od,0,Cd/2,0),this.merge(Pd,Od);var Id=this.genColorCube(sd.headScale,sd.headScale,sd.headScale,[wd,.2,Rd,.8]);this.moveMesh(Id,0,sd.playerHeight-sd.headScale/2-sd.legHeight,0),this.merge(Pd,Id),Ld[Td]=Pd}var Dd=new id.Mesh(Pd,this.getMat("default"));return Dd.castShadow=!0,Dd.receiveShadow=!0,Dd};var bd={};this.genLeg=function(Td,Md,wd,Rd){var Pd=sd.legScale,Cd=null;if(Rd){var Od=Md+"-"+(Rd||"");if(!(Cd=bd[Od])){var Id=sd.legHeight/2,Dd=Pd/2,Fd=[0.5,2],Bd=this.genColorCube(Pd,Id,Pd,[Md,1]);this.moveMesh(Bd,0,-Id/2*Math.cos(Fd[1]),-Id/2*Math.sin(Fd[1])),this.rotateMesh(Bd,0,Fd[1],0);var Ud=Math.sqrt(Dd*Dd+Dd*Dd-2*Dd*Dd*Math.cos(Fd[0]-Fd[1])),Nd=2*Math.sqrt(Dd*Dd-Ud/2*(Ud/2)),Wd=this.genColorCube(Pd,Ud,Nd,[Md,1]);this.moveMesh(Wd,0,-Id*Math.cos(Fd[1]),-Id*Math.sin(Fd[1])),this.rotateMesh(Wd,0,(Fd[1]+Fd[0])/2,0);var zd=this.genColorCube(Pd,Id,Pd,[Md,.5,wd,.5]);this.moveMesh(zd,0,-Id*Math.cos(Fd[1])-Id/2*Math.cos(Fd[0]),-Id*Math.sin(Fd[1])-Id/2*Math.sin(Fd[0])),this.rotateMesh(zd,0,Fd[0],0),Cd=new id.Geometry,this.merge(Cd,Bd),this.merge(Cd,Wd),this.merge(Cd,zd),bd[Od]=Cd}Cd=new id.Mesh(Cd,this.getMat("default")),this.moveMesh(Cd,sd.legScale/2*(Td?-1:1),sd.legHeight-sd.crouchDst+.5,0)}else Cd=this.genColorCube(Pd,sd.legHeight,Pd,[Md,.75,wd,.25],-.5),this.moveMesh(Cd,sd.legScale/2*(Td?-1:1),sd.legHeight,0);return Cd.castShadow=!0,Cd.receiveShadow=!0,Cd};var _d={};this.genArms=function(Td,Md,wd,Rd,Pd){var Cd=_d[Td.name+"-"+wd+"-"+Pd];if(!Cd){Cd=new id.Geometry;var Od=(-sd.chestWidth+sd.armScale/2-sd.armInset)*(Pd?.4:1);this.merge(Cd,this.genArm(Od,sd.armOff,Td,!0,Md,wd,Rd,Pd)),this.merge(Cd,this.genArm(-Od,sd.armOff,Td,!1,Md,wd,Rd,Pd)),_d[Td.name+"-"+wd+"-"+Pd]=Cd}return(Cd=new id.Mesh(Cd,this.getMat("default"))).receiveShadow=!0,Cd},this.genArm=function(Td,Md,wd,Rd,Pd,Cd,Od,Id){var Dd=Rd?wd.leftHoldY:wd.rightHoldY,Fd=Rd?wd.leftHoldZ:wd.rightHoldZ,Bd=Rd?0:wd.rightHoldX||0,Ud=sd.armScale*(Id?.75:1),Nd=Math.min(sd.uArmLength+sd.lArmLength-.01,nd.getDistance3D(Td,Md,0,wd.xOff-Bd,wd.yOff+Dd,wd.zOff-Fd)),Wd=nd.getAnglesSSS(Nd,sd.uArmLength,sd.lArmLength),zd=Math.PI/2;if(!Id){var Hd=this.genColorCube(Ud,sd.uArmLength,Ud,[Pd,1]);this.moveMesh(Hd,0,-sd.uArmLength/2*Math.cos(zd),-sd.uArmLength/2*Math.sin(zd)),this.rotateMesh(Hd,0,zd,0);var Gd=Ud/2,Vd=Math.sqrt(Gd*Gd+Gd*Gd-2*Gd*Gd*Math.cos(Math.PI+Wd[0]+Math.PI/2)),kd=2*Math.sqrt(Gd*Gd-Vd/2*(Vd/2)),jd=this.genColorCube(Ud,Vd,kd,[Pd,1]);this.moveMesh(jd,0,-sd.uArmLength*Math.cos(zd),-sd.uArmLength*Math.sin(zd)),this.rotateMesh(jd,0,(zd+Wd[0])/2,0)}var Yd=this.genColorCube(Ud,sd.lArmLength,Ud,[Pd,.65,Cd,.15,Od,.2]),Xd=sd.lArmLength/2;this.moveMesh(Yd,0,-sd.uArmLength*Math.cos(zd)-Xd*Math.cos(Wd[0]),-sd.uArmLength*Math.sin(zd)-Xd*Math.sin(Wd[0])),this.rotateMesh(Yd,0,Wd[0],0);var qd=new id.Geometry;if(!Id)this.merge(qd,Hd),this.merge(qd,jd);else if(Rd){var Zd=this.genColorCube(Ud,20,Ud,[Pd,1]);this.moveMesh(Zd,0,-sd.uArmLength*Math.cos(zd)- -10*Math.cos(Wd[0]),-sd.uArmLength*Math.sin(zd)- -10*Math.sin(Wd[0])),this.rotateMesh(Zd,0,Wd[0],0),this.merge(qd,Zd)}return this.merge(qd,Yd),qd=new id.Mesh(qd),this.moveMesh(qd,Td-wd.xOff,Md-wd.yOff,-wd.zOff),qd.rotation.order="YXZ",qd.rotation.x=-Wd[1]-nd.getDirection(0,Md,wd.zOff-Fd,wd.yOff+Dd),qd.rotation.y=nd.getDirection(-Td,0,-wd.xOff-Bd,wd.zOff-Fd)-Math.PI/2,qd},this.addCube=function(Td,Md,wd,Rd,Pd,Cd,Od,Id){Id=Id||{};var Dd=new id.Mesh(dd.generateCube(Od,Rd,Pd,Cd,Id));return this.moveMesh(Dd,Td,Md,wd),Dd.rotateY(Id.xR||0),Dd.rotateX(Id.yR||0),Dd.scale.set(Rd,Pd,Cd),Id.src?this.meshGroup(Dd,Id):this.add(Dd,Id),Dd};var Ad=[];this.addSpray=function(Td,Md,wd,Rd,Pd,Cd,Od,Id){tmpObj=null;for(var Dd=0;Dd<Ad.length;++Dd)if(Ad[Dd].sid==Td){tmpObj=Ad[Dd];break}tmpObj||(tmpObj=new id.Mesh(cd),tmpObj.sid=Td,tmpObj.scale.set(sd.sprayScale,sd.sprayScale,1),tmpObj.receiveShadow=!0,Ad.push(tmpObj),this.add(tmpObj)),this.moveMesh(tmpObj,wd,Rd,Pd),tmpObj.rotation.y=nd.toRad(Cd),tmpObj.rotation.x=nd.toRad(Od),tmpObj.material=this.getMat("sprays/"+Md,{opacity:Id,transparent:!0})},this.clearSprays=function(){for(var Td=0;Td<Ad.length;++Td)Ad[Td].material.map.dispose(),this.scene.remove(Ad[Td]);Ad.length=0},this.addPlane=function(Td,Md,wd,Rd,Pd,Cd,Od,Id,Dd){Cd=Cd||{};var Fd=new id.Mesh(dd.generatePlane(Pd,Rd,Cd));return Cd.euler&&(Fd.eulerOrder=Cd.euler),this.moveMesh(Fd,Td,Md,wd),Fd.rotateY(Od||0),Fd.rotateX((Id||0)-Math.PI/2),Fd.rotateZ(Dd||0),Fd.scale.set(2*Rd,2*Pd,1),Cd.dontAdd?Cd.src&&(Fd.material=this.getMat(Cd.src,Cd)):Cd.src&&!Cd.noGroup?this.meshGroup(Fd,Cd):this.add(Fd,Cd),Fd},this.addRamp=function(Td,Md,wd,Rd,Pd,Cd,Od,Id){Id=Id||{};var Dd=new id.Mesh(dd.generatePlane(Cd,Rd,Id));this.moveMesh(Dd,Td,Md+Pd/2,wd),Cd*=2;var Fd=Math.sqrt(Pd*Pd+Cd*Cd);return Dd.scale.set(Rd,Fd,2),Dd.rotateY(-Math.PI/2-Od),Dd.rotateX(Math.asin(Pd/Fd)-Math.PI/2),Id.src?this.meshGroup(Dd,Id):this.add(Dd,Id),Dd},this.addCylinder=function(Td,Md,wd,Rd,Pd,Cd){Cd=Cd||{};var Od=new id.Mesh(md);return this.moveMesh(Od,Td,Md+Pd/2,wd),Od.scale.set(2*Rd,Pd,2*Rd),Cd.src?this.meshGroup(Od,Cd):this.add(Od,Cd),Od};var Ed=[],Sd=[];this.loadMesh=function(Td,Md,wd,Rd,Pd,Cd,Od,Id){var Dd=this.getMat(Td.src,Td),Fd=Ed[Td.src];Fd||(Fd=Id?new id.Geometry:new id.BufferGeometry,Ed[Td.src]=Fd,pd.load("/models/"+Td.src+".obj",function(Ud){if(Ud.children[0].geometry.computeVertexNormals(),Fd.copy(Id?new id.Geometry().fromBufferGeometry(Ud.children[0].geometry):Ud.children[0].geometry),Td.uv2&&Fd.addAttribute("uv2",new id.BufferAttribute(Fd.attributes.uv.array,2)),Id){for(var Nd=new id.Geometry,Wd=0;Wd<Sd[Td.src].length;++Wd)yd.merge(Nd,Sd[Td.src][Wd]);yd.add(new id.Mesh(Nd,Dd),Td),Sd[Td.src].loaded=!0}}));var Bd=new id.Mesh(Fd,Dd);Bd.receiveShadow=!0,Bd.castShadow=Td.shadows,Bd.rotation.y=Pd||0,yd.moveMesh(Bd,Md,wd,Rd),yd.scaleMesh(Bd,Cd||1,Cd||1,Cd||1),Id?Sd[Td.src]?Sd[Td.src].loaded?this.meshGroup(Bd,Td):Sd[Td.src].push(Bd):Sd[Td.src]=[Bd]:Od.add(Bd)},this.genObj3D=function(Td,Md,wd){var Rd=new id.Object3D;return this.moveMesh(Rd,Td||0,Md||0,wd||0),Rd},this.merge=function(Td,Md,wd){Md.updateMatrix(),Td.merge(Md.geometry,Md.matrix,wd)},this.meshGroup=function(Td,Md){var wd=Md.src+"-"+Md.shadowsR;xd[wd]||(xd[wd]=new id.Geometry,xd[wd].data=Md),Td.updateMatrix(),xd[wd].merge(Td.geometry,Td.matrix)},this.addMeshGroups=function(){for(var Td in xd)if(xd.hasOwnProperty(Td)){var Md=new id.Mesh(xd[Td]);this.add(Md,xd[Td].data)}xd={}},this.add=function(Td,Md){Md&&(Td.castShadow=Md.shadows,Td.receiveShadow=Md.shadows||Md.shadowsR,Td.material=this.getMat(Md.src,Md)),this.scene.add(Td)},this.remove=function(Td){this.scene.remove(Td)},this.moveMesh=function(Td,Md,wd,Rd){void 0!=Md&&(Td.position.x=Md),void 0!=wd&&(Td.position.y=wd),void 0!=Rd&&(Td.position.z=Rd)},this.scaleMesh=function(Td,Md,wd,Rd){Td.scale.set(Md,wd,Rd)},this.rotateMesh=function(Td,Md,wd,Rd){(Md||0==Md)&&(Td.rotation.y=Md),(wd||0==wd)&&(Td.rotation.x=wd),(Rd||0==Rd)&&(Td.rotation.z=Rd)}},ed.exports.initScene=function(id,nd){this.ambientLight=new od.AmbientLight(nd.ambient),this.scene.add(this.ambientLight),this.skyLight=new od.DirectionalLight(nd.light,1),this.scene.fog=new od.Fog(nd.fog,1,nd.fogD),this.renderer.setClearColor(nd.sky),this.scene.add(this.skyLight);var sd=-.3*Math.PI,dd=-.25*(2*Math.PI);this.skyLight.position.x=rd.lightDistance*Math.cos(dd),this.skyLight.position.y=rd.lightDistance*Math.sin(dd)*Math.sin(sd),this.skyLight.position.z=rd.lightDistance*Math.sin(dd)*Math.cos(sd),this.skyLight.castShadow=!0,this.skyLight.shadow.bias=.001,this.skyLight.shadow.mapSize.width=rd.shadowRes,this.skyLight.shadow.mapSize.height=rd.shadowRes,this.skyLight.shadow.camera.far=rd.shadowDst,this.skyLight.shadow.camera.right=id.shadScale,this.skyLight.shadow.camera.left=-id.shadScale,this.skyLight.shadow.camera.top=id.shadScale,this.skyLight.shadow.camera.bottom=-id.shadScale}},function(ed){ed.exports=function(ad){return function(){function rd(sd){this.manager=void 0===sd?ad.DefaultLoadingManager:sd,this.materials=null}var od=/^[og]\s*(.+)?/,id=/^mtllib /,nd=/^usemtl /;return rd.prototype={constructor:rd,load:function(sd,dd,ld,pd){var cd=this,md=new ad.FileLoader(cd.manager);md.setPath(this.path),md.load(sd,function(ud){dd(cd.parse(ud))},ld,pd)},setPath:function(sd){return this.path=sd,this},setMaterials:function(sd){return this.materials=sd,this},parse:function(sd){console.time("OBJLoader");var dd=new function(){var Kd={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materialLibraries:[],startObject:function(Qd,$d){if(this.object&&!1===this.object.fromDeclaration)return this.object.name=Qd,void(this.object.fromDeclaration=!1!==$d);var el=this.object&&"function"==typeof this.object.currentMaterial?this.object.currentMaterial():void 0;if(this.object&&"function"==typeof this.object._finalize&&this.object._finalize(!0),this.object={name:Qd||"",fromDeclaration:!1!==$d,geometry:{vertices:[],normals:[],colors:[],uvs:[]},materials:[],smooth:!0,startMaterial:function(al,rl){var ol=this._finalize(!1);ol&&(ol.inherited||0>=ol.groupCount)&&this.materials.splice(ol.index,1);var il={index:this.materials.length,name:al||"",mtllib:Array.isArray(rl)&&0<rl.length?rl[rl.length-1]:"",smooth:void 0===ol?this.smooth:ol.smooth,groupStart:void 0===ol?0:ol.groupEnd,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(nl){var sl={index:"number"==typeof nl?nl:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return sl.clone=this.clone.bind(sl),sl}};return this.materials.push(il),il},currentMaterial:function(){if(0<this.materials.length)return this.materials[this.materials.length-1]},_finalize:function(al){var rl=this.currentMaterial();if(rl&&-1===rl.groupEnd&&(rl.groupEnd=this.geometry.vertices.length/3,rl.groupCount=rl.groupEnd-rl.groupStart,rl.inherited=!1),al&&1<this.materials.length)for(var ol=this.materials.length-1;0<=ol;ol--)0>=this.materials[ol].groupCount&&this.materials.splice(ol,1);return al&&0===this.materials.length&&this.materials.push({name:"",smooth:this.smooth}),rl}},el&&el.name&&"function"==typeof el.clone){var tl=el.clone(0);tl.inherited=!0,this.object.materials.push(tl)}this.objects.push(this.object)},finalize:function(){this.object&&"function"==typeof this.object._finalize&&this.object._finalize(!0)},parseVertexIndex:function(Qd,$d){var el=parseInt(Qd,10);return 3*(0<=el?el-1:el+$d/3)},parseNormalIndex:function(Qd,$d){var el=parseInt(Qd,10);return 3*(0<=el?el-1:el+$d/3)},parseUVIndex:function(Qd,$d){var el=parseInt(Qd,10);return 2*(0<=el?el-1:el+$d/2)},addVertex:function(Qd,$d,el){var tl=this.vertices,al=this.object.geometry.vertices;al.push(tl[Qd+0],tl[Qd+1],tl[Qd+2]),al.push(tl[$d+0],tl[$d+1],tl[$d+2]),al.push(tl[el+0],tl[el+1],tl[el+2])},addVertexPoint:function(Qd){var $d=this.vertices;this.object.geometry.vertices.push($d[Qd+0],$d[Qd+1],$d[Qd+2])},addVertexLine:function(Qd){var $d=this.vertices;this.object.geometry.vertices.push($d[Qd+0],$d[Qd+1],$d[Qd+2])},addNormal:function(Qd,$d,el){var tl=this.normals,al=this.object.geometry.normals;al.push(tl[Qd+0],tl[Qd+1],tl[Qd+2]),al.push(tl[$d+0],tl[$d+1],tl[$d+2]),al.push(tl[el+0],tl[el+1],tl[el+2])},addColor:function(Qd,$d,el){var tl=this.colors,al=this.object.geometry.colors;al.push(tl[Qd+0],tl[Qd+1],tl[Qd+2]),al.push(tl[$d+0],tl[$d+1],tl[$d+2]),al.push(tl[el+0],tl[el+1],tl[el+2])},addUV:function(Qd,$d,el){var tl=this.uvs,al=this.object.geometry.uvs;al.push(tl[Qd+0],tl[Qd+1]),al.push(tl[$d+0],tl[$d+1]),al.push(tl[el+0],tl[el+1])},addUVLine:function(Qd){var $d=this.uvs;this.object.geometry.uvs.push($d[Qd+0],$d[Qd+1])},addFace:function(Qd,$d,el,tl,al,rl,ol,il,nl){var sl=this.vertices.length,dl=this.parseVertexIndex(Qd,sl),ll=this.parseVertexIndex($d,sl),pl=this.parseVertexIndex(el,sl);if(this.addVertex(dl,ll,pl),void 0!==tl&&""!==tl){var cl=this.uvs.length;dl=this.parseUVIndex(tl,cl),ll=this.parseUVIndex(al,cl),pl=this.parseUVIndex(rl,cl),this.addUV(dl,ll,pl)}if(void 0!==ol&&""!==ol){var ml=this.normals.length;dl=this.parseNormalIndex(ol,ml),ll=ol===il?dl:this.parseNormalIndex(il,ml),pl=ol===nl?dl:this.parseNormalIndex(nl,ml),this.addNormal(dl,ll,pl)}0<this.colors.length&&this.addColor(dl,ll,pl)},addPointGeometry:function(Qd){this.object.geometry.type="Points";for(var $d=this.vertices.length,el=0,tl=Qd.length;el<tl;el++)this.addVertexPoint(this.parseVertexIndex(Qd[el],$d))},addLineGeometry:function(Qd,$d){this.object.geometry.type="Line";for(var el=this.vertices.length,tl=this.uvs.length,al=0,rl=Qd.length;al<rl;al++)this.addVertexLine(this.parseVertexIndex(Qd[al],el));var ol=0;for(rl=$d.length;ol<rl;ol++)this.addUVLine(this.parseUVIndex($d[ol],tl))}};return Kd.startObject("",!1),Kd};-1!==sd.indexOf("\r\n")&&(sd=sd.replace(/\r\n/g,"\n")),-1!==sd.indexOf("\\\n")&&(sd=sd.replace(/\\\n/g,""));for(var ld=sd.split("\n"),pd="",cd="",md=[],ud="function"==typeof"".trimLeft,gd=0,hd=ld.length;gd<hd;gd++)if(pd=ld[gd],0!==(pd=pd.trimLeft()).length&&"#"!==(cd=pd.charAt(0)))if("v"===cd){var fd=pd.split(/\s+/);switch(fd[0]){case"v":dd.vertices.push(parseFloat(fd[1]),parseFloat(fd[2]),parseFloat(fd[3])),8===fd.length&&dd.colors.push(parseFloat(fd[4]),parseFloat(fd[5]),parseFloat(fd[6]));break;case"vn":dd.normals.push(parseFloat(fd[1]),parseFloat(fd[2]),parseFloat(fd[3]));break;case"vt":dd.uvs.push(parseFloat(fd[1]),parseFloat(fd[2]));}}else if("f"===cd){for(var yd=pd.substr(1).trim().split(/\s+/),xd=[],vd=0,Ld=yd.length,bd;vd<Ld;vd++)if(bd=yd[vd],0<bd.length){var _d=bd.split("/");xd.push(_d)}var Ad=xd[0];for(vd=1,Ld=xd.length-1;vd<Ld;vd++){var Ed=xd[vd],Sd=xd[vd+1];dd.addFace(Ad[0],Ed[0],Sd[0],Ad[1],Ed[1],Sd[1],Ad[2],Ed[2],Sd[2])}}else if("l"===cd){var Td=pd.substring(1).trim().split(" "),Md=[],wd=[];if(-1===pd.indexOf("/"))Md=Td;else for(var Rd=0,Pd=Td.length,Cd;Rd<Pd;Rd++)Cd=Td[Rd].split("/"),""!==Cd[0]&&Md.push(Cd[0]),""!==Cd[1]&&wd.push(Cd[1]);dd.addLineGeometry(Md,wd)}else if("p"===cd){var Od=pd.substr(1).trim().split(" ");dd.addPointGeometry(Od)}else if(null!==(md=od.exec(pd))){var Id=(" "+md[0].substr(1).trim()).substr(1);dd.startObject(Id)}else if(nd.test(pd))dd.object.startMaterial(pd.substring(7).trim(),dd.materialLibraries);else if(id.test(pd))dd.materialLibraries.push(pd.substring(7).trim());else{if("s"!==cd){if("\0"===pd)continue;throw new Error("THREE.OBJLoader: Unexpected line: \""+pd+"\"")}if(1<(md=pd.split(" ")).length){var Dd=md[1].trim().toLowerCase();dd.object.smooth="0"!==Dd&&"off"!==Dd}else dd.object.smooth=!0;(qd=dd.object.currentMaterial())&&(qd.smooth=dd.object.smooth)}dd.finalize();var Fd=new ad.Group;for(Fd.materialLibraries=[].concat(dd.materialLibraries),gd=0,hd=dd.objects.length;gd<hd;gd++){var Bd=dd.objects[gd],Ud=Bd.geometry,Nd=Bd.materials,Wd="Line"===Ud.type,zd="Points"===Ud.type,Hd=!1;if(0!==Ud.vertices.length){var Gd=new ad.BufferGeometry;Gd.addAttribute("position",new ad.Float32BufferAttribute(Ud.vertices,3)),0<Ud.normals.length?Gd.addAttribute("normal",new ad.Float32BufferAttribute(Ud.normals,3)):Gd.computeVertexNormals(),0<Ud.colors.length&&(Hd=!0,Gd.addAttribute("color",new ad.Float32BufferAttribute(Ud.colors,3))),0<Ud.uvs.length&&Gd.addAttribute("uv",new ad.Float32BufferAttribute(Ud.uvs,2));for(var kd=[],jd=0,Yd=Nd.length,Vd;jd<Yd;jd++){var Xd=Nd[jd],qd=void 0;if(null!==this.materials)if(!(qd=this.materials.create(Xd.name),!Wd||!qd||qd instanceof ad.LineBasicMaterial)){var Jd=new ad.LineBasicMaterial;Jd.copy(qd),Jd.lights=!1,qd=Jd}else if(zd&&qd&&!(qd instanceof ad.PointsMaterial)){var Zd=new ad.PointsMaterial({size:10,sizeAttenuation:!1});Jd.copy(qd),qd=Zd}qd||((qd=Wd?new ad.LineBasicMaterial:zd?new ad.PointsMaterial({size:1,sizeAttenuation:!1}):new ad.MeshPhongMaterial).name=Xd.name),qd.flatShading=!Xd.smooth,qd.vertexColors=Hd?ad.VertexColors:ad.NoColors,kd.push(qd)}if(1<kd.length){for(jd=0,Yd=Nd.length;jd<Yd;jd++)Xd=Nd[jd],Gd.addGroup(Xd.groupStart,Xd.groupCount,jd);Vd=Wd?new ad.LineSegments(Gd,kd):zd?new ad.Points(Gd,kd):new ad.Mesh(Gd,kd)}else Vd=Wd?new ad.LineSegments(Gd,kd[0]):zd?new ad.Points(Gd,kd[0]):new ad.Mesh(Gd,kd[0]);Vd.name=Bd.name,Fd.add(Vd)}}return console.timeEnd("OBJLoader"),Fd}},rd}()}},function(ed){var ad={utf8:{stringToBytes:function(rd){return ad.bin.stringToBytes(unescape(encodeURIComponent(rd)))},bytesToString:function(rd){return decodeURIComponent(escape(ad.bin.bytesToString(rd)))}},bin:{stringToBytes:function(rd){for(var od=[],id=0;id<rd.length;id++)od.push(255&rd.charCodeAt(id));return od},bytesToString:function(rd){for(var od=[],id=0;id<rd.length;id++)od.push(String.fromCharCode(rd[id]));return od.join("")}}};ed.exports=ad},,,,,function(ed){ed.exports=function(ad,rd,od,id){od=od||{},this.id=ad,this.name=rd,this.score=od.player_score||0,this.kills=od.player_kills||0,this.deaths=od.player_deaths||0,this.wins=od.player_wins||0,this.games=od.player_games_played||0,this.clan=od.player_clanid,this.funds=od.player_funds||0,this.timePlayed=od.player_timeplayed||0,this.setData=function(nd){this.kills=nd[1],this.wins=nd[2],this.games=nd[3],this.deaths=nd[4],this.funds=nd[5],this.score=nd[6],this.updateLevel(),this.clan=nd[7],this.timePlayed=nd[8]},this.updateLevel=function(){this.level=Math.max(1,Math.floor(id.rankVar*Math.sqrt(this.score)))},this.updateLevel(),this.getData=function(){return[this.id,this.kills,this.wins,this.games,this.deaths,this.funds,this.score,this.clan,this.timePlayed]}}},function(ed){var ad=["Double Kill","Triple Kill","Quad Kill","Multi Kill","Mega Kill","Ultra Kill","Super Kill"],rd=[];ed.exports.reward=function(od,id,nd,sd){if(rd.length=0,id.weapon.melee)rd.push("Execution",300);else{id.weapon.kill?rd.push(id.weapon.kill[0],id.weapon.kill[1]):id.weapon.scope&&1==id.aimVal?rd.push("No Scope",100):!id.weapon.scope||0==id.aimVal&&180<id.aimTime||1==id.aimDir?rd.push("",50):rd.push("Quick Scope",75);var dd=od.getSpin(id);720<=dd?rd.push("720!",200):360<=dd&&rd.push("360!",150),sd.headShot&&rd.push("Headshot",50),!id.weapon.scope&&200<sd.dst*id.weapon.range&&rd.push("Longshot",25)}400<=id.airTime&&rd.push("Mid Air",25);for(var ld=ad.length-1;0<=ld;--ld)if(id.streak>ld){rd.push(ad[ld],50*(ld+1));break}return rd.length?rd:null},ed.exports.getScore=function(od){var id=0;if(od)for(var nd=1;nd<od.length;nd+=2)id+=od[nd];return id}},function(ed,td,ad){var rd=ad(2);ed.exports.manager=function(od,id,nd,sd,dd,ld,pd){var cd,md,ud;this.list=[];var gd=ad(52);this.setTeam=function(xd,vd){if(vd.teams&&!xd.team){for(var Ld=0,bd=0,_d=0;_d<this.list.length;++_d)1==this.list[_d].team&&Ld++,2==this.list[_d].team&&bd++;xd.team=Ld>=bd?2:1}},this.update=function(xd){id&&(md=id.camera.getWorldPosition());for(var vd=0;vd<this.list.length;++vd)if((cd=this.list[vd]).active&&(cd.update(od.map,xd),pd&&(this.tickPlayer(cd,xd),this.storeState(cd),cd.y<=ld.deathY&&this.kill(cd)),id&&(this.updateMesh(cd),cd.isYou||this.updateHeight(cd)),!cd.isYou&&cd.objInstances)){var Ld=document.getElementById("pInfo"+cd.sid);if(Ld)var bd=cd.objInstances.position.clone();bd.y+=ld.playerHeight+ld.nameOffset-cd.crouchVal*ld.crouchDst;var _d=1-dd.getDistance3D(md.x,md.y,md.z,bd.x,bd.y,bd.z)/600,Ad=22*_d,Ed=.1<=Ad&&id.frustum.containsPoint(bd);if(Ld.style.display=Ed?"block":"none",Ed){bd.project(id.camera),bd.x=(bd.x+1)/2,bd.y=(bd.y+1)/2;var Sd=14*_d,Td=22*_d;Ld.style.left=100*bd.x+"%",Ld.style.marginLeft=-Ld.offsetWidth/2+"px",Ld.style.top=100*(1-bd.y)+"%",Ld.style.marginTop=-(Sd+Td)+"px",(Ld=document.getElementById("pInfoH"+cd.sid))&&(Ld.style.fontSize=Ad+"px",Ld.children[1].style.width=120*_d+"px",Ld.children[1].style.height=Sd+"px",Ld.children[1].style.marginTop=Td+"px"),cd.level&&(Ld=document.getElementById("pInfoR"+cd.sid))&&(Ld.style.fontSize=32*_d+"px",Ld.style.marginRight=10*_d+"px")}}},this.forcePos=function(){for(var xd=0;xd<this.list.length;++xd)this.list[xd].forcePos=!0,this.list[xd].objInstances&&(this.list[xd].objInstances.visible=!1,this.list[xd].isVisible=!1)},this.saveSpin=function(xd,vd){pd&&(xd.spins.unshift(vd),xd.spins.length>ld.spinTimer/ld.serverTickRate&&(xd.spins.length=Math.round(ld.spinTimer/ld.serverTickRate)))},this.getSpin=function(xd){for(var vd=0,Ld=0;Ld<xd.spins.length;++Ld)vd+=xd.spins[Ld];return Math.abs(vd*(180/Math.PI))},this.storeState=function(xd){xd.stateHistory.unshift({time:od.now,x:xd.x,y:xd.y,z:xd.z});for(var vd=xd.stateHistory.length-1;0<=vd;--vd)od.now-xd.stateHistory[vd].time>=ld.stateHistory&&xd.stateHistory.splice(vd,1)},this.fetchState=function(xd,vd){for(var Ld=od.now-(vd+ld.serverSendRate*ld.interpolation),bd=0;bd<xd.stateHistory.length;++bd)if(xd.stateHistory[bd].time<=Ld)return xd.stateHistory[bd];return xd.stateHistory[xd.stateHistory.length-1]},this.updateMesh=function(xd){if(xd.objInstances){var vd=(1-(1-ld.aimAnimMlt)*(1-xd.aimVal))*ld.animMult*id.weaponLean,Ld=1-.55*(1-xd.aimVal),bd=Math.sin(xd.stepVal)*ld.stepAnim,_d=Math.cos(2*xd.stepVal)/2*ld.stepAnim,Ad=1-xd.aimVal,Ed=.35*(.5>=Ad?Ad:.5-(Ad-.5)),Sd=xd.swapTime/xd.weapon.swapTime,Td=xd.weapon.xOff,Md=0;0<xd.reloadTimer&&(Md=.5<(Md=1-xd.reloadTimer/xd.weapon.reload)?.5-(Md-.5):Md),id.moveMesh(xd.objInstances,xd.x,xd.y+(xd.isYou?0:Math.abs(3.5*bd)),xd.z),id.rotateMesh(xd.objInstances,xd.xDir+(xd.isYou?0:2*-bd)),_d-=_d*(xd.crouchVal*ld.crouchAnimMlt),bd-=bd*(xd.crouchVal*ld.crouchAnimMlt);for(var wd=0;wd<xd.legMeshes.length;++wd)xd.legMeshes[wd].rotation.x=7*(bd*(1==wd||3==wd?1:-1))+(1<wd?-.6:0);id.rotateMesh(xd.upperBody,-1*Md,-2.8*Md+xd.yDir*(xd.isYou?1:.5)+(-Math.PI/4*Sd+xd.recoilAnimY*ld.recoilMlt*(xd.weapon.recoilY||1)-xd.bobAnimY*vd)),id.moveMesh(xd.upperBody,5*xd.leanAnimX*vd,xd.height-ld.cameraHeight-ld.legHeight,Math.abs(1.8*xd.leanAnimX)*vd),id.rotateMesh(xd.weaponMeshes[xd.weaponIndex],(.3*bd+xd.leanAnimX*(xd.weapon.leanMlt||0))*vd,(xd.recoilAnimY*(xd.weapon.recoilY||0)+1.8*xd.leanAnimY-.15*_d-.2*xd.bobAnimY)*vd,Ed+(xd.leanAnimZ+.3*bd)*vd),id.moveMesh(xd.weaponMeshes[xd.weaponIndex],(1.2*xd.leanAnimZ+bd)*xd.aimVal*vd+Td-(Td-xd.weapon.xOrg)*Ad,(_d+5*xd.leanAnimY)*vd+xd.weapon.yOff-(xd.weapon.yOff-xd.weapon.yOrg)*Ad,xd.weapon.zOff-(xd.weapon.zOff-xd.weapon.zOrg)*Ad+(xd.recoilAnim*(xd.weapon.recoilZ||0)+xd.bobAnimZ)*Ld)}},this.updateHeight=function(xd){var vd=ld.crouchDst*xd.crouchVal;if(id&&!xd.isYou){var Ld=ld.crouchLean*xd.crouchVal;id.rotateMesh(xd.lowerBody,0,Ld+.5*xd.yDir,0),xd.upperBody.rotation.x-=Ld,id.moveMesh(xd.lowerBody,0,ld.legHeight-vd,0);for(var bd=0;4>bd;++bd)xd.legMeshes[bd].visible=1>=bd?!xd.crouchVal:!!xd.crouchVal}else xd.height=ld.playerHeight-vd},this.generateMeshes=function(xd,vd){var Ld=od.classes[xd.classIndex].colors;if(xd.objInstances=id.genObj3D(xd.x,xd.y,xd.z),xd.lowerBody=id.genObj3D(0,ld.legHeight,0),vd||xd.lowerBody.add(id.genBody(Ld[1],Ld[2],Ld[4],Ld[0])),xd.upperBody=id.genObj3D(0,0,0),xd.lowerBody.add(xd.upperBody),!vd)for(var bd=0;4>bd;++bd)xd.legMeshes.push(id.genLeg(1==bd||3==bd,Ld[2],Ld[3],1<bd)),2<=bd&&id.rotateMesh(xd.legMeshes[bd],2==bd?-Math.PI/6:Math.PI/8,0,0),xd.legMeshes[bd].visible=1>=bd,xd.objInstances.add(xd.legMeshes[bd]);for(bd=0;bd<xd.ammos.length;++bd){var _d=id.genObj3D(0,0,0),Ad=od.weapons[xd.loadout[bd]];vd&&(_d.muzzle=new rd.Sprite,_d.muzzle.visible=!1,_d.muzzle.static=!0,sd.particles.push(_d.muzzle),_d.add(_d.muzzle)),_d.add(id.genArms(Ad,Ld[1],Ld[5],Ld[0],vd)),xd.weaponMeshes.push(_d),xd.weaponMeshes[bd].visible=!1,xd.upperBody.add(xd.weaponMeshes[bd]),id.loadMesh({src:"weapons/"+Ad.src,uv2:!0,ao:vd,emissive:Ad.transp?16777215:null},0,0,0,Math.PI/2,Ad.scale,xd.weaponMeshes[bd])}xd.objInstances.add(xd.lowerBody),id.add(xd.objInstances)},this.hideAll=function(){for(var xd=0;xd<this.list.length;++xd)this.list[xd].active&&this.list[xd].objInstances&&(this.list[xd].forcePos=!this.list[xd].objInstances.visible,this.list[xd].isYou||(this.list[xd].objInstances.visible=!1))},this.clear=function(){if(id)for(var xd=0;xd<this.list.length;++xd)this.disposeMesh(this.list[xd]);this.list.length=0},this.disposeMesh=function(xd){id.remove(xd.objInstances),xd.objInstances=null,xd.weaponMeshes.length=0,xd.legMeshes.length=0;var vd=document.getElementById("pInfo"+xd.sid);vd&&vd.parentNode.removeChild(vd)},this.add=function(xd,vd,Ld,bd,_d,Ad,Ed,Sd){for(var Md=0,Td;Md<this.list.length;++Md)if(this.list[Md].id==xd){Td=this.list[Md];break}return Td||((Td=new function(wd,Rd,Pd,Cd){var Od;this.id=wd,this.sentTo=[],this.inputs=[],this.spins=[],this.stateHistory=[],this.weaponMeshes=[],this.legMeshes=[],this.lastInput=[],this.reloads=[],this.ammos=[],this.ping=0,this.pings=[],this.score=0,this.kills=0,this.deaths=0,this.level=0,this.highest=0,this.deltaAdd=0,this.deltaDiv=1,this.sprayIndex=0,this.lastSpray=0,this.playTime=0,this.init=function(Id,Dd,Fd,Bd,Ud){this.x=Id,this.y=Dd,this.z=Fd,this.stepSrc=null,this.name=Bd||"unknown",this.xVel=0,this.yVel=0,this.zVel=0,this.spins.length=0,this.xDir=0,this.yDir=0,this.hitTimer=0,this.ticker=0,this.spread=0,this.spreadPlus=0,this.aimVal=1,this.aimDir=0,this.aimTime=0,this.streak=0,this.lastKill=0,this.stateHistory.length=0,this.lastInput.length=0,this.leanAnimX=0,this.leanAnimY=0,this.leanAnimZ=0,this.bobAnimZ=0,this.bobAnimY=0,this.stepVal=0,this.stepDir=1,this.recoilAnim=0,this.recoilAnimY=0,this.recoilForce=0,this.crouchVal=0,this.onGround=!0,this.onLadder=!1,this.rampFix=null,this.fixRamp=!1,this.didJump=!1,this.didShoot=!1,this.airTime=0,this.height=Cd.playerHeight,this.headScale=Cd.cameraHeight,this.scale=Cd.playerScale,this.active=!0,this.interpolate=!1,this.isYou=Ud,this.sentTo.length=0,this.inputSN=0,this.weaponIndex=0,this.swapTime=0,this.recon=!1,this.isVisible=!1},this.setClass=function(Id,Dd){this.classIndex=Dd,this.reloads.length=0,this.ammos.length=0,this.loadout=Id.classes[Dd].loadout,this.speed=Id.classes[Dd].speed||1;for(var Fd=0;Fd<this.loadout.length;++Fd)this.reloads.push(0),this.ammos.push(Id.weapons[this.loadout[Fd]].ammo);this.reloadTimer=0,this.maxHealth=Id.classes[Dd].health,this.health=this.maxHealth},this.resetInputs=function(){this.inputs.length=0},this.processInput=function(Id,Dd,Fd){this.recon=Fd;var Bd=Math.min(Id[1],Cd.maxDelta)/this.deltaDiv;this.inputSN=Id[0];var Ud=Pd.getAngleDist(Id[2],this.xDir);Rd.saveSpin(this,Ud);var Nd=!Fd&&this.isYou;if(Nd&&(this.leanAnimX-=Ud*Cd.leanSens,this.leanAnimX=Pd.limit(this.leanAnimX,Cd.leanMax),this.leanAnimY-=Pd.getAngleDist(Id[3],this.yDir)*Cd.leanSens,this.leanAnimY=Pd.limit(this.leanAnimY,Cd.leanMax),this.leanAnimX&&(this.leanAnimX*=Math.pow(Cd.leanPull,Bd)),this.leanAnimY&&(this.leanAnimY*=Math.pow(Cd.leanPull,Bd)),this.leanAnimZ&&(this.leanAnimZ*=Math.pow(Cd.leanPullZ,Bd)),this.bobAnimZ&&(this.bobAnimZ*=Math.pow(Cd.bobPullZ,Bd)),this.bobAnimY&&(this.bobAnimY*=Math.pow(Cd.bobPullY,Bd))),Id[10]&&Rd.swapWeapon(this,Id[10]),Fd||(this.recoilForce&&(this.recoilAnim+=this.recoilForce*Bd,this.recoilAnimY+=this.recoilForce*Bd,this.recoilForce*=Math.pow(this.weapon.recoverF,Bd)),this.recoilAnim&&(this.recoilAnim*=Math.pow(this.weapon.recover,Bd)),this.recoilAnimY&&(this.recoilAnimY*=Math.pow(this.weapon.recoverY||this.weapon.recover,Bd))),this.xDir=Id[2].round(3),this.yDir=Id[3].round(3),this.oldX=this.x,this.oldY=this.y,this.oldZ=this.z,this.weapon.zoom){var Wd=0>=this.reloadTimer&&0>=this.swapTime;Id[6]&&0<this.aimVal&&Wd?(this.aimDir=0,this.aimVal-=1/(this.weapon.aimSpeed/Bd),0>=this.aimVal&&(this.aimVal=0,this.isYou&&!Fd&&Rd.toggleAim(this,1)),!this.isYou||Fd||this.weapon.scope||Rd.updateAim(this,1-this.aimVal)):(!Wd||!Id[6]&&1>this.aimVal)&&(this.aimDir=1,this.aimVal||!this.isYou||Fd||Rd.toggleAim(this,0),this.aimVal+=1/(this.weapon.aimSpeed/Bd),1<=this.aimVal&&(this.aimVal=1),!this.isYou||Fd||this.weapon.scope||Rd.updateAim(this,1-this.aimVal)),0==this.aimVal?this.aimTime+=Bd:this.aimTime=0}Id[8]&&1>this.crouchVal&&!this.onLadder?(this.crouchVal+=Cd.crouchSpeed*Bd,1<=this.crouchVal&&(this.crouchVal=1),this.onGround?Nd&&(this.bobAnimY-=Cd.crouchAnim*Bd):this.y+=Cd.crouchSpeed*Bd):!Id[8]&&0<this.crouchVal&&(this.crouchVal-=Cd.crouchSpeed*Bd,0>=this.crouchVal&&(this.crouchVal=0),this.onGround?Nd&&(this.bobAnimY+=Cd.crouchAnim*Bd):this.y-=Cd.crouchSpeed*Bd),this.crouchVal&&(this.crouchVal=this.crouchVal.round(3)),Rd.updateHeight(this);var zd=this.onGround||this.onLadder,Hd=Bd*(zd?Cd.playerSpeed*this.speed:Cd.airSpeed)*(this.aimVal?1:Cd.aimSlow)*(this.crouchVal?Cd.crouchSlow:1)*this.weapon.spdMlt,Gd=this.onLadder?Cd.ladderDecel:this.onGround?Cd.groundDecel:Cd.airDecel;this.onGround&&(this.didJump&&!Id[7]&&(this.didJump=!1),!this.didJump&&Id[7]&&Rd.jump(this)),zd||(this.yVel-=Bd*Cd.gravity);var Vd=Cd.movDirs[Id[4]];void 0!==Vd&&(this.xVel+=Hd*Math.cos(Vd-this.xDir),this.zVel+=Hd*Math.sin(Vd-this.xDir)),this.xVel&&(this.x+=this.xVel*Bd,this.xVel*=Math.pow(Gd,Bd),this.xVel=Pd.cropVal(this.xVel,Cd.decelMin)),this.yVel&&(this.y+=this.yVel*Bd,this.yVel*=Math.pow(Gd,Bd),this.yVel=Pd.cropVal(this.yVel,Cd.decelMin)),this.zVel&&(this.z+=this.zVel*Bd,this.zVel*=Math.pow(Gd,Bd),this.zVel=Pd.cropVal(this.zVel,Cd.decelMin));var kd=this.onGround&&!this.didJump,jd=!1;this.onGround=!1,this.onLadder=!1;for(var Yd=0;Yd<Dd.manager.objects.length;++Yd)if(Od=Dd.manager.objects[Yd],this.collides(Od))if(Od.ladder){if(this.y<Od.y+Od.height&&0==this.crouchVal&&(this.yVel=0,this.onLadder=!0,this.stepSrc=null,void 0!==Vd)){var Xd=(Math.abs(Pd.getAngleDist(Od.dir,Vd-this.xDir))-Math.PI/2)/(Math.PI/2);0<Xd&&(this.y+=Cd.ladderSpeed*this.weapon.spdMlt*Bd*Xd,this.y<=Od.y-Od.height?this.y=Od.y-Od.height:this.y>=Od.y+Od.height&&(this.y=Od.y+Od.height))}}else if(!Od.ramp)this.y<Od.y+Od.height&&Od.y+Od.height-this.y<=Cd.climbHeight&&this.oldY<Od.y+Od.height&&kd?(this.y=Od.y+Od.height,this.onGround=!0):this.oldY>=Od.y+Od.height?(this.stepSrc=Od.stepSrc,!Fd&&this.oldY>this.y&&Rd.resetStep(this),this.y=Od.y+Od.height,this.yVel=0,this.onGround=!0):this.oldX-this.scale>=Od.x+Od.width?(this.x=Od.x+Od.width+this.scale,this.xVel=0):this.oldX+this.scale<=Od.x-Od.width?(this.x=Od.x-Od.width-this.scale,this.xVel=0):this.oldZ-this.scale>=Od.z+Od.length?(this.z=Od.z+Od.length+this.scale,this.zVel=0):this.oldZ+this.scale<=Od.z-Od.length?(this.z=Od.z-Od.length-this.scale,this.zVel=0):this.oldY+this.height<=Od.y-Od.height&&(this.y=Od.y-Od.height-this.height,this.yVel=0);else if(this.y<Od.y+Od.height){var qd=Math.max(0,Math.min(1,Pd.progressOnLine(Od.ramp.sX,Od.ramp.sZ,Od.ramp.eX,Od.ramp.eZ,this.x-this.scale*Math.cos(Od.dir),this.z-this.scale*Math.sin(Od.dir)))),Zd=Od.y-Od.height+2*Od.height*qd;(this.y<=Zd||kd)&&(!Fd&&this.oldY>this.y&&Rd.resetStep(this),this.y=Zd,this.yVel=0,this.onGround=!0,jd=!0,this.rampFix=Od.y-Od.height+2*Od.height*Math.round(qd))}if(!jd&&!this.didJump&&null!=this.rampFix&&Math.abs(this.y-this.rampFix)<=Cd.climbHeight&&(this.y=this.rampFix,this.onGround=!0,this.yVel=0,this.rampFix=null),this.onGround?this.airTime=0:this.airTime+=Bd,!Fd){var Jd=Pd.getDistance3D(this.oldX,this.oldY,this.oldZ,this.x,this.y,this.z);if(this.isYou&&(this.onLadder&&(Jd*=1.4),Pd.getDirection(this.oldX,this.oldZ,this.x,this.z),this.bobAnimZ+=Jd*Cd.bobMltZ,this.bobAnimZ=Pd.limit(this.bobAnimZ,Cd.bobAnimZMax),this.bobAnimY+=(this.oldY-this.y)*Cd.bobMltY,zd&&void 0!==Vd?(Rd.playerStep(this,Jd),this.leanAnimZ-=Jd*Cd.leanMltZ*Math.cos(Vd)):this.stepVal*=Math.pow(Cd.stepPull,Bd)),this.spreadPlus+=Jd*Cd.spreadMove+Math.abs(this.oldY-this.y)*Cd.spreadFall,this.spreadPlus*=Math.pow(Cd.spreadRecover,Bd),this.spread=Math.max(this.weapon.minSpread||0,(this.weapon.spread-this.weapon.spread*Cd.crouchSpread*this.crouchVal+this.recoilAnim*Cd.spreadMlt+this.spreadPlus)*this.aimVal),Id[9]&&Rd.reload(this),0<this.reloadTimer){var Kd=this.reloadTimer;this.reloadTimer-=Bd,this.isYou&&Kd>=this.weapon.reload/2&&this.reloadTimer<this.weapon.reload/2&&Rd.endReload(),0>=this.reloadTimer&&(this.reloadTimer=0,this.didShoot=!1,this.ammos[this.weaponIndex]=this.weapon.ammo,Rd.updatePlayerAmmo(this))}for(0<this.swapTime&&(this.swapTime-=Bd,0>this.swapTime&&(this.swapTime=0)),Yd=0;Yd<this.reloads.length;++Yd)0<this.reloads[Yd]&&(this.reloads[Yd]-=Bd,0>this.reloads[Yd]&&(this.reloads[Yd]=0));var Qd=!this.weapon.nAuto&&Id[5];this.didShoot&&!Id[5]&&(this.didShoot=!1),!this.didShoot&&Id[5]&&(Qd=!0),Qd&&0>=this.reloads[this.weaponIndex]&&0>=this.swapTime&&0>=this.reloadTimer&&(0<this.ammos[this.weaponIndex]?Rd.shoot(this):Rd.reload(this))}},this.collides=function(Id){return this.x-this.scale<Id.x+Id.width&&this.x+this.scale>Id.x-Id.width&&this.z-this.scale<Id.z+Id.length&&this.z+this.scale>Id.z-Id.length&&this.y<=Id.y+Id.height&&this.y+this.height>=Id.y-Id.height},this.update=function(Id,Dd){if(this.active){if(this.inputs.length){for(var Fd=0;Fd<this.inputs.length;++Fd)this.processInput(this.inputs[Fd],Id);this.resetInputs()}if(this.interpolate){this.dt+=Dd;var Bd=Math.min(1.6,this.dt/(Cd.serverSendRate*Cd.interpolation));this.oldX=this.x,this.oldY=this.y,this.oldZ=this.z,this.x=this.x1+(this.x2-this.x1)*Bd,this.y=this.y1+(this.y2-this.y1)*Bd,this.z=this.z1+(this.z2-this.z1)*Bd,this.onGround&&Rd.playerStep(this,Pd.getDistance(this.oldX,this.oldZ,this.x,this.z)),this.xDir=Math.lerpAngle(this.xDir2,this.xDir1,Math.min(1,Bd)),this.yDir=Math.lerpAngle(this.yDir2,this.yDir1,Math.min(1,Bd))}}}}(xd,this,dd,ld)).sid=vd||dd.generateSID(this.list),this.list.push(Td)),Ad||(Ad="Guest_"+Td.sid),Td.init(Ld,bd,_d,Ad,Sd),Td.setClass(od,Ed),this.setTeam(Td,od.mode),id&&this.generateMeshes(Td,Sd),this.swapWeapon(Td,0,!0),Td},this.remove=function(xd){var vd=this.indexBySid(xd);if(0<=vd){this.list[vd].room;var Ld=this.list[vd].id;if(this.list[vd].objInstances&&this.disposeMesh(this.list[vd]),this.list.splice(vd,1),pd){for(var bd=this.list.length-1;0<=bd;--bd)0<=(vd=this.list[bd].sentTo.indexOf(Ld))&&this.list[bd].sentTo.splice(vd,1);pd.broadcast("game"+od.sid,"2",xd),this.syncLeaders()}}};var hd=[0,1,2];this.getStepSound=function(){var xd=dd.randInt(0,hd.length-1),vd=hd[xd];return hd.splice(xd,1),0>=hd.length&&hd.push(0,1,2),vd},this.playerStep=function(xd,vd){if(vd&&(!xd.isYou&&xd.crouchVal&&(vd*=1.6),xd.stepVal+=vd*ld.stepMlt*xd.stepDir,xd.stepVal>=Math.PI/2&&1==xd.stepDir||xd.stepVal<=-Math.PI/2&&-1==xd.stepDir)){if(nd){var Ld=.65*(1>xd.crouchVal?1:xd.isYou?.5:0),bd=1>xd.crouchVal?1:.8,_d=xd.stepSrc?"_"+xd.stepSrc:"";xd.isYou?nd.play("step_"+this.getStepSound()+_d,Ld,!1,bd):Ld&&od.playerSound("step_"+dd.randInt(0,2)+_d,0,Ld,xd,bd,10)}xd.stepDir*=-1}},this.resetStep=function(xd){if(nd){var vd=xd.stepSrc?"_"+xd.stepSrc:"";nd.play("step_0"+vd)}},this.jump=function(xd){xd.didJump=!0,xd.yVel+=(ld.jumpVel-ld.jumpVel*(ld.crouchJump*xd.crouchVal))*xd.weapon.spdMlt*(xd.aimVal?1:ld.aimJumpSlow);var vd=dd.getDistance(0,0,xd.xVel,xd.zVel);xd.xVel-=ld.jumpPush*vd*Math.sin(xd.xDir),xd.zVel-=ld.jumpPush*vd*Math.cos(xd.xDir),nd&&!xd.recon&&nd.play("jump_0",.1)},this.updateAim=function(xd,vd){id.zoom(1+(xd.weapon.zoom-1)*vd)},this.toggleAim=function(xd,vd){nd&&!xd.recon&&nd.play("aim_"+vd,.1),vd||(id.zoom(1),aimRecticle.style.display="none"),xd.weapon.scope&&(id.zoom(vd?xd.weapon.zoom:1),xd.weaponMeshes[xd.weaponIndex].visible=!vd,aimRecticle.style.display=vd?"block":"none")},this.reload=function(xd){!xd.reloadTimer&&xd.ammos[xd.weaponIndex]<xd.weapon.ammo&&(nd&&nd.play("reload_1",.25),xd.reloadTimer=xd.weapon.reload)},this.endReload=function(){nd&&nd.play("reload_2",.25)},this.updatePlayerAmmo=function(xd){xd.isYou&&(ammoVal.innerHTML=xd.ammos[xd.weaponIndex]+" <span id='ammoMax'> | "+xd.weapon.ammo+"</span>",0>=xd.ammos[xd.weaponIndex]?(reloadMsg.innerHTML="[R] Reload",reloadMsg.style.display="block"):reloadMsg.style.display="none")};var fd=[];this.shoot=function(xd){if(xd.reloads[xd.weaponIndex]=xd.weapon.rate,xd.ammos[xd.weaponIndex]--,xd.didShoot=!0,this.updatePlayerAmmo(xd),od.playSound(xd.weapon.sound,.85,xd),xd.recoilForce+=xd.weapon.recoil*(1-.3*xd.crouchVal),xd.isYou&&(xd.leanAnimX+=dd.randInt(0,1)?-xd.weapon.recoilR:xd.weapon.recoilR),xd.isYou){var vd=xd.weaponMeshes[xd.weaponIndex];vd.muzzle.visible=!0,sd.setMaterial(vd.muzzle,2,1,!0),xd.weapon.nCase||nd.play("case_"+dd.randInt(0,1),.2),vd.muzzle.init(0,xd.weapon.muzOffY||0,-xd.weapon.muzOff,0,0,0,3*(xd.weapon.muzMlt||1),50)}for(var Ld=0;Ld<(xd.weapon.shots||1);++Ld){var bd=(xd.spread+(xd.weapon.innac||0))*ld.spreadAdj,_d=xd.xDir+dd.randFloat(-bd,bd),Ad=xd.yDir+xd.recoilAnimY*ld.recoilMlt+dd.randFloat(-bd,bd);fd.length=0;for(var Ed=0,Sd=1/(xd.weapon.range*Math.sin(_d+Math.PI)*Math.cos(Ad)),Td=1/(xd.weapon.range*Math.cos(_d+Math.PI)*Math.cos(Ad)),Md=1/(xd.weapon.range*Math.sin(Ad)),wd=0;wd<od.map.manager.objects.length;++wd)md=od.map.manager.objects[wd],(Ed=dd.lineInRect(xd.x,xd.z,xd.y+xd.height-ld.cameraHeight,Sd,Td,Md,md.x-md.width,md.z-md.length,md.y-md.height,md.x+md.width,md.z+md.length,md.y+md.height))&&1>=Ed&&fd.push({obj:md,dst:Ed});if(pd)for(wd=0;wd<this.list.length;++wd)!this.list[wd].active||xd==this.list[wd]||xd.team&&xd.team==this.list[wd].team||(md=this.fetchState(this.list[wd],xd.ping))&&(Ed=dd.lineInRect(xd.x,xd.z,xd.y+xd.height-ld.cameraHeight,Sd,Td,Md,md.x-this.list[wd].scale-ld.hitBoxPad,md.z-this.list[wd].scale-ld.hitBoxPad,md.y,md.x+this.list[wd].scale+ld.hitBoxPad,md.z+this.list[wd].scale+ld.hitBoxPad,md.y+this.list[wd].height+ld.hitBoxPad))&&1>=Ed&&fd.push({player:!0,obj:this.list[wd],dst:Ed});var Rd=xd.weapon.range;if(fd.length){fd.sort(dd.orderByDst);var Pd=xd.weapon.dmg;for(wd=0;wd<fd.length&&(md=fd[wd],Rd=xd.weapon.range*md.dst,pd);++wd){var Cd=Pd-xd.weapon.dmgDrop*md.dst,Od=!1,Id=!1;if(md.player){var Dd=xd.y+xd.height-ld.cameraHeight+Rd*Math.sin(Ad);Od=md.obj.y+md.obj.height-Dd<ld.headScale,Id=md.obj.y+ld.legHeight>Dd,Cd*=Od&&!xd.weapon.noHeadShot?1.5:1,Cd*=Id?.5:1}if(md.player||md.obj.dummy){if(this.changeHealth(md.obj,xd,Cd)){var Fd={dst:md.dst,headShot:Od};this.kill(md.obj,xd,Fd)}Pd-=void 0==xd.weapon.pierce?Pd:xd.weapon.dmg*ld.materialDens.flesh*xd.weapon.pierce}else{if(!ld.materialDens[md.obj.src])break;Pd-=void 0==xd.weapon.pierce?Pd:xd.weapon.dmg*ld.materialDens[md.obj.src]*xd.weapon.pierce}if(0>=Pd)break}}Rd-=.12;var Bd=xd.x+Rd*Math.sin(_d+Math.PI)*Math.cos(Ad),Ud=(Dd=xd.y+xd.height-ld.cameraHeight+Rd*Math.sin(Ad),xd.z+Rd*Math.cos(_d+Math.PI)*Math.cos(Ad)),Nd=0,Wd=0;if(fd.length&&(Dd>=md.obj.y+md.obj.height?Wd=Math.PI/2:Dd<=md.obj.y-md.obj.height?Wd=-Math.PI/2:Bd<=md.obj.x-md.obj.width?Nd=-Math.PI/2:Bd>=md.obj.x+md.obj.width?Nd=Math.PI/2:Ud<=md.obj.z-md.obj.length&&(Nd=Math.PI),pd||sd.effect(Bd,Dd,Ud,Nd,Wd,0)),pd&&(!fd.length||!md.player))for(wd=0;wd<this.list.length;++wd)this.list[wd].active&&this.list[wd]!=xd&&(fd.length?pd.send(this.list[wd].id,"9",xd.sid,Math.round(Bd),Math.round(Dd),Math.round(Ud),Nd.round(1),Wd.round(1)):pd.send(this.list[wd].id,"9",xd.sid,Math.round(Bd),Math.round(Dd),Math.round(Ud)));if(xd.isYou&&Rd>=ld.tracerMinDst){var zd=xd.weaponMeshes[xd.weaponIndex].muzzle.getWorldPosition(),Hd=zd.x,Gd=zd.y,Vd=zd.z;dd.getDistance3D(Hd,Gd,Vd,Bd,Dd,Ud),Nd=dd.getDirection(Vd,Hd,Ud,Bd),Wd=dd.getDirection(dd.getDistance(Hd,Vd,Bd,Ud),Dd,0,Gd),sd.tracer(Hd,Gd,Vd,Nd,Wd,Math.min(Rd,ld.tracerMaxDst))}}},this.spray=function(xd){if(od.now-xd.lastSpray>=ld.sprayTimer){fd.length=0;for(var vd=0,Ld=1/(ld.sprayRange*Math.sin(xd.xDir+Math.PI)*Math.cos(xd.yDir)),bd=1/(ld.sprayRange*Math.cos(xd.xDir+Math.PI)*Math.cos(xd.yDir)),_d=1/(ld.sprayRange*Math.sin(xd.yDir)),Ad=0;Ad<od.map.manager.objects.length;++Ad)md=od.map.manager.objects[Ad],(vd=dd.lineInRect(xd.x,xd.z,xd.y+xd.height-ld.cameraHeight,Ld,bd,_d,md.x-md.width,md.z-md.length,md.y-md.height,md.x+md.width,md.z+md.length,md.y+md.height))&&1>=vd&&fd.push({obj:md,dst:vd});if(fd.length&&(fd.sort(dd.orderByDst),md=fd[0].obj)){var Ed=ld.sprayRange*fd[0].dst-.1,Sd=xd.y+xd.height-ld.cameraHeight+Ed*Math.sin(xd.yDir),Td=xd.x+Ed*Math.sin(xd.xDir+Math.PI)*Math.cos(xd.yDir),Md=xd.z+Ed*Math.cos(xd.xDir+Math.PI)*Math.cos(xd.yDir),wd=0,Rd=0;Sd>=md.y+md.height?Rd=-90:Sd<=md.y-md.height?Rd=90:Td<=md.x-md.width?wd=-90:Td>=md.x+md.width?wd=90:Md<=md.z-md.length&&(wd=180);var Pd=ld.sprayScale/2;if(Rd){if(md.width<Pd||md.length<Pd)return;Md-Pd<md.z-md.length?Md=md.z-md.length+Pd:Md+Pd>md.z+md.length&&(Md=md.z+md.length-Pd),Td-Pd<md.x-md.width?Td=md.x-md.width+Pd:Td+Pd>md.x+md.width&&(Td=md.x+md.width-Pd)}else{if(md.height<Pd)return;if(90==wd||-90==wd){if(md.length<Pd)return;Md-Pd<md.z-md.length?Md=md.z-md.length+Pd:Md+Pd>md.z+md.length&&(Md=md.z+md.length-Pd)}else{if(md.width<Pd)return;Td-Pd<md.x-md.width?Td=md.x-md.width+Pd:Td+Pd>md.x+md.width&&(Td=md.x+md.width-Pd)}Sd+Pd>md.y+md.height&&(Sd=md.y+md.height-Pd)}xd.lastSpray=od.now,od.playSound("spray",.4,xd,!0),pd.broadcast("game"+od.sid,"sp",xd.sid,xd.sprayIndex,Td.round(2),Sd.round(2),Md.round(2),wd,Rd)}}};var yd=[];this.syncLeaders=function(){ud=this.list.slice().sort(dd.orderByScore),yd.length=0;for(var xd=0;xd<ud.length;++xd)yd.push(ud[xd].sid,ud[xd].name,ud[xd].team,ud[xd].score);pd.broadcast("game"+od.sid,"7",yd)},this.score=function(xd,vd){xd.score+=vd,vd>xd.highest&&(xd.highest=vd),pd.send(xd.id,"5",vd),this.syncLeaders()},this.tickPlayer=function(xd,vd){xd.playTime+=vd,0<xd.hitTimer&&(xd.hitTimer-=vd),xd.ticker-=vd,0>=xd.ticker&&(xd.ticker=500,0>=xd.hitTimer&&this.changeHealth(xd,null,-ld.regenVal))},this.changeHealth=function(xd,vd,Ld){if(!(0>Ld&&xd.health==xd.maxHealth||xd.team&&vd&&xd.team==vd.team&&0<Ld)){if(vd&&pd.send(vd.id,"4",xd.sid,Math.round(Ld)),xd.dummy)return!0;0<Ld&&(xd.hitTimer=ld.regenDelay),xd.health-=Ld,xd.health=Math.max(Math.min(xd.maxHealth,xd.health),0),vd?pd.send(xd.id,"h",Math.ceil(xd.health),null,Math.round(vd.x),Math.round(vd.z)):pd.send(xd.id,"h",Math.ceil(xd.health));for(var bd=0;bd<this.list.length;++bd)this.list[bd]!=xd&&pd.send(this.list[bd].id,"h",Math.ceil(xd.health),xd.sid);return 0>=xd.health}},this.swapWeapon=function(xd,vd,Ld,bd){if(!(1>=xd.ammos.length&&vd)){var _d=xd.weaponIndex;if(vd&&(xd.reloadTimer=0,xd.weaponIndex+=vd,xd.didShoot=!1,0>xd.weaponIndex&&(xd.weaponIndex=xd.ammos.length-1),xd.weaponIndex>xd.ammos.length-1&&(xd.weaponIndex=0)),void 0!=bd&&(xd.weaponIndex=bd),xd.weapon=od.weapons[xd.loadout[xd.weaponIndex]],id&&(_d!=xd.weaponIndex||Ld)&&(xd.weaponMeshes[_d]&&(xd.weaponMeshes[_d].visible=!1),xd.weaponMeshes[xd.weaponIndex]&&(xd.weaponMeshes[xd.weaponIndex].visible=!0)),void 0==bd&&(!id||xd.isYou)&&(xd.swapTime=xd.weapon.swapTime,xd.isYou&&(_d!=xd.weaponIndex||Ld))){for(var Ad="",Ed=xd.ammos.length-1;0<=Ed;--Ed)Ad+="<div class='weaponItem'><img style='opacity:"+(Ed==xd.weaponIndex?1:.7)+"' class='weaponIcon' src='./textures/weapons/"+od.weapons[xd.loadout[Ed]].icon+".png' /></div>";weaponDisplay.innerHTML=Ad,this.updatePlayerAmmo(xd)}}},this.kill=function(xd,vd,Ld){var bd;if(xd.dummy||(xd.active=!1,xd.isYou&&this.toggleAim(xd,0),xd.objInstances&&this.disposeMesh(xd)),pd&&(xd.deaths++,vd&&(xd.dummy||vd.kills++,vd.streak++,od.now-vd.lastKill>=ld.feedTimer&&(vd.streak=0),vd.lastKill=od.now,(bd=gd.reward(this,vd,xd,Ld))&&pd.send(vd.id,"6",bd,Ld.headShot?1:0,vd.kills),this.score(vd,gd.getScore(bd))),!xd.dummy))for(var _d=0;_d<this.list.length;++_d)this.list[_d]==xd?pd.send(xd.id,"3",xd.sid,vd?vd.sid:0,[vd?vd.loadout[vd.weaponIndex]:-1,bd?gd.getScore(bd):0]):pd.send(this.list[_d].id,"3",xd.sid,vd?vd.sid:0)},this.indexBySid=function(xd){for(var vd=0;vd<this.list.length;++vd)if(this.list[vd].sid==xd)return vd;return-1},this.findBySid=function(xd){for(var vd=0;vd<this.list.length;++vd)if(this.list[vd].sid===xd)return this.list[vd];return null}}},function(ed){ed.exports=[{name:"Dummy",opacity:1},{name:"Target",opacity:.7},{name:"Vertix",opacity:.7}]},function(ed){ed.exports=[{name:"Triggerman",loadout:[2,1],colors:[10975328,4013373,2302755,2631720,7098434,12566463],health:100,speed:1.05},{name:"Hunter",loadout:[0,1],colors:[10975328,8083261,6506290,2631720,6506290,6506290],health:60,speed:1},{name:"Run N Gun",loadout:[3],colors:[10975328,4088706,3099491,2631720,6506290,3099491],health:80,speed:1.1},{name:"Spray N Pray",loadout:[4],colors:[10975328,5793865,4806204,2631720,2631720,4806204],health:150,speed:1},{name:"Vince",loadout:[5,1],colors:[8412234,5526119,4144461,2631720,2631720,4144461],health:100,speed:1},{name:"Detective",loadout:[6],colors:[10975328,7360054,6308654,2631720,6506290,6308654],health:100,speed:1},{name:"Marksman",loadout:[7],colors:[10975328,5793865,4806204,2631720,2631720,4806204],health:100,speed:1}]},function(ed){ed.exports=[{name:"Sniper Rifle",src:"weapon_1",icon:"icon_1",sound:"weapon_1",nAuto:!0,type:0,scope:!0,swapTime:400,aimSpeed:120,spdMlt:.85,ammo:3,reload:1500,dmg:100,pierce:.2,range:800,dmgDrop:0,scale:1.3,leftHoldY:-.8,rightHoldY:-.8,leftHoldZ:2.1,rightHoldZ:0,xOff:.7,yOff:-.6,zOff:-2.4,xOrg:0,yOrg:-.33,zOrg:-1.2,muzOff:5.5,muzMlt:1.4,rate:900,spread:260,zoom:2.7,leanMlt:1,recoil:.005,recoilR:.02,recover:.993,recoverF:.975,recoilY:1.5,recoilZ:3},{name:"Pistol",src:"weapon_3",icon:"icon_3",sound:"weapon_3",transp:!0,nAuto:!0,kill:["",75],type:1,swapTime:200,aimSpeed:120,spdMlt:1.05,ammo:10,reload:700,dmg:20,range:500,dmgDrop:10,scale:1.2,leftHoldY:-.1,rightHoldY:.21,leftHoldZ:-.5,rightHoldZ:-.5,xOff:.7,yOff:-2.1,zOff:-4.5,xOrg:0,yOrg:-1.09,zOrg:-4.25,muzOff:1.5,muzOffY:.6,muzMlt:.95,rate:150,spread:90,zoom:1.4,leanMlt:.3,recoil:.006,recoilR:.01,recover:.992,recoverF:.94,recoilY:2.5,recoilZ:6},{name:"Assault Rifle",src:"weapon_2",icon:"icon_2",sound:"weapon_2_t",transp:!0,type:0,swapTime:300,aimSpeed:140,spdMlt:1,ammo:30,reload:1200,dmg:22,pierce:1,range:700,dmgDrop:10,scale:1,leftHoldY:.07,rightHoldY:0,rightHoldX:.2,leftHoldZ:1,rightHoldZ:-.7,xOff:.95,yOff:-1.4,zOff:-3.5,xOrg:0,yOrg:-.94,zOrg:-2.1,muzOff:4.5,muzOffY:.5,rate:110,spread:120,minSpread:5,zoom:1.5,leanMlt:.3,recoil:.002,recoilR:.01,recover:.99,recoverY:.9975,recoverF:.975,recoilZ:5},{name:"Submachine Gun",src:"weapon_4",icon:"icon_4",sound:"weapon_4",transp:!0,type:0,swapTime:300,aimSpeed:120,spdMlt:1.04,ammo:24,reload:1200,dmg:18,pierce:1,range:500,dmgDrop:12,scale:1.6,leftHoldY:-.35,rightHoldY:-.45,leftHoldZ:1.2,rightHoldZ:-.2,xOff:.95,yOff:-.95,zOff:-3,xOrg:0,yOrg:-.62,zOrg:-2.2,muzOff:2.4,muzOffY:.1,rate:80,spread:200,minSpread:10,zoom:1.4,recoil:.0019,recoilR:.008,recover:.99,recoverY:.997,recoverF:.975,recoilZ:4},{name:"Light Machine Gun",src:"weapon_7",icon:"icon_7",sound:"weapon_7",transp:!0,type:0,swapTime:800,aimSpeed:200,spdMlt:.79,ammo:100,reload:2500,dmg:22,pierce:1,range:700,dmgDrop:10,scale:1.9,leftHoldY:-.5,rightHoldY:-.55,rightHoldX:.1,leftHoldZ:1.2,rightHoldZ:-.2,xOff:.95,yOff:-.95,zOff:-3,xOrg:0,yOrg:-.3,zOrg:-2,muzOff:3.9,rate:120,spread:300,minSpread:15,zoom:1.2,recoil:.0025,recoilR:.015,recover:.994,recoverY:.998,recoverF:.975,recoilZ:3.5},{name:"Shotgun",src:"weapon_6",icon:"icon_6",sound:"weapon_6",nAuto:!0,nCase:!0,type:0,swapTime:300,aimSpeed:180,spdMlt:1,ammo:2,shots:5,reload:900,dmg:50,dmgDrop:25,scale:2,leftHoldY:-.4,rightHoldY:-.5,rightHoldX:0,leftHoldZ:2.2,rightHoldZ:.3,xOff:.95,yOff:-.95,zOff:-2,xOrg:0,yOrg:-.4,zOrg:-1.5,muzOff:5,muzMlt:1.2,range:240,rate:400,innac:110,spread:120,minSpread:20,zoom:1.25,recoil:.008,recoilR:.015,recover:.994,recoverF:.975,recoilY:.5,recoilZ:4},{name:"Revolver",src:"weapon_5",icon:"icon_5",sound:"weapon_5",nAuto:!0,transp:!0,kill:["",50],type:1,swapTime:200,aimSpeed:120,spdMlt:1.04,ammo:6,reload:900,dmg:61,pierce:.85,dmgDrop:10,scale:1.7,leftHoldY:-.05,rightHoldY:.05,leftHoldZ:-.75,rightHoldZ:-.75,xOff:.7,yOff:-2.1,zOff:-4.1,xOrg:0,yOrg:-1.26,zOrg:-4.25,muzOff:2.3,muzOffY:.6,muzMlt:.95,range:700,rate:300,spread:100,zoom:1.4,recoil:.009,recoilR:.02,recover:.992,recoverF:.94,recoilY:2.5,recoilZ:6},{name:"Semi Auto",src:"weapon_8",icon:"icon_8",sound:"weapon_8",nAuto:!0,type:0,scope:!0,swapTime:400,aimSpeed:160,spdMlt:1,ammo:6,reload:1300,dmg:50,pierce:.2,range:800,dmgDrop:0,scale:1.3,leftHoldY:-.8,rightHoldY:-.8,leftHoldZ:2.1,rightHoldZ:0,xOff:.7,yOff:-.6,zOff:-2.4,xOrg:0,yOrg:-.33,zOrg:-1.2,muzOff:5.5,muzOffY:-.2,muzMlt:1.4,rate:300,spread:300,zoom:2.2,leanMlt:1,recoil:.007,recoilR:.02,recover:.993,recoverY:.998,recoverF:.975,recoilZ:2.4}]},function(ed,td,ad){var rd=ad(12);ed.exports.obj=function(od,id,nd,sd,dd,ld,pd,cd,md){function ud(){return{name:"KRUNKER",availableMaps:function(){for(var fd=[],yd=0;yd<rd.maps.length;yd++)fd.push(yd);return fd}()}}var gd,hd;this.index=od,this.connectedClients=0,this.password=void 0,this.config=ud(),this.isPrivate=function(){return void 0!=this.password},this.makePublic=function(){this.password=void 0,this.config=ud(),md.setPrivateGame(this.index,!1)},this.setPrivate=function(fd,yd){this.password=fd,this.config=yd,md.setPrivateGame(this.index,!0)},this.map=new rd.manager(dd,pd,sd,id),this.weapons=ad(56),this.classes=ad(55),this.sprays=ad(54),this.players=new(ad(53).manager)(this,dd,ld,pd,sd,id,cd),this.endData=[],this.playSound=function(fd,yd,xd,vd){if(ld)ld.play(fd,yd);else for(var Ld=0;Ld<this.players.list.length;++Ld)(gd=this.players.list[Ld]).active&&(xd!=gd||vd)&&cd.send(gd.id,"s",fd,xd.sid)},this.playerSound=function(fd,yd,xd,vd,Ld){(gd=vd||this.players.findBySid(yd))&&ld.play3D(fd,gd.x,gd.y,gd.z,xd||1,Ld)},this.getSpawnPoint=function(fd){for(var yd=0;yd<this.map.spawns.length;++yd){this.map.spawns[yd].dst=0;for(var xd=0;xd<this.players.list.length;++xd)!(gd=this.players.list[xd]).active||fd&&gd.team==fd||(this.map.spawns[yd].dst+=sd.getDistance3D(this.map.spawns[yd].x,this.map.spawns[yd].y,this.map.spawns[yd].z,gd.x,gd.y,gd.z))}return this.map.spawns.sort(sd.orderByDst),this.map.spawns.reverse(),this.map.spawns[0]},this.savePlayerData=function(){if(nd)for(var fd=0;fd<this.players.list.length;++fd)if((gd=this.players.list[fd]).account){gd.account.kills+=gd.kills,gd.account.deaths+=gd.deaths,gd.account.games++,gd.account.timePlayed+=gd.playTime||0,gd.account.score+=gd.score,gd.didWin&&gd.account.wins++;var yd=gd.account.getData();cd.send(gd.id,"ua",yd),nd.call(2,yd)}},this.init=function(fd,yd,xd,vd){this.players.clear(),this.gameTimer=id.gameTime,this.lastTimer=0,this.mapIndex=void 0==fd?this.config.availableMaps[Math.floor(Math.random()*this.config.availableMaps.length)]:fd,this.modeIndex=void 0==yd?this.map.getRandomMode(this.mapIndex):yd,this.biomeIndex=void 0==xd?this.map.getRandomBiome(this.mapIndex):xd,this.mode=rd.modes[this.modeIndex],this.biome=rd.biomes[this.biomeIndex],this.map.generate(this.mapIndex,this.mode,this.biome,vd),ld&&ld.play("ambient_1",.12,!0)},this.endGame=function(){this.endTimer=id.endTimer,this.players.list.sort(sd.orderByScore),this.endData.length=0;for(var fd=0;fd<this.players.list.length;++fd)for(var yd=0;yd<id.endStats.length;++yd)this.endData.push(this.players.list[fd][id.endStats[yd]]);if(this.mode.teams){var xd=0,vd=0;for(fd=0;fd<this.players.list.length;++fd)1==(gd=this.players.list[fd]).team?xd+=gd.score:2==gd.team&&(vd+=gd.score);this.winner=xd>=vd?1:2}else this.winner=this.players.list[0];for(fd=0;fd<this.players.list.length;++fd)(gd=this.players.list[fd]).didWin=this.mode.teams?gd.team&&gd.team==this.winner:gd==this.winner,cd.send(gd.id,"end",!1,gd.didWin,this.endData);this.savePlayerData(),this.init()},this.forceNewGame=function(){this.gameTimer=0,this.endGame(),cd.broadcast("game"+this.sid,"init",this.mapIndex,this.modeIndex,this.biomeIndex),this.endTimer=0},this.update=function(fd,yd,xd){this.now=yd,cd&&(0<this.endTimer?(this.endTimer-=fd,0>=this.endTimer?(this.endTimer=0,cd.broadcast("game"+this.sid,"init",this.mapIndex,this.modeIndex,this.biomeIndex)):(hd=sd.getTime(this.endTimer))!=this.lastTimer&&(this.lastTimer=hd,cd.broadcast("game"+this.sid,"t",hd,1))):0<this.gameTimer&&(this.gameTimer-=fd,0>=this.gameTimer?(this.gameTimer=0,this.endGame()):(hd=sd.getTime(this.gameTimer))!=this.lastTimer&&(this.lastTimer=hd,cd.broadcast("game"+this.sid,"t",hd)))),this.players.update(fd),pd&&pd.update(fd,xd),dd&&dd.render(fd)}}},function(ed,td,ad){ad(2),ed.exports=function(rd,od,id,nd,sd,dd){function ld(hd,fd){if(window.idleTimer=0,pd.keys){if(fd&&pd.keys[hd]!==fd&&null!=pd.inputChanger)pd.moveKeys[pd.inputChanger]?pd.moveKeys[pd.inputChanger]=hd:pd[pd.inputChanger]=hd,saveVal("cont_"+pd.inputChanger,hd),pd.inputChanger=null,showWindow(7,!0);else if(!pd.enabled)return;pd.keys[hd]!==fd&&(pd.keys[hd]=fd,0<=pd.moveKeys.indexOf(hd)&&pd.updateMoveDir(),fd&&(hd==pd.swapKeyU?pd.scrollDelta=1:hd==pd.swapKeyD?pd.scrollDelta=-1:window.pressButton(hd)))}}var pd=this,cd=rd.renderer.domElement;if(this.hasPointerlock="pointerLockElement"in document||"mozPointerLockElement"in document||"webkitPointerLockElement"in document,this.hasPointerlock){cd.requestPointerLock=cd.requestPointerLock||cd.mozRequestPointerLock||cd.webkitRequestPointerLock;var md=function(){pd.enabled=document.pointerLockElement===cd||document.mozPointerLockElement===cd||document.webkitPointerLockElement===cd,dd.connected&&(pd.enabled&&enterGame(),id.toggleControlUI(pd.enabled))};document.addEventListener("pointerlockchange",md,!1),document.addEventListener("mozpointerlockchange",md,!1),document.addEventListener("webkitpointerlockchange",md,!1)}this.isn=0,this.tmpInputs=[],this.getISN=function(){return this.isn++},this.sensMlt=1,this.locked=!1,this.enabled=!1,rd.camera.rotation.set(0,0,0),this.pitchObject=new od.Object3D,this.pitchObject.add(rd.camera),this.object=new od.Object3D,this.object.add(this.pitchObject);var ud=Math.PI/2;cd.addEventListener("mousemove",function(hd){if(pd.enabled){hd.preventDefault();var fd=hd.movementX||hd.mozMovementX||hd.webkitMovementX||0,yd=hd.movementY||hd.mozMovementY||hd.webkitMovementY||0,xd=sd.mouseSens*pd.sensMlt*(pd.target?sd.camChaseSen:1)*(rd.camera.fov/rd.fov);pd.object.rotation.y-=fd*xd,pd.pitchObject.rotation.x-=yd*xd*(pd.invertY?-1:1),pd.pitchObject.rotation.x=Math.max(-ud,Math.min(ud,pd.pitchObject.rotation.x)),pd.yDir=(pd.pitchObject.rotation.x%Math.PI2).round(3),pd.xDir=(pd.object.rotation.y%Math.PI2).round(3)}},!1),cd.addEventListener("mousedown",function(hd){if(!pd.locked)switch(pd.enabled||pd.toggle(!0),document.activeElement==chatInput&&chatInput.blur(),hd.which){case 3:pd.mouseDownR=1;break;default:pd.mouseDownL=1;}},!1),cd.addEventListener("mouseup",function(hd){if(!pd.locked)switch(hd.which){case 3:pd.mouseDownR=0;break;default:pd.mouseDownL=0;}},!1);var gd=function(hd){return hd=window.event||hd,pd.skipScroll?pd.skipScroll=!1:pd.scrollDelta=-Math.max(-1,Math.min(1,hd.wheelDelta||-hd.detail)),!1};cd.addEventListener?(cd.addEventListener("mousewheel",gd,!1),cd.addEventListener("DOMMouseScroll",gd,!1)):myitem.attachEvent("onmousewheel",gd),this.update=function(hd){if(this.target){var fd=nd.getAngleDist(this.object.rotation.y,this.target.yD);this.object.rotation.y+=fd*hd*sd.camChaseTrn,fd=nd.getAngleDist(pd.pitchObject.rotation.x,this.target.xD),this.pitchObject.rotation.x+=fd*hd*sd.camChaseTrn,fd=nd.getDistance3D(this.object.position.x,this.object.position.y,this.object.position.z,this.target.x,this.target.y,this.target.z)*hd*sd.camChaseSpd;var yd=nd.getDirection(this.object.position.z,this.object.position.x,this.target.z,this.target.x),xd=nd.getXDir(this.object.position.x,this.object.position.y,this.object.position.z,this.target.x,this.target.y,this.target.z);this.object.position.x-=fd*Math.sin(yd)*Math.cos(xd),this.object.position.y+=fd*Math.sin(xd),this.object.position.z-=fd*Math.cos(yd)*Math.cos(xd),rd.updateFrustum()}},this.camLookAt=function(hd,fd,yd){var xd=nd.getXDir(this.object.position.x,this.object.position.y,this.object.position.z,hd,fd,yd),vd=nd.getDirection(this.object.position.z,this.object.position.x,yd,hd);this.target={xD:xd,yD:vd,x:hd+sd.camChaseDst*Math.sin(vd)*Math.cos(xd),y:fd-sd.camChaseDst*Math.sin(xd),z:yd+sd.camChaseDst*Math.cos(vd)*Math.cos(xd)}},this.moveCam=function(hd,fd,yd){pd.object.position.set(hd,fd,yd),rd.camera.updateProjectionMatrix(),rd.updateFrustum()},this.rotateCam=function(hd,fd,yd){rd.camera.rotation.y=hd,rd.camera.rotation.x=fd,rd.camera.rotation.z=yd},this.jumpKey=parseInt(getSavedVal("cont_4")||32),this.crouchKey=parseInt(getSavedVal("cont_5")||16),this.swapKeyD=parseInt(getSavedVal("cont_6")||81),this.swapKeyU=parseInt(getSavedVal("cont_7")||69),this.reloadKey=parseInt(getSavedVal("cont_8")||82),this.sprayKey=parseInt(getSavedVal("cont_9")||70),this.aimKey=parseInt(getSavedVal("cont_10")||67),this.chatKey=parseInt(getSavedVal("cont_11")||13),this.moveKeys=[parseInt(getSavedVal("cont_0")||87),parseInt(getSavedVal("cont_1")||83),parseInt(getSavedVal("cont_2")||65),parseInt(getSavedVal("cont_3")||68)],this.moveDirs=[[0,-1],[0,1],[-1,0],[1,0]],this.updateMoveDir=function(){for(var hd=0,fd=0,yd=0;yd<pd.moveKeys.length;++yd)pd.keys[pd.moveKeys[yd]]&&(hd+=pd.moveDirs[yd][0],fd+=pd.moveDirs[yd][1]);this.moveDir=0==hd&&0==fd?null:Math.atan2(fd,hd)},window.addEventListener("keydown",function(hd){(hd.which||hd.keyCode)==pd.chatKey?window.pressButton(hd.which||hd.keyCode):document.activeElement!=chatInput&&(pd.enabled&&hd.preventDefault(),ld(hd.which||hd.keyCode||0,1))},!1),window.addEventListener("keyup",function(hd){pd.enabled&&hd.preventDefault(),ld(hd.which||hd.keyCode||0,0)},!1),this.toggle=function(hd){this.locked||("block"==windowHolder.style.display?hd&&id.toggleWindow(!1):(hd?cd.requestPointerLock():document.exitPointerLock(),this.enabled=hd))},this.disable=function(){pd.toggle(!1),pd.locked=!0},this.reset=function(){this.mouseDownL=0,this.mouseDownR=0,this.keys={},this.tmpInputs.length=0,this.scrollDelta=0,this.xDir=0,this.yDir=0,this.isn=0,this.moveDir=null,this.skipScroll=!1,this.inputChanger=null,this.target=null,this.locked=!1,pd.pitchObject.rotation.x=0,pd.object.rotation.y=0,rd.camera.rotation.set(0,0,0)}}},function(ed){ed.exports=function(){var od;this.divs=[],this.update=function(id){for(var nd=this.divs.length-1;0<=nd;--nd)if(0<(od=this.divs[nd]).delay)od.delay-=id,0>=od.delay&&(od.style.display="inline-block");else{if(od.scale>od.minScale&&(od.scale-=od.scaleSpeed*id,od.scale<=od.minScale&&(od.scale=od.minScale),od.style.fontSize=od.scale+"px"),od.scaleSpd&&(od.startS+=od.scaleSpd*id,od.style.width=od.startS+"vh",od.style.height=od.startS+"vh"),od.life-=id,0>=od.life){od.style.display="none";var sd=od.callback;this.divs.splice(nd,1),sd&&sd()}od.fade&&od.life<=od.fade&&(od.style.opacity=od.life/od.fade)}},this.animateText=function(id,nd,sd,dd,ld,pd,cd,md){0>this.divs.indexOf(id)&&this.divs.push(id),id.delay=cd,cd||(id.style.display="inline-block"),id.style.fontSize=sd+"px",id.scale=sd,id.minScale=dd?.4*sd:sd,id.innerHTML=nd,id.scaleSpeed=dd,id.life=ld,id.fade=pd,id.style.opacity=1,id.callback=md},this.animateDiv=function(id,nd,sd,dd,ld){0>this.divs.indexOf(id)&&this.divs.push(id),id.style.display="block",id.life=nd,id.maxLife=nd,id.style.opacity=1,id.fade=sd,dd&&(id.style.width=dd+"vh",id.style.height=dd+"vh",id.startS=dd,id.scaleSpd=ld)},this.reset=function(){for(var id=0;id<this.divs.length;++id)this.divs[id].style.display="none";this.divs.length=0}}},function(ed){var ad=ed.exports;ad.active=!0,ad.toggleMenu=function(id){menuHolder.style.display=id?"block":"none",chatHolder.style.bottom=(id?20:88)+"px",id&&(endUI.style.display="none",instructionHolder.style.display="block"),ad.active=!0},ad.hideUI=function(){ad.toggleMenu(!1),inGameUI.style.display="none",instructionHolder.style.display="none",chatHolder.style.bottom="20px",ad.active=!1},ad.showEndScreen=function(){endTable.style.display="none",endUI.style.display="block",ad.hideUI()},ad.toggleWindow=function(id){windowHolder.style.display=id?"block":"none",instructions.innerHTML=id?"":"CLICK TO PLAY"},ad.showError=function(id){ad.toggleMenu(!0),instructions.innerHTML=id},ad.toggleGameUI=function(id){topRight.style.display=id?"block":"none",crosshair.style.display=id?"block":"none",reloadMsg.style.display=id?"block":"none",healthHolder.style.display=id?"block":"none",weaponDisplay.style.display=id?"block":"none",ammoDisplay.style.display=id?"block":"none",killCardHolder.style.display=id?"none":"block",chatHolder.style.bottom=(id?88:20)+"px"},ad.toggleControlUI=function(id){window.loading&&(id=!1),inGameUI.style.display=id&&ad.active?"block":"none",instructionHolder.style.display=!id&&ad.active?"block":"none",aHolder.style.display=id?"none":"block",chatHolder.style.bottom=(id?88:20)+"px","block"!=endUI.style.display&&(menuHolder.style.display=id?"none":"block")};var rd=0,od=0;ad.updateCrosshair=function(id,nd){rd==Math.round(id)&&od==nd.round(1)||(od=nd.round(1),rd=Math.round(id),crosshair.style.width=rd+"px",crosshair.style.height=rd+"px",crosshair.style.opacity=od)}},function(ed,td,ad){var rd=ad(2);rd.Sprite.prototype.init=function(nd,sd,dd,ld,pd,cd,md,ud,gd){this.position.x=nd,this.position.y=sd,this.position.z=dd,this.xVel=ld,this.yVel=pd,this.zVel=cd,this.scale.x=this.scale.y=md,this.life=ud,this.area=gd},rd.Sprite.prototype.update=function(nd){if(this.visible){if(this.position.x+=this.xVel*nd,this.position.y+=this.yVel*nd,this.position.z+=this.zVel*nd,this.area){var sd=this.scale.x/2;this.position.x-sd>=this.area.x+this.area.s?this.position.x=this.area.x-this.area.s-sd:this.position.x+sd<=this.area.x-this.area.s&&(this.position.x=this.area.x+this.area.s+sd),this.position.z-sd>=this.area.z+this.area.s?this.position.z=this.area.z-this.area.s-sd:this.position.z+sd<=this.area.z-this.area.s&&(this.position.z=this.area.z+this.area.s+sd),this.position.y-sd>=this.area.y+this.area.h?this.position.y=this.area.y-sd:this.position.y+sd<=this.area.y&&(this.position.y=this.area.y+this.area.h+sd)}0<this.life&&(this.life-=nd,0>=this.life&&(this.visible=!1))}};var od=[Math.PI/3,-Math.PI/3],id=[{hole:!0,count:10,scale:[1,4],speed:[0,0.025],spread:[-0.4,0.4],life:[300,500]},{},{count:1,blending:2,scale:[5,7],speed:[0,0],spread:[0,0],life:[30,35]},{count:1,blending:2,scale:[2000,2000],speed:[0,0],spread:[0,0]}];ed.exports=function(nd,sd,dd){var ld,pd;this.particles=[],this.tracers=[],this.areas=[],this.active=!0,this.area=function(cd,md,ud,gd,hd,fd,yd){this.areas.push({f:yd,x:cd,y:md,z:ud,s:gd,h:hd});for(var xd=cd-gd,vd=ud-gd,Ld=2*gd/Math.sqrt(fd.count),bd=.9*Ld,_d=0;_d<fd.count;++_d)this.add(fd.src,xd+sd.randInt(-bd,bd),md+sd.randInt(0,hd),vd+sd.randInt(-bd,bd),fd.spd*Math.sin(fd.dir),fd.grav?sd.randFloat(fd.grav[0],fd.grav[1]):0,fd.spd*Math.cos(fd.dir),sd.randFloat(fd.scl[0],fd.scl[1]),0,fd.blending,this.areas[this.areas.length-1]),(xd+=Ld)>=gd&&(xd=cd-gd,vd+=Ld)},this.effect=function(cd,md,ud,gd,hd,fd){if(this.active){ld=id[fd];for(var yd=0;yd<ld.count;++yd){var xd=sd.randFloat(ld.speed[0],ld.speed[1]),vd=gd+sd.randFloat(ld.spread[0],ld.spread[1]),Ld=hd+sd.randFloat(ld.spread[0],ld.spread[1]);this.add(fd,cd,md,ud,xd*Math.sin(vd)*Math.cos(Ld),xd*Math.sin(Ld),xd*Math.cos(vd)*Math.cos(Ld),sd.randFloat(ld.scale[0],ld.scale[1]),ld.life?sd.randInt(ld.life[0],ld.life[1]):0,ld.blending)}ld.hole&&this.add(1,cd,md,ud,0,0,0,sd.randFloat(.4,1),5e3,rd.SubtractiveBlending)}},this.add=function(cd,md,ud,gd,hd,fd,yd,xd,vd,Ld,bd){pd=null;for(var _d=0;_d<this.particles.length;++_d)if(!this.particles[_d].visible&&!this.particles[_d].static){pd=this.particles[_d];break}pd||(pd=new rd.Sprite,this.particles.push(pd),nd.scene.add(pd)),this.setMaterial(pd,cd,Ld),pd.visible=!0,pd.init(md,ud,gd,hd,fd,yd,xd,vd,bd)},this.setMaterial=function(cd,md,ud,gd){cd.material=nd.getMat("particles/"+md,{mat:rd.SpriteMaterial,blending:ud||rd.NormalBlending,rotation:gd?od[sd.randInt(0,1)]:0})},this.tracer=function(cd,md,ud,gd,hd,fd){pd=null;for(var yd=0;yd<this.tracers.length;++yd)if(!this.tracers[yd].mesh.visible){pd=this.tracers[yd];break}pd||(pd=new function(xd){this.mesh=new rd.Mesh(xd.cubeGeo,xd.getMat("default",{fog:!1,mat:rd.MeshBasicMaterial,color:16777179})),this.init=function(vd,Ld,bd,_d,Ad,Ed,Sd){this.dst=Sd,this.spd=Ed,_d-=Math.PI,this.xS=Ed*Math.sin(_d)*Math.cos(Ad),this.zS=Ed*Math.cos(_d)*Math.cos(Ad),this.yS=Ed*Math.sin(Ad),xd.moveMesh(this.mesh,vd,Ld,bd),this.mesh.lookAt(vd+this.xS,Ld+this.yS,bd+this.zS),xd.scaleMesh(this.mesh,1.4,1.4,10)},this.update=function(vd){this.mesh.visible&&(this.mesh.position.x+=this.xS*vd,this.mesh.position.z+=this.zS*vd,this.mesh.position.y+=this.yS*vd,this.dst-=this.spd*vd,0>=this.dst&&(this.mesh.visible=!1))}}(nd),this.tracers.push(pd),nd.scene.add(pd.mesh)),pd.mesh.visible=!0,pd.init(cd,md,ud,gd,hd,dd.tracerSpeed,fd)},this.update=function(cd,md){if(md&&md.active)for(var ud=0;ud<this.areas.length;++ud)this.areas[ud].f&&(this.areas[ud].x=md.x,this.areas[ud].y=md.y,this.areas[ud].z=md.z);for(ud=0;ud<this.particles.length;++ud)this.particles[ud].update(cd);for(ud=0;ud<this.tracers.length;++ud)this.tracers[ud].update(cd)},this.reset=function(){this.particles.length=0,this.tracers.length=0,this.areas.length=0}}},function(ed){ed.exports=function(ad,rd){var od;this.sounds=[],this.listener={},this.setVolume=function(id){Howler.volume(id)},this.getSound=function(id,nd){var sd=id+(nd||"");(od=this.sounds[sd])||(od=new Howl({src:".././sound/"+id+".mp3"}),this.sounds[sd]=od)},this.play=function(id,nd,sd,dd){if(this.getSound(id),!sd||!od.isPlaying){od.isPlaying=!0;var ld=od.play();od.volume(nd||1,ld),od.loop(sd,ld),od.rate(dd||1,ld)}},this.play3D=function(id,nd,sd,dd,ld,pd,cd){this.getSound(id,"3d");var md=od.play();ld=(ld||1)*rd.otherSoundMlt,od.volume(ld,md),od.rate(pd||1,md),od.pos(nd,sd,dd,md),od.pannerAttr({refDistance:cd||25,rolloffFactor:1},md)}}},function(ed){function ad(rd){return!!rd.constructor&&"function"==typeof rd.constructor.isBuffer&&rd.constructor.isBuffer(rd)}ed.exports=function(rd){return null!=rd&&(ad(rd)||function(od){return"function"==typeof od.readFloatLE&&"function"==typeof od.slice&&ad(od.slice(0,0))}(rd)||!!rd._isBuffer)}},function(ed){!function(){var ad="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",rd={rotl:function(od,id){return od<<id|od>>>32-id},rotr:function(od,id){return od<<32-id|od>>>id},endian:function(od){if(od.constructor==Number)return 16711935&rd.rotl(od,8)|4278255360&rd.rotl(od,24);for(var id=0;id<od.length;id++)od[id]=rd.endian(od[id]);return od},randomBytes:function(od){for(var id=[];0<od;od--)id.push(Math.floor(256*Math.random()));return id},bytesToWords:function(od){for(var id=[],nd=0,sd=0;nd<od.length;nd++,sd+=8)id[sd>>>5]|=od[nd]<<24-sd%32;return id},wordsToBytes:function(od){for(var id=[],nd=0;nd<32*od.length;nd+=8)id.push(255&od[nd>>>5]>>>24-nd%32);return id},bytesToHex:function(od){for(var id=[],nd=0;nd<od.length;nd++)id.push((od[nd]>>>4).toString(16)),id.push((15&od[nd]).toString(16));return id.join("")},hexToBytes:function(od){for(var id=[],nd=0;nd<od.length;nd+=2)id.push(parseInt(od.substr(nd,2),16));return id},bytesToBase64:function(od){for(var id=[],nd=0;nd<od.length;nd+=3)for(var sd=od[nd]<<16|od[nd+1]<<8|od[nd+2],dd=0;4>dd;dd++)8*nd+6*dd<=8*od.length?id.push(ad.charAt(63&sd>>>6*(3-dd))):id.push("=");return id.join("")},base64ToBytes:function(od){od=od.replace(/[^A-Z0-9+\/]/gi,"");for(var id=[],nd=0,sd=0;nd<od.length;sd=++nd%4)0!=sd&&id.push((ad.indexOf(od.charAt(nd-1))&Math.pow(2,-2*sd+8)-1)<<2*sd|ad.indexOf(od.charAt(nd))>>>6-2*sd);return id}};ed.exports=rd}()},function(ed,td,ad){!function(){var rd=ad(64),od=ad(46).utf8,id=ad(63),nd=ad(46).bin,sd=function(dd,ld){dd.constructor==String?dd=ld&&"binary"===ld.encoding?nd.stringToBytes(dd):od.stringToBytes(dd):id(dd)?dd=Array.prototype.slice.call(dd,0):Array.isArray(dd)||(dd=dd.toString());for(var pd=rd.bytesToWords(dd),cd=8*dd.length,md=1732584193,ud=-271733879,gd=-1732584194,hd=271733878,fd=0;fd<pd.length;fd++)pd[fd]=16711935&(pd[fd]<<8|pd[fd]>>>24)|4278255360&(pd[fd]<<24|pd[fd]>>>8);pd[cd>>>5]|=128<<cd%32,pd[14+(cd+64>>>9<<4)]=cd;var yd=sd._ff,xd=sd._gg,vd=sd._hh,Ld=sd._ii;for(fd=0;fd<pd.length;fd+=16){var bd=md,_d=ud,Ad=gd,Ed=hd;ud=Ld(ud=Ld(ud=Ld(ud=Ld(ud=vd(ud=vd(ud=vd(ud=vd(ud=xd(ud=xd(ud=xd(ud=xd(ud=yd(ud=yd(ud=yd(ud=yd(ud,gd=yd(gd,hd=yd(hd,md=yd(md,ud,gd,hd,pd[fd+0],7,-680876936),ud,gd,pd[fd+1],12,-389564586),md,ud,pd[fd+2],17,606105819),hd,md,pd[fd+3],22,-1044525330),gd=yd(gd,hd=yd(hd,md=yd(md,ud,gd,hd,pd[fd+4],7,-176418897),ud,gd,pd[fd+5],12,1200080426),md,ud,pd[fd+6],17,-1473231341),hd,md,pd[fd+7],22,-45705983),gd=yd(gd,hd=yd(hd,md=yd(md,ud,gd,hd,pd[fd+8],7,1770035416),ud,gd,pd[fd+9],12,-1958414417),md,ud,pd[fd+10],17,-42063),hd,md,pd[fd+11],22,-1990404162),gd=yd(gd,hd=yd(hd,md=yd(md,ud,gd,hd,pd[fd+12],7,1804603682),ud,gd,pd[fd+13],12,-40341101),md,ud,pd[fd+14],17,-1502002290),hd,md,pd[fd+15],22,1236535329),gd=xd(gd,hd=xd(hd,md=xd(md,ud,gd,hd,pd[fd+1],5,-165796510),ud,gd,pd[fd+6],9,-1069501632),md,ud,pd[fd+11],14,643717713),hd,md,pd[fd+0],20,-373897302),gd=xd(gd,hd=xd(hd,md=xd(md,ud,gd,hd,pd[fd+5],5,-701558691),ud,gd,pd[fd+10],9,38016083),md,ud,pd[fd+15],14,-660478335),hd,md,pd[fd+4],20,-405537848),gd=xd(gd,hd=xd(hd,md=xd(md,ud,gd,hd,pd[fd+9],5,568446438),ud,gd,pd[fd+14],9,-1019803690),md,ud,pd[fd+3],14,-187363961),hd,md,pd[fd+8],20,1163531501),gd=xd(gd,hd=xd(hd,md=xd(md,ud,gd,hd,pd[fd+13],5,-1444681467),ud,gd,pd[fd+2],9,-51403784),md,ud,pd[fd+7],14,1735328473),hd,md,pd[fd+12],20,-1926607734),gd=vd(gd,hd=vd(hd,md=vd(md,ud,gd,hd,pd[fd+5],4,-378558),ud,gd,pd[fd+8],11,-2022574463),md,ud,pd[fd+11],16,1839030562),hd,md,pd[fd+14],23,-35309556),gd=vd(gd,hd=vd(hd,md=vd(md,ud,gd,hd,pd[fd+1],4,-1530992060),ud,gd,pd[fd+4],11,1272893353),md,ud,pd[fd+7],16,-155497632),hd,md,pd[fd+10],23,-1094730640),gd=vd(gd,hd=vd(hd,md=vd(md,ud,gd,hd,pd[fd+13],4,681279174),ud,gd,pd[fd+0],11,-358537222),md,ud,pd[fd+3],16,-722521979),hd,md,pd[fd+6],23,76029189),gd=vd(gd,hd=vd(hd,md=vd(md,ud,gd,hd,pd[fd+9],4,-640364487),ud,gd,pd[fd+12],11,-421815835),md,ud,pd[fd+15],16,530742520),hd,md,pd[fd+2],23,-995338651),gd=Ld(gd,hd=Ld(hd,md=Ld(md,ud,gd,hd,pd[fd+0],6,-198630844),ud,gd,pd[fd+7],10,1126891415),md,ud,pd[fd+14],15,-1416354905),hd,md,pd[fd+5],21,-57434055),gd=Ld(gd,hd=Ld(hd,md=Ld(md,ud,gd,hd,pd[fd+12],6,1700485571),ud,gd,pd[fd+3],10,-1894986606),md,ud,pd[fd+10],15,-1051523),hd,md,pd[fd+1],21,-2054922799),gd=Ld(gd,hd=Ld(hd,md=Ld(md,ud,gd,hd,pd[fd+8],6,1873313359),ud,gd,pd[fd+15],10,-30611744),md,ud,pd[fd+6],15,-1560198380),hd,md,pd[fd+13],21,1309151649),gd=Ld(gd,hd=Ld(hd,md=Ld(md,ud,gd,hd,pd[fd+4],6,-145523070),ud,gd,pd[fd+11],10,-1120210379),md,ud,pd[fd+2],15,718787259),hd,md,pd[fd+9],21,-343485551),md=md+bd>>>0,ud=ud+_d>>>0,gd=gd+Ad>>>0,hd=hd+Ed>>>0}return rd.endian([md,ud,gd,hd])};sd._ff=function(dd,ld,pd,cd,md,ud,gd){var hd=dd+(ld&pd|~ld&cd)+(md>>>0)+gd;return(hd<<ud|hd>>>32-ud)+ld},sd._gg=function(dd,ld,pd,cd,md,ud,gd){var hd=dd+(ld&cd|pd&~cd)+(md>>>0)+gd;return(hd<<ud|hd>>>32-ud)+ld},sd._hh=function(dd,ld,pd,cd,md,ud,gd){var hd=dd+(ld^pd^cd)+(md>>>0)+gd;return(hd<<ud|hd>>>32-ud)+ld},sd._ii=function(dd,ld,pd,cd,md,ud,gd){var hd=dd+(pd^(ld|~cd))+(md>>>0)+gd;return(hd<<ud|hd>>>32-ud)+ld},sd._blocksize=16,sd._digestsize=16,ed.exports=function(dd,ld){if(void 0===dd||null===dd)throw new Error("Illegal argument "+dd);var pd=rd.wordsToBytes(sd(dd,ld));return ld&&ld.asBytes?pd:ld&&ld.asString?nd.bytesToString(pd):rd.bytesToHex(pd)}}()},function(ed){"use strict";function rd(sd,dd){if(sd.map)return sd.map(dd);for(var ld=[],pd=0;pd<sd.length;pd++)ld.push(dd(sd[pd],pd));return ld}var od=function(sd){switch(typeof sd){case"string":return sd;case"boolean":return sd?"true":"false";case"number":return isFinite(sd)?sd:"";default:return"";}};ed.exports=function(sd,dd,ld,pd){return dd=dd||"&",ld=ld||"=",null===sd&&(sd=void 0),"object"==typeof sd?rd(nd(sd),function(cd){var md=encodeURIComponent(od(cd))+ld;return id(sd[cd])?rd(sd[cd],function(ud){return md+encodeURIComponent(od(ud))}).join(dd):md+encodeURIComponent(od(sd[cd]))}).join(dd):pd?encodeURIComponent(od(pd))+ld+encodeURIComponent(od(sd)):""};var id=Array.isArray||function(sd){return"[object Array]"===Object.prototype.toString.call(sd)},nd=Object.keys||function(sd){var dd=[];for(var ld in sd)Object.prototype.hasOwnProperty.call(sd,ld)&&dd.push(ld);return dd}},function(ed){"use strict";function rd(id,nd){return Object.prototype.hasOwnProperty.call(id,nd)}ed.exports=function(id,nd,sd,dd){nd=nd||"&",sd=sd||"=";var ld={};if("string"!=typeof id||0===id.length)return ld;var pd=/\+/g;id=id.split(nd);var cd=1e3;dd&&"number"==typeof dd.maxKeys&&(cd=dd.maxKeys);var md=id.length;0<cd&&md>cd&&(md=cd);for(var ud=0;ud<md;++ud){var xd=id[ud].replace(pd,"%20"),vd=xd.indexOf(sd),gd,hd,fd,yd;0<=vd?(gd=xd.substr(0,vd),hd=xd.substr(vd+1)):(gd=xd,hd=""),fd=decodeURIComponent(gd),yd=decodeURIComponent(hd),rd(ld,fd)?od(ld[fd])?ld[fd].push(yd):ld[fd]=[ld[fd],yd]:ld[fd]=yd}return ld};var od=Array.isArray||function(id){return"[object Array]"===Object.prototype.toString.call(id)}},function(ed,td,ad){"use strict";td.decode=td.parse=ad(67),td.encode=td.stringify=ad(66)},function(ed){"use strict";ed.exports={isString:function(rd){return"string"==typeof rd},isObject:function(rd){return"object"==typeof rd&&null!==rd},isNull:function(rd){return null===rd},isNullOrUndefined:function(rd){return null==rd}}},function(ed){ed.exports=function(ad){return ad.webpackPolyfill||(ad.deprecate=function(){},ad.paths=[],ad.children||(ad.children=[]),Object.defineProperty(ad,"loaded",{enumerable:!0,get:function(){return ad.l}}),Object.defineProperty(ad,"id",{enumerable:!0,get:function(){return ad.i}}),ad.webpackPolyfill=1),ad}},function(ed,td,ad){(function(rd,od){var id;!function(){function sd(Fd){throw RangeError(Cd[Fd])}function dd(Fd,Bd){for(var Ud=Fd.length,Nd=[];Ud--;)Nd[Ud]=Bd(Fd[Ud]);return Nd}function ld(Fd,Bd){var Ud=Fd.split("@"),Nd="";return 1<Ud.length&&(Nd=Ud[0]+"@",Fd=Ud[1]),Nd+dd((Fd=Fd.replace(Pd,".")).split("."),Bd).join(".")}function pd(Fd){for(var Nd=[],Wd=0,zd=Fd.length,Bd,Ud;Wd<zd;)55296<=(Bd=Fd.charCodeAt(Wd++))&&56319>=Bd&&Wd<zd?56320==(64512&(Ud=Fd.charCodeAt(Wd++)))?Nd.push(((1023&Bd)<<10)+(1023&Ud)+65536):(Nd.push(Bd),Wd--):Nd.push(Bd);return Nd}function cd(Fd){return dd(Fd,function(Bd){var Ud="";return 65535<Bd&&(Ud+=Dd(55296|1023&(Bd-=65536)>>>10),Bd=56320|1023&Bd),Ud+Dd(Bd)}).join("")}function md(Fd){return 10>Fd-48?Fd-22:26>Fd-65?Fd-65:26>Fd-97?Fd-97:Ld}function ud(Fd,Bd){return Fd+22+75*(26>Fd)-((0!=Bd)<<5)}function gd(Fd,Bd,Ud){var Nd=0;for(Fd=Ud?Id(Fd/700):Fd>>1,Fd+=Id(Fd/Bd);Fd>Od*_d>>1;Nd+=Ld)Fd=Id(Fd/Od);return Id(Nd+(Od+1)*Fd/(Fd+38))}function hd(Fd){var Yd=[],Xd=Fd.length,qd=0,Zd=Td,Jd=Sd,Bd,Ud,Nd,Wd,zd,Hd,Gd,Vd,kd,jd;for(0>(Ud=Fd.lastIndexOf(Md))&&(Ud=0),Nd=0;Nd<Ud;++Nd)128<=Fd.charCodeAt(Nd)&&sd("not-basic"),Yd.push(Fd.charCodeAt(Nd));for(Wd=0<Ud?Ud+1:0;Wd<Xd;){for(zd=qd,Hd=1,Gd=Ld;Wd>=Xd&&sd("invalid-input"),((Vd=md(Fd.charCodeAt(Wd++)))>=Ld||Vd>Id((vd-qd)/Hd))&&sd("overflow"),qd+=Vd*Hd,!(Vd<(kd=Gd<=Jd?bd:Gd>=Jd+_d?_d:Gd-Jd));Gd+=Ld)Hd>Id(vd/(jd=Ld-kd))&&sd("overflow"),Hd*=jd;Jd=gd(qd-zd,Bd=Yd.length+1,0==zd),Id(qd/Bd)>vd-Zd&&sd("overflow"),Zd+=Id(qd/Bd),qd%=Bd,Yd.splice(qd++,0,Zd)}return cd(Yd)}function fd(Fd){var Kd=[],Bd,Ud,Nd,Wd,zd,Hd,Gd,Vd,kd,jd,Yd,Xd,qd,Zd,Jd;for(Xd=(Fd=pd(Fd)).length,Bd=Td,Ud=0,zd=Sd,Hd=0;Hd<Xd;++Hd)128>(Yd=Fd[Hd])&&Kd.push(Dd(Yd));for(Nd=Wd=Kd.length,Wd&&Kd.push(Md);Nd<Xd;){for(Gd=vd,Hd=0;Hd<Xd;++Hd)(Yd=Fd[Hd])>=Bd&&Yd<Gd&&(Gd=Yd);for(Gd-Bd>Id((vd-Ud)/(qd=Nd+1))&&sd("overflow"),Ud+=(Gd-Bd)*qd,Bd=Gd,Hd=0;Hd<Xd;++Hd)if((Yd=Fd[Hd])<Bd&&++Ud>vd&&sd("overflow"),Yd==Bd){for(Vd=Ud,kd=Ld;!(Vd<(jd=kd<=zd?bd:kd>=zd+_d?_d:kd-zd));kd+=Ld)Jd=Vd-jd,Zd=Ld-jd,Kd.push(Dd(ud(jd+Jd%Zd,0))),Vd=Id(Jd/Zd);Kd.push(Dd(ud(Vd,0))),zd=gd(Ud,qd,Nd==Wd),Ud=0,++Nd}++Ud,++Bd}return Kd.join("")}"object"==typeof td&&td&&td.nodeType,"object"==typeof rd&&rd&&rd.nodeType;var yd="object"==typeof od&&od;yd.global!==yd&&yd.window!==yd&&yd.self;var vd=2147483647,Ld=36,bd=1,_d=26,Sd=72,Td=128,Md="-",wd=/^xn--/,Rd=/[^\x20-\x7E]/,Pd=/[\x2E\u3002\uFF0E\uFF61]/g,Cd={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},Od=Ld-bd,Id=Math.floor,Dd=String.fromCharCode,xd;xd={version:"1.3.2",ucs2:{decode:pd,encode:cd},decode:hd,encode:fd,toASCII:function(Fd){return ld(Fd,function(Bd){return Rd.test(Bd)?"xn--"+fd(Bd):Bd})},toUnicode:function(Fd){return ld(Fd,function(Bd){return wd.test(Bd)?hd(Bd.slice(4).toLowerCase()):Bd})}},void 0===(id=function(){return xd}.call(td,ad,td,rd))||(rd.exports=id)}()}).call(this,ad(70)(ed),ad(25))},function(ed,td,ad){"use strict";function rd(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function od(Ld,bd,_d){if(Ld&&nd.isObject(Ld)&&Ld instanceof rd)return Ld;var Ad=new rd;return Ad.parse(Ld,bd,_d),Ad}var id=ad(71),nd=ad(69);td.parse=od,td.resolve=function(Ld,bd){return od(Ld,!1,!0).resolve(bd)},td.resolveObject=function(Ld,bd){return Ld?od(Ld,!1,!0).resolveObject(bd):bd},td.format=function(Ld){return nd.isString(Ld)&&(Ld=od(Ld)),Ld instanceof rd?Ld.format():rd.prototype.format.call(Ld)},td.Url=rd;var sd=/^([a-z0-9.+-]+:)/i,dd=/:[0-9]*$/,ld=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,pd=["{","}","|","\\","^","`"].concat(["<",">","\"","`"," ","\r","\n","\t"]),cd=["'"].concat(pd),md=["%","/","?",";","#"].concat(cd),ud=["/","?","#"],gd=/^[+a-z0-9A-Z_-]{0,63}$/,hd=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,fd={javascript:!0,"javascript:":!0},yd={javascript:!0,"javascript:":!0},xd={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},vd=ad(68);rd.prototype.parse=function(Ld,bd,_d){if(!nd.isString(Ld))throw new TypeError("Parameter 'url' must be a string, not "+typeof Ld);var Ad=Ld.indexOf("?"),Ed=-1!==Ad&&Ad<Ld.indexOf("#")?"?":"#",Sd=Ld.split(Ed);Sd[0]=Sd[0].replace(/\\/g,"/");var Td=Ld=Sd.join(Ed);if(Td=Td.trim(),!_d&&1===Ld.split("#").length){var Md=ld.exec(Td);if(Md)return this.path=Td,this.href=Td,this.pathname=Md[1],Md[2]?(this.search=Md[2],this.query=bd?vd.parse(this.search.substr(1)):this.search.substr(1)):bd&&(this.search="",this.query={}),this}var wd=sd.exec(Td);if(wd){var Rd=(wd=wd[0]).toLowerCase();this.protocol=Rd,Td=Td.substr(wd.length)}if(_d||wd||Td.match(/^\/\/[^@\/]+@[^@\/]+/)){var Pd="//"===Td.substr(0,2);!Pd||wd&&yd[wd]||(Td=Td.substr(2),this.slashes=!0)}if(!yd[wd]&&(Pd||wd&&!xd[wd])){for(var Id=-1,Dd=0,Cd,Od;Dd<ud.length;Dd++)-1!==(Fd=Td.indexOf(ud[Dd]))&&(-1===Id||Fd<Id)&&(Id=Fd);for(-1!==(Od=-1===Id?Td.lastIndexOf("@"):Td.lastIndexOf("@",Id))&&(Cd=Td.slice(0,Od),Td=Td.slice(Od+1),this.auth=decodeURIComponent(Cd)),Id=-1,Dd=0;Dd<md.length;Dd++){var Fd;-1!==(Fd=Td.indexOf(md[Dd]))&&(-1===Id||Fd<Id)&&(Id=Fd)}-1===Id&&(Id=Td.length),this.host=Td.slice(0,Id),Td=Td.slice(Id),this.parseHost(),this.hostname=this.hostname||"";var Bd="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!Bd)for(var Ud=this.hostname.split(/\./),Nd=(Dd=0,Ud.length),Wd;Dd<Nd;Dd++)if(Wd=Ud[Dd],Wd&&!Wd.match(gd)){for(var zd="",Hd=0,Gd=Wd.length;Hd<Gd;Hd++)zd+=127<Wd.charCodeAt(Hd)?"x":Wd[Hd];if(!zd.match(gd)){var Vd=Ud.slice(0,Dd),kd=Ud.slice(Dd+1),jd=Wd.match(hd);jd&&(Vd.push(jd[1]),kd.unshift(jd[2])),kd.length&&(Td="/"+kd.join(".")+Td),this.hostname=Vd.join(".");break}}this.hostname=255<this.hostname.length?"":this.hostname.toLowerCase(),Bd||(this.hostname=id.toASCII(this.hostname));var Yd=this.port?":"+this.port:"",Xd=this.hostname||"";this.host=Xd+Yd,this.href+=this.host,Bd&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==Td[0]&&(Td="/"+Td))}if(!fd[Rd])for(Dd=0,Nd=cd.length;Dd<Nd;Dd++){var qd=cd[Dd];if(-1!==Td.indexOf(qd)){var Zd=encodeURIComponent(qd);Zd===qd&&(Zd=escape(qd)),Td=Td.split(qd).join(Zd)}}var Jd=Td.indexOf("#");-1!==Jd&&(this.hash=Td.substr(Jd),Td=Td.slice(0,Jd));var Kd=Td.indexOf("?");if(-1===Kd?bd&&(this.search="",this.query={}):(this.search=Td.substr(Kd),this.query=Td.substr(Kd+1),bd&&(this.query=vd.parse(this.query)),Td=Td.slice(0,Kd)),Td&&(this.pathname=Td),xd[Rd]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){Yd=this.pathname||"";var Qd=this.search||"";this.path=Yd+Qd}return this.href=this.format(),this},rd.prototype.format=function(){var Ld=this.auth||"";Ld&&(Ld=(Ld=encodeURIComponent(Ld)).replace(/%3A/i,":"),Ld+="@");var bd=this.protocol||"",_d=this.pathname||"",Ad=this.hash||"",Ed=!1,Sd="";this.host?Ed=Ld+this.host:this.hostname&&(Ed=Ld+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(Ed+=":"+this.port)),this.query&&nd.isObject(this.query)&&Object.keys(this.query).length&&(Sd=vd.stringify(this.query));var Td=this.search||Sd&&"?"+Sd||"";return bd&&":"!==bd.substr(-1)&&(bd+=":"),this.slashes||(!bd||xd[bd])&&!1!==Ed?(Ed="//"+(Ed||""),_d&&"/"!==_d.charAt(0)&&(_d="/"+_d)):Ed||(Ed=""),Ad&&"#"!==Ad.charAt(0)&&(Ad="#"+Ad),Td&&"?"!==Td.charAt(0)&&(Td="?"+Td),bd+Ed+(_d=_d.replace(/[?#]/g,function(Md){return encodeURIComponent(Md)}))+(Td=Td.replace("#","%23"))+Ad},rd.prototype.resolve=function(Ld){return this.resolveObject(od(Ld,!1,!0)).format()},rd.prototype.resolveObject=function(Ld){if(nd.isString(Ld)){var bd=new rd;bd.parse(Ld,!1,!0),Ld=bd}for(var _d=new rd,Ad=Object.keys(this),Ed=0,Sd;Ed<Ad.length;Ed++)Sd=Ad[Ed],_d[Sd]=this[Sd];if(_d.hash=Ld.hash,""===Ld.href)return _d.href=_d.format(),_d;if(Ld.slashes&&!Ld.protocol){for(var Td=Object.keys(Ld),Md=0,wd;Md<Td.length;Md++)wd=Td[Md],"protocol"!==wd&&(_d[wd]=Ld[wd]);return xd[_d.protocol]&&_d.hostname&&!_d.pathname&&(_d.path=_d.pathname="/"),_d.href=_d.format(),_d}if(Ld.protocol&&Ld.protocol!==_d.protocol){if(!xd[Ld.protocol]){for(var Rd=Object.keys(Ld),Pd=0,Cd;Pd<Rd.length;Pd++)Cd=Rd[Pd],_d[Cd]=Ld[Cd];return _d.href=_d.format(),_d}if(_d.protocol=Ld.protocol,Ld.host||yd[Ld.protocol])_d.pathname=Ld.pathname;else{for(var Od=(Ld.pathname||"").split("/");Od.length&&!(Ld.host=Od.shift()););Ld.host||(Ld.host=""),Ld.hostname||(Ld.hostname=""),""!==Od[0]&&Od.unshift(""),2>Od.length&&Od.unshift(""),_d.pathname=Od.join("/")}if(_d.search=Ld.search,_d.query=Ld.query,_d.host=Ld.host||"",_d.auth=Ld.auth,_d.hostname=Ld.hostname||Ld.host,_d.port=Ld.port,_d.pathname||_d.search){var Id=_d.pathname||"",Dd=_d.search||"";_d.path=Id+Dd}return _d.slashes=_d.slashes||Ld.slashes,_d.href=_d.format(),_d}var Fd=_d.pathname&&"/"===_d.pathname.charAt(0),Bd=Ld.host||Ld.pathname&&"/"===Ld.pathname.charAt(0),Ud=Bd||Fd||_d.host&&Ld.pathname,Nd=Ud,Wd=_d.pathname&&_d.pathname.split("/")||[],zd=(Od=Ld.pathname&&Ld.pathname.split("/")||[],_d.protocol&&!xd[_d.protocol]);if(zd&&(_d.hostname="",_d.port=null,_d.host&&(""===Wd[0]?Wd[0]=_d.host:Wd.unshift(_d.host)),_d.host="",Ld.protocol&&(Ld.hostname=null,Ld.port=null,Ld.host&&(""===Od[0]?Od[0]=Ld.host:Od.unshift(Ld.host)),Ld.host=null),Ud=Ud&&(""===Od[0]||""===Wd[0])),Bd)_d.host=Ld.host||""===Ld.host?Ld.host:_d.host,_d.hostname=Ld.hostname||""===Ld.hostname?Ld.hostname:_d.hostname,_d.search=Ld.search,_d.query=Ld.query,Wd=Od;else if(Od.length)Wd||(Wd=[]),Wd.pop(),Wd=Wd.concat(Od),_d.search=Ld.search,_d.query=Ld.query;else if(!nd.isNullOrUndefined(Ld.search))return zd&&(_d.hostname=_d.host=Wd.shift(),(jd=!!(_d.host&&0<_d.host.indexOf("@"))&&_d.host.split("@"))&&(_d.auth=jd.shift(),_d.host=_d.hostname=jd.shift())),_d.search=Ld.search,_d.query=Ld.query,nd.isNull(_d.pathname)&&nd.isNull(_d.search)||(_d.path=(_d.pathname?_d.pathname:"")+(_d.search?_d.search:"")),_d.href=_d.format(),_d;if(!Wd.length)return _d.pathname=null,_d.path=_d.search?"/"+_d.search:null,_d.href=_d.format(),_d;for(var Hd=Wd.slice(-1)[0],Gd=(_d.host||Ld.host||1<Wd.length)&&("."===Hd||".."===Hd)||""===Hd,Vd=0,kd=Wd.length;0<=kd;kd--)"."===(Hd=Wd[kd])?Wd.splice(kd,1):".."===Hd?(Wd.splice(kd,1),Vd++):Vd&&(Wd.splice(kd,1),Vd--);if(!Ud&&!Nd)for(;Vd--;Vd)Wd.unshift("..");!Ud||""===Wd[0]||Wd[0]&&"/"===Wd[0].charAt(0)||Wd.unshift(""),Gd&&"/"!==Wd.join("/").substr(-1)&&Wd.push("");var Yd=""===Wd[0]||Wd[0]&&"/"===Wd[0].charAt(0),jd;return zd&&(_d.hostname=_d.host=Yd?"":Wd.length?Wd.shift():"",(jd=!!(_d.host&&0<_d.host.indexOf("@"))&&_d.host.split("@"))&&(_d.auth=jd.shift(),_d.host=_d.hostname=jd.shift())),(Ud=Ud||_d.host&&Wd.length)&&!Yd&&Wd.unshift(""),Wd.length?_d.pathname=Wd.join("/"):(_d.pathname=null,_d.path=null),nd.isNull(_d.pathname)&&nd.isNull(_d.search)||(_d.path=(_d.pathname?_d.pathname:"")+(_d.search?_d.search:"")),_d.auth=Ld.auth||_d.auth,_d.slashes=_d.slashes||Ld.slashes,_d.href=_d.format(),_d},rd.prototype.parseHost=function(){var Ld=this.host,bd=dd.exec(Ld);bd&&(":"!==(bd=bd[0])&&(this.port=bd.substr(1)),Ld=Ld.substr(0,Ld.length-bd.length)),Ld&&(this.hostname=Ld)}},function(ed,td,ad){function rd(sd,dd,ld,pd,cd){"localhost"==location.hostname&&(window.location.hostname="127.0.0.1"),this.debugLog=!1,this.baseUrl=sd,this.lobbySize=ld,this.devPort=dd,this.lobbySpread=pd,this.rawIPs=!!cd,this.server=void 0,this.gameIndex=void 0,this.callback=void 0,this.errorCallback=void 0,this.processServers(vultr.servers)}var od=ad(72),id=ad(65);rd.prototype.regionInfo={0:{name:"Local",latitude:0,longitude:0},1:{name:"New Jersey",latitude:40.1393329,longitude:-75.8521818},2:{name:"Chicago",latitude:41.8339037,longitude:-87.872238},3:{name:"Dallas",latitude:32.8208751,longitude:-96.8714229},4:{name:"Seattle",latitude:47.6149942,longitude:-122.4759879},5:{name:"Los Angeles",latitude:34.0207504,longitude:-118.691914},6:{name:"Atlanta",latitude:33.7676334,longitude:-84.5610332},7:{name:"Amsterdam",latitude:52.3745287,longitude:4.7581878},8:{name:"London",latitude:51.5283063,longitude:-.382486},9:{name:"Frankfurt",latitude:50.1211273,longitude:8.496137},12:{name:"Silicon Valley",latitude:37.4024714,longitude:-122.3219752},19:{name:"Sydney",latitude:-33.8479715,longitude:150.651084},24:{name:"Paris",latitude:48.8588376,longitude:2.2773454},25:{name:"Tokyo",latitude:35.6732615,longitude:139.569959},39:{name:"Miami",latitude:25.7823071,longitude:-80.3012156},40:{name:"Singapore",latitude:1.3147268,longitude:103.7065876}},rd.prototype.start=function(sd,dd){this.callback=sd,this.errorCallback=dd;var ld=this.parseServerQuery();ld?(this.log("Found server in query."),this.password=ld[3],this.connect(ld[0],ld[1],ld[2])):(this.log("Pinging servers..."),this.pingServers())},rd.prototype.parseServerQuery=function(){var sd=od.parse(location.href,!0),dd=sd.query.server;if("string"==typeof dd){var ld=dd.split(":");if(3==ld.length)return[parseInt(ld[0]),parseInt(ld[1]),parseInt(ld[2]),sd.query.password];this.errorCallback("Invalid number of server parameters in "+dd)}},rd.prototype.findServer=function(sd,dd){var ld=this.servers[sd];if(Array.isArray(ld)){for(var pd=0,cd;pd<ld.length;pd++)if(cd=ld[pd],cd.index==dd)return cd;console.warn("Could not find server in region "+sd+" with index "+dd+".")}else this.errorCallback("No server list for region "+sd)},rd.prototype.pingServers=function(){var sd=this,dd=[];for(var ld in this.servers)if(this.servers.hasOwnProperty(ld)){var pd=this.servers[ld],cd=pd[Math.floor(Math.random()*pd.length)];void 0==cd?console.log("No target server for region "+ld):function(md,ud){var gd=new XMLHttpRequest;gd.onreadystatechange=function(fd){var yd=fd.target;if(4==yd.readyState)if(200==yd.status){for(var xd=0;xd<dd.length;xd++)dd[xd].abort();sd.log("Connecting to region",ud.region);var vd=sd.seekServer(ud.region);sd.connect(vd[0],vd[1],vd[2])}else console.warn("Error pinging "+ud.ip+" in region "+ld)};var hd="//"+sd.serverAddress(ud.ip,!0)+":"+sd.serverPort(ud)+"/ping";gd.open("GET",hd,!0),gd.send(null),sd.log("Pinging",hd),dd.push(gd)}(0,cd)}},rd.prototype.seekServer=function(sd,dd,ld){void 0==ld&&(ld="random"),void 0==dd&&(dd=!1);const pd=["random"];var cd=this.lobbySize,md=this.lobbySpread,ud=this.servers[sd].flatMap(function(vd){var Ld=0;return vd.games.map(function(bd){var _d=Ld++;return{region:vd.region,index:vd.index*vd.games.length+_d,gameIndex:_d,gameCount:vd.games.length,playerCount:bd.playerCount,isPrivate:bd.isPrivate}})}).filter(function(vd){return!vd.isPrivate}).filter(function(vd){return!dd||0==vd.playerCount&&vd.gameIndex>=vd.gameCount/2}).filter(function(vd){return"random"==ld||pd[vd.index%pd.length].key==ld}).sort(function(vd,Ld){return Ld.playerCount-vd.playerCount}).filter(function(vd){return vd.playerCount<cd});if(dd&&ud.reverse(),0!=ud.length){var gd=Math.min(md,ud.length),hd=Math.floor(Math.random()*gd),fd=ud[hd=Math.min(hd,ud.length-1)],yd=fd.region,xd=(hd=Math.floor(fd.index/fd.gameCount),fd.index%fd.gameCount);return this.log("Found server."),[yd,hd,xd]}this.errorCallback("No open servers.")},rd.prototype.connect=function(sd,dd,ld){if(!this.connected){var pd=this.findServer(sd,dd);void 0==pd?this.errorCallback("Failed to find server for region "+sd+" and index "+dd):(this.log("Connecting to server",pd,"with game index",ld),pd.games[ld].playerCount>=this.lobbySize?this.errorCallback("Server is already full."):(window.history.replaceState(document.title,document.title,this.generateHref(sd,dd,ld,this.password)),this.server=pd,this.gameIndex=ld,this.log("Calling callback with address",this.serverAddress(pd.ip),"on port",this.serverPort(pd),"with game index",ld),this.callback(this.serverAddress(pd.ip),this.serverPort(pd),ld)))}},rd.prototype.switchServer=function(sd,dd,ld,pd){this.switchingServers=!0,window.location.href=this.generateHref(sd,dd,ld,pd)},rd.prototype.generateHref=function(sd,dd,ld,pd){var cd="/?server="+sd+":"+dd+":"+ld;return pd&&(cd+="&password="+encodeURIComponent(pd)),cd},rd.prototype.serverAddress=function(sd,dd){return"127.0.0.1"==sd||"7f000001"==sd||"903d62ef5d1c2fecdcaeb5e7dd485eff"==sd?window.location.hostname:this.rawIPs?dd?"ip_"+this.hashIP(sd)+"."+this.baseUrl:sd:"ip_"+sd+"."+this.baseUrl},rd.prototype.serverPort=function(sd){return 0==sd.region?this.devPort:location.protocol.startsWith("https")?443:80},rd.prototype.processServers=function(sd){for(var dd={},ld=0;ld<sd.length;ld++){var pd=sd[ld],cd=dd[pd.region];void 0==cd&&(cd=[],dd[pd.region]=cd),cd.push(pd)}for(var md in dd)dd[md]=dd[md].sort(function(ud,gd){return ud.index-gd.index});this.servers=dd},rd.prototype.ipToHex=function(sd){return sd.split(".").map(dd=>("00"+parseInt(dd).toString(16)).substr(-2)).join("").toLowerCase()},rd.prototype.hashIP=function(sd){return id(this.ipToHex(sd))},rd.prototype.log=function(){return this.debugLog?console.log.apply(void 0,arguments):console.verbose?console.verbose.apply(void 0,arguments):void 0},window.testVultrClient=function(){function sd(pd,cd){(pd=`${pd}`)==(cd=`${cd}`)?console.log(`Assert ${dd} passed.`):console.warn(`Assert ${dd} failed. Expected ${cd}, got ${pd}.`),dd++}var dd=1,ld=new rd("test.io",-1,5,1,!1);ld.errorCallback=function(){},ld.processServers(function(pd){var cd=[];for(var md in pd)for(var ud=pd[md],gd=0;gd<ud.length;gd++)cd.push({ip:md+":"+gd,scheme:"testing",region:md,index:gd,games:ud[gd].map(hd=>({playerCount:hd,isPrivate:!1}))});return cd}({1:[[0,0,0,0],[0,0,0,0]],2:[[5,1,0,0],[0,0,0,0]],3:[[5,0,1,5],[0,0,0,0]],4:[[5,1,1,5],[1,0,0,0]],5:[[5,1,1,5],[1,0,4,0]],6:[[5,5,5,5],[2,3,1,4]],7:[[5,5,5,5],[5,5,5,5]]})),sd(ld.seekServer(1,!1),[1,0,0]),sd(ld.seekServer(1,!0),[1,1,3]),sd(ld.seekServer(2,!1),[2,0,1]),sd(ld.seekServer(2,!0),[2,1,3]),sd(ld.seekServer(3,!1),[3,0,2]),sd(ld.seekServer(3,!0),[3,1,3]),sd(ld.seekServer(4,!1),[4,0,1]),sd(ld.seekServer(4,!0),[4,1,3]),sd(ld.seekServer(5,!1),[5,1,2]),sd(ld.seekServer(5,!0),[5,1,3]),sd(ld.seekServer(6,!1),[6,1,3]),sd(ld.seekServer(6,!0),void 0),sd(ld.seekServer(7,!1),void 0),sd(ld.seekServer(7,!0),void 0),console.log("Tests passed.")};var nd=function(sd,dd){return sd.concat(dd)};Array.prototype.flatMap=function(sd){return function(dd,ld){return ld.map(dd).reduce(nd,[])}(sd,this)},ed.exports=rd},function(ed,td,ad){function rd(){window.innerWidth,dl=window.innerHeight,ll=dl/693,kd.resize()}function od(){pl=!1,window.idleTimer=0,Xd.toggleMenu(!0),Jd.toggle(!1)}function id(El){Nd&&Nd.setData(El),"block"==windowHolder.style.display&&5==fl&&showWindow(5,!0)}function nd(El){try{accResp.innerHTML=El||"",accResp.style.display=El?"block":"none"}catch(Sl){}}function sd(El,Sl){0<=El&&nd("Please Wait..."),Zd.send("a",El,Sl)}function dd(El,Sl,Tl,Ml,wl){El?nd(El):(Nd=new $d(Sl,Tl,null,Id),saveVal("krunker_username",Tl),id(Ml),wl&&saveVal("krunker_token",wl))}function ld(El){this.imgAsDataURL="",this.process=function(Sl){if(this.imgAsDataURL=URL.createObjectURL(Sl),this.imgAsDataURL&&El){try{var Tl=new Image;Tl.onload=function(){kd.updateTexture(El.replace("textures/","").replace(".png",""),this)},Tl.src=this.imgAsDataURL}catch(Ml){}xl.close()}}}function pd(El){this.filename=El;var Sl=this;this.process=function(Tl){var Ml=URL.createObjectURL(Tl);if(Ml){try{var wl=Sl.filename.split("/")[1];jd.sounds[wl]=new Howl({src:[Ml],format:"mp3"}),"ambient_1"==wl&&jd.play("ambient_1",.12,!0)}catch(Rl){}xl.close()}}}function cd(El,Sl){sl=Sl,xd(El),Xd.toggleMenu(!1),function(){Ll.length=0,_l.length=0,Xd.toggleGameUI(!0),qd.reset(),Jd.reset(),Qd.players.forcePos(),ol.length=0,window.loading=!1,window.idleTimer=0,instructions.innerHTML="CLICK TO PLAY",Gd=null;for(var Tl=0;Tl<playerInfos.children.length;Tl++)playerInfos.children[Tl].style.display="none"}(),Xd.toggleControlUI(Jd.enabled)}function md(El){gameName.innerText=El.name}function ud(El,Sl,Tl,Ml){Qd.init(El,Sl,Tl,Ml),rl=null,Jd.reset();var wl=Qd.map.maps[El];Jd.moveCam(wl.camPos[0],wl.camPos[1],wl.camPos[2]),Jd.rotateCam(0,0,0),kd.clearSprays(),kd.scene.add(Jd.object),Ud=null,playerInfos.innerHTML="",killsVal.innerHTML=0,nl=0,od()}function gd(El,Sl,Tl){instructions.innerHTML="CLICK TO PLAY",victoryText.innerHTML=Sl?"VICTORY":"DEFEAT",victorySub.src="./img/"+(Sl?"sub":"defeat")+".png",Ud&&Ud.active?(Xd.showEndScreen(),rl=Id.endAnim,setTimeout(function(){Jd.disable(),hd(Tl)},Id.endAnim)):El&&(Jd.disable(),Xd.showEndScreen(),hd(Tl))}function hd(El){if(El&&El.length){endTable.style.display="inline-block";for(var Sl="<tr><th>Rank</th>",Tl=Id.endStats.length,Ml=1;Ml<Tl;++Ml)Sl+="<th>"+Vd.capFirst(Id.endStats[Ml])+"</th>";Sl+="</tr>";var wl=1;for(Ml=0;Ml<El.length;){if(Wd=Qd.players.findBySid(El[Ml])){Sl+="<tr style='"+(Ml+Tl>=El.length?"border-bottom:none":"")+"'><td style='color:#fff'>"+wl+".</td>";for(var Rl=1;Rl<Tl;++Rl)Sl+="<td "+(1==Rl?"style='color:"+(Ud&&Ud.sid==Wd.sid?"#fff'":Ud&&Ud.team&&Ud.team==Wd.team?"rgba(255,255,255,0.6)'":"#eb5656'"):"")+">"+El[Ml+Rl]+"</td>"}Sl+="</tr>",wl++,Ml+=Tl}endTable.innerHTML=Sl}}function fd(El,Sl,Tl){Qd.playerSound(El,Sl,Tl)}function yd(El,Sl,Tl,Ml,wl,Rl,Pl){kd.addSpray(El,Sl,Tl,Ml,wl,Rl,Pl,Qd.sprays[Sl].opacity)}function xd(El,Sl){Sl?endTimer.innerHTML="Next Round in "+El:timerVal.innerHTML=El}function vd(El){for(var Sl=0,Tl;Sl<El.length;){if(Tl=El[Sl]==Zd.socketId,(Wd=Qd.players.add(El[Sl],El[Sl+1],El[Sl+2],El[Sl+3],El[Sl+4],El[Sl+5],El[Sl+6],Tl)).health=null==El[Sl+7]?Wd.maxHealth:El[Sl+7],Wd.team=El[Sl+8],Wd.level=El[Sl+9],Tl)Ud=Wd;else{playerInfos.innerHTML+="<div id='pInfo"+Wd.sid+"' class='playerInfo'>"+(Wd.level?"<div class='playerRank' id='pInfoR"+Wd.sid+"'>"+Wd.level+"</div>":"")+"<div class='pInfoH' id='pInfoH"+Wd.sid+"'>"+Wd.name+"<div></div><div class='playerHealth'><div class='healthBar"+(sl&&sl==Wd.team?"":"E")+"' id='healthBarE"+Wd.sid+"'></div></div></div></div>";var Ml=document.getElementById("pInfoH"+Wd.sid);Ml&&(Ml.style.textAlign=Wd.level?"left":"center")}wd(Wd.health,Wd.sid,null,null),Sl+=10}}function Ld(El){if(Zd.send("p"),Ud){Ud.x=El[1],Ud.y=El[2],Ud.z=El[3],Ud.xVel=El[4],Ud.yVel=El[5],Ud.zVel=El[6],Ud.onGround=El[7],Ud.didJump=El[8],Ud.onLadder=El[9],Ud.aimVal=El[10],Ud.crouchVal=El[11],Qd.players.swapWeapon(Ud,0,!1,El[12]);for(var Sl=0;Sl<Jd.tmpInputs.length;)Jd.tmpInputs[Sl][0]<=El[0]?Jd.tmpInputs.splice(Sl,1):(Ud.processInput(Jd.tmpInputs[Sl],Qd.map,!0),Sl++)}}function bd(El){Qd.players.hideAll();for(var Sl=0;Sl<El.length;)(Wd=Qd.players.findBySid(El[Sl]))&&(Wd.objInstances.visible=!0,Wd.forcePos?(Wd.x=El[Sl+1],Wd.y=El[Sl+2],Wd.z=El[Sl+3],Wd.xDir=El[Sl+4],Wd.yDir=El[Sl+5],Wd.interpolate=!1,Wd.forcePos=!1):(Wd.dt=0,Wd.x1=Wd.x,Wd.x2=El[Sl+1],Wd.y1=Wd.y,Wd.y2=El[Sl+2],Wd.z1=Wd.z,Wd.z2=El[Sl+3],Wd.xDir1=Wd.xDir,Wd.xDir2=El[Sl+4],Wd.yDir1=Wd.yDir,Wd.yDir2=El[Sl+5],Wd.interpolate=!0),Wd.onGround=El[Sl+6],Wd.crouchVal=El[Sl+7],Qd.players.swapWeapon(Wd,0,!1,El[Sl+8])),Sl+=9}function _d(El){Qd.players.remove(El)}function Ad(El,Sl,Tl){if(Wd=Qd.players.findBySid(El),zd=Qd.players.findBySid(Sl),Wd){if(Qd.players.kill(Wd),Wd.isYou){var Ml="";zd&&(Jd.camLookAt(zd.x,zd.y+zd.height-Id.cameraHeight,zd.z),zd.interpolate=!1,zd.isVisible=!0,Ml="<img id='kCProfile' src='./textures/classes/icon_"+zd.classIndex+".png' />",Ml+="<div id='kCName'>"+(zd?zd.name:"You")+"</div>",Ml+="<br/><div id='kCInfo'>["+Qd.weapons[Tl[0]].name+"] <span id='kCInfoS'>+"+Tl[1]+"</span></div>"),killCard.innerHTML=Ml,Xd.toggleGameUI(!1),setTimeout(function(){od()},Id.deathDelay)}var wl=Wd==Ud?"<span style='color:#fff'>You</span>":"<span style='color:"+(sl&&sl==Wd.team?"#9eeb56":"#eb5656")+"'>"+Wd.name+"</span>",Rl=zd==Ud?"<span style='color:#fff'>You</span>":zd?"<span style='color:"+(sl&&sl==zd.team?"#9eeb56":"#eb5656")+"'>"+zd.name+"</span>":"";Pd(null,zd?Rl+" killed "+wl:wl+" committed suicide",!0)}}function Ed(El){if(Ud){for(var Sl="",Tl=1,Ml=0;Ml<El.length;Ml+=4)Sl+="<div class='leaderItem'>",Sl+="<div class='leaderCounter'>"+Tl+".</div>",Sl+="<div class='leaderName"+(El[Ml]==Ud.sid?"M":sl&&sl==El[Ml+2]?"F":"")+"'>"+El[Ml+1]+"</div>",Sl+="<div class='leaderScore'>"+Vd.formatNum(El[Ml+3])+"</div>",Sl+="</div>",Tl++;leaderContainer.innerHTML=Sl}}function Sd(El,Sl,Tl,Ml,wl,Rl){if(Ud&&Ud.active){if(Wd=Qd.players.findBySid(El)){var Pl=Wd.y+Wd.height-Id.cameraHeight-Wd.crouchVal*Id.crouchDst,Cl=Vd.getDistance3D(Wd.x,Pl,Wd.z,Sl,Tl,Ml),Ol=Vd.getDirection(Wd.z,Wd.x,Ml,Sl),Il=Vd.getDirection(Vd.getDistance(Wd.x,Wd.z,Sl,Ml),Tl,0,Pl);Yd.tracer(Wd.x,Pl,Wd.z,Ol,Il,Cl)}void 0!=wl&&Yd.effect(Sl,Tl,Ml,wl,Rl,0)}}function Td(El){nl+=El,qd.animateText(scoreText,"+"+nl,100,.38,1100,100,0,function(){nl=0}),Ud.score+=El}function Md(El,Sl,Tl){if(El){for(var Ml=0==Ll.length,wl=0;wl<El.length;++wl)""==El[wl]?wl++:Ll.push(El[wl]);Ml&&function Rl(Pl){0<Ll.length&&qd.animateText(chalName,"<span class='cTxt'>"+Ll[0]+"</span><div id='chalScore'>+"+Ll[1]+"</div>",130,.4,Id.medalAnim,100,Pl,function(){Ll.splice(0,2),Rl(0)})}(Id.medalDelay)}Sl&&jd.play("headshot"),killsVal.innerHTML=Tl}function wd(El,Sl,Tl,Ml){if(Ud&&(Wd=void 0==Sl||null==Sl?Ud:Qd.players.findBySid(Sl))){Wd.health=El;var wl=100*(El/Wd.maxHealth);Wd==Ud?(healthValue.innerHTML=El+" <span id='maxHP'>|"+Wd.maxHealth+"</span>",healthBarH.style.width=wl+"%",healthBarH.style.backgroundColor=35>=wl?"#eb5656":"#9eeb56",bloodDisplay.style.display=35>=wl?"block":"none",bloodDisplay.style.opacity=1-wl/35,El<bl&&(void 0!=Tl&&null!=Tl&&function(Rl,Pl){for(var Cl=null,Ol=0;Ol<_l.length;++Ol)if(!_l[Ol].life){Cl=_l[Ol];break}Cl||(Cl={},_l.push(Cl)),Cl.life=Id.hitLife,Cl.x=Rl,Cl.z=Pl}(Tl,Ml),jd.play("impact_0",.6)),bl=El):document.getElementById("healthBarE"+Sl).style.width=wl+"%"}}function Rd(){jd.play("hit_0",3),qd.animateDiv(hitmarker,400,100,14)}function Pd(El,Sl,Tl){for(chatList.innerHTML+=Tl?"<div class='chatItem'><span class='chatMsg'>"+Sl+"</span></div><br/>":"<div class='chatItem'>"+(El||"unknown")+": <span class='chatMsg'>"+Sl+"</span></div><br/>";250<=chatList.scrollHeight;)chatList.removeChild(chatList.childNodes[0])}function Cd(El){Al=El,showWindow(0),Jd.disable(),Xd.hideUI(),instructionHolder.style.display="block",instructions.innerHTML="<span style='color: rgba(255, 255, 255, 0.6)'>"+El+"</span><br/><span style='color: rgba(255, 255, 255, 0.6)'>Try seeking a new server by clicking <a href='//krunker.io'>here</a>.</span>",instructionHolder.style.pointerEvents="all"}function Od(El,Sl){Zd.socket.onclose=function(){},Zd.socket.close(),Sl||(showWindow(0),Jd.disable(),Xd.hideUI(),instructionHolder.style.display="block",instructions.innerText=El||"DISCONNECTED")}var Id=ad(1),Dd="undefined"!=typeof Storage;window.saveVal=function(El,Sl){Dd&&localStorage.setItem(El,Sl)},window.getSavedVal=function(El){return Dd?localStorage.getItem(El):null};var Fd=new(ad(73))("krunker.io",3e3,Id.maxPlayers,Id.playerSpread,!1);window.switchServer=function(El,Sl,Tl){Fd.switchServer(El,Sl,Tl)},window.createPrivateRoom=function(){for(var El=[],Sl=0;Sl<Kd.length;Sl++)document.getElementById("gameMap"+Sl).checked&&El.push(Sl);0==El.length&&(El=[0]),saveVal("private-game-config",JSON.stringify({name:"KRUNKER",availableMaps:El}));var Tl=Fd.seekServer(Fd.server.region,!0);void 0==Tl?alert("No private servers available at this time"):Fd.switchServer(Tl[0],Tl[1],Tl[2],Vd.randomString(10))},Object.defineProperty(console,"_commandLineAPI",{get:function(){throw""}});var Bd=ad(2);Bd.OBJLoader=ad(45)(Bd);var Vd=ad(23),kd=new(ad(44))(Bd,Vd,Id),jd=new(ad(62))(Vd,Id),Yd=new(ad(61))(kd,Vd,Id),Xd=ad(60),qd=new(ad(59))(kd,Id),Zd=ad(43),Jd=new(ad(58))(kd,Bd,Xd,Vd,Id,Zd),Kd=ad(12).maps,Qd=(ad(12).modes,ad(57).obj),$d=ad(51),Ud,Nd,Wd,zd,Hd,Gd;Qd=new Qd(0,Id,null,Vd,kd,jd,Yd);var ol=[],il=0,nl=0,sl=0,el,tl,al,rl;window.idleTimer=0,Math.PI2=2*Math.PI,Math.lerpAngle=function(El,Sl,Tl){Math.abs(Sl-El)>Math.PI&&(El>Sl?Sl+=Math.PI2:El+=Math.PI2);var Ml=Sl+(El-Sl)*Tl;return 0<=Ml&&Ml<=Math.PI2?Ml:Ml%Math.PI2},console.warn=()=>{},console.info=()=>{};var pl=!1,dl,ll;window.loading=!1,window.enterGame=function(){if(Qd.singlePlayer&&!pl){cd("0:00");var El=Qd.getSpawnPoint();vd([Zd.socketId,1,El.x,El.y,El.z,"TEST",gl,null]),pl=!0,Ed([1,"TEST",0,0]),Xd.toggleMenu(!1)}else Zd.connected&&!pl&&(pl=!0,window.idleTimer=0,Xd.toggleMenu(!1),instructions.innerHTML="LOADING...",window.loading=!0,Zd.send("enter",[gl,vl]))},window.addEventListener("resize",rd),rd(),window.setSetting=function(El,Sl){document.getElementById("slid"+El)&&(document.getElementById("slid"+El).innerHTML=Sl),cl[El].set(Sl),cl[El].val=Sl,saveVal("sett_"+El,Sl)};for(var cl=[{name:"<div style='width:100%'><a href='javascript:;' onclick='showWindow(7);' class='menuLink'>Change Controls</a></div>",html:function(){return""}},{name:"Resolution",val:.7,html:function(){return"<span class='sliderVal' id='slid1'>"+cl[1].val+"</span><div class='slidecontainer'><input type='range' min='0.1' max='2' step='0.1' value='"+cl[1].val+"' class='sliderM' oninput='setSetting(1, this.value)'></div>"},set:function(El){kd.setResMlt(El)}},{name:"Sensitivity",val:1,html:function(){return"<span class='sliderVal' id='slid2'>"+cl[2].val+"</span><div class='slidecontainer'><input type='range' min='0.1' max='10' step='0.1' value='"+cl[2].val+"' class='sliderM' oninput='setSetting(2, this.value)'></div>"},set:function(El){Jd.sensMlt=El}},{name:"Field of View",val:Id.fov,html:function(){return"<span class='sliderVal' id='slid3'>"+cl[3].val+"</span><div class='slidecontainer'><input type='range' min='60' max='100' step='5' value='"+cl[3].val+"' class='sliderM' oninput='setSetting(3, this.value)'></div>"},set:function(El){kd.setFov(El)}},{name:"Sound",val:1,html:function(){return"<span class='sliderVal' id='slid4'>"+cl[4].val+"</span><div class='slidecontainer'><input type='range' min='0' max='1' step='0.1' value='"+cl[4].val+"' class='sliderM' oninput='setSetting(4, this.value)'></div>"},set:function(El){jd.setVolume(El)}},{name:"Particles",val:!0,html:function(){return"<label class='switch'><input type='checkbox' onclick='setSetting(5, this.checked)' "+(cl[5].val?"checked":"")+"><span class='slider'></span></label>"},set:function(El){Yd.active=El}},{name:"Invert Y-Axis",val:!1,html:function(){return"<label class='switch'><input type='checkbox' onclick='setSetting(6, this.checked)' "+(cl[6].val?"checked":"")+"><span class='slider'></span></label>"},set:function(El){Jd.invertY=El}},{name:"Show Chat",val:!0,html:function(){return"<label class='switch'><input type='checkbox' onclick='setSetting(7, this.checked)' "+(cl[7].val?"checked":"")+"><span class='slider'></span></label>"},set:function(El){chatHolder.style.display=El?"block":"none"}},{name:"Crosshair Color",val:"#ffffff",html:function(){return"<input type='color' id='head' name='color' value='"+cl[8].val+"' oninput='setSetting(8, this.value)' style='float:right;margin-top:5px'/>"},set:function(El){crosshairT.style.backgroundColor=El,crosshairB.style.backgroundColor=El,crosshairLL.style.backgroundColor=El,crosshairRL.style.backgroundColor=El}},{name:"Weapon Bobbing",val:1,html:function(){return"<span class='sliderVal' id='slid9'>"+cl[9].val+"</span><div class='slidecontainer'><input type='range' min='0' max='2' step='0.1' value='"+cl[9].val+"' class='sliderM' oninput='setSetting(9, this.value)'></div>"},set:function(El){kd.weaponLean=El}}],ml=0;ml<cl.length;++ml)if(cl[ml].set){var ul=getSavedVal("sett_"+ml);cl[ml].val=null===ul?cl[ml].val:ul,"false"==cl[ml].val&&(cl[ml].val=!1),cl[ml].set(cl[ml].val)}window.changeCont=function(El){showWindow(7,!0),3>=El?Jd.inputChanger=El:4==El?Jd.inputChanger="jumpKey":5==El?Jd.inputChanger="crouchKey":6==El?Jd.inputChanger="swapKeyD":7==El?Jd.inputChanger="swapKeyU":8==El?Jd.inputChanger="reloadKey":9==El?Jd.inputChanger="sprayKey":10==El?Jd.inputChanger="aimKey":11==El&&(Jd.inputChanger="chatKey"),document.getElementById("cont"+El).innerHTML="Press any Key"},window.registerAcc=function(){sd(0,[accName.value,accPass.value])},window.loginAcc=function(){sd(1,[accName.value,accPass.value,null])},window.logoutAcc=function(){sd(-1),nd(),Dd&&localStorage.removeItem("krunker_token"),Nd=null,id()};var gl=getSavedVal("classindex")||0;window.selectClass=function(El){saveVal("classindex",El),gl=El,showWindow(3)};var hl=[{header:"Game Settings",gen:function(){for(var El="",Sl=0;Sl<cl.length;++Sl)El+="<div class='settName'>"+cl[Sl].name+" "+cl[Sl].html()+"</div>";return El}},{header:"Server Browser",lastLoadTime:0,gen:function(){return 1e4>Date.now()-this.lastLoadTime?this.genList():this.loadData()},loadData:function(){var El=new XMLHttpRequest,Sl=this;return El.onreadystatechange=function(){4==this.readyState&&(200==this.status?(window.vultr=JSON.parse(this.responseText),Fd.processServers(vultr.servers),Sl.lastLoadTime=Date.now(),window.showWindow(2,!0)):console.error("Failed to load server data with status code:",this.status))},El.open("GET","/serverData",!0),El.send(),"Loading..."},expandedRegion:-1,genList:function(){var El=this;window.setExpandedRegion=function(Vl){El.expandedRegion=Vl,El.lastLoadTime=Date.now(),showWindow(2,!0)};var Sl="<div style='font-size:20px'>";Sl+="<a id='createPrivateRoom' class='menuLink' onclick='showWindow(8)'>+ Private Game</a><br/>";var Tl=0,Ml=0;for(var wl in Fd.servers){for(var Rl=Fd.servers[wl],Pl=0,Cl=0;Cl<Rl.length;Cl++)for(var Ol=0;Ol<Rl[Cl].games.length;Ol++)Pl+=Rl[Cl].games[Ol].playerCount;Tl+=Pl;var Il=Fd.regionInfo[wl].name,Dl=Il+" - "+Pl+" online",Fl=this.expandedRegion==Ml;if(Sl+="<div class='menuSelectorHeader' onclick='setExpandedRegion("+(Fl?-1:Ml)+")' style='cursor: pointer;'>"+(Fl?"&#x25BC;":"&#x25B6;")+" "+Dl+"</div>",Fl){Sl+="<div class='menuSelectorHolder'>";for(var Bl=0;Bl<Rl.length;Bl++)for(var Ul=Rl[Bl],Nl=0;Nl<Ul.games.length;Nl++){var Wl=Ul.games[Nl],zl=Ul.index*Id.gamesPerServer+Nl+1,Hl=Fd.server&&Fd.server.region==Ul.region&&Fd.server.index==Ul.index&&Fd.gameIndex==Nl,Gl=Il+" "+zl+" - "+Wl.playerCount+"/"+Id.maxPlayers+" online";Sl+="<div class='menuSelector"+(Hl?" selectedMenuSelector":"")+(Wl.isPrivate?" privateMenuSelector":"")+"' onclick='"+(Wl.isPrivate?"":"switchServer("+wl+","+Bl+","+Nl+")")+"'>"+Gl+"</div>"}Sl+="</div>"}Sl+="<br/>",Ml++}return(Sl+="<b>"+Tl+" total online</b>")+"</div>"}},{header:"Change Loadout",gen:function(){var El=Qd.classes[gl];return"<div class='settName'>Class<span class='settText floatR' onclick='showWindow(6)'>"+El.name+"</span></div><div class='settName'>Primary<span class='settLabel'>"+Qd.weapons[El.loadout[0]].name+"</span></div><div class='settName'>Secondary<span class='settLabel'>"+(El.loadout[1]?Qd.weapons[El.loadout[1]].name:"None")+"</span></div><div class='settName'>Spray<span onclick='showWindow(9)' class='settText floatR'>"+Qd.sprays[vl].name+"</span></div>"}},{header:"Mod Manager",gen:function(){return"<div id='modLinks'><a href='./docs/mods.txt' class='menuLink'>Mod Guide</a> | <a href='' class='menuLink'>Find Mods</a></div><form id='modDropper'><input onchange='loadMod()' id='modInput'type='file'><p id='modLInfo'>drop mod file here or click</p></form>"}},{header:"Account",gen:function(){return Nd?"<div class='settName'>Name<span class='floatR'>"+Nd.name+"</span></div><div class='settName'>Level<span class='floatR'><img src='./img/levels/"+Math.max(Math.min(Id.maxLevel,Nd.level.roundToNearest(3)-2),0)+".png' class='rnkIcon'>"+Nd.level+"</span></div><div class='settName'>Score<span class='floatR'>"+Nd.score+"</span></div><div class='settName'>Kills<span class='floatR'>"+Nd.kills+"</span></div><div class='settName'>Deaths<span class='floatR'>"+Nd.deaths+"</span></div><div class='settName'>KDR<span class='floatR'>"+(Nd.kills/Math.max(Nd.deaths,1)).toFixed(2)+"</span></div><div class='settName'>Games Played<span class='floatR'>"+Nd.games+"</span></div><div class='settName'>Games Won<span class='floatR'>"+Nd.wins+"</span></div><div class='settName'>W/L<span class='floatR'>"+(Nd.wins/Math.max(Nd.games-Nd.wins,1)).toFixed(2)+"</span></div><div class='settName'>Time Played<span class='floatR'>"+Vd.getReadableTime(Nd.timePlayed)+"</span></div><div style='height:10px'></div><a class='menuLink' onclick='logoutAcc()'>Logout</a>":"<input id='accName' type='text' placeholder='Username' class='accountInput' style='margin-top:0' value='"+(getSavedVal("krunker_username")||"")+"'></input><input id='accPass' type='password' placeholder='Password' class='accountInput'></input><div id='accResp' style='margin-top:15px;color:rgba(0,0,0,0.7);display:none'></div><div class='accountButton' onclick='registerAcc()'>Register</div><div class='accountButton' onclick='loginAcc()' style='margin-left: 20px'>Login</div>"}},{header:"Select Class",gen:function(){for(var El="",Sl=0;Sl<Qd.classes.length;++Sl)El+="<div class='selItem' style='margin-top:"+(0<Sl?"10px":"")+"'><div class='equipBtn' onclick='selectClass("+Sl+")'><i class='material-icons'>&#xE037</i></div><div class='itemIcon'><img class='itemIconImg' src='./textures/classes/icon_"+Sl+".png'/></div><div class='itemInfo'><div class='itemName'>"+Qd.classes[Sl].name+"</div><div class='itemCat'>"+Qd.weapons[Qd.classes[Sl].loadout[0]].name+"</div></div></div>";return El}},{header:"Change Controls",gen:function(){var El="";return El+="<div class='settName'>Forward<span class='settText floatR' id='cont0' onclick='changeCont(0)'>"+Vd.getKeyName(Jd.moveKeys[0])+"</span></div>",El+="<div class='settName'>Backward<span class='settText floatR' id='cont1' onclick='changeCont(1)'>"+Vd.getKeyName(Jd.moveKeys[1])+"</span></div>",El+="<div class='settName'>Left<span class='settText floatR' id='cont2' onclick='changeCont(2)'>"+Vd.getKeyName(Jd.moveKeys[2])+"</span></div>",El+="<div class='settName'>Right<span class='settText floatR' id='cont3' onclick='changeCont(3)'>"+Vd.getKeyName(Jd.moveKeys[3])+"</span></div>",El+="<div class='settName'>Reload<span class='settText floatR' id='cont8' onclick='changeCont(8)'>"+Vd.getKeyName(Jd.reloadKey)+"</span></div>",El+="<div class='settName'>Aim<span class='settText floatR' id='cont10' onclick='changeCont(10)'>"+Vd.getKeyName(Jd.aimKey)+"</span></div>",El+="<div class='settName'>Spray<span class='settText floatR' id='cont9' onclick='changeCont(9)'>"+Vd.getKeyName(Jd.sprayKey)+"</span></div>",El+="<div class='settName'>Jump<span class='settText floatR' id='cont4' onclick='changeCont(4)'>"+Vd.getKeyName(Jd.jumpKey)+"</span></div>",El+="<div class='settName'>Crouch<span class='settText floatR' id='cont5' onclick='changeCont(5)'>"+Vd.getKeyName(Jd.crouchKey)+"</span></div>",El+="<div class='settName'>Next Weapon<span class='settText floatR' id='cont6' onclick='changeCont(6)'>"+Vd.getKeyName(Jd.swapKeyD)+"</span></div>",(El+="<div class='settName'>Previous Weapon<span class='settText floatR' id='cont7' onclick='changeCont(7)'>"+Vd.getKeyName(Jd.swapKeyU)+"</span></div>")+"<div class='settName'>Chat<span class='settText floatR' id='cont11' onclick='changeCont(11)'>"+Vd.getKeyName(Jd.chatKey)+"</span></div>"}},{header:"Create Private Game",gen:function(){var El="";El+="<div class='settName'>Select Maps</div>",El+="<div style='margin-top:5px'>";for(var Sl=0,Tl;Sl<Kd.length;Sl++)Tl="<label class='switch'><input id='gameMap"+Sl+"' type='checkbox' checked=''><span class='slider'></span></label>",El+="<div class='settNameSmall' style='margin:0'>"+Kd[Sl].name+Tl+"</div>";return El+="</div><br />",El+="<div style='text-align: left'>",El+="<a class='menuLink' onclick='createPrivateRoom()'>Create Game</a><br/>",(El+="<span style='opacity: 0.5'>Share the URL with your friends</span>")+"</div>"}},{header:"Select Spray",gen:function(){for(var El="",Sl=0;Sl<Qd.sprays.length;++Sl)El+="<div class='selItem' style='margin-top:"+(0<Sl?"10px":"")+"'><div class='equipBtn' onclick='selectSpray("+Sl+")'><i class='material-icons'>&#xE037</i></div><div class='itemIcon'><img class='itemIconImg' src='./textures/sprays/"+Sl+".png'/></div><div class='itemInfo'><div class='itemName'>"+Qd.sprays[Sl].name+"</div><div class='itemCat'>Default Spray</div></div></div>";return El}},{header:"Custom Maps",gen:function(){return"<a href='./editor.html' class='menuLink'>Map Editor</a><br/><input id='mapData' type='text' placeholder='Copy Map Data' class='mapInput' /><div class='mapLoadButton' onclick='loadCustomMap()'>Load</div>"}}];for(ml=0;ml<hl.length;++ml)hl[ml].html="";var fl=0;window.showWindow=function(El,Sl){window.idleTimer=0,Sl||El&&("block"!=windowHolder.style.display||El!=fl)?(menuWindow.innerHTML=hl[El-1].gen?hl[El-1].gen():hl[El-1].html,fl=El,windowHeader.innerHTML=hl[El-1].header,Xd.toggleWindow(!0)):(Xd.toggleWindow(!1),Jd.inputChanger=null)},window.loadCustomMap=function(){Od(null,!0),Qd.singlePlayer=!0;try{var El=JSON.parse(mapData.value);Qd.map.maps=[El];for(var Sl=0;Sl<Qd.map.maps.length;++Sl)for(var Tl=0;Tl<Qd.map.maps[Sl].objects.length;++Tl)Qd.map.maps[Sl].objects[Tl].id=Id.prefabIDS[Qd.map.maps[Sl].objects[Tl].id];ud(0,null,null,!0)}catch(Ml){}},zip.workerScriptsPath="./libs/";var yl=new FileReader;yl.onload=function(El){!function(Sl){try{var Tl="";zip.createReader(new zip.Data64URIReader(Sl),function(Ml){Ml.getEntries(function(wl){if(wl.length){xl.init(Ml,wl.length);for(var Rl=0,Pl;Rl<wl.length;Rl++)Pl=wl[Rl],Pl.directory?xl.close():"textures"==(Tl=Pl.filename.split("/")[0])?Pl.getData(new zip.BlobWriter("image/png"),new ld(Pl.filename).process,function(){}):"sound"==Tl&&Pl.getData(new zip.BlobWriter("audio/mp3"),new pd(Pl.filename.replace(".mp3","")).process,function(){})}})},function(){modLInfo.innerHTML="mod error!"})}catch(Ml){modLInfo.innerHTML="mod error!"}}(El.target.result)};var xl=new function(){this.init=function(El,Sl){this.numFiles=Sl,this.progress=0,this.reader=El},this.close=function(){this.reader&&(this.progress++,modLInfo.innerHTML="extracting "+this.progress+"/"+this.numFiles,this.numFiles===this.progress&&(spriteIndex=0,modLInfo.innerHTML="success!",this.reader.close(),this.reader=void 0))}};window.loadMod=function(){if(modInput.files&&modInput.files[0]){var El=modInput.files[0];"zip"==El.name.split(".").pop().toLowerCase()?(modLInfo.innerHTML="loading mod...",yl.readAsDataURL(El)):modLInfo.innerHTML="invalid mod file!"}};var vl=getSavedVal("sprayindex")||0;window.selectSpray=function(El){saveVal("sprayindex",El),vl=El,showWindow(3)};var Ll=[],bl=0,_l=[];window.pressButton=function(El){El==Jd.chatKey&&(document.activeElement==chatInput?(""!=chatInput.value&&(Zd.send("c",chatInput.value),chatInput.value=""),chatInput.blur()):chatInput.focus()),Ud&&Ud.active&&El==Jd.sprayKey&&Zd.send("s")};var Al;Fd.start(function(El,Sl,Tl){var Ml="//"+El+":8008/?gameIndex="+Tl;if(void 0!=Fd.password&&(Ml+="&password="+encodeURIComponent(Fd.password),void 0!=Fd.password&&!Fd.server.games[Fd.gameIndex].isPrivate)){var wl=getSavedVal("private-game-config");Ml+="&serverConfig="+encodeURIComponent(wl)}Zd.connect(Ml,function(Rl){if(Rl){if(void 0!=Al)return;Od()}else od(),function(){var Pl=getSavedVal("krunker_token"),Cl=getSavedVal("krunker_username");Pl&&Cl&&sd(1,[Cl,null,Pl])}()},{config:md,init:ud,start:cd,end:gd,error:Cd,t:xd,0:vd,1:bd,8:Ld,2:_d,3:Ad,4:Rd,5:Td,6:Md,7:Ed,9:Sd,h:wd,s:fd,sp:yd,ch:Pd,a:dd,ua:id})},function(El){Cd(El)}),window.requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(El){window.setTimeout(El,1e3/60)},setInterval(function(){!Qd.singlePlayer&&Ud&&Ud.active&&(Zd.send("0",ol),ol.length=0)},Id.clientSendRate),setInterval(function(){if(!Qd.singlePlayer&&Ud&&Ud.active)for(var El=0;El<Qd.players.list.length;++El)if((Wd=Qd.players.list[El]).active&&Wd.objInstances&&Wd!=Ud&&(Wd.isVisible=!0,!sl||sl!=Wd.team))for(var Sl=Vd.getDistance3D(Ud.x,Ud.y,Ud.z,Wd.x,Wd.y,Wd.z),Tl=Vd.getDirection(Ud.z,Ud.x,Wd.z,Wd.x),Ml=Vd.getDirection(Vd.getDistance(Ud.x,Ud.z,Wd.x,Wd.z),Wd.y,0,Ud.y),wl=1/(Sl*Math.sin(Tl-Math.PI)*Math.cos(Ml)),Rl=1/(Sl*Math.cos(Tl-Math.PI)*Math.cos(Ml)),Pl=1/(Sl*Math.sin(Ml)),Cl=0;Cl<Qd.map.manager.objects.length;++Cl)if(zd=Qd.map.manager.objects[Cl],tmpDst=Vd.lineInRect(Ud.x,Ud.z,Ud.y+Ud.height-Id.cameraHeight,wl,Rl,Pl,zd.x-zd.width,zd.z-zd.length,zd.y-zd.height,zd.x+zd.width,zd.z+zd.length,zd.y+zd.height),tmpDst&&1>tmpDst){Wd.isVisible=!1;break}},Id.nameVisRate),al=Date.now(),function El(){el=Date.now(),tl=el-al,tl=Math.min(tl,Id.maxDelta),al=el,0<rl&&0>=(rl-=tl)&&(rl=0),null!=rl&&(tl*=rl/Id.endAnim),Ud||(il+=1e-4*tl,il%=2*Math.PI,Jd.rotateCam(il,0,0)),Jd.update(tl),Ud&&Ud.active&&(Jd.skipScroll=!1,Hd=[Jd.getISN(),tl,Jd.xDir,Jd.yDir,Id.movDirs.indexOf(Jd.moveDir),Jd.mouseDownL,Jd.mouseDownR||Jd.keys[Jd.aimKey]?1:0,Jd.keys[Jd.jumpKey]?1:0,Jd.keys[Jd.crouchKey]?1:0,Jd.keys[Jd.reloadKey]?1:0,Jd.scrollDelta],Jd.scrollDelta&&(Jd.skipScroll=!0),Jd.scrollDelta=0,Jd.tmpInputs.push(Hd),Ud.processInput(Hd,Qd.map),Jd.moveCam(Ud.x,Ud.y+Ud.height-Id.cameraHeight,Ud.z),Jd.rotateCam(0,Ud.recoilAnimY*Id.recoilMlt,0),Xd.updateCrosshair(Math.max(.05*window.innerHeight,Ud.spread*ll),Ud.aimVal*(Ud.weapon.melee||0<Ud.reloadTimer?0:1)),Qd.singlePlayer||function(Sl){for(var Tl=ol.length?1:0;Tl<Sl.length;)if(2==Tl&&Gd&&Gd[2]==Sl[2]&&Gd[3]==Sl[3])ol.push("x"),Tl+=2;else{if(5==Tl&&Gd&&Gd[5]==Sl[5]&&Gd[6]==Sl[6]&&Gd[7]==Sl[7]&&Gd[8]==Sl[8]&&Gd[9]==Sl[9]&&Gd[10]==Sl[10]){ol.push("x");break}ol.push(Sl[Tl]),Tl++}Gd=Sl}(Hd),Howler.pos(Ud.x,Ud.y+Ud.height-Id.cameraHeight,Ud.z),Howler.orientation(Math.sin(Jd.xDir+Math.PI),Jd.yDir,Math.cos(Jd.xDir+Math.PI)),Ud.y<=Id.deathY&&Ad(Ud.sid)),Qd.update(tl,el,Ud),function(Sl){var Tl="";if(Ud&&Ud.active)for(var Ml=0;Ml<_l.length;++Ml)_l[Ml].life&&(_l[Ml].life-=Sl,0>=_l[Ml].life&&(_l[Ml].life=0),Tl+="<div class='hitInd' style='transform: translate(0, -50%) rotate("+(Jd.xDir+Vd.getDirection(_l[Ml].x,_l[Ml].z,Ud.x,Ud.z))+"rad);opacity:"+_l[Ml].life/Id.hitLife+"'></div>");hitHolder.innerHTML=Tl}(tl),qd.update(tl),"block"==menuHolder.style.display&&(window.idleTimer+=tl,window.idleTimer>=Id.kickTimer&&Od("Kicked for inactivity")),requestAnimFrame(El)}()}]);
